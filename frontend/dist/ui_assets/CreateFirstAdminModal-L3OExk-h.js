import{u as C,X as A,K as r,c as y,w as P,$ as S,n as V,l as i,g,e as s,j as M,V as B,J as U,d as u,h as v,O as p,Y as f,t as q}from"./index-DBRQkGj9.js";import{_ as j}from"./GenericModal-CuRb-XTE.js";const D={class:"flex justify-center mb-6"},E=["src"],L=["disabled"],N=["disabled"],T=["disabled"],z={key:0,class:"text-xs text-red-500 mt-1"},F=["disabled"],I={key:0,class:"text-xs text-red-500 mt-1"},O={key:0,class:"text-red-600 text-sm text-center p-2 bg-red-100 dark:bg-red-900/50 rounded-md",role:"alert"},W={class:"pt-2"},$=["disabled"],H={key:0,class:"flex items-center"},J={key:1},Y={__name:"CreateFirstAdminModal",setup(K){const h=C(),k=A(),m=r(""),c=r(""),l=r(""),n=r(""),a=r(!1),o=r(""),w=y(()=>l.value===n.value),b=y(()=>l.value.length>=8),x=r(null);P(()=>k.activeModal,d=>{d==="firstAdminSetup"&&S(()=>{var e;(e=x.value)==null||e.focus()})});const _=async()=>{var d,e;if(o.value="",!m.value||!c.value||!l.value||!n.value){o.value="All fields are required.";return}if(!b.value){o.value="Password must be at least 8 characters long.";return}if(!w.value){o.value="Passwords do not match.";return}a.value=!0;try{await h.register({username:m.value,email:c.value,password:l.value})}catch(t){o.value=((e=(d=t.response)==null?void 0:d.data)==null?void 0:e.detail)||"An unexpected error occurred during registration."}finally{a.value=!1}};return(d,e)=>(i(),V(j,{modalName:"firstAdminSetup",title:"Welcome! First Admin Setup",showCloseButton:!1,allowOverlayClose:!1,maxWidthClass:"max-w-md"},{body:g(()=>[s("div",D,[s("img",{src:M(B),alt:"Application Logo",class:"h-16 w-auto"},null,8,E)]),e[9]||(e[9]=s("div",{class:"text-sm bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 p-3 rounded-md mb-4"}," This is your first time running the application. Please create an administrator account. ",-1)),s("form",{onSubmit:U(_,["prevent"]),class:"space-y-4"},[s("div",null,[e[4]||(e[4]=s("label",{for:"admin-username",class:"block text-sm font-medium"},"Username",-1)),p(s("input",{ref_key:"usernameInput",ref:x,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),type:"text",id:"admin-username",required:"",disabled:a.value,class:"input-field mt-1 w-full",placeholder:"Choose a username",autocomplete:"username"},null,8,L),[[f,m.value]])]),s("div",null,[e[5]||(e[5]=s("label",{for:"admin-email",class:"block text-sm font-medium"},"Email Address",-1)),p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),type:"email",id:"admin-email",required:"",disabled:a.value,class:"input-field mt-1 w-full",placeholder:"your@email.com",autocomplete:"email"},null,8,N),[[f,c.value]])]),s("div",null,[e[6]||(e[6]=s("label",{for:"admin-password",class:"block text-sm font-medium"},"Password",-1)),p(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.value=t),type:"password",id:"admin-password",required:"",disabled:a.value,class:"input-field mt-1 w-full",placeholder:"Create a password (min. 8 characters)",autocomplete:"new-password"},null,8,T),[[f,l.value]]),l.value&&!b.value?(i(),u("p",z," Password must be at least 8 characters. ")):v("",!0)]),s("div",null,[e[7]||(e[7]=s("label",{for:"admin-confirm-password",class:"block text-sm font-medium"},"Confirm Password",-1)),p(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>n.value=t),type:"password",id:"admin-confirm-password",required:"",disabled:a.value,class:"input-field mt-1 w-full",placeholder:"Confirm your password",autocomplete:"new-password"},null,8,F),[[f,n.value]]),n.value&&!w.value?(i(),u("p",I," Passwords do not match. ")):v("",!0)]),o.value?(i(),u("div",O,q(o.value),1)):v("",!0),s("div",W,[s("button",{type:"submit",class:"btn btn-primary w-full flex justify-center items-center",disabled:a.value},[a.value?(i(),u("span",H,e[8]||(e[8]=[s("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),s("span",null,"Creating Admin...",-1)]))):(i(),u("span",J,"Create Admin Account"))],8,$)])],32)]),footer:g(()=>e[10]||(e[10]=[])),_:1}))}};export{Y as default};
