import{aS as N,u as C,r as n,b as v,S as D,f as F,o as f,w as g,a as t,A,t as y,c as p,h as M,J as x,G as O,O as h,F as V,j}from"./index-D2Id9a0s.js";import{_ as B}from"./GenericModal-_6JiAudK.js";const E={class:"space-y-4"},J={key:0,class:"space-y-2"},U={class:"border dark:border-gray-600 rounded-md max-h-60 overflow-y-auto p-3 space-y-2"},R={class:"border-b dark:border-gray-600 pb-2 mb-2"},T={class:"flex items-center text-sm font-medium cursor-pointer"},$=["value"],L=["disabled"],q={__name:"ImportModal",setup(P){const k=N(),o=C(),u=n(null),m=n(null),a=n([]),l=n([]),d=n(!1),_=v(()=>o.isModalOpen("import"));D(_,i=>{i&&c()});const b=v({get:()=>a.value.length>0&&l.value.length===a.value.length,set:i=>{l.value=i?a.value.map(e=>e.discussion_id):[]}});function c(){u.value=null,a.value=[],l.value=[],m.value&&(m.value.value="")}async function S(i){const e=i.target.files[0];if(!e){c();return}if(e.type!=="application/json"){o.addNotification("Invalid file type. Please select a JSON file.","error"),c();return}u.value=e,o.addNotification("Reading file...","info");try{const s=await e.text(),r=JSON.parse(s);if(!r||!Array.isArray(r.discussions))throw new Error("Invalid import file format.");a.value=r.discussions,l.value=r.discussions.map(I=>I.discussion_id)}catch(s){o.addNotification(`Error reading file: ${s.message}`,"error"),c()}}async function w(){if(!u.value||l.value.length===0){o.addNotification("Please select a file and discussions to import.","warning");return}d.value=!0;try{await k.importDiscussions({file:u.value,discussionIdsToImport:l.value}),o.closeModal("import")}catch{}finally{d.value=!1}}return(i,e)=>(f(),F(B,{modalName:"import",title:"Import Discussions",maxWidthClass:"max-w-lg"},{body:g(()=>[t("div",E,[t("div",null,[e[3]||(e[3]=t("label",{for:"importFile",class:"block text-sm font-medium mb-1"},"Select Exported JSON File (.json)",-1)),t("input",{type:"file",id:"importFile",ref_key:"fileInputRef",ref:m,onChange:S,accept:".json",class:"block w-full text-sm file:mr-4 file:py-1.5 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-100 dark:file:bg-blue-900/50 file:text-blue-700 dark:file:text-blue-300 hover:file:bg-blue-200 dark:hover:file:bg-blue-800/50 border border-gray-300 dark:border-gray-600 rounded-md cursor-pointer"},null,544)]),a.value.length>0?(f(),p("div",J,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Select discussions to import from the file:",-1)),t("div",U,[t("div",R,[t("label",T,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"},null,512),[[h,b.value]]),e[4]||(e[4]=O(" Select All / Deselect All "))])]),(f(!0),p(V,null,j(a.value,s=>(f(),p("label",{key:s.discussion_id,class:"flex items-center text-sm cursor-pointer p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700"},[x(t("input",{type:"checkbox",value:s.discussion_id,"onUpdate:modelValue":e[1]||(e[1]=r=>l.value=r),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"},null,8,$),[[h,l.value]]),t("span",null,y(s.title||"Untitled Discussion"),1)]))),128))])])):M("",!0)])]),footer:g(()=>[t("button",{onClick:e[2]||(e[2]=s=>A(o).closeModal("import")),class:"btn btn-secondary"},"Cancel"),t("button",{onClick:w,class:"btn btn-primary",disabled:d.value||l.value.length===0},y(d.value?"Importing...":"Import Selected"),9,L)]),_:1}))}};export{q as default};
