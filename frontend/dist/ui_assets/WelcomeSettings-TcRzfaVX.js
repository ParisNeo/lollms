import{q as ee,K as te,Q as se,s as u,c as C,o as le,w as A,d as n,l as i,e,j as v,H as w,z as x,L as h,h as R,G as oe,t as p,p as F,cL as ae,f as d,al as ne,m as S,aq as ie,y as j,F as T,i as U,a2 as re,$ as de,Z as D,ah as V}from"./index-CEXks4lv.js";import{u as ce}from"./admin-Dmx5gjU7.js";const ue={class:"space-y-10"},ge={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},me={key:0,class:"p-6 text-center text-gray-500"},fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ve={class:"mt-2 flex items-center gap-x-4"},pe=["src"],be=["disabled"],_e={class:"pt-6 mt-6 border-t dark:border-gray-700 space-y-6"},ye={class:"flex items-center justify-between p-4 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-100 dark:border-yellow-900/30 rounded-xl"},we={key:0,class:"space-y-4 animate-fade-in"},xe={class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},he={class:"flex items-center gap-2 mb-2 text-blue-600 dark:text-blue-400"},ke={class:"flex justify-end pt-4 border-t dark:border-gray-700"},Ce=["disabled"],Fe={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},Se={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center flex-wrap gap-2"},Le={class:"flex gap-2"},$e={class:"p-6 grid grid-cols-1 lg:grid-cols-2 gap-8"},Me={class:"flex justify-between items-center mb-2"},Ie={class:"flex items-center gap-2"},Ne={class:"border rounded-lg overflow-hidden dark:border-gray-700 h-96 overflow-y-auto"},Ae={key:0,class:"p-4 text-center text-gray-500"},Re={key:1,class:"divide-y dark:divide-gray-700"},je=["onClick"],Te={class:"flex items-center gap-3"},Ue={class:"font-medium text-sm truncate"},De={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100"},Ve=["onClick"],Pe=["onClick"],We=["onClick"],Ee={class:"flex justify-between items-center mb-2"},Ge={class:"font-semibold truncate pr-2"},Oe=["disabled"],Be={class:"border rounded-lg overflow-hidden dark:border-gray-700 h-96 overflow-y-auto"},Je={key:0,class:"p-4 text-center text-gray-500"},ze={key:1,class:"p-4 text-center text-sm text-gray-500 italic"},qe={key:2,class:"divide-y dark:divide-gray-700"},He=["title"],Ke={class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"},Qe=["onClick"],Ye=["onClick"],Ze={__name:"WelcomeSettings",setup(Xe){const a=ce(),g=te(),{globalSettings:L,funFacts:P,funFactCategories:$,isLoadingFunFacts:W,isLoadingFunFactCategories:E}=se(a),o=u({welcome_text:"",welcome_slogan:"",welcome_logo_url:"",force_welcome_message:!1,forced_welcome_message_title:"",forced_welcome_message_content:""}),b=u(!1),_=u(!1),m=u(!1),f=u(null),y=u(null);let k="{}";const r=u(null),M=C(()=>L.value.filter(s=>s.category==="Welcome Page")),G=C(()=>r.value?P.value.filter(s=>s.category.id===r.value):[]),O=C(()=>{if(!r.value)return"Select a Category";const s=$.value.find(t=>t.id===r.value);return s?s.name:"Select a Category"});le(()=>{a.fetchGlobalSettings(),a.fetchFunFacts(),a.fetchFunFactCategories()}),A(()=>L.value,B,{deep:!0,immediate:!0}),A(o,s=>{m.value=JSON.stringify(s)!==k},{deep:!0});function B(){if(M.value.length>0){const s=M.value.reduce((t,l)=>(t[l.key]=l.value,t),{});o.value.welcome_text=s.welcome_text||"",o.value.welcome_slogan=s.welcome_slogan||"",o.value.welcome_logo_url=s.welcome_logo_url||"",o.value.force_welcome_message=s.force_welcome_message||!1,o.value.forced_welcome_message_title=s.forced_welcome_message_title||"System Announcement",o.value.forced_welcome_message_content=s.forced_welcome_message_content||"",k=JSON.stringify(o.value),m.value=!1,y.value=null,f.value=null}}function J(s){const t=s.target.files[0];if(t&&t.type.startsWith("image/")){f.value=t;const l=new FileReader;l.onload=c=>{y.value=c.target.result},l.readAsDataURL(t),m.value=!0}}async function z(){_.value=!0;try{await a.removeWelcomeLogo()}finally{_.value=!1}}async function q(){b.value=!0;try{const s={welcome_text:o.value.welcome_text,welcome_slogan:o.value.welcome_slogan,force_welcome_message:o.value.force_welcome_message,forced_welcome_message_title:o.value.forced_welcome_message_title,forced_welcome_message_content:o.value.forced_welcome_message_content},t=[a.updateGlobalSettings(s)];f.value&&t.push(a.uploadWelcomeLogo(f.value)),await Promise.all(t),k=JSON.stringify(o.value),m.value=!1,f.value=null,y.value=null}finally{b.value=!1}}function I(s=null){g.openModal("funFactCategory",{category:s,onSave:a.fetchFunFactCategories})}function N(s=null){if(!r.value&&!s){g.addNotification("Please select a category first.","warning");return}g.openModal("funFact",{fact:s,preselectedCategoryId:r.value,onSave:a.fetchFunFacts})}async function H(s){await g.showConfirmation({title:"Delete Category?",message:`Permanently delete "${s.name}" and all facts inside?`,confirmText:"Delete All"})&&(await a.deleteFunFactCategory(s.id),r.value===s.id&&(r.value=null))}async function K(s){await g.showConfirmation({title:"Delete Fun Fact?",message:"Are you sure?",confirmText:"Delete"})&&await a.deleteFunFact(s.id)}async function Q(s){await a.exportCategory(s.id,s.name)}async function Y(s){const t=s.target.files[0];t&&await a.importCategoryFromFile(t),s.target.value=""}async function Z(){await a.exportFunFacts()}function X(){g.openModal("generateFunFacts")}return(s,t)=>(i(),n("div",ue,[e("div",ge,[t[18]||(t[18]=e("div",{class:"p-6 border-b dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold"},"Welcome Page Branding"),e("p",{class:"text-sm text-gray-500 mt-1"},"Configure text and visuals for the login and splash screens.")],-1)),v(a).isLoadingSettings&&!Object.keys(o.value).length?(i(),n("div",me,"Loading...")):(i(),n("form",{key:1,onSubmit:w(q,["prevent"]),class:"p-6 space-y-6"},[e("div",fe,[e("div",null,[t[9]||(t[9]=e("label",{for:"welcome_text",class:"label"},"Main Branding Text",-1)),x(e("input",{id:"welcome_text","onUpdate:modelValue":t[0]||(t[0]=l=>o.value.welcome_text=l),type:"text",class:"input-field mt-1",placeholder:"LoLLMs"},null,512),[[h,o.value.welcome_text]])]),e("div",null,[t[10]||(t[10]=e("label",{for:"welcome_slogan",class:"label"},"Slogan",-1)),x(e("input",{id:"welcome_slogan","onUpdate:modelValue":t[1]||(t[1]=l=>o.value.welcome_slogan=l),type:"text",class:"input-field mt-1",placeholder:"One tool to rule them all"},null,512),[[h,o.value.welcome_slogan]])])]),e("div",null,[t[11]||(t[11]=e("label",{class:"label"},"Custom Logo",-1)),e("div",ve,[e("img",{src:y.value||o.value.welcome_logo_url||v(oe),alt:"Logo Preview",class:"h-16 w-16 object-contain rounded-md bg-gray-100 dark:bg-gray-700 p-1 border dark:border-gray-600"},null,8,pe),e("input",{type:"file",onChange:J,accept:"image/*",class:"hidden",ref:"logoInput"},null,544),e("button",{type:"button",onClick:t[2]||(t[2]=l=>s.$refs.logoInput.click()),class:"btn btn-secondary"},"Change"),o.value.welcome_logo_url?(i(),n("button",{key:0,type:"button",onClick:z,class:"btn btn-danger-outline",disabled:_.value},p(_.value?"Removing...":"Remove"),9,be)):R("",!0)])]),e("div",_e,[e("div",ye,[t[12]||(t[12]=e("div",{class:"flex flex-col"},[e("span",{class:"text-sm font-bold text-yellow-800 dark:text-yellow-400 uppercase tracking-widest"},"System-wide Announcement"),e("span",{class:"text-xs text-gray-600 dark:text-gray-400 mt-1"},"Replace random fun facts with a specific message for all users.")],-1)),e("button",{onClick:t[3]||(t[3]=l=>o.value.force_welcome_message=!o.value.force_welcome_message),type:"button",class:F([o.value.force_welcome_message?"bg-yellow-500":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:F([o.value.force_welcome_message?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),o.value.force_welcome_message?(i(),n("div",we,[e("div",null,[t[13]||(t[13]=e("label",{class:"label"},"Announcement Title",-1)),x(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.forced_welcome_message_title=l),type:"text",class:"input-field mt-1",placeholder:"Maintenance, New Feature, etc."},null,512),[[h,o.value.forced_welcome_message_title]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"label"},"Announcement Content (Markdown Supported)",-1)),x(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.forced_welcome_message_content=l),rows:"4",class:"input-field mt-1",placeholder:"Write your message here..."},null,512),[[h,o.value.forced_welcome_message_content]])]),e("div",xe,[e("div",he,[d(ne,{class:"w-4 h-4"}),t[15]||(t[15]=e("span",{class:"text-xs font-bold uppercase tracking-wider"},"Markdown Cheat Sheet",-1))]),t[16]||(t[16]=ae('<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-[11px] font-mono leading-relaxed" data-v-f4143fa8><div data-v-f4143fa8><p class="text-gray-400 mb-1 font-sans" data-v-f4143fa8>Links</p><code class="text-blue-500" data-v-f4143fa8>[Text](URL)</code></div><div data-v-f4143fa8><p class="text-gray-400 mb-1 font-sans" data-v-f4143fa8>Images</p><code class="text-green-500" data-v-f4143fa8>![Alt](IMG_URL)</code></div><div data-v-f4143fa8><p class="text-gray-400 mb-1 font-sans" data-v-f4143fa8>Video (YouTube)</p><code class="text-red-500" data-v-f4143fa8>Just paste the full URL on a new line</code></div></div>',1))]),t[17]||(t[17]=e("div",{class:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-xs text-blue-800 dark:text-blue-300"}," ðŸ’¡ Users can click this message on the splash screen to keep it visible while they read. ",-1))])):R("",!0)]),e("div",ke,[e("button",{type:"submit",class:"btn btn-primary",disabled:b.value||!m.value},p(b.value?"Saving...":"Save Settings"),9,Ce)])],32))]),e("div",Fe,[e("div",Se,[t[19]||(t[19]=e("h3",{class:"text-xl font-semibold"},"Fun Facts Repository",-1)),e("div",Le,[e("button",{onClick:t[6]||(t[6]=l=>s.$refs.importInput.click()),class:"btn btn-secondary btn-sm"},"Import Category"),e("input",{type:"file",ref:"importInput",onChange:Y,accept:".json",class:"hidden"},null,544),e("button",{onClick:Z,class:"btn btn-secondary btn-sm"},"Export All")])]),e("div",$e,[e("div",null,[e("div",Me,[t[22]||(t[22]=e("h4",{class:"font-semibold"},"Categories",-1)),e("div",Ie,[e("button",{onClick:X,class:"btn btn-secondary btn-sm"},[d(ie,{class:"w-4 h-4 mr-1"}),t[20]||(t[20]=S(" AI Generate"))]),e("button",{onClick:t[7]||(t[7]=l=>I()),class:"btn btn-secondary btn-sm"},[d(j,{class:"w-4 h-4 mr-1"}),t[21]||(t[21]=S("New"))])])]),e("div",Ne,[v(E)?(i(),n("div",Ae,"Loading...")):(i(),n("ul",Re,[(i(!0),n(T,null,U(v($),l=>(i(),n("li",{key:l.id,onClick:c=>r.value=l.id,class:F(["p-3 flex items-center justify-between cursor-pointer transition-colors",r.value===l.id?"bg-blue-100 dark:bg-blue-900/50":"hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[e("div",Te,[e("span",{class:"w-5 h-5 rounded-full flex-shrink-0 shadow-sm",style:re({backgroundColor:l.color})},null,4),e("span",Ue,p(l.name),1)]),e("div",De,[e("button",{onClick:w(c=>Q(l),["stop"]),class:"btn-icon",title:"Export JSON"},[d(de,{class:"w-4 h-4"})],8,Ve),e("button",{onClick:w(c=>I(l),["stop"]),class:"btn-icon",title:"Edit Category"},[d(D,{class:"w-4 h-4"})],8,Pe),e("button",{onClick:w(c=>H(l),["stop"]),class:"btn-icon-danger",title:"Delete Category"},[d(V,{class:"w-4 h-4"})],8,We)])],10,je))),128))]))])]),e("div",null,[e("div",Ee,[e("h4",Ge,p(O.value),1),e("button",{onClick:t[8]||(t[8]=l=>N()),disabled:!r.value,class:"btn btn-secondary btn-sm"},[d(j,{class:"w-4 h-4 mr-1"}),t[23]||(t[23]=S("New"))],8,Oe)]),e("div",Be,[v(W)?(i(),n("div",Je,"Loading...")):r.value?(i(),n("ul",qe,[(i(!0),n(T,null,U(G.value,l=>(i(),n("li",{key:l.id,class:"p-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 group"},[e("p",{class:"text-sm flex-grow pr-2 truncate",title:l.content},p(l.content),9,He),e("div",Ke,[e("button",{onClick:c=>N(l),class:"btn-icon",title:"Edit Fact"},[d(D,{class:"w-4 h-4"})],8,Qe),e("button",{onClick:c=>K(l),class:"btn-icon-danger",title:"Delete Fact"},[d(V,{class:"w-4 h-4"})],8,Ye)])]))),128))])):(i(),n("div",ze,"Select a category."))])])])])]))}},st=ee(Ze,[["__scopeId","data-v-f4143fa8"]]);export{st as default};
