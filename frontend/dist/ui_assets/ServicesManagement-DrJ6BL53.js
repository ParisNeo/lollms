import{a4 as T,u as M,T as O,L as m,l as P,e as n,o as l,b as e,g as x,d as c,f as v,h as f,n as r,av as U,az as V,F as $,r as D,t as y,w as E,a0 as h,ac as S,ad as N,a as z,aD as B}from"./index-CLx4cEXd.js";import{u as K}from"./admin-Dq5PjGKC.js";const F={class:"space-y-8 animate-fade-in"},G={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},J={class:"flex gap-2"},W=["disabled"],H={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Q={class:"flex items-center gap-3 mb-4"},X={class:"w-10 h-10 rounded-lg bg-gray-100 dark:bg-gray-700 p-2 flex items-center justify-center"},Y=["src"],Z={class:"font-bold text-lg text-gray-900 dark:text-white truncate"},ee={class:"grid grid-cols-2 gap-4"},te={class:"p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg"},se={class:"text-xl font-mono font-bold text-blue-600 dark:text-blue-400"},ae={class:"p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg"},re={class:"text-xl font-mono font-bold text-purple-600 dark:text-purple-400"},le={class:"mt-6 pt-4 border-t dark:border-gray-700 flex items-center justify-between"},ne={key:0,class:"px-2 py-0.5 rounded-full bg-green-100 text-green-700 text-[10px] font-bold uppercase tracking-tighter border border-green-200"},oe={key:1,class:"px-2 py-0.5 rounded-full bg-red-100 text-red-700 text-[10px] font-bold uppercase tracking-tighter border border-red-200"},ie={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md border dark:border-gray-700 overflow-hidden"},de={class:"p-6 space-y-8"},ge={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},ue={class:"p-5 border dark:border-gray-700 rounded-2xl bg-white dark:bg-gray-800/50 space-y-6"},be={class:"flex items-center justify-between"},ce={class:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-xl space-y-4 border dark:border-gray-700"},pe={class:"flex items-center justify-between"},ye={class:"p-5 border dark:border-gray-700 rounded-2xl bg-white dark:bg-gray-800/50 space-y-6"},me={class:"flex items-center justify-between"},xe={class:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-xl space-y-4 border dark:border-gray-700"},ve={class:"flex items-center justify-between"},fe={class:"p-5 border dark:border-gray-700 rounded-2xl bg-white dark:bg-gray-800/50 space-y-6"},_e={class:"flex items-center justify-between"},ke={class:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-xl space-y-4 border dark:border-gray-700"},we={class:"flex items-center justify-between"},he={class:"pt-8 border-t dark:border-gray-700"},Se={class:"flex items-center justify-between mb-6"},Ie={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-8 p-6 bg-orange-50 dark:bg-orange-900/10 rounded-2xl border border-orange-100 dark:border-orange-900/30"},qe={class:"px-6 py-4 bg-gray-50 dark:bg-gray-900/50 border-t dark:border-gray-700 flex justify-between items-center"},Ae={key:0,class:"text-xs font-bold text-orange-500 animate-pulse"},Le={key:1,class:"text-xs text-gray-400"},Ce=["disabled"],Re={__name:"ServicesManagement",setup(je){const d=K(),I=M(),{serviceStats:g,isLoadingServiceStats:_,globalSettings:Te}=O(d),s=m({}),u=m(!1),o=m(!1);let k="{}";P(()=>{w()});async function w(){await d.fetchServiceDashboard(),g.value&&(s.value={...g.value.settings},k=JSON.stringify(s.value),o.value=!1)}async function q(){u.value=!0;try{await d.updateGlobalSettings(s.value),k=JSON.stringify(s.value),o.value=!1,await d.fetchServiceDashboard()}finally{u.value=!1}}function i(p){s.value[p]=!s.value[p],o.value=!0}const A={openai:"OpenAI V1 API",ollama:"Ollama V1 API",lollms:"LoLLMs Exclusive Services"},L={openai:"https://openai.com/favicon.ico",ollama:"https://ollama.com/favicon.ico",lollms:"/favicon.ico"},C={openai:"openai_api_service_enabled",ollama:"ollama_service_enabled",lollms:"lollms_services_enabled"};async function R(){await I.showConfirmation({title:"Reset Usage Stats?",message:"This will clear all in-memory service hit counters. This action is permanent.",confirmText:"Reset"})&&await d.resetServiceUsage()}return(p,t)=>(l(),n("div",F,[e("div",G,[t[14]||(t[14]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"API Services Dashboard"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Manage OpenAI/Ollama compatibility layers and exclusive LoLLMs endpoints. ")],-1)),e("div",J,[e("button",{onClick:w,class:"btn btn-secondary btn-sm",disabled:c(_)},[v(U,{class:r(["w-4 h-4 mr-2",{"animate-spin":c(_)}])},null,8,["class"]),t[12]||(t[12]=f(" Refresh "))],8,W),e("button",{onClick:R,class:"btn btn-danger btn-sm"},[v(V,{class:"w-4 h-4 mr-2"}),t[13]||(t[13]=f(" Reset Usage "))])])]),c(g)?(l(),n("div",H,[(l(!0),n($,null,D(c(g).usage,(a,b)=>(l(),n("div",{key:b,class:"bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col justify-between group"},[e("div",null,[e("div",Q,[e("div",X,[e("img",{src:L[b],class:"w-full h-full object-contain grayscale opacity-70 group-hover:grayscale-0 transition-all",onError:t[0]||(t[0]=j=>j.target.src="/favicon.ico")},null,40,Y)]),e("h4",Z,y(A[b]||b),1)]),e("div",ee,[e("div",te,[t[15]||(t[15]=e("p",{class:"text-[10px] uppercase font-black text-gray-400 tracking-wider"},"Total Requests",-1)),e("p",se,y(a.total_hits.toLocaleString()),1)]),e("div",ae,[t[16]||(t[16]=e("p",{class:"text-[10px] uppercase font-black text-gray-400 tracking-wider"},"Active Users",-1)),e("p",re,y(a.user_count.toLocaleString()),1)])])]),e("div",le,[t[17]||(t[17]=e("span",{class:"text-xs font-medium text-gray-500"},"Status",-1)),c(g).settings[C[b]]?(l(),n("span",ne,"Enabled")):(l(),n("span",oe,"Disabled"))])]))),128))])):x("",!0),e("div",ie,[t[32]||(t[32]=e("div",{class:"p-6 border-b dark:border-gray-700 bg-gray-50/50 dark:bg-gray-900/20"},[e("h4",{class:"text-lg font-bold"},"Interface & Security Controls"),e("p",{class:"text-sm text-gray-500"},"Enable interfaces and manage authentication requirements.")],-1)),e("div",de,[e("div",ge,[e("div",ue,[e("div",be,[t[18]||(t[18]=e("h5",{class:"font-black uppercase text-xs tracking-widest text-gray-400"},"OPENAI API",-1)),e("button",{onClick:t[1]||(t[1]=a=>i("openai_api_service_enabled")),type:"button",class:r([s.value.openai_api_service_enabled?"bg-blue-600":"bg-gray-300 dark:bg-gray-600","toggle-switch"])},[e("span",{class:r([s.value.openai_api_service_enabled?"translate-x-5":"translate-x-0","toggle-knob"])},null,2)],2)]),e("div",ce,[e("div",pe,[t[19]||(t[19]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Require API Key",-1)),e("button",{onClick:t[2]||(t[2]=a=>i("openai_api_require_key")),type:"button",class:r([s.value.openai_api_require_key?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600","toggle-switch-sm"])},[e("span",{class:r([s.value.openai_api_require_key?"translate-x-4":"translate-x-0","toggle-knob-sm"])},null,2)],2)]),t[20]||(t[20]=e("p",{class:"text-[10px] text-gray-500 leading-tight"},"If disabled, anonymous requests will be handled by the primary administrator account.",-1))])]),e("div",ye,[e("div",me,[t[21]||(t[21]=e("h5",{class:"font-black uppercase text-xs tracking-widest text-gray-400"},"OLLAMA",-1)),e("button",{onClick:t[3]||(t[3]=a=>i("ollama_service_enabled")),type:"button",class:r([s.value.ollama_service_enabled?"bg-blue-600":"bg-gray-300 dark:bg-gray-600","toggle-switch"])},[e("span",{class:r([s.value.ollama_service_enabled?"translate-x-5":"translate-x-0","toggle-knob"])},null,2)],2)]),e("div",xe,[e("div",ve,[t[22]||(t[22]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Require API Key",-1)),e("button",{onClick:t[4]||(t[4]=a=>i("ollama_require_key")),type:"button",class:r([s.value.ollama_require_key?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600","toggle-switch-sm"])},[e("span",{class:r([s.value.ollama_require_key?"translate-x-4":"translate-x-0","toggle-knob-sm"])},null,2)],2)]),t[23]||(t[23]=e("p",{class:"text-[10px] text-gray-500 leading-tight"},"If disabled, anonymous requests will be handled by the primary administrator account.",-1))])]),e("div",fe,[e("div",_e,[t[24]||(t[24]=e("h5",{class:"font-black uppercase text-xs tracking-widest text-gray-400"},"LOLLMS SERVICES",-1)),e("button",{onClick:t[5]||(t[5]=a=>i("lollms_services_enabled")),type:"button",class:r([s.value.lollms_services_enabled?"bg-blue-600":"bg-gray-300 dark:bg-gray-600","toggle-switch"])},[e("span",{class:r([s.value.lollms_services_enabled?"translate-x-5":"translate-x-0","toggle-knob"])},null,2)],2)]),e("div",ke,[e("div",we,[t[25]||(t[25]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Require API Key",-1)),e("button",{onClick:t[6]||(t[6]=a=>i("lollms_services_require_key")),type:"button",class:r([s.value.lollms_services_require_key?"bg-indigo-600":"bg-gray-300 dark:bg-gray-600","toggle-switch-sm"])},[e("span",{class:r([s.value.lollms_services_require_key?"translate-x-4":"translate-x-0","toggle-knob-sm"])},null,2)],2)]),t[26]||(t[26]=e("p",{class:"text-[10px] text-gray-500 leading-tight"},"If disabled, anonymous requests will be handled by the primary administrator account.",-1))])])]),e("div",he,[e("div",Se,[t[27]||(t[27]=e("div",null,[e("h4",{class:"text-lg font-bold text-orange-600 dark:text-orange-400"},"Global Rate Limiting"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Apply traffic control across all external API interfaces.")],-1)),e("button",{onClick:t[7]||(t[7]=a=>i("rate_limit_enabled")),type:"button",class:r([s.value.rate_limit_enabled?"bg-orange-600":"bg-gray-300 dark:bg-gray-600","toggle-switch"])},[e("span",{class:r([s.value.rate_limit_enabled?"translate-x-5":"translate-x-0","toggle-knob"])},null,2)],2)]),v(N,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:E(()=>[s.value.rate_limit_enabled?(l(),n("div",Ie,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2"},"Max Requests",-1)),h(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>s.value.rate_limit_max_requests=a),onInput:t[9]||(t[9]=a=>o.value=!0),class:"input-field w-full",placeholder:"e.g. 60"},null,544),[[S,s.value.rate_limit_max_requests,void 0,{number:!0}]]),t[29]||(t[29]=e("p",{class:"text-[10px] text-gray-500 mt-2 italic"},"Threshold of requests allowed per user/key within the window.",-1))]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2"},"Window Size (Seconds)",-1)),h(e("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=a=>s.value.rate_limit_window_seconds=a),onInput:t[11]||(t[11]=a=>o.value=!0),class:"input-field w-full",placeholder:"e.g. 60"},null,544),[[S,s.value.rate_limit_window_seconds,void 0,{number:!0}]]),t[31]||(t[31]=e("p",{class:"text-[10px] text-gray-500 mt-2 italic"},"The timeframe in seconds for the request count bucket.",-1))])])):x("",!0)]),_:1})])]),e("div",qe,[o.value?(l(),n("span",Ae,"‚óè Unsaved changes detected")):(l(),n("span",Le,"All settings synchronized")),e("button",{onClick:q,class:"btn btn-primary min-w-[140px]",disabled:!o.value||u.value},[u.value?(l(),z(B,{key:0,class:"w-5 h-5 mr-2 animate-spin"})):x("",!0),f(" "+y(u.value?"Saving...":"Save Settings"),1)],8,Ce)])])]))}},Pe=T(Re,[["__scopeId","data-v-dcd89a20"]]);export{Pe as default};
