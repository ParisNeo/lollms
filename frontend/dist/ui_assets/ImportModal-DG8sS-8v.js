import{ao as N,u as C,L as n,c as v,m as D,a as F,o as f,w as g,b as t,d as M,t as y,e as p,g as A,a0 as x,h as V,at as h,F as B,r as E}from"./index-CZ57W16T.js";import{_ as O}from"./GenericModal-Bo823HoA.js";const U={class:"space-y-4"},j={key:0,class:"space-y-2"},J={class:"border dark:border-gray-600 rounded-md max-h-60 overflow-y-auto p-3 space-y-2"},L={class:"border-b dark:border-gray-600 pb-2 mb-2"},R={class:"flex items-center text-sm font-medium cursor-pointer"},T=["value"],$=["disabled"],z={__name:"ImportModal",setup(P){const k=N(),o=C(),d=n(null),m=n(null),a=n([]),l=n([]),u=n(!1),_=v(()=>o.isModalOpen("import"));D(_,i=>{i&&c()});const b=v({get:()=>a.value.length>0&&l.value.length===a.value.length,set:i=>{l.value=i?a.value.map(e=>e.discussion_id):[]}});function c(){d.value=null,a.value=[],l.value=[],m.value&&(m.value.value="")}async function w(i){const e=i.target.files[0];if(!e){c();return}if(e.type!=="application/json"){o.addNotification("Invalid file type. Please select a JSON file.","error"),c();return}d.value=e,o.addNotification("Reading file...","info");try{const s=await e.text(),r=JSON.parse(s);if(!r||!Array.isArray(r.discussions))throw new Error("Invalid import file format.");a.value=r.discussions,l.value=r.discussions.map(I=>I.discussion_id)}catch(s){o.addNotification(`Error reading file: ${s.message}`,"error"),c()}}async function S(){if(!d.value||l.value.length===0){o.addNotification("Please select a file and discussions to import.","warning");return}u.value=!0;try{await k.importDiscussions({file:d.value,discussionIdsToImport:l.value}),o.closeModal("import")}catch{}finally{u.value=!1}}return(i,e)=>(f(),F(O,{modalName:"import",title:"Import Discussions",maxWidthClass:"max-w-lg"},{body:g(()=>[t("div",U,[t("div",null,[e[3]||(e[3]=t("label",{for:"importFile",class:"block text-sm font-medium mb-1"},"Select Exported JSON File (.json)",-1)),t("input",{type:"file",id:"importFile",ref_key:"fileInputRef",ref:m,onChange:w,accept:".json",class:"block w-full text-sm file:mr-4 file:py-1.5 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-100 dark:file:bg-blue-900/50 file:text-blue-700 dark:file:text-blue-300 hover:file:bg-blue-200 dark:hover:file:bg-blue-800/50 border border-gray-300 dark:border-gray-600 rounded-md cursor-pointer"},null,544)]),a.value.length>0?(f(),p("div",j,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Select discussions to import from the file:",-1)),t("div",J,[t("div",L,[t("label",R,[x(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"},null,512),[[h,b.value]]),e[4]||(e[4]=V(" Select All / Deselect All "))])]),(f(!0),p(B,null,E(a.value,s=>(f(),p("label",{key:s.discussion_id,class:"flex items-center text-sm cursor-pointer p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700"},[x(t("input",{type:"checkbox",value:s.discussion_id,"onUpdate:modelValue":e[1]||(e[1]=r=>l.value=r),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-2"},null,8,T),[[h,l.value]]),t("span",null,y(s.title||"Untitled Discussion"),1)]))),128))])])):A("",!0)])]),footer:g(()=>[t("button",{onClick:e[2]||(e[2]=s=>M(o).closeModal("import")),class:"btn btn-secondary"},"Cancel"),t("button",{onClick:S,class:"btn btn-primary",disabled:u.value||l.value.length===0},y(u.value?"Importing...":"Import Selected"),9,$)]),_:1}))}};export{z as default};
