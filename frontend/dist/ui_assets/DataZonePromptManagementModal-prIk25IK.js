import{X as B,aB as E,a as L,c as p,K as f,w as O,n as T,l as s,g as _,e as a,f as v,m as g,a5 as j,j as b,aC as F,d as r,h as y,t as C,N as J,F as R,i as q,H as z,O as A,Y as H,a7 as K}from"./index-DBRQkGj9.js";import{_ as W}from"./GenericModal-CuRb-XTE.js";const X={class:"grid grid-cols-1 md:grid-cols-3 gap-6 h-[60vh]"},Y={class:"md:col-span-1 flex flex-col h-full bg-gray-50 dark:bg-gray-700/50 rounded-lg p-2"},G={class:"flex-shrink-0 mb-2"},Q={class:"flex-grow overflow-y-auto"},ee={key:0,class:"text-center p-4 text-sm"},te={key:1,class:"text-center p-4 text-sm text-gray-500"},ae={key:2,class:"space-y-1"},oe=["onClick"],ne={class:"md:col-span-2 flex flex-col h-full"},se={key:0,class:"flex flex-col h-full space-y-4"},le={class:"flex-grow flex flex-col min-h-0"},re={key:1,class:"flex items-center justify-center h-full bg-gray-50 dark:bg-gray-700/50 rounded-lg"},ie={class:"flex justify-between w-full"},de={class:"flex gap-3"},ue=["disabled"],pe={__name:"DataZonePromptManagementModal",setup(me){const u=B(),i=E(),x=L(),S=p(()=>u.modalData("dataZonePromptManagement")),h=p(()=>{var t;return(t=S.value)==null?void 0:t.onLoad}),w=p(()=>i.savedPrompts),n=f(null),m=f(""),l=f(""),d=f(!1),k=f(null);O(()=>u.isModalOpen("dataZonePromptManagement"),t=>{t&&(i.fetchPrompts(),x.fetchFriends(),c())});function c(){n.value=null,d.value=!1,m.value="",l.value=""}function N(t){var e;d.value&&((e=n.value)==null?void 0:e.id)===t.id?c():(n.value={...t},m.value=t.name,l.value=t.content,d.value=!0)}function M(){c(),d.value=!0}async function $(){if(!m.value.trim()||!l.value.trim()){u.addNotification("Name and content are required.","warning");return}n.value?await i.updatePrompt(n.value.id,m.value,l.value):await i.savePrompt(m.value,l.value),c()}async function D(t){var o;await u.showConfirmation({title:`Delete '${t.name}'?`,message:"This action cannot be undone."})&&(await i.deletePrompt(t.id),((o=n.value)==null?void 0:o.id)===t.id&&c())}function V(){h.value&&l.value&&(h.value(l.value),u.closeModal("dataZonePromptManagement"))}function Z(){var t;(t=k.value)==null||t.click()}async function I(t){const e=t.target.files[0];e&&await i.importPrompts(e),t.target.value=""}async function U(t){const e=await u.showConfirmation({title:`Share '${t.name}'`,message:"Select a friend to share this prompt with:",inputType:"select",inputOptions:x.friends.map(o=>({value:o.username,text:o.username})),confirmText:"Share"});e&&await i.sharePrompt(t.content,e)}return(t,e)=>(s(),T(W,{"modal-name":"dataZonePromptManagement",title:"Data Zone Prompt Management",maxWidthClass:"max-w-5xl"},{body:_(()=>[a("div",X,[a("div",Y,[a("div",G,[a("button",{onClick:M,class:"btn btn-secondary w-full"},[v(J,{class:"w-4 h-4 mr-2"}),e[6]||(e[6]=g(" New Prompt "))])]),a("div",Q,[b(i).isLoading?(s(),r("div",ee,"Loading...")):w.value.length===0?(s(),r("div",te,"No saved prompts.")):(s(),r("ul",ae,[(s(!0),r(R,null,q(w.value,o=>{var P;return s(),r("li",{key:o.id},[a("button",{onClick:ce=>N(o),class:z(["w-full text-left p-2 rounded-md truncate text-sm",[((P=n.value)==null?void 0:P.id)===o.id?"bg-blue-200 dark:bg-blue-800 font-semibold":"hover:bg-gray-200 dark:hover:bg-gray-600"]])},C(o.name),11,oe)])}),128))]))])]),a("div",ne,[d.value?(s(),r("div",se,[a("div",null,[e[7]||(e[7]=a("label",{class:"block text-sm font-medium"},"Prompt Name",-1)),A(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),class:"input-field mt-1",placeholder:"A descriptive name for your prompt"},null,512),[[H,m.value]])]),a("div",le,[e[8]||(e[8]=a("label",{class:"block text-sm font-medium mb-1"},"Prompt Content",-1)),v(K,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),class:"flex-grow",placeholder:"Enter your prompt here. Use @<name:type:default>@ for placeholders."},null,8,["modelValue"])])])):(s(),r("div",re,e[9]||(e[9]=[a("p",{class:"text-gray-500"},"Select a prompt to view or edit, or create a new one.",-1)])))])])]),footer:_(()=>[a("div",ie,[a("div",null,[a("input",{type:"file",ref_key:"importInputRef",ref:k,onChange:I,class:"hidden",accept:".json"},null,544),a("button",{onClick:Z,class:"btn btn-secondary",title:"Import from JSON"},[v(j,{class:"w-4 h-4 mr-2"}),e[10]||(e[10]=g("Import"))]),a("button",{onClick:e[2]||(e[2]=o=>b(i).exportPrompts()),class:"btn btn-secondary ml-2",title:"Export all to JSON"},[v(F,{class:"w-4 h-4 mr-2"}),e[11]||(e[11]=g("Export"))])]),a("div",de,[a("button",{onClick:e[3]||(e[3]=o=>b(u).closeModal("dataZonePromptManagement")),class:"btn btn-secondary"},"Close"),d.value&&n.value?(s(),r("button",{key:0,onClick:e[4]||(e[4]=o=>D(n.value)),class:"btn btn-danger"},"Delete")):y("",!0),d.value&&n.value?(s(),r("button",{key:1,onClick:e[5]||(e[5]=o=>U(n.value)),class:"btn btn-secondary"},"Share")):y("",!0),d.value?(s(),r("button",{key:2,onClick:$,class:"btn btn-secondary"},C(n.value?"Save Changes":"Save New"),1)):y("",!0),a("button",{onClick:V,class:"btn btn-primary",disabled:!l.value.trim()},"Use Prompt",8,ue)])])]),_:1}))}};export{pe as default};
