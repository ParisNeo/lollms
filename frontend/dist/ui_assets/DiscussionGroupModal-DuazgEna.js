import{u as N,ao as B,c as i,L as p,m as L,a as V,o as m,w as G,b as u,d as $,t as y,K as C,a0 as x,ac as F,e as k,F as P,r as U,ar as j}from"./index-DltwgrES.js";import{_ as E}from"./GenericModal-CoKmABee.js";const T=["value"],q={class:"flex justify-end gap-2"},H=["disabled"],z={__name:"DiscussionGroupModal",setup(I){const d=N(),v=B(),w=i(()=>d.modalData("discussionGroup")),a=p(null),f=p(null),s=p(""),o=p(null),n=p(!1),S=i(()=>v.discussionGroups);L(w,e=>{e?(a.value=e.group,f.value=e.parentGroup,s.value=e.group?e.group.name:"",o.value=e.group?e.group.parent_id:e.parentGroup?e.parentGroup.id:null):(a.value=null,f.value=null,s.value="",o.value=null)},{immediate:!0});const _=i(()=>a.value?"Edit Discussion Group":"New Discussion Group"),g=i(()=>s.value.trim().length>0);function b(e,t=null,l=0){let c=[];const M=e.filter(r=>r.parent_id===t);for(const r of M)a.value&&r.id===a.value.id||(c.push({value:r.id,text:`${"â€”".repeat(l)} ${r.name}`}),c=c.concat(b(e,r.id,l+1)));return c}const D=i(()=>[{value:null,text:"None (Top Level)"},...b(S.value)]);async function h(){if(!(!g.value||n.value)){n.value=!0;try{a.value?await v.updateGroup(a.value.id,s.value,o.value):await v.createGroup(s.value,o.value),d.closeModal("discussionGroup")}catch{}finally{n.value=!1}}}return(e,t)=>(m(),V(E,{modalName:"discussionGroup",title:_.value},{body:G(()=>[u("form",{onSubmit:C(h,["prevent"]),id:"discussion-group-form",class:"space-y-4 p-6"},[u("div",null,[t[3]||(t[3]=u("label",{for:"group-name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Group Name",-1)),x(u("input",{type:"text",id:"group-name","onUpdate:modelValue":t[0]||(t[0]=l=>s.value=l),class:"mt-1 input-field w-full",placeholder:"e.g., Work Projects",required:"",autofocus:""},null,512),[[F,s.value]])]),u("div",null,[t[4]||(t[4]=u("label",{for:"parent-group",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Parent Group",-1)),x(u("select",{id:"parent-group","onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l),class:"mt-1 input-field w-full"},[(m(!0),k(P,null,U(D.value,l=>(m(),k("option",{key:l.value,value:l.value},y(l.text),9,T))),128))],512),[[j,o.value]])])],32)]),footer:G(()=>[u("div",q,[u("button",{type:"button",onClick:t[2]||(t[2]=l=>$(d).closeModal("discussionGroup")),class:"btn btn-secondary"}," Cancel "),u("button",{type:"submit",form:"discussion-group-form",disabled:!g.value||n.value,class:"btn btn-primary"},y(n.value?"Saving...":"Save"),9,H)])]),_:1},8,["title"]))}};export{z as default};
