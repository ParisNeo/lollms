import{L,ad as O,i as W,u as z,N as r,c as H,l as J,ac as q,$ as Q,e as o,b as e,f as n,w as X,p as Y,a as G,h as x,t as T,V as P,F as S,r as N,W as p,ak as f,ap as Z,g as ee,ao as te,aB as $,O as le,o as a,a1 as se,a6 as ae,ax as oe,cC as d}from"./index-Cg5UBQvj.js";const re={class:"h-full flex flex-col bg-gray-50 dark:bg-gray-900 overflow-hidden relative"},ie={class:"h-14 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-4 z-20 shadow-sm flex-shrink-0"},ne={class:"flex items-center gap-4"},de={class:"flex items-center gap-2"},ue={class:"flex items-center gap-2"},pe=["disabled"],ce={class:"flex-grow flex min-h-0 overflow-hidden"},me={class:"w-96 flex-shrink-0 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col overflow-hidden"},fe={class:"p-3 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 flex justify-between items-center"},ve={class:"flex-grow overflow-y-auto p-3 space-y-3 custom-scrollbar"},be={class:"flex justify-between items-start mb-2"},ge={class:"text-xs font-bold text-gray-500 bg-gray-200 dark:bg-gray-600 px-1.5 rounded"},ye=["onClick"],xe={class:"space-y-2"},we=["onUpdate:modelValue"],he={class:"flex gap-2"},ke={class:"flex-1"},_e=["onUpdate:modelValue"],Ve={class:"flex-grow flex flex-col min-w-0 bg-gray-100 dark:bg-gray-900 overflow-y-auto p-6"},Te={class:"max-w-4xl mx-auto w-full space-y-6"},Se={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},Ne={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ce={class:"col-span-2"},Ue=["value"],Fe={class:"col-span-2"},Ae={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col items-center"},Be={key:0,class:"w-full max-w-lg aspect-video bg-black rounded-lg overflow-hidden relative shadow-lg"},Me=["src"],je={key:1,class:"w-full overflow-x-auto p-2"},Ie={class:"flex gap-2"},De=["src"],Ge={class:"mt-4 flex gap-3"},Pe=["href","download"],$e={key:1,class:"flex flex-col items-center justify-center py-12 text-gray-400"},Re={key:2,class:"flex flex-col items-center justify-center py-12 text-gray-400 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg"},Ke={__name:"TimelapseView",setup(Ee){const C={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),d("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),d("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),d("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),d("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),d("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),d("line",{x1:"17",y1:"17",x2:"22",y2:"17"}),d("line",{x1:"17",y1:"7",x2:"22",y2:"7"})])},U=O(),F=W(),c=z(),{on:A,off:B}=q(),v=r([{prompt:"A sunrise over a calm ocean",duration:3},{prompt:"A sunny day at the beach with palm trees",duration:3},{prompt:"A sunset over the ocean with vibrant colors",duration:3}]),w=r(512),h=r(512),k=r(24),_=r(1),V=r(""),b=r(""),u=r(!1),i=r(null),m=r(null),M=H(()=>U.availableTtiModels);J(()=>{F.user&&(b.value=F.user.tti_binding_model_name||""),M.value.length===0&&U.fetchAvailableTtiModels(),A("task:completed",I),A("task:failed",D)}),Q(()=>{B("task:completed",I),B("task:failed",D)});function j(){v.value.push({prompt:"",duration:3})}function R(s){v.value.splice(s,1)}async function K(){if(v.value.length<2){c.addNotification("Add at least 2 keyframes.","warning");return}if(!b.value){c.addNotification("Select a model.","warning");return}u.value=!0,i.value=null;try{const s=await le.post("/api/image-studio/timelapse",{keyframes:v.value,negative_prompt:V.value,model:b.value,width:w.value,height:h.value,fps:k.value,transition_duration:_.value});s.data&&s.data.id&&(m.value=s.data.id),c.addNotification("Timelapse task started.","info")}catch(s){console.error(s),u.value=!1,c.addNotification("Failed to start task.","error")}}function I(s){m.value&&s.id===m.value&&(u.value=!1,s.status==="completed"&&s.result?(i.value=typeof s.result=="string"?JSON.parse(s.result):s.result,c.addNotification("Timelapse ready!","success")):c.addNotification("Timelapse generation failed or cancelled.","error"),m.value=null)}function D(s){m.value&&s.id===m.value&&(u.value=!1,m.value=null,c.addNotification("Timelapse generation failed.","error"))}return(s,t)=>{const E=Y("router-link");return a(),o("div",re,[e("div",ie,[e("div",ne,[n(E,{to:"/image-studio",class:"btn-icon",title:"Back to Image Studio"},{default:X(()=>[n(se,{class:"w-5 h-5"})]),_:1}),e("div",de,[n(C,{class:"w-5 h-5 text-blue-500"}),t[6]||(t[6]=e("h1",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"Timelapse Creator",-1))])]),e("div",ue,[e("button",{onClick:K,class:"btn btn-primary btn-sm gap-2",disabled:u.value||v.value.length<2},[u.value?(a(),G($,{key:0,class:"w-4 h-4 animate-spin"})):(a(),G(ae,{key:1,class:"w-4 h-4"})),x(" "+T(u.value?"Rendering...":"Generate Video"),1)],8,pe)])]),e("div",ce,[e("div",me,[e("div",fe,[t[8]||(t[8]=e("h3",{class:"font-semibold text-sm"},"Storyboard",-1)),e("button",{onClick:j,class:"btn btn-secondary btn-sm text-xs gap-1"},[n(P,{class:"w-3 h-3"}),t[7]||(t[7]=x(" Add Frame "))])]),e("div",ve,[(a(!0),o(S,null,N(v.value,(l,g)=>(a(),o("div",{key:g,class:"p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 relative group transition-all hover:shadow-md"},[e("div",be,[e("span",ge,"Frame "+T(g+1),1),e("button",{onClick:y=>R(g),class:"text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove Frame"},[n(oe,{class:"w-4 h-4"})],8,ye)]),e("div",xe,[e("div",null,[t[9]||(t[9]=e("label",{class:"text-[10px] font-semibold text-gray-500 uppercase"},"Prompt",-1)),p(e("textarea",{"onUpdate:modelValue":y=>l.prompt=y,rows:"2",class:"input-field w-full text-xs",placeholder:"Scene description..."},null,8,we),[[f,l.prompt]])]),e("div",he,[e("div",ke,[t[10]||(t[10]=e("label",{class:"text-[10px] font-semibold text-gray-500 uppercase"},"Duration (s)",-1)),p(e("input",{type:"number","onUpdate:modelValue":y=>l.duration=y,min:"0.1",step:"0.1",class:"input-field w-full text-xs"},null,8,_e),[[f,l.duration,void 0,{number:!0}]])])])])]))),128)),e("button",{onClick:j,class:"w-full py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-400 hover:border-blue-400 hover:text-blue-500 transition-colors flex items-center justify-center gap-2 text-sm"},[n(P,{class:"w-4 h-4"}),t[11]||(t[11]=x(" Add Keyframe "))])])]),e("div",Ve,[e("div",Te,[e("div",Se,[t[18]||(t[18]=e("h3",{class:"font-semibold text-sm mb-4 border-b pb-2 dark:border-gray-700"},"Global Settings",-1)),e("div",Ne,[e("div",null,[t[12]||(t[12]=e("label",{class:"label text-xs"},"Width",-1)),p(e("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=l=>w.value=l),class:"input-field mt-1 w-full",step:"64"},null,512),[[f,w.value,void 0,{number:!0}]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"label text-xs"},"Height",-1)),p(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=l=>h.value=l),class:"input-field mt-1 w-full",step:"64"},null,512),[[f,h.value,void 0,{number:!0}]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"label text-xs"},"FPS",-1)),p(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=l=>k.value=l),class:"input-field mt-1 w-full"},null,512),[[f,k.value,void 0,{number:!0}]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"label text-xs"},"Transition (s)",-1)),p(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=l=>_.value=l),class:"input-field mt-1 w-full",step:"0.1"},null,512),[[f,_.value,void 0,{number:!0}]])]),e("div",Ce,[t[16]||(t[16]=e("label",{class:"label text-xs"},"Model",-1)),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>b.value=l),class:"input-field mt-1 w-full"},[(a(!0),o(S,null,N(M.value,l=>(a(),o("option",{key:l.id,value:l.id},T(l.name),9,Ue))),128))],512),[[Z,b.value]])]),e("div",Fe,[t[17]||(t[17]=e("label",{class:"label text-xs"},"Negative Prompt (Global)",-1)),p(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=l=>V.value=l),class:"input-field mt-1 w-full"},null,512),[[f,V.value]])])])]),i.value?(a(),o("div",Ae,[t[21]||(t[21]=e("h3",{class:"font-semibold text-sm mb-4 w-full text-left"},"Result",-1)),i.value.type==="video"?(a(),o("div",Be,[e("video",{controls:"",class:"w-full h-full object-contain",src:i.value.video_url},null,8,Me)])):(a(),o("div",je,[t[19]||(t[19]=e("p",{class:"text-sm text-gray-500 mb-2"},"Video generation skipped or failed. Frames:",-1)),e("div",Ie,[(a(!0),o(S,null,N(i.value.images,(l,g)=>(a(),o("img",{key:g,src:l,class:"h-32 w-auto rounded border border-gray-300 dark:border-gray-600"},null,8,De))),128))])])),e("div",Ge,[i.value.type==="video"?(a(),o("a",{key:0,href:i.value.video_url,download:i.value.filename,class:"btn btn-primary gap-2"},[n(te,{class:"w-4 h-4"}),t[20]||(t[20]=x(" Download Video "))],8,Pe)):ee("",!0)])])):u.value?(a(),o("div",$e,[n($,{class:"w-12 h-12 text-blue-500 mb-4 animate-spin"}),t[22]||(t[22]=e("p",{class:"text-lg font-medium text-gray-600 dark:text-gray-300"},"Generating frames & compiling video...",-1)),t[23]||(t[23]=e("p",{class:"text-sm"},"This may take a while depending on the number of frames.",-1))])):(a(),o("div",Re,[n(C,{class:"w-12 h-12 mb-2"}),t[24]||(t[24]=e("p",null,"Configure keyframes and click Generate",-1))]))])])])])}}},Oe=L(Ke,[["__scopeId","data-v-841a7181"]]);export{Oe as default};
