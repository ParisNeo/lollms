import{K as N,R as B,c as i,s as p,w as V,n as $,l as m,g as b,e as u,j,t as y,H as C,z as x,Q as F,d as k,F as L,i as P,X as U}from"./index-BaERX4Xe.js";import{_ as E}from"./GenericModal-BhrPHn5j.js";const H=["value"],T={class:"flex justify-end gap-2"},q=["disabled"],Q={__name:"DiscussionGroupModal",setup(z){const d=N(),v=B(),w=i(()=>d.modalData("discussionGroup")),s=p(null),f=p(null),o=p(""),a=p(null),n=p(!1),S=i(()=>v.discussionGroups);V(w,e=>{e?(s.value=e.group,f.value=e.parentGroup,o.value=e.group?e.group.name:"",a.value=e.group?e.group.parent_id:e.parentGroup?e.parentGroup.id:null):(s.value=null,f.value=null,o.value="",a.value=null)},{immediate:!0});const _=i(()=>s.value?"Edit Discussion Group":"New Discussion Group"),g=i(()=>o.value.trim().length>0);function G(e,t=null,l=0){let c=[];const M=e.filter(r=>r.parent_id===t);for(const r of M)s.value&&r.id===s.value.id||(c.push({value:r.id,text:`${"â€”".repeat(l)} ${r.name}`}),c=c.concat(G(e,r.id,l+1)));return c}const D=i(()=>[{value:null,text:"None (Top Level)"},...G(S.value)]);async function h(){if(!(!g.value||n.value)){n.value=!0;try{s.value?await v.updateGroup(s.value.id,o.value,a.value):await v.createGroup(o.value,a.value),d.closeModal("discussionGroup")}catch{}finally{n.value=!1}}}return(e,t)=>(m(),$(E,{modalName:"discussionGroup",title:_.value},{body:b(()=>[u("form",{onSubmit:C(h,["prevent"]),id:"discussion-group-form",class:"space-y-4 p-6"},[u("div",null,[t[3]||(t[3]=u("label",{for:"group-name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Group Name",-1)),x(u("input",{type:"text",id:"group-name","onUpdate:modelValue":t[0]||(t[0]=l=>o.value=l),class:"mt-1 input-field w-full",placeholder:"e.g., Work Projects",required:"",autofocus:""},null,512),[[F,o.value]])]),u("div",null,[t[4]||(t[4]=u("label",{for:"parent-group",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Parent Group",-1)),x(u("select",{id:"parent-group","onUpdate:modelValue":t[1]||(t[1]=l=>a.value=l),class:"mt-1 input-field w-full"},[(m(!0),k(L,null,P(D.value,l=>(m(),k("option",{key:l.value,value:l.value},y(l.text),9,H))),128))],512),[[U,a.value]])])],32)]),footer:b(()=>[u("div",T,[u("button",{type:"button",onClick:t[2]||(t[2]=l=>j(d).closeModal("discussionGroup")),class:"btn btn-secondary"}," Cancel "),u("button",{type:"submit",form:"discussion-group-form",disabled:!g.value||n.value,class:"btn btn-primary"},y(n.value?"Saving...":"Save"),9,q)])]),_:1},8,["title"]))}};export{Q as default};
