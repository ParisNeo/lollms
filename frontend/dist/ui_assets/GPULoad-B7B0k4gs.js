import{u as P}from"./admin-CYP4McKY.js";import{K as S,c as I,s as G,o as U,N,d as a,l as o,e as t,f as c,m as f,p as A,a0 as B,F as b,i as h,t as l,a5 as _,ai as C}from"./index-BaERX4Xe.js";import{a as p}from"./AdminView-Dq_ga0u-.js";import"./PageViewLayout-D6KzNGUR.js";import"./IconGlobeAlt-C6Awz4Qu.js";import"./IconKey-DdSXstsI.js";const D={class:"space-y-6"},V={class:"flex items-center justify-between"},F=["disabled"],K={key:0,class:"space-y-6"},L={class:"p-6 border-b dark:border-gray-700"},$={class:"flex flex-col md:flex-row md:items-center justify-between gap-6"},j={class:"flex items-center gap-4 min-w-[200px]"},z={class:"p-3 bg-green-100 dark:bg-green-900/30 rounded-full text-green-600 dark:text-green-400"},M={class:"font-bold text-lg text-gray-900 dark:text-white"},R={class:"text-sm text-gray-500 font-mono"},T={class:"flex-grow grid grid-cols-1 sm:grid-cols-2 gap-6"},E={class:"flex justify-between text-xs mb-1 font-medium text-gray-600 dark:text-gray-300"},q={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5"},H={class:"flex justify-between text-xs mb-1 font-medium text-gray-600 dark:text-gray-300"},J={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mb-1"},O={class:"text-xs text-gray-500 text-right"},Q={class:"bg-gray-50 dark:bg-gray-900/30 p-4"},W={key:0,class:"overflow-x-auto rounded-lg border dark:border-gray-700 bg-white dark:bg-gray-800"},X={class:"w-full text-sm text-left"},Y={class:"divide-y divide-gray-200 dark:divide-gray-700"},Z={class:"px-4 py-2 font-mono text-gray-600 dark:text-gray-400"},tt={class:"px-4 py-2 font-medium text-gray-900 dark:text-white"},st={class:"px-4 py-2 text-gray-600 dark:text-gray-400"},et={class:"px-4 py-2 text-right"},at=["onClick"],ot={key:1,class:"text-sm text-gray-500 italic px-2"},rt={key:1,class:"p-8 text-center bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700"},lt={key:2,class:"text-center py-10 text-gray-500"},yt={__name:"GPULoad",setup(nt){const g=P(),v=S(),i=I(()=>g.systemStatus),d=G(!1);let u=null;async function m(){d.value=!0;try{await g.fetchSystemStatus()}finally{d.value=!1}}U(()=>{m(),u=setInterval(m,3e3)}),N(()=>{u&&clearInterval(u)});async function k(r,s){(await v.showConfirmation({title:"Kill Process?",message:`Are you sure you want to kill process ${r} on ${s}? This might crash running generations.`,confirmText:"Kill",isDanger:!0})).confirmed&&await g.killProcess(r)}const y=r=>r?`${r.toFixed(1)} GB`:"0 GB",w=r=>r?`${r.toFixed(1)}%`:"0%";return(r,s)=>{var x;return o(),a("div",D,[t("div",V,[s[1]||(s[1]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"},"GPU Status",-1)),t("button",{onClick:m,class:"btn btn-secondary btn-sm",disabled:d.value},[c(B,{class:A(["w-4 h-4 mr-2",{"animate-spin":d.value}])},null,8,["class"]),s[0]||(s[0]=f(" Refresh "))],8,F)]),(x=i.value)!=null&&x.gpus&&i.value.gpus.length?(o(),a("div",K,[(o(!0),a(b,null,h(i.value.gpus,e=>(o(),a("div",{key:e.id,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 overflow-hidden"},[t("div",L,[t("div",$,[t("div",j,[t("div",z,[c(p,{class:"w-8 h-8"})]),t("div",null,[t("h4",M,l(e.name),1),t("p",R,"ID: "+l(e.id),1)])]),t("div",T,[t("div",null,[t("div",E,[s[2]||(s[2]=t("span",null,"Compute Load",-1)),t("span",null,l(e.gpu_utilization)+"%",1)]),t("div",q,[t("div",{class:"bg-orange-500 h-2.5 rounded-full transition-all duration-500",style:_({width:e.gpu_utilization+"%"})},null,4)])]),t("div",null,[t("div",H,[s[3]||(s[3]=t("span",null,"VRAM Usage",-1)),t("span",null,l(w(e.vram_usage_percent)),1)]),t("div",J,[t("div",{class:"bg-indigo-500 h-2.5 rounded-full transition-all duration-500",style:_({width:e.vram_usage_percent+"%"})},null,4)]),t("div",O,l(y(e.vram_used_gb))+" / "+l(y(e.vram_total_gb)),1)])])])]),t("div",Q,[s[6]||(s[6]=t("h5",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 px-2"},"Active Processes",-1)),e.processes&&e.processes.length?(o(),a("div",W,[t("table",X,[s[5]||(s[5]=t("thead",{class:"text-xs text-gray-500 uppercase bg-gray-100 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-4 py-2 font-semibold"},"PID"),t("th",{class:"px-4 py-2 font-semibold"},"Process Name"),t("th",{class:"px-4 py-2 font-semibold"},"VRAM"),t("th",{class:"px-4 py-2 text-right"},"Action")])],-1)),t("tbody",Y,[(o(!0),a(b,null,h(e.processes,n=>(o(),a("tr",{key:n.pid,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",Z,l(n.pid),1),t("td",tt,l(n.name),1),t("td",st,l(n.memory_used.toFixed(0))+" MB",1),t("td",et,[t("button",{onClick:it=>k(n.pid,e.name),class:"btn btn-danger btn-xs",title:"Kill Process"},[c(C,{class:"w-3 h-3 mr-1"}),s[4]||(s[4]=f(" Kill "))],8,at)])]))),128))])])])):(o(),a("div",ot,"No active processes detected on this GPU."))])]))),128))])):i.value?(o(),a("div",rt,[c(p,{class:"w-12 h-12 mx-auto text-gray-400 mb-3"}),s[7]||(s[7]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"},"No GPU Detected",-1)),s[8]||(s[8]=t("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"NVIDIA drivers might not be installed or no compatible GPU was found.",-1))])):(o(),a("div",lt," Loading GPU status... "))])}}};export{yt as default};
