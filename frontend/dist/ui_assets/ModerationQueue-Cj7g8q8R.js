import{J as k,q as f,o as w,d as r,l as n,e as a,y as C,W as m,f as g,p,$ as N,F as D,i as U,n as A,U as F,t as i,m as v,ao as M,ah as S}from"./index-4tYqOs8q.js";import{u as V}from"./admin-etPRT619.js";const q={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg h-full flex flex-col"},Q={class:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},$={class:"flex items-center gap-3"},j={class:"flex-grow overflow-y-auto p-0"},B={key:0,class:"text-center py-10 text-gray-500"},L={key:1,class:"text-center py-10 text-gray-500"},z={key:2,class:"divide-y divide-gray-200 dark:divide-gray-700"},I={class:"flex items-start gap-4"},R={class:"flex-shrink-0 pt-1"},E={key:1,class:"h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center text-gray-500"},O={class:"flex-grow min-w-0"},P={class:"flex items-center justify-between mb-1"},T={class:"flex items-center gap-2"},J={class:"font-bold text-sm"},W={class:"text-xs text-gray-500"},G={class:"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap bg-gray-50 dark:bg-gray-900 p-3 rounded border dark:border-gray-600"},H={class:"flex flex-col gap-2 flex-shrink-0 ml-2"},K=["onClick"],X=["onClick"],te={__name:"ModerationQueue",setup(Y){const u=V(),l=k(),o=f([]),c=f(!1),y=f("flagged");w(()=>{d()});async function d(){c.value=!0,o.value=[];try{const e=await u.fetchModerationQueue(y.value);Array.isArray(e)?o.value=e.filter(t=>t&&typeof t=="object"&&t.id!==void 0&&t.id!==null&&t.type):(console.error("Moderation queue response is not an array:",e),o.value=[])}catch(e){console.error("Error fetching moderation queue:",e),l.addNotification("Failed to load queue","error")}finally{c.value=!1}}async function x(e){if(!(!(e!=null&&e.id)||!(e!=null&&e.type)))try{await u.approveContent(e.type,e.id),o.value=o.value.filter(t=>t.id!==e.id||t.type!==e.type),l.addNotification("Content validated.","success")}catch(t){console.error(t),l.addNotification("Failed to approve content.","error"),d()}}async function h(e){if(!(!(e!=null&&e.id)||!(e!=null&&e.type))&&confirm("Are you sure you want to permanently delete this content?"))try{await u.deleteContent(e.type,e.id),o.value=o.value.filter(t=>t.id!==e.id||t.type!==e.type),l.addNotification("Content deleted.","info")}catch(t){console.error(t),l.addNotification("Failed to delete content.","error"),d()}}function b(e){if(!e)return"Unknown Date";try{return new Date(e).toLocaleString()}catch{return e}}return(e,t)=>(n(),r("div",q,[a("div",Q,[t[2]||(t[2]=a("div",null,[a("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"},"Moderation Queue"),a("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Review flagged posts and comments.")],-1)),a("div",$,[C(a("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),onChange:d,class:"input-field-sm"},t[1]||(t[1]=[a("option",{value:""},"All Pending",-1),a("option",{value:"flagged"},"Flagged Only",-1),a("option",{value:"pending"},"Unreviewed Only",-1)]),544),[[m,y.value]]),a("button",{onClick:d,class:"btn btn-secondary btn-sm",title:"Refresh Queue"},[g(N,{class:p(["w-4 h-4",{"animate-spin":c.value}])},null,8,["class"])])])]),a("div",j,[c.value?(n(),r("div",B,"Loading queue...")):o.value.length===0?(n(),r("div",L,t[3]||(t[3]=[a("p",null,"No content pending moderation.",-1)]))):(n(),r("div",z,[(n(!0),r(D,null,U(o.value,s=>(n(),r("div",{key:`${s.type}-${s.id}`,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors"},[a("div",I,[a("div",R,[s.author?(n(),A(F,{key:0,username:s.author.username,icon:s.author.icon,"size-class":"h-10 w-10"},null,8,["username","icon"])):(n(),r("div",E,t[4]||(t[4]=[a("span",{class:"text-xs"},"?",-1)])))]),a("div",O,[a("div",P,[a("div",T,[a("span",J,i(s.author?s.author.username:"Unknown User"),1),a("span",W,i(b(s.created_at)),1),a("span",{class:p(["px-2 py-0.5 text-xs rounded-full font-bold capitalize",{"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300":s.moderation_status==="flagged","bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300":s.moderation_status==="pending"}])},i(s.moderation_status)+" "+i(s.type),3)])]),a("div",G,i(s.content),1)]),a("div",H,[a("button",{onClick:_=>x(s),class:"btn btn-success btn-sm flex items-center gap-1",title:"Validate (Safe)"},[g(M,{class:"w-4 h-4"}),t[5]||(t[5]=v(" Valid "))],8,K),a("button",{onClick:_=>h(s),class:"btn btn-danger btn-sm flex items-center gap-1",title:"Delete Permanently"},[g(S,{class:"w-4 h-4"}),t[6]||(t[6]=v(" Delete "))],8,X)])])]))),128))]))])]))}};export{te as default};
