import{u as P,ah as k,R as N,T as S,L as m,c as g,m as v,a as G,o as l,w as b,b as r,d as C,f as h,h as D,z as M,t as f,e as u,g as d,a0 as A,ac as B,aD as I,an as V}from"./index-CGhbodaL.js";import{_ as $}from"./GenericModal-B1eOXHiV.js";const O={class:"space-y-4"},U={key:0},z={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},E={key:0,class:"text-sm text-gray-500 mt-2"},F={key:1,class:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-600 mt-4"},J={key:2,class:"text-xs text-gray-500 mt-1"},L={class:"flex justify-end gap-3"},R=["disabled"],Y={__name:"GeneratePersonalityModal",setup(j){const a=P(),y=k(),x=N(),{tasks:_}=S(x),n=m(""),i=m(null),o=m(!1),s=g(()=>i.value?_.value.find(e=>e.id===i.value):null),c=g(()=>o.value||s.value&&["pending","running"].includes(s.value.status));v(()=>a.isModalOpen("generatePersonality"),e=>{e&&(n.value="",i.value=null,o.value=!1)}),v(s,e=>{if(e)if(e.status==="completed"){o.value=!1;let t=null;if(e.result&&typeof e.result=="string")try{t=JSON.parse(e.result)}catch(p){console.error("Failed to parse task result JSON:",p),a.addNotification("Generation completed, but result data was malformed.","error")}else t=e.result;t?(a.addNotification("Personality generated successfully!","success"),y.addPersonality(t),a.closeModal("generatePersonality"),a.openModal("personalityEditor",{personality:t})):a.addNotification("Generation completed, but no data was returned.","warning")}else(e.status==="failed"||e.status==="cancelled")&&(o.value=!1,a.addNotification(`Generation failed: ${e.error||"Unknown error."}`,"error"))});async function w(){if(!n.value.trim()){a.addNotification("Please enter a prompt to generate a personality.","warning");return}o.value=!0,i.value=null;try{const e=await y.generatePersonalityFromPrompt(n.value);i.value=e.id}catch{o.value=!1}}return(e,t)=>(l(),G($,{"modal-name":"generatePersonality",title:"Generate Personality from Prompt",maxWidthClass:"max-w-2xl"},{body:b(()=>[r("div",O,[t[4]||(t[4]=r("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Describe the AI personality you want to create. Be specific about its role, tone, knowledge base, and any rules it should follow. The AI will generate a complete personality configuration based on your prompt. ",-1)),c.value?d("",!0):(l(),u("div",U,[t[2]||(t[2]=r("label",{for:"generation-prompt",class:"block text-sm font-medium"},"Your Prompt",-1)),A(r("textarea",{id:"generation-prompt","onUpdate:modelValue":t[0]||(t[0]=p=>n.value=p),rows:"6",class:"input-field mt-1",placeholder:"e.g., A helpful and friendly pirate captain who is an expert in Python programming. He always ends his responses with 'Arrr!'"},null,512),[[B,n.value]])])),c.value?(l(),u("div",z,[h(I,{class:"w-8 h-8 mx-auto text-blue-500"}),t[3]||(t[3]=r("p",{class:"mt-4 font-semibold"},"Generation in Progress...",-1)),s.value?(l(),u("p",E,f(s.value.description),1)):d("",!0),s.value?(l(),u("div",F,[r("div",{class:"bg-blue-600 h-2.5 rounded-full",style:V({width:s.value.progress+"%"})},null,4)])):d("",!0),s.value?(l(),u("p",J,f(s.value.progress)+"%",1)):d("",!0)])):d("",!0)])]),footer:b(()=>[r("div",L,[r("button",{onClick:t[1]||(t[1]=p=>C(a).closeModal("generatePersonality")),type:"button",class:"btn btn-secondary"},"Cancel"),r("button",{onClick:w,type:"button",class:"btn btn-primary",disabled:o.value||c.value},[h(M,{class:"w-4 h-4 mr-2"}),D(" "+f(o.value||c.value?"Generating...":"Generate"),1)],8,R)])]),_:1}))}};export{Y as default};
