import{a4 as de,Q as ue,u as ce,R as be,T as ge,L as y,c as A,m as P,e as l,o as n,f as s,b as t,w as G,g as k,aD as pe,t as x,an as fe,F as w,r as M,n as T,h as v,aF as B,ad as H,a0 as $,ac as z,aa as E,Y as K,a2 as O,a as R,aE as ve,K as V,aK as J,aw as Q,az as xe,d0 as ye,d as h,z as q,M as me,as as ke,d1 as we,au as he,at as _e,ap as Ce}from"./index-CGhbodaL.js";import{I as Se}from"./IconWeb-BFVFB-NQ.js";import{I as Ae}from"./IconVideoCamera-CL5UBKxO.js";import{I as Te}from"./IconArrowRight-t3WGlYez.js";const $e={class:"h-full flex overflow-hidden bg-gray-50 dark:bg-gray-950 relative"},Ne={key:0,class:"absolute inset-0 z-50 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md flex flex-col p-10"},Ie={class:"max-w-4xl mx-auto w-full flex flex-col h-full animate-in fade-in zoom-in-95 duration-500"},je={class:"flex items-center justify-between mb-8"},ze={class:"flex items-center gap-6"},Re={class:"p-4 bg-blue-600 rounded-3xl shadow-xl shadow-blue-500/20"},Ve={class:"text-2xl font-black text-gray-900 dark:text-white uppercase tracking-tighter"},Pe={class:"text-sm font-bold text-blue-500 opacity-80 uppercase tracking-widest"},Me={class:"text-4xl font-black text-blue-600 font-mono"},Be={class:"w-full bg-gray-200 dark:bg-gray-800 h-3 rounded-full overflow-hidden mb-10 shadow-inner"},Ee={class:"flex-grow flex flex-col min-h-0 bg-black rounded-3xl shadow-2xl border border-gray-800 overflow-hidden"},Oe={class:"text-gray-700 shrink-0 select-none"},Ue={key:0,class:"mt-6 flex justify-end"},De={key:0,class:"fixed inset-0 z-[100] bg-gray-900/60 backdrop-blur-sm p-6 flex items-center justify-center"},Le={class:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl h-full max-h-[80vh] flex flex-col overflow-hidden border dark:border-gray-800"},Fe={class:"p-4 border-b dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-800/50"},We={class:"flex-grow p-6 flex flex-col gap-4 overflow-hidden"},Ge={class:"flex-grow flex flex-col"},He={class:"p-4 border-t dark:border-gray-800 flex justify-end gap-3"},Ke={class:"w-72 border-r dark:border-gray-800 bg-gray-100 dark:bg-gray-900 flex flex-col flex-shrink-0 transition-all z-10"},Je={class:"p-4 border-b dark:border-gray-800 font-black text-[10px] uppercase tracking-widest text-gray-500 flex justify-between items-center"},Qe={class:"flex-grow overflow-y-auto p-2 space-y-1 custom-scrollbar"},qe={key:0,class:"text-center p-8 text-xs text-gray-400 italic"},Ye={class:"mb-2 opacity-50"},Xe=["onClick"],Ze={class:"flex-shrink-0"},et={class:"truncate text-xs font-bold text-gray-700 dark:text-gray-300 flex-grow"},tt={class:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 bg-gray-100 dark:bg-gray-700 rounded px-1"},at=["onClick"],ot=["onClick"],rt=["onClick"],st={class:"p-4 border-t dark:border-gray-800 bg-gray-200 dark:bg-black/20"},nt={class:"grid grid-cols-2 gap-2"},lt={class:"flex-grow flex flex-col overflow-hidden bg-gray-100 dark:bg-gray-950"},it={class:"bg-white dark:bg-gray-900 border-b dark:border-gray-800 pt-2 px-4 flex gap-2 overflow-x-auto no-scrollbar shadow-sm z-20"},dt=["onClick"],ut={class:"truncate"},ct=["onClick"],bt={class:"flex-grow flex flex-col relative min-h-0 bg-gray-100 dark:bg-gray-950"},gt={class:"p-3 border-b dark:border-gray-800 flex justify-between items-center bg-gray-50/50 dark:bg-gray-900/50 z-10 backdrop-blur-sm sticky top-0"},pt={class:"flex items-center gap-2"},ft={class:"text-[10px] uppercase font-bold text-gray-400 px-2 py-0.5 bg-gray-200 dark:bg-gray-800 rounded"},vt={class:"flex items-center gap-2"},xt={key:1,class:"flex gap-1 bg-white dark:bg-gray-800 p-0.5 rounded-lg border dark:border-gray-700 shadow-sm"},yt={class:"flex-grow overflow-hidden relative"},mt=["src"],kt={key:1,class:"flex items-center justify-center h-full text-gray-400"},wt={key:0,class:"absolute inset-0 overflow-y-auto p-4 md:p-8 custom-scrollbar"},ht={class:"max-w-5xl mx-auto bg-white dark:bg-gray-900 shadow-xl border border-gray-200 dark:border-gray-800 min-h-[80vh] p-8 md:p-12 rounded-xl"},_t={key:1,class:"flex-grow flex items-center justify-center text-gray-400 italic flex-col gap-4"},Ct={class:"w-20 h-20 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center"},St={class:"p-4 bg-gray-50 dark:bg-gray-900 flex flex-col gap-2 border-t dark:border-gray-800 z-20"},At={class:"flex items-center gap-2 overflow-x-auto no-scrollbar pb-1"},Tt={class:"flex gap-2 relative shadow-lg rounded-xl"},$t={class:"flex items-center gap-2 px-2 border-l dark:border-gray-700 absolute right-16 top-1/2 -translate-y-1/2 h-8 pl-3"},Nt=["disabled"],It={__name:"GenericNotebookView",props:{notebook:{type:Object,required:!0}},setup(N){const u=N,i=ue(),m=ce(),Y=be(),{tasks:X}=ge(Y),p=y(null),_=y(!0),C=y(""),I=y(!1),f=y([]),j=y(null),c=y(null),b=A(()=>X.value.find(o=>(o.name.includes(u.notebook.title)||o.description.includes(u.notebook.id))&&(o.status==="running"||o.status==="pending"))),r=A(()=>{var o;return(o=u.notebook.tabs)!=null&&o.length?u.notebook.tabs.find(e=>e.id===p.value)||u.notebook.tabs[0]:null}),U=A(()=>{var o;if(((o=r.value)==null?void 0:o.type)==="html"&&r.value.content){const e=new Blob([r.value.content],{type:"text/html"});return URL.createObjectURL(e)}return null});A(()=>{var o;if(((o=r.value)==null?void 0:o.type)==="slides")try{return JSON.parse(r.value.content)}catch{return null}return null}),A(()=>{var o,e;if(((o=r.value)==null?void 0:o.type)==="youtube_storyboard"||((e=r.value)==null?void 0:e.type)==="youtube_script")try{return JSON.parse(r.value.content)}catch{return null}return null});const D=()=>{var o;if(((o=u.notebook.tabs)==null?void 0:o.length)>0&&(!p.value||!u.notebook.tabs.find(e=>e.id===p.value))){const e=u.notebook.tabs.find(d=>d.title==="Research Report"||d.title==="Main");p.value=e?e.id:u.notebook.tabs[0].id}};P(()=>u.notebook.id,D,{immediate:!0}),P(()=>u.notebook.tabs,D,{deep:!0}),P(()=>{var o,e;return(e=(o=b.value)==null?void 0:o.logs)==null?void 0:e.length},()=>{j.value&&Ce(()=>{j.value.scrollTop=j.value.scrollHeight})});async function S(o){var a;const e=I.value?p.value:null;let d=C.value;if(o==="summarize"&&!d&&(d="Summarize the selected information."),o==="generate_report"&&!d&&(d="Analyze all sources and generate a comprehensive research report.",((a=r.value)==null?void 0:a.title)==="Research Report"&&(I.value=!0)),!d.trim()&&!f.value.length&&o!=="generate_report"){m.addNotification("Please enter a prompt or select artefacts.","warning");return}await i.processWithAi(d,[],o,e,!1,f.value),C.value=""}async function Z(){b.value&&await i.cancelTask(b.value.id)}function L(){S("text_processing")}function ee(o){const e=f.value.indexOf(o);e===-1?f.value.push(o):f.value.splice(e,1)}function te(){m.openModal("artefactImportWizard",{notebookId:u.notebook.id})}async function ae(){if(!r.value)return;const{confirmed:o,value:e}=await m.showConfirmation({title:"Save as Artefact",message:"Enter a name for this new source:",confirmText:"Save",inputType:"text",inputValue:r.value.title});o&&e&&await i.createManualArtefact(e,r.value.content)}async function F(o){let e="";r.value&&r.value.content&&(e+=`

[Primary Content from ${r.value.title}]
${r.value.content}
`);for(const g of f.value){const W=u.notebook.artefacts.find(ie=>ie.filename===g);W&&(e+=`

[Source: ${g}]
${W.content}
`)}if(!e.trim()){m.addNotification("Please select artefacts or open a tab with content to use as a base.","warning");return}const d=o==="slides_making"?"New Presentation":"New Video Project",a=await i.createStructuredNotebook({title:d,type:o,initialPrompt:"Initialize project from previous research.",raw_text:e});a&&(m.addNotification("Project created! Switching views...","success"),await i.selectNotebook(a.id))}function oe(o){confirm("Delete this tab?")&&(i.removeTab(o),p.value===o&&(p.value=null))}function re(o){m.openModal("artefactViewer",{artefact:{title:o.filename,content:o.content}})}function se(o){c.value={originalName:o.filename,name:o.filename,content:o.content}}async function ne(){if(c.value)try{await i.updateArtefact(c.value.originalName,c.value.name,c.value.content),c.value=null}catch(o){console.error(o)}}async function le(o){await i.deleteArtefact(o)}return(o,e)=>{var d;return n(),l("div",$e,[s(H,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:G(()=>[b.value?(n(),l("div",Ne,[t("div",Ie,[t("div",je,[t("div",ze,[t("div",Re,[s(pe,{class:"w-10 h-10 animate-spin text-white"})]),t("div",null,[t("h2",Ve,x(b.value.name),1),t("p",Pe,x(b.value.description),1)])]),t("div",Me,x(b.value.progress)+"%",1)]),t("div",Be,[t("div",{class:"h-full bg-blue-600 transition-all duration-500 progress-bar-animated",style:fe({width:b.value.progress+"%"})},null,4)]),t("div",Ee,[e[19]||(e[19]=t("div",{class:"px-6 py-3 bg-gray-900 border-b border-gray-800 flex items-center justify-between"},[t("span",{class:"text-[10px] font-black uppercase text-gray-500 tracking-widest"},"Research Operation Terminal"),t("div",{class:"flex gap-1.5"},[t("div",{class:"w-2 h-2 rounded-full bg-red-500/50"}),t("div",{class:"w-2 h-2 rounded-full bg-yellow-500/50"}),t("div",{class:"w-2 h-2 rounded-full bg-green-500/50"})])],-1)),t("div",{ref_key:"logsContainerRef",ref:j,class:"flex-grow overflow-y-auto p-6 font-mono text-xs text-gray-400 space-y-1.5 custom-scrollbar"},[(n(!0),l(w,null,M(b.value.logs,(a,g)=>(n(),l("div",{key:g,class:"flex gap-4"},[t("span",Oe,"["+x(new Date(a.timestamp).toLocaleTimeString())+"]",1),t("span",{class:T({"text-red-400 font-bold":a.level==="ERROR","text-blue-400":a.level==="INFO","text-yellow-400":a.level==="WARNING"})},x(a.message),3)]))),128))],512)]),b.value.status==="running"||b.value.status==="pending"?(n(),l("div",Ue,[t("button",{onClick:Z,class:"btn btn-warning px-6 py-2 flex items-center gap-2 rounded-xl shadow-lg border border-red-500/30"},[s(B,{class:"w-4 h-4"}),e[20]||(e[20]=v(" Stop Operation "))])])):k("",!0)])])):k("",!0)]),_:1}),s(H,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-4"},{default:G(()=>[c.value?(n(),l("div",De,[t("div",Le,[t("div",Fe,[e[21]||(e[21]=t("h3",{class:"font-black text-sm uppercase tracking-widest"},"Edit Source",-1)),t("button",{onClick:e[0]||(e[0]=a=>c.value=null),class:"btn-icon-flat"},[s(B,{class:"w-5 h-5"})])]),t("div",We,[t("div",null,[e[22]||(e[22]=t("label",{class:"text-[10px] font-bold uppercase text-gray-500 mb-1 block"},"Title",-1)),$(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>c.value.name=a),class:"input-field w-full font-bold"},null,512),[[z,c.value.name]])]),t("div",Ge,[e[23]||(e[23]=t("label",{class:"text-[10px] font-bold uppercase text-gray-500 mb-1 block"},"Content",-1)),$(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>c.value.content=a),class:"flex-grow input-field w-full font-mono text-xs resize-none"},null,512),[[z,c.value.content]])])]),t("div",He,[t("button",{onClick:e[3]||(e[3]=a=>c.value=null),class:"btn btn-secondary"},"Cancel"),t("button",{onClick:ne,class:"btn btn-primary"},[s(E,{class:"w-4 h-4 mr-2"}),e[24]||(e[24]=v(" Save"))])])])])):k("",!0)]),_:1}),t("div",Ke,[t("div",Je,[e[25]||(e[25]=t("span",null,"Data Sources",-1)),t("button",{onClick:te,class:"text-green-500 hover:text-green-600 p-1 rounded hover:bg-green-50 dark:hover:bg-green-900/20"},[s(K,{class:"w-4 h-4"})])]),t("div",Qe,[N.notebook.artefacts.length===0?(n(),l("div",qe,[t("div",Ye,[s(O,{class:"w-8 h-8 mx-auto"})]),e[26]||(e[26]=v(" No data sources yet.")),e[27]||(e[27]=t("br",null,null,-1)),e[28]||(e[28]=v("Click + to import content. "))])):k("",!0),(n(!0),l(w,null,M(N.notebook.artefacts,a=>(n(),l("div",{key:a.filename,onClick:g=>ee(a.filename),class:T(["flex items-center gap-2 p-3 rounded-lg cursor-pointer group transition-all border border-transparent shadow-sm",f.value.includes(a.filename)?"bg-white dark:bg-gray-800 border-green-500 shadow-md ring-1 ring-green-500/20":"bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600"])},[t("div",Ze,[f.value.includes(a.filename)?(n(),R(ve,{key:0,class:"w-4 h-4 text-green-500"})):(n(),R(O,{key:1,class:"w-4 h-4 text-gray-400"}))]),t("span",et,x(a.filename),1),t("div",tt,[t("button",{onClick:V(g=>re(a),["stop"]),class:"p-1 hover:text-blue-500",title:"View"},[s(J,{class:"w-3 h-3"})],8,at),t("button",{onClick:V(g=>se(a),["stop"]),class:"p-1 hover:text-orange-500",title:"Edit"},[s(Q,{class:"w-3 h-3"})],8,ot),t("button",{onClick:V(g=>le(a.filename),["stop"]),class:"p-1 hover:text-red-500",title:"Delete"},[s(xe,{class:"w-3 h-3"})],8,rt)])],10,Xe))),128))]),t("div",st,[e[31]||(e[31]=t("p",{class:"text-[9px] font-black uppercase text-gray-500 mb-2"},"Convert Selection To Project",-1)),t("div",nt,[t("button",{onClick:e[4]||(e[4]=a=>F("slides_making")),class:"flex flex-col items-center justify-center p-2 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg hover:border-blue-500 hover:shadow-lg transition-all text-center group"},[s(ye,{class:"w-5 h-5 text-gray-400 group-hover:text-blue-500 mb-1"}),e[29]||(e[29]=t("span",{class:"text-[10px] font-bold"},"Slides",-1))]),t("button",{onClick:e[5]||(e[5]=a=>F("youtube_video")),class:"flex flex-col items-center justify-center p-2 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg hover:border-pink-500 hover:shadow-lg transition-all text-center group"},[s(Ae,{class:"w-5 h-5 text-gray-400 group-hover:text-pink-500 mb-1"}),e[30]||(e[30]=t("span",{class:"text-[10px] font-bold"},"Video",-1))])])])]),t("div",lt,[t("div",it,[(n(!0),l(w,null,M(N.notebook.tabs,a=>(n(),l("div",{key:a.id,onClick:g=>p.value=a.id,class:T(["group relative px-4 py-2 rounded-t-lg cursor-pointer text-xs font-bold uppercase transition-all flex items-center gap-2 min-w-[120px] justify-between border-t border-x",p.value===a.id?"bg-gray-100 dark:bg-gray-950 border-gray-200 dark:border-gray-700 text-blue-600 dark:text-blue-400 translate-y-px":"bg-gray-50 dark:bg-gray-900 border-transparent text-gray-500 hover:bg-gray-100 hover:text-gray-700"])},[t("span",ut,x(a.title),1),t("button",{onClick:V(g=>oe(a.id),["stop"]),class:"opacity-0 group-hover:opacity-100 hover:text-red-500 transition-opacity"},[s(B,{class:"w-3 h-3"})],8,ct)],10,dt))),128)),t("button",{onClick:e[6]||(e[6]=a=>h(i).addTab("markdown")),class:"px-3 py-2 text-gray-400 hover:text-blue-500 transition-colors"},[s(K,{class:"w-4 h-4"})])]),t("div",bt,[r.value?(n(),l(w,{key:0},[t("div",gt,[t("div",pt,[$(t("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.title=a),onBlur:e[8]||(e[8]=(...a)=>h(i).saveActive&&h(i).saveActive(...a)),class:"font-black bg-transparent border-none focus:ring-0 text-gray-800 dark:text-gray-100 text-sm"},null,544),[[z,r.value.title]]),t("span",ft,x(r.value.type),1)]),t("div",vt,[r.value.title==="Research Report"?(n(),l("button",{key:0,onClick:e[9]||(e[9]=a=>S("generate_report")),class:"btn btn-primary btn-sm flex items-center gap-1 shadow-md"},[s(q,{class:"w-3 h-3"}),e[32]||(e[32]=v(" Regenerate Report "))])):k("",!0),e[34]||(e[34]=t("div",{class:"h-4 w-px bg-gray-300 dark:bg-gray-700 mx-2"},null,-1)),t("button",{onClick:ae,class:"btn btn-secondary btn-sm text-xs",title:"Save this content as a reusable artefact"},[s(E,{class:"w-3 h-3 mr-1"}),e[33]||(e[33]=v(" Save Source "))]),["html","slides","youtube_storyboard","youtube_script"].includes(r.value.type)?k("",!0):(n(),l("div",xt,[t("button",{onClick:e[10]||(e[10]=a=>_.value=!0),class:T(["p-1.5 rounded transition-colors",_.value?"bg-blue-100 dark:bg-blue-900/30 text-blue-600":"text-gray-400 hover:text-gray-600"])},[s(J,{class:"w-3.5 h-3.5"})],2),t("button",{onClick:e[11]||(e[11]=a=>_.value=!1),class:T(["p-1.5 rounded transition-colors",_.value?"text-gray-400 hover:text-gray-600":"bg-blue-100 dark:bg-blue-900/30 text-blue-600"])},[s(Q,{class:"w-3.5 h-3.5"})],2)])),t("button",{onClick:e[12]||(e[12]=(...a)=>h(i).saveActive&&h(i).saveActive(...a)),class:"p-1.5 rounded hover:bg-white text-gray-500",title:"Save changes"},[s(E,{class:"w-4 h-4"})])])]),t("div",yt,[r.value.type==="html"?(n(),l(w,{key:0},[U.value?(n(),l("iframe",{key:0,src:U.value,class:"w-full h-full border-none bg-white"},null,8,mt)):(n(),l("div",kt,"No HTML Content"))],64)):(n(),l(w,{key:1},[_.value?(n(),l("div",wt,[t("div",ht,[(n(),R(me,{content:r.value.content,key:r.value.id+((d=r.value.content)==null?void 0:d.length),class:"prose prose-lg dark:prose-invert max-w-none"},null,8,["content"]))])])):(n(),R(ke,{key:1,modelValue:r.value.content,"onUpdate:modelValue":e[13]||(e[13]=a=>r.value.content=a),onBlur:h(i).saveActive,class:"h-full",language:r.value.type==="code"?"python":"markdown"},null,8,["modelValue","onBlur","language"]))],64))])],64)):(n(),l("div",_t,[t("div",Ct,[s(q,{class:"w-10 h-10 opacity-30"})]),e[35]||(e[35]=t("p",null,"Select a tab or create a new one to begin.",-1))]))]),t("div",St,[t("div",At,[e[39]||(e[39]=t("span",{class:"text-[10px] font-black uppercase text-gray-400 whitespace-nowrap"},"Quick Actions:",-1)),t("button",{onClick:e[14]||(e[14]=a=>S("summarize")),class:"px-3 py-1 bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-full text-xs font-bold border hover:border-blue-500 hover:text-blue-500 transition-all whitespace-nowrap shadow-sm"},[s(O,{class:"w-3 h-3 inline mr-1"}),e[36]||(e[36]=v("Summarize"))]),t("button",{onClick:e[15]||(e[15]=a=>S("generate_html")),class:"px-3 py-1 bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-full text-xs font-bold border hover:border-purple-500 hover:text-purple-500 transition-all whitespace-nowrap shadow-sm"},[s(Se,{class:"w-3 h-3 inline mr-1"}),e[37]||(e[37]=v("Visualize (HTML)"))]),t("button",{onClick:e[16]||(e[16]=a=>S("generate_code")),class:"px-3 py-1 bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-full text-xs font-bold border hover:border-yellow-500 hover:text-yellow-500 transition-all whitespace-nowrap shadow-sm"},[s(we,{class:"w-3 h-3 inline mr-1"}),e[38]||(e[38]=v("Generate Code"))])]),t("div",Tt,[$(t("input",{"onUpdate:modelValue":e[17]||(e[17]=a=>C.value=a),onKeyup:he(L,["enter"]),placeholder:"Ask AI to analyze data or write content...",class:"input-field flex-grow pr-36 h-14 rounded-xl text-base pl-4 border-none focus:ring-2 ring-blue-500"},null,544),[[z,C.value]]),t("div",$t,[$(t("input",{type:"checkbox",id:"mod-tab","onUpdate:modelValue":e[18]||(e[18]=a=>I.value=a),class:"h-4 w-4 rounded text-blue-600 focus:ring-blue-500 cursor-pointer"},null,512),[[_e,I.value]]),e[40]||(e[40]=t("label",{for:"mod-tab",class:"text-[9px] font-black uppercase text-gray-400 cursor-pointer select-none whitespace-nowrap"},"Edit Active",-1))]),t("button",{onClick:L,class:"absolute right-2 top-2 bottom-2 btn btn-primary w-10 flex items-center justify-center rounded-lg shadow-md",disabled:!C.value.trim()&&!f.value.length||b.value},[s(Te,{class:"w-5 h-5"})],8,Nt)])])])])}}},Pt=de(It,[["__scopeId","data-v-7f4b0a01"]]);export{Pt as default};
