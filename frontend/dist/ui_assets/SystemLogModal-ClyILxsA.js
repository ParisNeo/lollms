import{useAdminStore as h}from"./admin-DdhxCg1C.js";import{u as k,h as u,x as v,c as w,o,w as g,a as e,i as L,z as p,Z as C,n as y,I as S,d as r,F as R,A as I,t as l}from"./index-BztlMlxc.js";import{_ as $}from"./GenericModal-DF57XP4_.js";const A={class:"flex flex-col h-[70vh]"},N={class:"flex justify-between items-center mb-2 px-1"},B={class:"flex gap-2"},T=["disabled"],M={class:"flex-grow overflow-y-auto bg-gray-50 dark:bg-gray-900 rounded-md border dark:border-gray-700 p-4 font-mono text-xs"},j={key:0,class:"text-center py-4 text-gray-500"},z={key:1,class:"text-center py-4 text-gray-500"},D={key:2},E={class:"flex gap-2"},F={class:"text-gray-400 whitespace-nowrap min-w-[140px]"},U=["title"],V={class:"break-all whitespace-pre-wrap"},q={__name:"SystemLogModal",setup(G){const d=h(),i=k(),n=u(()=>d.systemLogs),c=u(()=>d.isLoadingSystemLogs);function m(){d.fetchSystemLogs()}function b(){const a=n.value.map(t=>`[${t.timestamp}] [${t.level}] [${t.task_name}] ${t.message}`).join(`
`);i.copyToClipboard(a,"Logs copied to clipboard")}function x(a){switch(a.toUpperCase()){case"ERROR":return"text-red-600 dark:text-red-400 font-bold";case"CRITICAL":return"text-red-700 dark:text-red-500 font-bold underline";case"WARNING":return"text-yellow-600 dark:text-yellow-400";default:return"text-gray-700 dark:text-gray-300"}}function _(a){return new Date(a).toLocaleString()}return v(()=>{m()}),(a,t)=>(o(),w($,{"modal-name":"systemLog",title:"System Logs (Recent Tasks)","max-width-class":"max-w-5xl"},{body:g(()=>[e("div",A,[e("div",N,[t[1]||(t[1]=e("span",{class:"text-sm text-gray-500"},"Aggregated logs from recent background tasks.",-1)),e("div",B,[e("button",{onClick:b,class:"btn btn-secondary btn-sm",title:"Copy to Clipboard"},[p(C,{class:"w-4 h-4"})]),e("button",{onClick:m,class:"btn btn-secondary btn-sm",disabled:c.value},[p(S,{class:y(["w-4 h-4",{"animate-spin":c.value}])},null,8,["class"])],8,T)])]),e("div",M,[c.value&&n.value.length===0?(o(),r("div",j,"Loading logs...")):n.value.length===0?(o(),r("div",z,"No logs found.")):(o(),r("div",D,[(o(!0),r(R,null,I(n.value,(s,f)=>(o(),r("div",{key:f,class:"mb-1 border-b border-gray-100 dark:border-gray-800 pb-1 last:border-0 hover:bg-gray-100 dark:hover:bg-gray-800/50 px-2 rounded"},[e("div",E,[e("span",F,l(_(s.timestamp)),1),e("span",{class:y([x(s.level),"w-16 flex-shrink-0"])},l(s.level),3),e("span",{class:"text-blue-500 dark:text-blue-400 w-32 truncate flex-shrink-0",title:s.task_name},l(s.task_name),9,U),e("span",V,l(s.message),1)])]))),128))]))])])]),footer:g(()=>[e("button",{onClick:t[0]||(t[0]=s=>L(i).closeModal("systemLog")),class:"btn btn-primary"},"Close")]),_:1}))}};export{q as default};
