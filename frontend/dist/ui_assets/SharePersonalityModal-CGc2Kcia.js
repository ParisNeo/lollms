import{K as k,P as _,a as x,c as o,s as y,o as P,n as w,l,g as v,e,j as C,t as f,H as b,d,h as U,z as M,L as B,F as D,i as N,f as V,U as $}from"./index-CEXks4lv.js";import{_ as F}from"./GenericModal-Br5hR2Sz.js";const I={key:0},L={class:"mt-2 max-h-40 overflow-y-auto space-y-1 p-1 bg-gray-50 dark:bg-gray-700/50 rounded-md border dark:border-gray-600"},z=["onClick"],E=["disabled"],K={__name:"SharePersonalityModal",setup(j){const i=k(),g=_(),u=x(),m=o(()=>i.modalData("sharePersonality")),h=o(()=>{var n;return(n=m.value)==null?void 0:n.personalityId}),S=o(()=>{var n;return(n=m.value)==null?void 0:n.title}),s=y(""),r=y(!1),c=o(()=>u.friends);P(()=>{u.friends.length===0&&u.fetchFriends()});async function p(){if(!s.value.trim()){i.addNotification("Please enter a username.","warning");return}r.value=!0;try{await g.sendPersonality({personalityId:h.value,targetUsername:s.value})}finally{r.value=!1}}return(n,t)=>(l(),w(F,{"modal-name":"sharePersonality",title:`Share Personality: ${S.value}`},{body:v(()=>[e("form",{onSubmit:b(p,["prevent"]),class:"space-y-4"},[e("div",null,[t[2]||(t[2]=e("label",{for:"target-username",class:"block text-sm font-medium"},"Username",-1)),M(e("input",{id:"target-username","onUpdate:modelValue":t[0]||(t[0]=a=>s.value=a),type:"text",class:"input-field mt-1",placeholder:"Enter username to send to",required:""},null,512),[[B,s.value]])]),c.value.length>0?(l(),d("div",I,[t[3]||(t[3]=e("p",{class:"text-sm font-medium"},"Or select a friend:",-1)),e("div",L,[(l(!0),d(D,null,N(c.value,a=>(l(),d("button",{key:a.id,onClick:b(q=>s.value=a.username,["prevent"]),type:"button",class:"w-full text-left p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},[V($,{icon:a.icon,username:a.username,"size-class":"w-6 h-6"},null,8,["icon","username"]),e("span",null,f(a.username),1)],8,z))),128))])])):U("",!0)],32)]),footer:v(()=>[e("button",{onClick:t[1]||(t[1]=a=>C(i).closeModal("sharePersonality")),type:"button",class:"btn btn-secondary"},"Cancel"),e("button",{onClick:p,type:"button",class:"btn btn-primary",disabled:r.value||!s.value.trim()},f(r.value?"Sending...":"Send"),9,E)]),_:1},8,["title"]))}};export{K as default};
