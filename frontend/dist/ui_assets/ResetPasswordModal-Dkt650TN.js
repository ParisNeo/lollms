import{X as C,c as m,K as u,w as M,n as _,l as w,g as k,e as s,j as y,t as x,d as v,h as g,J as R,O as h,W as P,Q as N}from"./index-BETWUTlj.js";import{_ as $}from"./GenericModal-D-THYpyF.js";const B={class:"relative mt-1"},j=["type","disabled"],V={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},A={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},D=["type","disabled"],S={key:0,class:"text-red-600 text-sm text-center p-2 bg-red-100 dark:bg-red-900/50 rounded-md",role:"alert"},U={class:"flex justify-end space-x-3"},q=["disabled"],J={__name:"ResetPasswordModal",setup(z){const d=C(),f=m(()=>d.modalData("resetPassword")),l=m(()=>{var t;return(t=f.value)==null?void 0:t.user}),c=m(()=>{var t;return(t=f.value)==null?void 0:t.onPasswordReset}),r=u(""),p=u(""),i=u(!1),n=u(!1),o=u("");M(l,t=>{t&&(r.value="",p.value="",o.value="")});const b=async()=>{var t,e;if(r.value.length<8){o.value="New password must be at least 8 characters long.";return}if(r.value!==p.value){o.value="Passwords do not match.";return}n.value=!0,o.value="";try{await N.post(`/api/admin/users/${l.value.id}/reset-password`,{new_password:r.value}),d.addNotification(`Password for ${l.value.username} has been reset.`,"success"),c.value&&typeof c.value=="function"&&c.value(),d.closeModal("resetPassword")}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.detail)||"An unexpected error occurred."}finally{n.value=!1}};return(t,e)=>(w(),_($,{modalName:"resetPassword",title:l.value?`Reset Password for ${l.value.username}`:"Reset Password",maxWidthClass:"max-w-md",onClose:e[4]||(e[4]=a=>y(d).closeModal("resetPassword"))},{body:k(()=>[l.value?(w(),v("form",{key:0,onSubmit:R(b,["prevent"]),class:"space-y-4"},[s("div",null,[e[7]||(e[7]=s("label",{for:"admin-new-password",class:"block text-sm font-medium"},"New Password",-1)),s("div",B,[h(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:i.value?"text":"password",id:"admin-new-password",required:"",minlength:"8",disabled:n.value,class:"input-field w-full pr-10",placeholder:"Enter new password"},null,8,j),[[P,r.value]]),s("button",{type:"button",onClick:e[1]||(e[1]=a=>i.value=!i.value),class:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500 hover:text-gray-700"},[i.value?(w(),v("svg",V,e[5]||(e[5]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a9.97 9.97 0 01-1.563 3.029m-2.135-2.135A6.978 6.978 0 0112 17c-1.855 0-3.56-.736-4.807-1.938"},null,-1)]))):(w(),v("svg",A,e[6]||(e[6]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))])])]),s("div",null,[e[8]||(e[8]=s("label",{for:"admin-confirm-password",class:"block text-sm font-medium"},"Confirm New Password",-1)),h(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>p.value=a),type:i.value?"text":"password",id:"admin-confirm-password",required:"",disabled:n.value,class:"input-field mt-1 w-full",placeholder:"Confirm new password"},null,8,D),[[P,p.value]])]),o.value?(w(),v("div",S,x(o.value),1)):g("",!0)],32)):g("",!0)]),footer:k(()=>[s("div",U,[s("button",{type:"button",class:"btn btn-secondary",onClick:e[3]||(e[3]=a=>y(d).closeModal("resetPassword"))},"Cancel"),s("button",{type:"button",class:"btn btn-danger",onClick:b,disabled:n.value},x(n.value?"Resetting...":"Reset Password"),9,q)])]),_:1},8,["title"]))}};export{J as default};
