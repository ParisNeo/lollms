const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["ui_assets/BindingModelsManager-BWLmtQ6p.js","ui_assets/index-BT_1XIF6.js","ui_assets/index-CR_O8NPc.css","ui_assets/admin-BOojpiAv.js","ui_assets/BindingZoo-Fu_rfoVq.js"])))=>i.map(i=>d[i]);
import{K as X,W as Y,s as u,c as V,w as ee,o as te,d as l,l as o,e as t,h as v,t as r,p as m,z as B,m as A,Q as U,X as z,F as h,i as k,j as w,J as ne,n as D,c9 as se,ca as ae,ao as oe,H as j,f as N,A as I,cc as ie,D as O}from"./index-BT_1XIF6.js";import{u as le}from"./admin-BOojpiAv.js";const re={class:"space-y-8"},de={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},ue={class:"flex justify-between items-center mb-4"},ce={class:"text-xl font-semibold"},ve={key:0,class:"flex gap-2 text-sm font-medium"},me={key:0},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},fe=["disabled"],be=["value"],ye={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},pe={class:"text-sm text-gray-600 dark:text-gray-400"},_e=["for"],xe={key:0,class:"text-red-500"},he=["id","onUpdate:modelValue"],ke=["value"],we={key:1},Te={class:"relative"},Ce=["type","id","onUpdate:modelValue","required","placeholder"],Se=["onClick","title"],Be={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Ae={class:"flex-grow flex flex-col pr-4"},$e={class:"text-sm text-gray-500 dark:text-gray-400"},Ve=["onClick"],De={class:"text-xs text-gray-500 mt-1"},je={key:1,class:"mt-6 border-t dark:border-gray-700 pt-6"},Ne={class:"grid grid-cols-1 gap-4"},Ee={class:"flex justify-between items-start mb-3"},Fe={class:"font-bold text-md"},Me={class:"text-sm text-gray-600 dark:text-gray-400"},Ue={key:0,class:"space-y-3 mb-4"},ze={class:"block text-xs font-medium uppercase text-gray-500 dark:text-gray-400 mb-1"},Ie=["onUpdate:modelValue","placeholder"],Oe={key:1,class:"flex items-center gap-2"},qe=["onClick"],Le={class:"text-sm"},Pe={class:"flex justify-end"},Je=["onClick"],Re={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},He={class:"flex justify-end gap-3"},Ke=["disabled"],We={key:1},Ze={key:2},Ge={key:1},Qe={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},Xe={class:"flex items-center gap-4"},Ye={key:0,class:"text-center p-6"},et={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},tt={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},nt=["onClick"],st=["onClick","title"],at={class:"flex-grow"},ot={class:"flex items-center gap-3 mb-2"},it={class:"font-bold text-lg text-gray-900 dark:text-white"},lt={class:"text-xs text-gray-500 dark:text-gray-400"},rt={class:"mt-3 text-sm text-gray-600 dark:text-gray-300"},dt={key:0,class:"mb-1"},ut={class:"text-xs text-gray-400 truncate"},ct={class:"border-t dark:border-gray-700 pt-3 flex justify-between items-center text-xs text-gray-500"},vt=["onClick"],yt={__name:"TTSBindingsSettings",setup(mt){const q=I(()=>O(()=>import("./BindingModelsManager-BWLmtQ6p.js"),__vite__mapDeps([0,1,2,3]))),L=I(()=>O(()=>import("./BindingZoo-Fu_rfoVq.js"),__vite__mapDeps([4,1,2,3]))),f=le(),T=X(),{ttsBindings:E,availableTtsBindingTypes:C,isLoadingTtsBindings:P,globalSettings:gt}=Y(f),x=u(!1),b=u(null),S=u(!1),p=u({}),g=u({}),d=u("settings");u(!1),u(null),u([]),u(null),u({}),u(!1);const F=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),i=u(F()),_=V(()=>b.value!==null),y=V(()=>i.value.name?C.value.find(a=>a.binding_name===i.value.name):null),J=V(()=>{if(!y.value)return[];const a=y.value.input_parameters||[],n=new Set(a.map(s=>s.name)),e=Object.keys(i.value.config||{}).filter(s=>!n.has(s)&&s!=="model_name").map(s=>({name:s,type:typeof i.value.config[s]=="boolean"?"bool":typeof i.value.config[s]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...a.filter(s=>s.name!=="model_name"),...e]});ee(()=>i.value.name,(a,n)=>{if(a!==n&&!_.value){const e=C.value.find(c=>c.binding_name===a),s={};e&&e.input_parameters&&e.input_parameters.forEach(c=>{s[c.name]=c.default}),i.value.config=s}}),te(()=>{f.fetchTtsBindings(),f.fetchAvailableTtsBindingTypes(),f.fetchGlobalSettings()});function M(){b.value=null,i.value=F(),p.value={},g.value={},x.value=!0,d.value="settings",window.scrollTo({top:0,behavior:"smooth"})}function R(a){b.value=a,i.value=JSON.parse(JSON.stringify(a)),i.value.config||(i.value.config={}),p.value={};const n=C.value.find(e=>e.binding_name===a.name);if(n&&n.commands){const e={};n.commands.forEach(s=>{e[s.name]={},s.parameters&&s.parameters.forEach(c=>{e[s.name][c.name]=c.default!==void 0?c.default:""})}),g.value=e}else g.value={};x.value=!0,d.value="settings",window.scrollTo({top:0,behavior:"smooth"})}function $(){x.value=!1,b.value=null}function H(a){return typeof a=="string"?a.split(",").map(n=>n.trim()).filter(n=>n):Array.isArray(a)?a.filter(n=>n):[]}async function K(){if(!i.value.alias.trim()||!i.value.name){T.addNotification("Alias and Binding Type are required fields.","warning");return}S.value=!0;try{const a={alias:i.value.alias,name:i.value.name,config:i.value.config||{},is_active:i.value.is_active,default_model_name:i.value.default_model_name||null};_.value?await f.updateTtsBinding(b.value.id,a):await f.addTtsBinding(a),$()}catch(a){console.error("Submit failed:",a.message)}finally{S.value=!1}}async function W(a){await T.showConfirmation({title:`Delete TTS Binding '${a.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await f.deleteTtsBinding(a.id)}async function Z(a){await f.updateTtsBinding(a.id,{is_active:!a.is_active})}function G(a){const n=C.value.find(e=>e.binding_name===a);return n?n.title:a}async function Q(a,n,e){try{T.addNotification(`Submitting command '${a.title||a.name}'...`,"info");const s=await f.executeTtsBindingCommand(n,a.name,e);if(s)return T.addNotification(`Task started: ${a.title||a.name}. Check Task Manager for progress.`,"success",5e3),s}catch(s){console.error(s),T.addNotification(`Command submission failed: ${s.message}`,"error")}}return(a,n)=>(o(),l("div",re,[x.value?(o(),l("div",de,[t("div",ue,[t("h3",ce,r(_.value?"Edit TTS Binding: "+i.value.alias:"Add New TTS Binding"),1),_.value?(o(),l("div",ve,[t("button",{onClick:n[0]||(n[0]=e=>d.value="settings"),class:m([{"text-blue-600 border-b-2 border-blue-600":d.value==="settings","text-gray-500 hover:text-gray-700":d.value!=="settings"},"px-3 py-2"])},"Settings",2),t("button",{onClick:n[1]||(n[1]=e=>d.value="zoo"),class:m([{"text-blue-600 border-b-2 border-blue-600":d.value==="zoo","text-gray-500 hover:text-gray-700":d.value!=="zoo"},"px-3 py-2"])},"Models Zoo",2),t("button",{onClick:n[2]||(n[2]=e=>d.value="models"),class:m([{"text-blue-600 border-b-2 border-blue-600":d.value==="models","text-gray-500 hover:text-gray-700":d.value!=="models"},"px-3 py-2"])},"Installed Models",2)])):v("",!0)]),d.value==="settings"?(o(),l("div",me,[t("form",{onSubmit:j(K,["prevent"]),class:"space-y-6"},[t("div",ge,[t("div",null,[n[7]||(n[7]=t("label",{for:"alias",class:"block text-sm font-medium"},[A("Alias "),t("span",{class:"text-red-500"},"*")],-1)),B(t("input",{type:"text",id:"alias","onUpdate:modelValue":n[3]||(n[3]=e=>i.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_xtts",autocomplete:"off"},null,512),[[U,i.value.alias]]),n[8]||(n[8]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[n[10]||(n[10]=t("label",{for:"name",class:"block text-sm font-medium"},[A("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),B(t("select",{id:"name","onUpdate:modelValue":n[4]||(n[4]=e=>i.value.name=e),class:"input-field mt-1",required:"",disabled:_.value},[n[9]||(n[9]=t("option",{disabled:"",value:""},"Select a type",-1)),(o(!0),l(h,null,k(w(C),e=>(o(),l("option",{key:e.binding_name,value:e.binding_name},r(e.title),9,be))),128))],8,fe),[[z,i.value.name]])])]),y.value?(o(),l("div",ye,[t("p",pe,r(y.value.description),1),(o(!0),l(h,null,k(J.value,e=>(o(),l("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[A(r(e.name.replace(/_/g," "))+" ",1),e.mandatory?(o(),l("span",xe,"*")):v("",!0)],8,_e),e.options&&e.options.length>0?B((o(),l("select",{key:0,id:`param-${e.name}`,"onUpdate:modelValue":s=>i.value.config[e.name]=s,class:"input-field"},[(o(!0),l(h,null,k(H(e.options),s=>(o(),l("option",{key:s,value:s},r(s),9,ke))),128))],8,he)),[[z,i.value.config[e.name]]]):["str","int","float"].includes(e.type)?(o(),l("div",we,[t("div",Te,[B(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!p.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":s=>i.value.config[e.name]=s,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,Ce),[[ne,i.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(o(),l("button",{key:0,type:"button",onClick:s=>p.value[e.name]=!p.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:p.value[e.name]?"Hide":"Show"},[p.value[e.name]?(o(),D(se,{key:0,class:"w-5 h-5"})):(o(),D(ae,{key:1,class:"w-5 h-5"}))],8,Se)):v("",!0)])])):e.type==="bool"?(o(),l("div",Be,[t("span",Ae,[t("span",$e,r(e.description),1)]),t("button",{onClick:s=>i.value.config[e.name]=!i.value.config[e.name],type:"button",class:m([i.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:m([i.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,Ve)])):v("",!0),t("p",De,r(e.description),1)]))),128))])):v("",!0),_.value&&y.value&&y.value.commands&&y.value.commands.length>0?(o(),l("div",je,[n[11]||(n[11]=t("h4",{class:"text-lg font-semibold mb-4"},"Binding Commands",-1)),t("div",Ne,[(o(!0),l(h,null,k(y.value.commands,e=>(o(),l("div",{key:e.name,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600"},[t("div",Ee,[t("div",null,[t("h5",Fe,r(e.title||e.name),1),t("p",Me,r(e.description),1)])]),e.parameters&&e.parameters.length>0?(o(),l("div",Ue,[(o(!0),l(h,null,k(e.parameters,s=>(o(),l("div",{key:s.name},[t("label",ze,r(s.name),1),s.type!=="bool"?B((o(),l("input",{key:0,type:"text","onUpdate:modelValue":c=>g.value[e.name][s.name]=c,class:"input-field text-sm",placeholder:s.default},null,8,Ie)),[[U,g.value[e.name][s.name]]]):(o(),l("div",Oe,[t("button",{onClick:c=>g.value[e.name][s.name]=!g.value[e.name][s.name],type:"button",class:m([g.value[e.name][s.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:m([g.value[e.name][s.name]?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,qe),t("span",Le,r(s.description),1)]))]))),128))])):v("",!0),t("div",Pe,[t("button",{type:"button",onClick:s=>Q(e,b.value.id,g.value[e.name]),class:"btn btn-primary btn-sm"},"Execute",8,Je)])]))),128))])])):v("",!0),t("div",Re,[n[12]||(n[12]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this TTS service will not be available.")],-1)),t("button",{onClick:n[5]||(n[5]=e=>i.value.is_active=!i.value.is_active),type:"button",class:m([i.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:m([i.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",He,[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:S.value},[S.value?(o(),D(oe,{key:0,class:"w-5 h-5 mr-2"})):v("",!0),A(" "+r(S.value?"Saving...":_.value?"Save Changes":"Add Binding"),1)],8,Ke)])],32)])):d.value==="zoo"?(o(),l("div",We,[N(w(L),{binding:b.value,"binding-type":"tts"},null,8,["binding"]),t("div",{class:"flex justify-end gap-3 mt-4"},[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Close")])])):d.value==="models"?(o(),l("div",Ze,[N(w(q),{binding:b.value,"binding-type":"tts"},null,8,["binding"]),t("div",{class:"flex justify-end gap-3 mt-4"},[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Close")])])):v("",!0)])):(o(),l("div",Ge,[t("div",Qe,[n[13]||(n[13]=t("h2",{class:"text-2xl font-bold"},"TTS Bindings",-1)),t("div",Xe,[x.value?v("",!0):(o(),l("button",{key:0,onClick:M,class:"btn btn-primary self-end"},"+ Add New TTS Binding"))])]),w(P)?(o(),l("div",Ye,"Loading TTS bindings...")):w(E).length===0&&!x.value?(o(),l("div",et,[n[14]||(n[14]=t("p",null,"No TTS bindings configured yet.",-1)),t("button",{onClick:M,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(o(),l("div",tt,[(o(!0),l(h,null,k(w(E),e=>(o(),l("div",{key:e.id,onClick:s=>R(e),class:"bg-white dark:bg-gray-800 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer flex flex-col gap-4 border border-transparent hover:border-blue-500 group relative"},[t("div",{class:"absolute top-4 right-4 z-10",onClick:n[6]||(n[6]=j(()=>{},["stop"]))},[t("button",{onClick:s=>Z(e),type:"button",class:m([e.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"]),title:e.is_active?"Deactivate":"Activate"},[t("span",{class:m([e.is_active?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],10,st)]),t("div",at,[t("div",ot,[N(ie,{class:"w-8 h-8 text-blue-500"}),t("div",null,[t("h4",it,r(e.alias),1),t("p",lt,r(G(e.name)),1)])]),t("div",rt,[e.default_model_name?(o(),l("p",dt,[n[15]||(n[15]=t("span",{class:"font-semibold"},"Default:",-1)),A(" "+r(e.default_model_name),1)])):v("",!0),t("p",ut,r(e.config?Object.keys(e.config).filter(s=>!s.includes("key")).join(", "):""),1)])]),t("div",ct,[n[16]||(n[16]=t("span",null,"Click to edit",-1)),t("button",{onClick:j(s=>W(e),["stop"]),class:"text-red-500 hover:underline p-1"},"Delete",8,vt)])],8,nt))),128))]))]))]))}};export{yt as default};
