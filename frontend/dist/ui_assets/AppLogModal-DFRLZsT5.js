import{u as k,c as d,N as b,m as x,a as m,o as g,w as v,b as p,d as $,aB as S,at as B}from"./index-BkSnPnj7.js";import{u as M}from"./admin-DblNksfn.js";import{_ as A}from"./GenericModal-CyWgHpU9.js";const N={class:"relative bg-gray-900 text-white font-mono text-xs p-4 rounded-md h-96 overflow-y-auto"},H=["innerHTML"],D={__name:"AppLogModal",setup(T){const u=k(),y=M(),_=d(()=>u.modalData("appLog")),l=d(()=>{var e;return(e=_.value)==null?void 0:e.app}),n=b(""),r=b(!1);async function h(){if(!(!l.value||r.value)){r.value=!0;try{n.value=await y.fetchAppLog(l.value.id)}catch(e){n.value=`Failed to load logs: ${e.message}`}finally{r.value=!1}}}function w(e){if(!e)return"No log output.";const f={30:"#000000",31:"#ff5555",32:"#50fa7b",33:"#f1fa8c",34:"#6272a4",35:"#ff79c6",36:"#8be9fd",37:"#f8f8f2",90:"#6272a4",91:"#ff6e6e",92:"#69ff94",93:"#ffffa5",94:"#d6acff",95:"#ff92df",96:"#a4ffff",97:"#ffffff"},s={40:"#000000",41:"#ff5555",42:"#50fa7b",43:"#f1fa8c",44:"#6272a4",45:"#ff79c6",46:"#8be9fd",47:"#f8f8f2",100:"#6272a4",101:"#ff6e6e",102:"#69ff94",103:"#ffffa5",104:"#d6acff",105:"#ff92df",106:"#a4ffff",107:"#ffffff"};let i="",a=[];e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");const c=e.split(/\x1b\[([0-9;]+)m/);for(let t=0;t<c.length;t++)if(t%2===0)a.length>0?i+=`<span style="${a.join(";")}">${c[t]}</span>`:i+=c[t];else{const C=c[t].split(";");a=[];for(const o of C)o==="0"||o===""?a=[]:o==="1"?a.push("font-weight:bold"):o==="2"?a.push("opacity:0.6"):o==="3"?a.push("font-style:italic"):o==="4"?a.push("text-decoration:underline"):f[o]?a.push(`color:${f[o]}`):s[o]&&a.push(`background-color:${s[o]}`)}return i}const L=d(()=>w(n.value));return x(()=>u.isModalOpen("appLog"),e=>{e&&l.value?h():n.value=""},{immediate:!0}),(e,f)=>{var s;return g(),m(A,{modalName:"appLog",title:`Logs: ${((s=l.value)==null?void 0:s.name)||""}`,maxWidthClass:"max-w-4xl"},{body:v(()=>[p("div",N,[p("button",{onClick:h,class:"absolute top-2 right-2 p-1.5 bg-gray-700 rounded-md hover:bg-gray-600",title:"Refresh Logs"},[r.value?(g(),m(S,{key:0,class:"w-4 h-4"})):(g(),m(B,{key:1,class:"w-4 h-4"}))]),p("pre",{class:"whitespace-pre-wrap break-words",innerHTML:L.value},null,8,H)])]),footer:v(()=>[p("button",{onClick:f[0]||(f[0]=i=>$(u).closeModal("appLog")),type:"button",class:"btn btn-secondary"},"Close")]),_:1},8,["title"])}}};export{D as default};
