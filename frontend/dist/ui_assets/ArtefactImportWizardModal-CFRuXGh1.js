import{a4 as B,e as n,o as s,b as e,Q as Z,u as ee,c as U,L as u,a as I,w as te,F as g,r as f,a2 as le,aL as ae,aw as se,n as M,h as W,J as oe,t as i,g as d,f as c,Y as D,aF as S,a0 as x,au as T,ac as m,ar as ne,aD as H,aN as re,at as ie,d as ue}from"./index-iFocv_fM.js";import{_ as de}from"./GenericModal-Brlmu_NN.js";import{I as ce}from"./IconWeb-HzNtpuYo.js";import{I as pe}from"./IconVideoCamera-NeuVhBFd.js";const be={},ve={width:"50px",height:"50px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ge(K,p){return s(),n("svg",ve,p[0]||(p[0]=[e("path",{d:"M8 12H9M16 12H12",stroke:"#1C274C","stroke-width":"1.5","stroke-linecap":"round"},null,-1),e("path",{d:"M16 8H15M12 8H8",stroke:"#1C274C","stroke-width":"1.5","stroke-linecap":"round"},null,-1),e("path",{d:"M8 16H13",stroke:"#1C274C","stroke-width":"1.5","stroke-linecap":"round"},null,-1),e("path",{d:"M3 14V10C3 6.22876 3 4.34315 4.17157 3.17157C5.34315 2 7.22876 2 11 2H13C16.7712 2 18.6569 2 19.8284 3.17157C20.4816 3.82476 20.7706 4.69989 20.8985 6M21 10V14C21 17.7712 21 19.6569 19.8284 20.8284C18.6569 22 16.7712 22 13 22H11C7.22876 22 5.34315 22 4.17157 20.8284C3.51839 20.1752 3.22937 19.3001 3.10149 18",stroke:"#1C274C","stroke-width":"1.5","stroke-linecap":"round"},null,-1)]))}const fe=B(be,[["render",ge]]),xe={class:"flex flex-col h-[500px]"},_e={class:"flex border-b dark:border-gray-700 overflow-x-auto no-scrollbar bg-gray-50 dark:bg-gray-800/50 p-1"},he=["onClick"],me={class:"flex-grow p-6 overflow-y-auto custom-scrollbar"},ke={key:0,class:"space-y-4"},ye={class:"flex flex-wrap gap-2"},we={class:"truncate max-w-[200px]"},Ce=["onClick"],Ie={key:1,class:"space-y-4"},Se={class:"flex gap-2"},Ve={class:"space-y-2"},Ae={class:"truncate pr-4 font-medium"},Me=["onClick"],De={key:2,class:"space-y-4"},$e={class:"flex gap-2"},Ue={class:"space-y-2"},We={class:"truncate pr-4 font-bold"},Te=["onClick"],Fe={key:3,class:"space-y-4"},Pe={class:"flex gap-2"},ze=["value"],Ne={class:"space-y-2"},je={class:"truncate pr-4 font-bold text-red-700 dark:text-red-400"},He={class:"flex items-center gap-3"},Be={class:"text-[9px] font-black uppercase px-2 py-1 bg-white dark:bg-gray-800 rounded border border-red-200"},Ke=["onClick"],Le={key:4,class:"space-y-4"},Ye={class:"flex gap-2"},Re=["disabled"],Ee={key:0,class:"space-y-2 max-h-80 overflow-y-auto custom-scrollbar border-t dark:border-gray-700 pt-2"},Xe={class:"flex justify-between items-start gap-2"},Ge={class:"flex items-start gap-2 flex-grow"},Je=["checked","onChange"],Oe={class:"font-bold text-gray-900 dark:text-white leading-tight"},Qe={class:"text-[10px] text-gray-500 mt-0.5"},qe={class:"mt-2 pl-6 flex items-center justify-between"},Ze={class:"flex items-center gap-2 cursor-pointer select-none"},et={class:"relative inline-block w-8 h-4 align-middle select-none transition duration-200 ease-in"},tt=["onUpdate:modelValue"],lt=["href"],at={key:1,class:"border-t dark:border-gray-700 pt-2"},st={class:"text-[10px] uppercase font-bold text-gray-500 mb-1"},ot={class:"space-y-1 max-h-32 overflow-y-auto custom-scrollbar"},nt={class:"truncate pr-2 font-medium"},rt={key:0,class:"text-[9px] bg-blue-200 text-blue-800 px-1 rounded ml-1"},it=["onClick"],ut={key:5,class:"space-y-4 h-full flex flex-col"},dt={class:"p-6 border-t dark:border-gray-700 flex justify-end items-center gap-3 bg-gray-50 dark:bg-gray-800/30"},ct=["disabled"],pt={__name:"ArtefactImportWizardModal",setup(K){const p=Z(),k=ee(),L=U(()=>k.modalData("artefactImportWizard")),Y=U(()=>{var o;return(o=L.value)==null?void 0:o.notebookId}),b=u("files"),V=u(!1),A=u(!1),$=u(""),h=u([]),v=u([]),a=u({urls:[],wikipedia_urls:[],youtube_configs:[],files:[],manual_title:"",manual_content:""}),R=[{code:"en",name:"English"},{code:"fr",name:"French"},{code:"es",name:"Spanish"},{code:"de",name:"German"},{code:"it",name:"Italian"},{code:"pt",name:"Portuguese"},{code:"zh",name:"Chinese"},{code:"ja",name:"Japanese"},{code:"ru",name:"Russian"}],y=u(""),w=u(""),_=u({url:"",lang:"en"}),F=u(null),P=()=>{y.value.trim()&&(a.value.urls.push(y.value.trim()),y.value="")},z=()=>{w.value.trim()&&(a.value.wikipedia_urls.push(w.value.trim()),w.value="")},E=()=>{_.value.url.trim()&&(a.value.youtube_configs.push({..._.value}),_.value.url="")},X=o=>{a.value.files.push(...Array.from(o.target.files)),o.target.value=""};async function N(){const o=$.value.trim();if(o){A.value=!0,h.value=[];try{const l=await p.searchArxiv(o);h.value=l.map(t=>({...t,selected:!1,ingest_full:!1}))}catch(l){console.error(l)}finally{A.value=!1}}}function j(o){o.selected=!o.selected,G()}function G(){v.value=h.value.filter(o=>o.selected).map(o=>({entry_id:o.entry_id,title:o.title,authors:o.authors,summary:o.summary,pdf_url:o.pdf_url,ingest_full:o.ingest_full}))}function J(o){return v.value.some(l=>l.entry_id===o)}const O=U(()=>a.value.urls.length>0||a.value.wikipedia_urls.length>0||a.value.youtube_configs.length>0||a.value.files.length>0||a.value.manual_title.trim()&&a.value.manual_content.trim()||v.value.length>0);async function Q(){if(Y.value){V.value=!0;try{(a.value.urls.length||a.value.wikipedia_urls.length||a.value.youtube_configs.length)&&await p.importSources({urls:a.value.urls,wikipedia_urls:a.value.wikipedia_urls,youtube_configs:a.value.youtube_configs});for(const o of a.value.files)await p.uploadSource(o,!0);a.value.manual_title&&a.value.manual_content&&await p.createManualArtefact(a.value.manual_title,a.value.manual_content),v.value.length>0&&await p.importSources({arxiv_selected:v.value}),k.addNotification("Knowledge import tasks started.","success"),k.closeModal("artefactImportWizard")}catch{k.addNotification("Import failed.","error")}finally{V.value=!1}}}const q=[{id:"files",label:"Documents",icon:le},{id:"web",label:"Links",icon:ce},{id:"wiki",label:"Wikipedia",icon:ae},{id:"youtube",label:"YouTube",icon:pe},{id:"arxiv",label:"Arxiv",icon:fe},{id:"manual",label:"Manual Text",icon:se}];return(o,l)=>(s(),I(de,{modalName:"artefactImportWizard",title:"Knowledge Import Wizard",maxWidthClass:"max-w-2xl"},{body:te(()=>[e("div",xe,[e("div",_e,[(s(),n(g,null,f(q,t=>e("button",{key:t.id,onClick:r=>b.value=t.id,class:M(["flex items-center gap-2 px-4 py-2 text-[10px] font-black uppercase tracking-widest transition-all rounded-lg",b.value===t.id?"bg-white dark:bg-gray-700 text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"])},[(s(),I(oe(t.icon),{class:"w-4 h-4"})),W(" "+i(t.label),1)],10,he)),64))]),e("div",me,[b.value==="files"?(s(),n("div",ke,[e("div",{onClick:l[0]||(l[0]=t=>F.value.click()),class:"border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-3xl p-12 text-center cursor-pointer hover:bg-blue-50 dark:hover:bg-blue-900/10 transition-all group"},[c(D,{class:"w-12 h-12 mx-auto text-gray-300 group-hover:text-blue-500 mb-4 transition-colors"}),l[9]||(l[9]=e("p",{class:"text-sm font-black uppercase tracking-tighter text-gray-500"},"Drop Documents Here",-1)),l[10]||(l[10]=e("p",{class:"text-[10px] text-gray-400 mt-1 uppercase tracking-widest"},"PDF, DOCX, PPTX, TXT, MD",-1)),e("input",{type:"file",ref_key:"fileInput",ref:F,onChange:X,multiple:"",class:"hidden"},null,544)]),e("div",ye,[(s(!0),n(g,null,f(a.value.files,(t,r)=>(s(),n("div",{key:r,class:"px-3 py-1.5 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-xl text-[10px] font-bold flex items-center gap-2 border border-purple-100 dark:border-purple-800"},[e("span",we,i(t.name),1),e("button",{onClick:C=>a.value.files.splice(r,1),class:"hover:text-red-500"},[c(S,{class:"w-3 h-3"})],8,Ce)]))),128))])])):d("",!0),b.value==="web"?(s(),n("div",Ie,[e("div",Se,[x(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>y.value=t),onKeyup:T(P,["enter"]),placeholder:"Enter link (https://...)",class:"input-field flex-grow"},null,544),[[m,y.value]]),e("button",{onClick:P,class:"btn btn-secondary"},[c(D,{class:"w-5 h-5"})])]),e("div",Ve,[(s(!0),n(g,null,f(a.value.urls,(t,r)=>(s(),n("div",{key:r,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-xl text-xs border dark:border-gray-700"},[e("span",Ae,i(t),1),e("button",{onClick:C=>a.value.urls.splice(r,1),class:"text-red-500 hover:scale-110 transition-transform"},[c(S,{class:"w-4 h-4"})],8,Me)]))),128))])])):d("",!0),b.value==="wiki"?(s(),n("div",De,[l[11]||(l[11]=e("div",{class:"p-4 bg-blue-50 dark:bg-blue-900/10 rounded-2xl border border-blue-100 dark:border-blue-900/30 text-[10px] text-blue-700 dark:text-blue-300 font-bold uppercase tracking-widest"}," Ground your notebook with full Wikipedia articles. ",-1)),e("div",$e,[x(e("input",{"onUpdate:modelValue":l[2]||(l[2]=t=>w.value=t),onKeyup:T(z,["enter"]),placeholder:"Article Title or Wiki URL...",class:"input-field flex-grow"},null,544),[[m,w.value]]),e("button",{onClick:z,class:"btn btn-secondary"},[c(D,{class:"w-5 h-5"})])]),e("div",Ue,[(s(!0),n(g,null,f(a.value.wikipedia_urls,(t,r)=>(s(),n("div",{key:r,class:"flex items-center justify-between p-3 bg-gray-100 dark:bg-gray-850 rounded-xl text-xs border-l-4 border-gray-400"},[e("span",We,i(t),1),e("button",{onClick:C=>a.value.wikipedia_urls.splice(r,1),class:"text-red-500 hover:scale-110"},[c(S,{class:"w-4 h-4"})],8,Te)]))),128))])])):d("",!0),b.value==="youtube"?(s(),n("div",Fe,[e("div",Pe,[x(e("input",{"onUpdate:modelValue":l[3]||(l[3]=t=>_.value.url=t),placeholder:"YouTube Video URL...",class:"input-field flex-grow"},null,512),[[m,_.value.url]]),x(e("select",{"onUpdate:modelValue":l[4]||(l[4]=t=>_.value.lang=t),class:"input-field w-32"},[(s(),n(g,null,f(R,t=>e("option",{key:t.code,value:t.code},i(t.name),9,ze)),64))],512),[[ne,_.value.lang]]),e("button",{onClick:E,class:"btn btn-secondary"},[c(D,{class:"w-5 h-5"})])]),e("div",Ne,[(s(!0),n(g,null,f(a.value.youtube_configs,(t,r)=>(s(),n("div",{key:r,class:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/10 rounded-xl text-xs border-l-4 border-red-500"},[e("span",je,i(t.url),1),e("div",He,[e("span",Be,i(t.lang),1),e("button",{onClick:C=>a.value.youtube_configs.splice(r,1),class:"text-red-500 hover:scale-110"},[c(S,{class:"w-4 h-4"})],8,Ke)])]))),128))])])):d("",!0),b.value==="arxiv"?(s(),n("div",Le,[l[12]||(l[12]=e("div",{class:"p-4 bg-orange-50 dark:bg-orange-900/10 rounded-2xl border border-orange-100 dark:border-orange-900/30 text-[10px] text-orange-700 dark:text-orange-300 font-bold uppercase tracking-widest"}," Search and import research papers from Arxiv. ",-1)),e("div",Ye,[x(e("input",{"onUpdate:modelValue":l[5]||(l[5]=t=>$.value=t),onKeyup:T(N,["enter"]),placeholder:"Search Arxiv (e.g. 'transformer attention')...",class:"input-field flex-grow"},null,544),[[m,$.value]]),e("button",{onClick:N,class:"btn btn-secondary",disabled:A.value},[A.value?(s(),I(H,{key:0,class:"w-4 h-4 animate-spin"})):(s(),I(re,{key:1,class:"w-4 h-4"}))],8,Re)]),h.value.length>0?(s(),n("div",Ee,[(s(!0),n(g,null,f(h.value,t=>(s(),n("div",{key:t.entry_id,class:"p-3 bg-white dark:bg-gray-700 rounded-lg text-xs shadow-sm border border-transparent hover:border-blue-300 transition-colors"},[e("div",Xe,[e("div",Ge,[e("input",{type:"checkbox",checked:J(t.entry_id),onChange:r=>j(t),class:"mt-1 rounded text-blue-600 focus:ring-blue-500"},null,40,Je),e("div",null,[e("p",Oe,i(t.title),1),e("p",Qe,i(t.authors.slice(0,2).join(", "))+i(t.authors.length>2?" et al.":"")+" • "+i(t.published),1)])])]),e("div",qe,[e("label",Ze,[e("div",et,[x(e("input",{type:"checkbox","onUpdate:modelValue":r=>t.ingest_full=r,class:M(["toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 appearance-none cursor-pointer",t.ingest_full?"right-0 border-blue-600":"left-0 border-gray-300"])},null,10,tt),[[ie,t.ingest_full]]),e("div",{class:M(["toggle-label block overflow-hidden h-4 rounded-full cursor-pointer bg-gray-300",t.ingest_full?"bg-blue-600":""])},null,2)]),e("span",{class:M(["text-[10px] font-bold uppercase",t.ingest_full?"text-blue-600":"text-gray-400"])},i(t.ingest_full?"Full PDF":"Abstract"),3)]),e("a",{href:t.pdf_url,target:"_blank",class:"text-blue-500 hover:underline text-[10px]"},"View PDF ↗",8,lt)])]))),128))])):d("",!0),v.value.length>0?(s(),n("div",at,[e("p",st,"Selected Papers ("+i(v.value.length)+")",1),e("ul",ot,[(s(!0),n(g,null,f(v.value,t=>(s(),n("li",{key:t.entry_id,class:"flex justify-between items-center text-xs bg-blue-50 dark:bg-blue-900/20 px-2 py-1.5 rounded"},[e("span",nt,[W(i(t.title)+" ",1),t.ingest_full?(s(),n("span",rt,"PDF")):d("",!0)]),e("button",{onClick:r=>j(h.value.find(C=>C.entry_id===t.entry_id)),class:"text-red-500 hover:text-red-700"},[c(S,{class:"w-3 h-3"})],8,it)]))),128))])])):d("",!0)])):d("",!0),b.value==="manual"?(s(),n("div",ut,[x(e("input",{"onUpdate:modelValue":l[6]||(l[6]=t=>a.value.manual_title=t),placeholder:"Artefact Title (e.g. Brainstorming Notes)",class:"input-field font-bold"},null,512),[[m,a.value.manual_title]]),x(e("textarea",{"onUpdate:modelValue":l[7]||(l[7]=t=>a.value.manual_content=t),placeholder:"Paste or type content here...",class:"flex-grow input-field text-sm leading-relaxed min-h-[200px] resize-none"},null,512),[[m,a.value.manual_content]])])):d("",!0)]),e("div",dt,[e("button",{onClick:l[8]||(l[8]=t=>ue(k).closeModal("artefactImportWizard")),class:"btn btn-secondary px-6"},"Cancel"),e("button",{onClick:Q,disabled:!O.value||V.value,class:"btn btn-primary px-10 relative shadow-lg shadow-blue-500/20 font-black uppercase text-xs tracking-widest"},[V.value?(s(),I(H,{key:0,class:"w-4 h-4 mr-2 animate-spin"})):d("",!0),l[13]||(l[13]=W(" Start Ingestion "))],8,ct)])])]),_:1}))}},xt=B(pt,[["__scopeId","data-v-5af828e2"]]);export{xt as default};
