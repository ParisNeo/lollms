import{u as _,aS as C,b as d,r as c,S as k,f as M,o as n,w as b,a as t,A as U,t as y,p as h,c as p,h as S,J as v,aC as g,n as D,K as N,F as V,j as B,L as I}from"./index-C3WkowhT.js";import{_ as L}from"./GenericModal-CcN9sQBb.js";const j={class:"space-y-2"},q={class:"flex items-center gap-4"},E={class:"flex items-center"},F={class:"flex items-center"},$=["disabled"],z={key:0},J={key:1},K=["value"],O={class:"flex justify-end gap-3"},P=["disabled"],G={__name:"ContextToArtefactModal",setup(R){const o=_(),A=C(),f=d(()=>o.modalData("contextToArtefact")),T=d(()=>{var l;return(l=f.value)==null?void 0:l.discussionId}),m=d(()=>{var l;return((l=f.value)==null?void 0:l.artefacts)||[]}),s=c("new"),i=c(""),r=c(null),u=c(!1);k(f,l=>{l&&o.isModalOpen("contextToArtefact")&&(s.value="new",i.value="",r.value=null)},{immediate:!0});const w=d(()=>s.value==="new"?i.value.trim():r.value);async function x(){if(!w.value){o.addNotification("Please provide a name for the new artefact or select one to update.","warning");return}u.value=!0;try{await A.exportContextAsArtefact({discussionId:T.value,title:w.value}),o.closeModal("contextToArtefact")}finally{u.value=!1}}return(l,e)=>(n(),M(L,{"modal-name":"contextToArtefact",title:"Save Context as Artefact","max-width-class":"max-w-lg"},{body:b(()=>[t("form",{onSubmit:h(x,["prevent"]),class:"space-y-6"},[e[9]||(e[9]=t("p",{class:"text-sm text-gray-600 dark:text-gray-300"},' This will save the current content of the "Discussion Data Zone" as a new artefact. You can create a new artefact or update an existing one, which will create a new version. ',-1)),t("div",j,[t("div",q,[t("label",E,[v(t("input",{type:"radio","onUpdate:modelValue":e[0]||(e[0]=a=>s.value=a),value:"new",class:"radio-input"},null,512),[[g,s.value]]),e[5]||(e[5]=t("span",{class:"ml-2"},"Create New Artefact",-1))]),t("label",F,[v(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),value:"update",class:"radio-input",disabled:m.value.length===0},null,8,$),[[g,s.value]]),t("span",{class:D(["ml-2",{"opacity-50":m.value.length===0}])},"Update Existing",2)])])]),s.value==="new"?(n(),p("div",z,[e[6]||(e[6]=t("label",{for:"new-artefact-title",class:"label"},"New Artefact Name",-1)),v(t("input",{id:"new-artefact-title","onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a),type:"text",class:"input-field mt-1",required:""},null,512),[[N,i.value]])])):S("",!0),s.value==="update"?(n(),p("div",J,[e[8]||(e[8]=t("label",{for:"update-artefact-title",class:"label"},"Select Artefact to Update",-1)),v(t("select",{id:"update-artefact-title","onUpdate:modelValue":e[3]||(e[3]=a=>r.value=a),class:"input-field mt-1",required:""},[e[7]||(e[7]=t("option",{value:null,disabled:""},"Select an artefact...",-1)),(n(!0),p(V,null,B(m.value,a=>(n(),p("option",{key:a.title,value:a.title},y(a.title),9,K))),128))],512),[[I,r.value]])])):S("",!0)],32)]),footer:b(()=>[t("div",O,[t("button",{onClick:e[4]||(e[4]=a=>U(o).closeModal("contextToArtefact")),type:"button",class:"btn btn-secondary"},"Cancel"),t("button",{onClick:x,type:"button",class:"btn btn-primary",disabled:u.value||!w.value},y(u.value?"Saving...":"Save Artefact"),9,P)])]),_:1}))}};export{G as default};
