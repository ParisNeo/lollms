import{r as o,a as R,o as V,g as i,d as n,h as T,f as e,t as d,i as y,v as _,C as $,j as D,A as m,k as h,p as x,J as E,ag as M,F as U,B as j,K as B,V as I,q as f}from"./index-Dja0BxAz.js";import{useAdminStore as L}from"./admin-DrWr55jq.js";const q={class:"space-y-6"},z={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},J={class:"text-xl font-semibold mb-4"},K={class:"flex items-center"},P={class:"flex justify-end gap-2"},G={type:"submit",class:"btn btn-primary"},H={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},O={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center"},Q={class:"flex items-center gap-2"},W=["disabled"],X={key:0,class:"p-6 text-center text-gray-500"},Y={key:1,class:"p-6 text-center text-gray-500"},Z={key:2,class:"divide-y dark:divide-gray-700"},ee={class:"font-semibold"},te={class:"text-sm text-gray-500 font-mono"},se={class:"flex gap-2 flex-shrink-0"},ae=["onClick"],le=["onClick"],de={__name:"RssManagement",setup(ie){const p=o([]),b=o(!1),r=o(!1),c=o(!1),a=o({id:null,name:"",url:"",is_active:!0}),v=R(),k=L(),u=o(!1);async function g(){b.value=!0;try{const l=await f.get("/api/admin/rss-feeds");p.value=l.data}catch{v.addNotification("Failed to load RSS feeds.","error")}finally{b.value=!1}}function w(){c.value=!1,a.value={id:null,name:"",url:"",is_active:!0},r.value=!0}function S(l){c.value=!0,a.value={...l},r.value=!0}async function C(){try{c.value?(await f.put(`/api/admin/rss-feeds/${a.value.id}`,a.value),v.addNotification("Feed updated.","success")):(await f.post("/api/admin/rss-feeds",a.value),v.addNotification("Feed added.","success")),await g(),r.value=!1}catch{}}async function F(l){(await v.showConfirmation({title:`Delete Feed '${l.name}'?`,message:"This will also delete all news articles from this source. This action cannot be undone.",confirmText:"Delete"})).confirmed&&(await f.delete(`/api/admin/rss-feeds/${l.id}`),await g())}async function N(){u.value=!0;try{await k.triggerRssScraping()}finally{u.value=!1}}return V(g),(l,t)=>(n(),i("div",q,[r.value?(n(),i("div",z,[e("h3",J,d(c.value?"Edit RSS Feed":"Add New RSS Feed"),1),e("form",{onSubmit:D(C,["prevent"]),class:"space-y-4"},[e("div",null,[t[4]||(t[4]=e("label",{class:"label"},"Name",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.name=s),type:"text",class:"input-field",required:"",placeholder:"e.g., Tech News"},null,512),[[_,a.value.name]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"label"},"URL",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.url=s),type:"url",class:"input-field",required:"",placeholder:"https://example.com/rss.xml"},null,512),[[_,a.value.url]])]),e("div",K,[y(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.is_active=s),type:"checkbox",id:"is_active_checkbox",class:"h-4 w-4 rounded"},null,512),[[$,a.value.is_active]]),t[6]||(t[6]=e("label",{for:"is_active_checkbox",class:"ml-2"},"Active",-1))]),e("div",P,[e("button",{type:"button",onClick:t[3]||(t[3]=s=>r.value=!1),class:"btn btn-secondary"},"Cancel"),e("button",G,d(c.value?"Save Changes":"Add Feed"),1)])],32)])):T("",!0),e("div",H,[e("div",O,[t[8]||(t[8]=e("h3",{class:"text-xl font-semibold"},"RSS Feed Sources",-1)),e("div",Q,[e("button",{onClick:N,class:"btn btn-secondary btn-sm",disabled:u.value},[m(E,{class:x(["w-4 h-4 mr-1",{"animate-spin":u.value}])},null,8,["class"]),h(" "+d(u.value?"Scraping...":"Scrape Now"),1)],8,W),e("button",{onClick:w,class:"btn btn-primary btn-sm"},[m(M,{class:"w-4 h-4 mr-1"}),t[7]||(t[7]=h("Add Feed"))])])]),b.value?(n(),i("div",X,"Loading feeds...")):p.value.length===0?(n(),i("div",Y,"No RSS feeds configured. Add one to get started.")):(n(),i("ul",Z,[(n(!0),i(U,null,j(p.value,s=>(n(),i("li",{key:s.id,class:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("div",null,[e("p",ee,[h(d(s.name)+" ",1),e("span",{class:x(["text-xs px-2 py-0.5 rounded-full ml-2",s.is_active?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":"bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-300"])},d(s.is_active?"Active":"Inactive"),3)]),e("p",te,d(s.url),1)]),e("div",se,[e("button",{onClick:A=>S(s),class:"btn-icon",title:"Edit"},[m(B,{class:"w-4 h-4"})],8,ae),e("button",{onClick:A=>F(s),class:"btn-icon-danger",title:"Delete"},[m(I,{class:"w-4 h-4"})],8,le)])]))),128))]))])]))}};export{de as default};
