import{u as l}from"./admin-BRuvzi00.js";import{u as g,N as m,e as u,o as f,b as t,f as s,at as y,h as r,t as p,cu as x}from"./index-Cg5UBQvj.js";import{I as o}from"./IconShieldCheck-DxZ7Mz78.js";const b={class:"space-y-6 animate-fade-in-up"},h={class:"flex items-center gap-3 mb-6"},_={class:"p-3 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg text-indigo-600 dark:text-indigo-400"},k={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},v={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},w={class:"p-6"},S={class:"flex items-start justify-between"},z={class:"flex items-center gap-3"},C={class:"mt-6"},R=["disabled"],T={class:"bg-gray-50 dark:bg-gray-700/50 px-6 py-3 border-t border-gray-200 dark:border-gray-700"},N={class:"text-xs text-gray-500 flex items-center gap-1"},D={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-dashed border-gray-300 dark:border-gray-600 flex flex-col items-center justify-center p-8 opacity-60"},V={__name:"SecurityTools",setup(M){const n=l(),i=g(),a=m(!1);async function d(){if((await i.showConfirmation({title:"Run Content Sanitization?",message:"This will scan all existing posts, comments, and messages in the database and strip out potentially malicious scripts. This operation might take a while.",confirmText:"Run Scan",isDanger:!1})).confirmed){a.value=!0;try{await n.sanitizeDatabase(),i.addNotification("Sanitization task started. Check Task Manager.","info")}catch(e){console.error(e),i.addNotification("Failed to start sanitization.","error")}finally{a.value=!1}}}return(c,e)=>(f(),u("div",b,[t("div",h,[t("div",_,[s(o,{class:"w-8 h-8"})]),e[0]||(e[0]=t("div",null,[t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Security & Maintenance"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Manage application security and data integrity.")],-1))]),t("div",k,[t("div",v,[t("div",w,[t("div",S,[t("div",z,[s(y,{class:"w-6 h-6 text-green-500"}),e[1]||(e[1]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Database Sanitization",-1))])]),e[2]||(e[2]=t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"}," Scan existing database content (Posts, Comments, DMs) to retroactively remove XSS scripts and malicious tags. Run this after updates to security policies. ",-1)),t("div",C,[t("button",{onClick:d,disabled:a.value,class:"w-full btn btn-primary flex items-center justify-center gap-2"},[s(o,{class:"w-5 h-5"}),r(" "+p(a.value?"Starting Task...":"Run Content Sanitizer"),1)],8,R)])]),t("div",T,[t("span",N,[s(x,{class:"w-3 h-3"}),e[3]||(e[3]=r(" Recommended: Run periodically or after major updates. "))])])]),t("div",D,[s(o,{class:"w-10 h-10 text-gray-300 dark:text-gray-600 mb-2"}),e[4]||(e[4]=t("p",{class:"text-sm font-medium text-gray-500"},"More security tools coming soon.",-1))])])]))}};export{V as default};
