const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["ui_assets/BindingModelsManager-k7laURU7.js","ui_assets/index-7OJ7XwkZ.js","ui_assets/index-CK-0lP38.css","ui_assets/admin-v36a84Dn.js","ui_assets/BindingZoo-DNr6S_90.js"])))=>i.map(i=>d[i]);
import{K as ne,Q as se,s as u,c as M,w as U,o as ae,d as o,l,e as t,h as v,t as r,p as m,z as A,m as B,L as z,R as I,F as k,i as w,j as C,J as le,n as V,c8 as ie,c9 as oe,an as re,H as j,f as N,A as L,cc as de,D as q}from"./index-7OJ7XwkZ.js";import{u as ue}from"./admin-v36a84Dn.js";const ce={class:"space-y-8"},ve={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},me={class:"flex justify-between items-center mb-4"},ge={class:"text-xl font-semibold"},fe={key:0,class:"flex gap-2 text-sm font-medium"},ye={key:0},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe=["disabled"],_e=["value"],xe={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},he={class:"text-sm text-gray-600 dark:text-gray-400"},ke=["for"],we={key:0,class:"text-red-500"},Ce=["id","onUpdate:modelValue"],Se=["value"],Te={key:1},Ae={class:"relative"},Be=["type","id","onUpdate:modelValue","required","placeholder"],$e=["onClick","title"],De={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Me={class:"flex-grow flex flex-col pr-4"},Ve={class:"text-sm text-gray-500 dark:text-gray-400"},je=["onClick"],Ne={class:"text-xs text-gray-500 mt-1"},Ee={key:1,class:"mt-6 border-t dark:border-gray-700 pt-6"},Fe={class:"grid grid-cols-1 gap-4"},Oe={class:"flex justify-between items-start mb-3"},Ue={class:"font-bold text-md"},ze={class:"text-sm text-gray-600 dark:text-gray-400"},Ie={key:0,class:"space-y-3 mb-4"},Le={class:"block text-xs font-medium uppercase text-gray-500 dark:text-gray-400 mb-1"},qe=["onUpdate:modelValue","placeholder"],Pe={key:1,class:"flex items-center gap-2"},Re=["onClick"],Je={class:"text-sm"},Ge={class:"flex justify-end"},He=["onClick"],Ke={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Ze={class:"flex justify-end gap-3"},Qe=["disabled"],We={key:1},Xe={key:2},Ye={key:1},et={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},tt={class:"flex items-center gap-4"},nt=["value"],st={key:0,class:"text-center p-6"},at={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},lt={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},it=["onClick"],ot=["onClick","title"],rt={class:"flex-grow"},dt={class:"flex items-center gap-3 mb-2"},ut={class:"font-bold text-lg text-gray-900 dark:text-white"},ct={class:"text-xs text-gray-500 dark:text-gray-400"},vt={class:"mt-3 text-sm text-gray-600 dark:text-gray-300"},mt={key:0,class:"mb-1"},gt={class:"text-xs text-gray-400 truncate"},ft={class:"border-t dark:border-gray-700 pt-3 flex justify-between items-center text-xs text-gray-500"},yt=["onClick"],xt={__name:"STTBindingsSettings",setup(bt){const P=L(()=>q(()=>import("./BindingModelsManager-k7laURU7.js"),__vite__mapDeps([0,1,2,3]))),R=L(()=>q(()=>import("./BindingZoo-DNr6S_90.js"),__vite__mapDeps([4,1,2,3]))),g=ue(),S=ne(),{sttBindings:E,availableSttBindingTypes:y,isLoadingSttBindings:J,globalSettings:G}=se(g),h=u(!1),b=u(null),T=u(!1),_=u({}),D=u("mixed"),f=u({}),d=u("settings");u(!1),u(null),u([]),u(null),u({}),u(!1);const F=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),i=u(F()),x=M(()=>b.value!==null),p=M(()=>!i.value.name||!Array.isArray(y.value)?null:y.value.find(a=>a.binding_name===i.value.name)),H=M(()=>{if(!p.value)return[];const a=p.value.input_parameters||[],n=new Set(a.map(s=>s.name)),e=Object.keys(i.value.config||{}).filter(s=>!n.has(s)&&s!=="model_name").map(s=>({name:s,type:typeof i.value.config[s]=="boolean"?"bool":typeof i.value.config[s]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...a.filter(s=>s.name!=="model_name"),...e]});U(G,a=>{if(Array.isArray(a)){const n=a.find(e=>e.key==="stt_model_display_mode");n&&(D.value=n.value)}},{deep:!0,immediate:!0});function K(a){const n=a.target.value;D.value=n,g.updateGlobalSettings({stt_model_display_mode:n})}U(()=>i.value.name,(a,n)=>{if(a!==n&&!x.value){if(!Array.isArray(y.value))return;const e=y.value.find(c=>c.binding_name===a),s={};e&&e.input_parameters&&e.input_parameters.forEach(c=>{s[c.name]=c.default}),i.value.config=s}}),ae(()=>{g.fetchSttBindings(),g.fetchAvailableSttBindingTypes(),g.fetchGlobalSettings()});function O(){b.value=null,i.value=F(),_.value={},f.value={},h.value=!0,d.value="settings",window.scrollTo({top:0,behavior:"smooth"})}function Z(a){b.value=a,i.value=JSON.parse(JSON.stringify(a)),i.value.config||(i.value.config={}),_.value={};const n=y.value.find(e=>e.binding_name===a.name);if(n&&n.commands){const e={};n.commands.forEach(s=>{e[s.name]={},s.parameters&&s.parameters.forEach(c=>{e[s.name][c.name]=c.default!==void 0?c.default:""})}),f.value=e}else f.value={};h.value=!0,d.value="settings",window.scrollTo({top:0,behavior:"smooth"})}function $(){h.value=!1,b.value=null}function Q(a){return typeof a=="string"?a.split(",").map(n=>n.trim()).filter(n=>n):Array.isArray(a)?a.filter(n=>n):[]}async function W(){if(!i.value.alias.trim()||!i.value.name){S.addNotification("Alias and Binding Type are required fields.","warning");return}T.value=!0;try{const a={alias:i.value.alias,name:i.value.name,config:i.value.config||{},is_active:i.value.is_active,default_model_name:i.value.default_model_name||null};x.value?await g.updateSttBinding(b.value.id,a):await g.addSttBinding(a),$()}catch(a){console.error("Submit failed:",a.message)}finally{T.value=!1}}async function X(a){await S.showConfirmation({title:`Delete STT Binding '${a.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await g.deleteSttBinding(a.id)}async function Y(a){await g.updateSttBinding(a.id,{is_active:!a.is_active})}function ee(a){if(!Array.isArray(y.value))return a;const n=y.value.find(e=>e.binding_name===a);return n?n.title:a}async function te(a,n,e){try{S.addNotification(`Submitting command '${a.title||a.name}'...`,"info");const s=await g.executeSttBindingCommand(n,a.name,e);if(s)return S.addNotification(`Task started: ${a.title||a.name}. Check Task Manager for progress.`,"success",5e3),s}catch(s){console.error(s),S.addNotification(`Command submission failed: ${s.message}`,"error")}}return(a,n)=>(l(),o("div",ce,[h.value?(l(),o("div",ve,[t("div",me,[t("h3",ge,r(x.value?"Edit STT Binding: "+i.value.alias:"Add New STT Binding"),1),x.value?(l(),o("div",fe,[t("button",{onClick:n[0]||(n[0]=e=>d.value="settings"),class:m([{"text-blue-600 border-b-2 border-blue-600":d.value==="settings","text-gray-500 hover:text-gray-700":d.value!=="settings"},"px-3 py-2"])},"Settings",2),t("button",{onClick:n[1]||(n[1]=e=>d.value="zoo"),class:m([{"text-blue-600 border-b-2 border-blue-600":d.value==="zoo","text-gray-500 hover:text-gray-700":d.value!=="zoo"},"px-3 py-2"])},"Models Zoo",2),t("button",{onClick:n[2]||(n[2]=e=>d.value="models"),class:m([{"text-blue-600 border-b-2 border-blue-600":d.value==="models","text-gray-500 hover:text-gray-700":d.value!=="models"},"px-3 py-2"])},"Installed Models",2)])):v("",!0)]),d.value==="settings"?(l(),o("div",ye,[t("form",{onSubmit:j(W,["prevent"]),class:"space-y-6"},[t("div",be,[t("div",null,[n[7]||(n[7]=t("label",{for:"alias",class:"block text-sm font-medium"},[B("Alias "),t("span",{class:"text-red-500"},"*")],-1)),A(t("input",{type:"text",id:"alias","onUpdate:modelValue":n[3]||(n[3]=e=>i.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_whisper",autocomplete:"off"},null,512),[[z,i.value.alias]]),n[8]||(n[8]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[n[10]||(n[10]=t("label",{for:"name",class:"block text-sm font-medium"},[B("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),A(t("select",{id:"name","onUpdate:modelValue":n[4]||(n[4]=e=>i.value.name=e),class:"input-field mt-1",required:"",disabled:x.value},[n[9]||(n[9]=t("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),o(k,null,w(C(y),e=>(l(),o("option",{key:e.binding_name,value:e.binding_name},r(e.title),9,_e))),128))],8,pe),[[I,i.value.name]])])]),p.value?(l(),o("div",xe,[t("p",he,r(p.value.description),1),(l(!0),o(k,null,w(H.value,e=>(l(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[B(r(e.name.replace(/_/g," "))+" ",1),e.mandatory?(l(),o("span",we,"*")):v("",!0)],8,ke),e.options&&e.options.length>0?A((l(),o("select",{key:0,id:`param-${e.name}`,"onUpdate:modelValue":s=>i.value.config[e.name]=s,class:"input-field"},[(l(!0),o(k,null,w(Q(e.options),s=>(l(),o("option",{key:s,value:s},r(s),9,Se))),128))],8,Ce)),[[I,i.value.config[e.name]]]):["str","int","float"].includes(e.type)?(l(),o("div",Te,[t("div",Ae,[A(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!_.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":s=>i.value.config[e.name]=s,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,Be),[[le,i.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(l(),o("button",{key:0,type:"button",onClick:s=>_.value[e.name]=!_.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:_.value[e.name]?"Hide":"Show"},[_.value[e.name]?(l(),V(ie,{key:0,class:"w-5 h-5"})):(l(),V(oe,{key:1,class:"w-5 h-5"}))],8,$e)):v("",!0)])])):e.type==="bool"?(l(),o("div",De,[t("span",Me,[t("span",Ve,r(e.description),1)]),t("button",{onClick:s=>i.value.config[e.name]=!i.value.config[e.name],type:"button",class:m([i.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:m([i.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,je)])):v("",!0),t("p",Ne,r(e.description),1)]))),128))])):v("",!0),x.value&&p.value&&p.value.commands&&p.value.commands.length>0?(l(),o("div",Ee,[n[11]||(n[11]=t("h4",{class:"text-lg font-semibold mb-4"},"Binding Commands",-1)),t("div",Fe,[(l(!0),o(k,null,w(p.value.commands,e=>(l(),o("div",{key:e.name,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600"},[t("div",Oe,[t("div",null,[t("h5",Ue,r(e.title||e.name),1),t("p",ze,r(e.description),1)])]),e.parameters&&e.parameters.length>0?(l(),o("div",Ie,[(l(!0),o(k,null,w(e.parameters,s=>(l(),o("div",{key:s.name},[t("label",Le,r(s.name),1),s.type!=="bool"?A((l(),o("input",{key:0,type:"text","onUpdate:modelValue":c=>f.value[e.name][s.name]=c,class:"input-field text-sm",placeholder:s.default},null,8,qe)),[[z,f.value[e.name][s.name]]]):(l(),o("div",Pe,[t("button",{onClick:c=>f.value[e.name][s.name]=!f.value[e.name][s.name],type:"button",class:m([f.value[e.name][s.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:m([f.value[e.name][s.name]?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,Re),t("span",Je,r(s.description),1)]))]))),128))])):v("",!0),t("div",Ge,[t("button",{type:"button",onClick:s=>te(e,b.value.id,f.value[e.name]),class:"btn btn-primary btn-sm"},"Execute",8,He)])]))),128))])])):v("",!0),t("div",Ke,[n[12]||(n[12]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this STT service will not be available.")],-1)),t("button",{onClick:n[5]||(n[5]=e=>i.value.is_active=!i.value.is_active),type:"button",class:m([i.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:m([i.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",Ze,[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:T.value},[T.value?(l(),V(re,{key:0,class:"w-5 h-5 mr-2"})):v("",!0),B(" "+r(T.value?"Saving...":x.value?"Save Changes":"Add Binding"),1)],8,Qe)])],32)])):d.value==="zoo"?(l(),o("div",We,[N(C(R),{binding:b.value,"binding-type":"stt"},null,8,["binding"]),t("div",{class:"flex justify-end gap-3 mt-4"},[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Close")])])):d.value==="models"?(l(),o("div",Xe,[N(C(P),{binding:b.value,"binding-type":"stt"},null,8,["binding"]),t("div",{class:"flex justify-end gap-3 mt-4"},[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Close")])])):v("",!0)])):(l(),o("div",Ye,[t("div",et,[n[15]||(n[15]=t("h2",{class:"text-2xl font-bold"},"STT Bindings",-1)),t("div",tt,[t("div",null,[n[14]||(n[14]=t("label",{for:"stt-model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),t("select",{id:"stt-model-display-mode",value:D.value,onChange:K,class:"input-field mt-1"},n[13]||(n[13]=[t("option",{value:"mixed"},"Mixed (Alias or Original)",-1),t("option",{value:"aliased"},"Aliased Only",-1),t("option",{value:"original"},"Original Names Only",-1)]),40,nt)]),h.value?v("",!0):(l(),o("button",{key:0,onClick:O,class:"btn btn-primary self-end"},"+ Add New STT Binding"))])]),C(J)?(l(),o("div",st,"Loading STT bindings...")):C(E).length===0&&!h.value?(l(),o("div",at,[n[16]||(n[16]=t("p",null,"No STT bindings configured yet.",-1)),t("button",{onClick:O,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(l(),o("div",lt,[(l(!0),o(k,null,w(C(E),e=>(l(),o("div",{key:e.id,onClick:s=>Z(e),class:"bg-white dark:bg-gray-800 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer flex flex-col gap-4 border border-transparent hover:border-blue-500 group relative"},[t("div",{class:"absolute top-4 right-4 z-10",onClick:n[6]||(n[6]=j(()=>{},["stop"]))},[t("button",{onClick:s=>Y(e),type:"button",class:m([e.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"]),title:e.is_active?"Deactivate":"Activate"},[t("span",{class:m([e.is_active?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],10,ot)]),t("div",rt,[t("div",dt,[N(de,{class:"w-8 h-8 text-blue-500"}),t("div",null,[t("h4",ut,r(e.alias),1),t("p",ct,r(ee(e.name)),1)])]),t("div",vt,[e.default_model_name?(l(),o("p",mt,[n[17]||(n[17]=t("span",{class:"font-semibold"},"Default:",-1)),B(" "+r(e.default_model_name),1)])):v("",!0),t("p",gt,r(e.config?Object.keys(e.config).filter(s=>!s.includes("key")).join(", "):""),1)])]),t("div",ft,[n[18]||(n[18]=t("span",null,"Click to edit",-1)),t("button",{onClick:j(s=>X(e),["stop"]),class:"text-red-500 hover:underline p-1"},"Delete",8,yt)])],8,it))),128))]))]))]))}};export{xt as default};
