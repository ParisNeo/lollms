import{q as ne,d as p,l as v,e as n,aw as ut,V as dt,K as ct,u as vt,s as o,c as he,o as pt,ac as gt,N as mt,k as ht,E as ft,f as g,P as bt,F as T,i as ae,h as Le,z as y,Q as A,t as w,p as B,m as fe,d4 as wt,cR as xt,a5 as Re,B as Se,d9 as yt,y as kt,cU as Ct,aq as Mt,ar as $e,X as _t,ao as It,n as Lt,C as Rt,a1 as St,cn as d,d5 as $t,cT as Tt}from"./index-BT_1XIF6.js";import{I as At,a as Vt}from"./IconRedo-C78tabfP.js";const Et={},Pt={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function Ft(X,x){return v(),p("svg",Pt,x[0]||(x[0]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"},null,-1)]))}const Bt=ne(Et,[["render",Ft]]),Ut={},Zt={width:"50px",height:"50px",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};function zt(X,x){return v(),p("svg",Zt,x[0]||(x[0]=[n("path",{d:"M5.50506 11.4096L6.03539 11.9399L5.50506 11.4096ZM3 14.9522H2.25H3ZM12.5904 18.4949L12.0601 17.9646L12.5904 18.4949ZM9.04776 21V21.75V21ZM11.4096 5.50506L10.8792 4.97473L11.4096 5.50506ZM13.241 17.8444C13.5339 18.1373 14.0088 18.1373 14.3017 17.8444C14.5946 17.5515 14.5946 17.0766 14.3017 16.7837L13.241 17.8444ZM7.21629 9.69832C6.9234 9.40543 6.44852 9.40543 6.15563 9.69832C5.86274 9.99122 5.86274 10.4661 6.15563 10.759L7.21629 9.69832ZM16.073 16.073C16.3659 15.7801 16.3659 15.3053 16.073 15.0124C15.7801 14.7195 15.3053 14.7195 15.0124 15.0124L16.073 16.073ZM18.4676 11.5559C18.1759 11.8499 18.1777 12.3248 18.4718 12.6165C18.7658 12.9083 19.2407 12.9064 19.5324 12.6124L18.4676 11.5559ZM6.03539 11.9399L11.9399 6.03539L10.8792 4.97473L4.97473 10.8792L6.03539 11.9399ZM6.03539 17.9646C5.18538 17.1146 4.60235 16.5293 4.22253 16.0315C3.85592 15.551 3.75 15.2411 3.75 14.9522H2.25C2.25 15.701 2.56159 16.3274 3.03 16.9414C3.48521 17.538 4.1547 18.2052 4.97473 19.0253L6.03539 17.9646ZM4.97473 10.8792C4.1547 11.6993 3.48521 12.3665 3.03 12.9631C2.56159 13.577 2.25 14.2035 2.25 14.9522H3.75C3.75 14.6633 3.85592 14.3535 4.22253 13.873C4.60235 13.3752 5.18538 12.7899 6.03539 11.9399L4.97473 10.8792ZM12.0601 17.9646C11.2101 18.8146 10.6248 19.3977 10.127 19.7775C9.64651 20.1441 9.33665 20.25 9.04776 20.25V21.75C9.79649 21.75 10.423 21.4384 11.0369 20.97C11.6335 20.5148 12.3008 19.8453 13.1208 19.0253L12.0601 17.9646ZM4.97473 19.0253C5.79476 19.8453 6.46201 20.5148 7.05863 20.97C7.67256 21.4384 8.29902 21.75 9.04776 21.75V20.25C8.75886 20.25 8.449 20.1441 7.9685 19.7775C7.47069 19.3977 6.88541 18.8146 6.03539 17.9646L4.97473 19.0253ZM17.9646 6.03539C18.8146 6.88541 19.3977 7.47069 19.7775 7.9685C20.1441 8.449 20.25 8.75886 20.25 9.04776H21.75C21.75 8.29902 21.4384 7.67256 20.97 7.05863C20.5148 6.46201 19.8453 5.79476 19.0253 4.97473L17.9646 6.03539ZM19.0253 4.97473C18.2052 4.1547 17.538 3.48521 16.9414 3.03C16.3274 2.56159 15.701 2.25 14.9522 2.25V3.75C15.2411 3.75 15.551 3.85592 16.0315 4.22253C16.5293 4.60235 17.1146 5.18538 17.9646 6.03539L19.0253 4.97473ZM11.9399 6.03539C12.7899 5.18538 13.3752 4.60235 13.873 4.22253C14.3535 3.85592 14.6633 3.75 14.9522 3.75V2.25C14.2035 2.25 13.577 2.56159 12.9631 3.03C12.3665 3.48521 11.6993 4.1547 10.8792 4.97473L11.9399 6.03539ZM14.3017 16.7837L7.21629 9.69832L6.15563 10.759L13.241 17.8444L14.3017 16.7837ZM15.0124 15.0124L12.0601 17.9646L13.1208 19.0253L16.073 16.073L15.0124 15.0124ZM19.5324 12.6124C20.1932 11.9464 20.7384 11.3759 21.114 10.8404C21.5023 10.2869 21.75 9.71511 21.75 9.04776H20.25C20.25 9.30755 20.1644 9.58207 19.886 9.979C19.5949 10.394 19.1401 10.8781 18.4676 11.5559L19.5324 12.6124Z",fill:"#1C274C"},null,-1),n("path",{d:"M9 21H21",stroke:"#1C274C","stroke-width":"1.5","stroke-linecap":"round"},null,-1)]))}const Ht=ne(Ut,[["render",zt]]),Nt={},jt={width:"50px",height:"50px",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};function Dt(X,x){return v(),p("svg",jt,x[0]||(x[0]=[n("path",{d:"M8 7H16M12 7V17M7.8 21H16.2C17.8802 21 18.7202 21 19.362 20.673C19.9265 20.3854 20.3854 19.9265 20.673 19.362C21 18.7202 21 17.8802 21 16.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21Z",stroke:"#000000","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const Xt=ne(Nt,[["render",Dt]]),Yt={class:"h-full flex flex-col bg-gray-100 dark:bg-gray-950 overflow-hidden relative select-none"},Gt={class:"h-16 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between px-2 sm:px-4 z-20 shadow-sm gap-2 sm:gap-4 overflow-x-auto no-scrollbar"},Ot={class:"flex items-center gap-1 sm:gap-2 shrink-0"},Kt={class:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-0.5 sm:p-1 gap-0.5 sm:gap-1"},Wt=["onClick","title"],qt={class:"flex items-center gap-2 sm:gap-4 flex-grow justify-center whitespace-nowrap px-2"},Jt={class:"flex items-center gap-2",title:"Color"},Qt={key:0,class:"flex items-center gap-2"},ea={class:"hidden sm:inline text-[10px] font-black text-gray-400 uppercase tracking-tighter"},ta={class:"text-[10px] font-mono w-6"},aa={class:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1 gap-1"},na={class:"flex items-center gap-1 sm:gap-2 shrink-0"},la=["disabled"],sa=["disabled"],oa={class:"flex-grow flex min-h-0 relative overflow-hidden"},ra={class:"absolute bottom-4 left-4 bg-white/90 dark:bg-gray-900/90 backdrop-blur rounded-xl shadow-lg p-1 sm:p-2 flex items-center gap-1 sm:gap-2 z-10 border dark:border-gray-800"},ia={class:"text-[10px] font-black font-mono w-10 text-center"},ua={class:"p-4 border-b dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50 flex justify-between items-center"},da={class:"flex-grow overflow-y-auto custom-scrollbar p-1"},ca=["onClick"],va={class:"text-[10px] font-black text-gray-400 uppercase tracking-widest group-hover:text-blue-500 transition-colors"},pa={class:"space-y-4 animate-in fade-in slide-in-from-top-1"},ga={key:0,class:"space-y-3"},ma={class:"flex justify-between text-[9px] font-bold text-gray-500 mb-1"},ha={class:"flex justify-between text-[9px] font-bold text-gray-500 mb-1"},fa={class:"grid grid-cols-2 gap-2"},ba={class:"grid grid-cols-2 gap-2"},wa={class:"space-y-2 p-3 bg-gray-50 dark:bg-black/40 rounded-xl border dark:border-gray-800"},xa={class:"flex justify-between text-[9px] text-gray-400 font-bold uppercase"},ya={class:"flex justify-between text-[9px] text-gray-400 font-bold uppercase"},ka={class:"grid grid-cols-3 gap-2 pt-2 border-t dark:border-gray-800"},Ca={key:2,class:"flex flex-wrap gap-1.5"},Ma=["onClick"],_a={class:"p-4 space-y-4"},Ia={class:"flex justify-between items-center mb-1"},La=["disabled"],Ra=["value"],Sa={class:"p-4 border-t dark:border-gray-800 bg-gray-50 dark:bg-gray-900/80"},$a=["disabled"],Ta={__name:"ImageEditorView",props:{id:{type:String,default:null}},setup(X){const x={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("path",{d:"M17 3l4 4-4 4"}),d("path",{d:"M3 7h18"}),d("path",{d:"M7 13l-4 4 4 4"}),d("path",{d:"M3 17h18"})])},Te={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("path",{d:"M7 17l4 4 4-4"}),d("path",{d:"M11 3v18"}),d("path",{d:"M17 7l-4-4-4 4"}),d("path",{d:"M13 3v18"})])},Ae={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("path",{d:"M20 11a8.1 8.1 0 0 0-15.5-2m-.5 5v-5h5"}),d("path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5-5v5h-5"})])},Ve={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})])},Ee={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},[d("path",{d:"M5 19L19 5"})])},Pe={render:()=>d("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[d("path",{d:"M15 4V2M15 16V14M8 9h2M20 9h2M17.8 11.8L19 13M10.6 5.2L12 6.6M11.6 12.2l-8.4 8.6"})])},le=X,se=ht(),oe=ut(),Fe=dt(),Y=ct(),G=vt(),{on:re,off:ie}=gt(),U=o(!1),V=o(!1),O=o(null),c=o(null),_=o(null),E=o(null),L=o(null),R=o(null),ue=o(null),K=o({Adjustments:!1,"Canvas & Geometry":!1,"Style Presets":!0,"Hair & Color":!0,"AI Retouch":!0}),Be={Adjustments:[],"Canvas & Geometry":[],"AI Retouch":[{name:"Skin Smooth",prompt:"retouch skin, smooth texture, highly detailed facial features"},{name:"Sharpen",prompt:"ultra sharp details, enhance micro texture, high resolution"},{name:"Remove Object",prompt:"fill area seamlessly with background context, inpaint"}],"Style Presets":[{name:"Watercolor",prompt:"transform area into watercolor painting style, soft paper texture"},{name:"Oil Paint",prompt:"transform area into thick oil painting brushstrokes, classical art style"},{name:"Anime",prompt:"transform area into vibrant 2d anime art style, cel shaded"}],"Hair & Color":[{name:"Mohawk",prompt:"a sharp mohawk haircut, highly detailed hair"},{name:"Bob Cut",prompt:"a stylish bob haircut, chin-length"},{name:"Bald",prompt:"a clean bald head"},{name:"Crimson Hair",prompt:"vibrant crimson red hair color"},{name:"Neon Green",prompt:"glowing neon green hair color"}]},h=o("image"),i=o("brush"),W=o("#000000"),S=o(40),Ue=o(1);o(10);const q=o(1),J=o(1),Z=o(0),z=o(0),k=o(1),de=o(0),ce=o(0),C=o(""),Ze=o(.75),ze=o(-1),H=o(""),M=o(!1),ve=o(!1),pe=o(null),N=o(!1),Q=o(0),ee=o(0),be=o(0),we=o(0),f=o(0),b=o(0),$=o([]),P=o(-1),He=[{id:"pan",name:"Pan",icon:Bt},{id:"brush",name:"Brush",icon:St},{id:"eraser",name:"Eraser",icon:Ht},{id:"text",name:"Text",icon:Xt},{id:"wand",name:"Wand",icon:Pe},{id:"line",name:"Line",icon:Ee},{id:"rect",name:"Rect",icon:Ve},{id:"circle",name:"Circle",icon:$t}],Ne=he(()=>Fe.availableTtiModels),je=he(()=>["brush","eraser","circle","text"].includes(i.value)&&i.value!=="pan"),De=he(()=>({transform:`translate(${de.value}px, ${ce.value}px) scale(${k.value}) perspective(1000px) rotateX(${Z.value}deg) rotateY(${z.value}deg)`}));function Xe(a){i.value=a}function Ye(a){h.value="mask",C.value=a,Y.addNotification("Preset applied to prompt.","info")}function Ge(){Z.value=0,z.value=0}pt(async()=>{U.value=!0,re("prompt:enhanced",Ce),re("image:generated",Me),re("task:completed",_e),c.value&&(L.value=c.value.getContext("2d",{willReadFrequently:!0})),_.value&&(R.value=_.value.getContext("2d",{willReadFrequently:!0})),E.value&&(ue.value=E.value.getContext("2d")),le.id==="new"?Oe():le.id&&await xe(le.id),G.user&&(H.value=G.user.iti_binding_model_name||G.user.tti_binding_model_name||""),window.addEventListener("keydown",Ie),window.addEventListener("resize",D)}),mt(()=>{U.value=!1,ie("prompt:enhanced",Ce),ie("image:generated",Me),ie("task:completed",_e),window.removeEventListener("keydown",Ie),window.removeEventListener("resize",D)});async function Oe(){const{confirmed:a,value:e}=await Y.showConfirmation({title:"Canvas Size",inputType:"select",inputOptions:[{text:"1:1",value:"1024x1024"},{text:"16:9",value:"1344x768"},{text:"9:16",value:"768x1344"}],inputValue:"1024x1024"});if(a&&e){const[t,l]=e.split("x").map(Number);Ke(t,l)}else se.push("/image-studio")}function Ke(a,e){ge(a,e),L.value.fillStyle="#FFFFFF",L.value.fillRect(0,0,a,e),I(),D()}async function xe(a){try{const e=await ft.get(`/api/image-studio/${a}/file`,{responseType:"blob"}),t=new Image;await new Promise((l,s)=>{t.onload=l,t.onerror=s,t.src=URL.createObjectURL(e.data)}),ge(t.naturalWidth,t.naturalHeight),L.value.drawImage(t,0,0),I(),D()}catch{se.push("/image-studio")}}function ge(a,e){[c,_,E].forEach(t=>{t.value&&(t.value.width=a,t.value.height=e)})}function me(a){const e=c.value.getBoundingClientRect(),t=c.value.width/e.width,l=c.value.height/e.height;return{x:(a.clientX-e.left)*t,y:(a.clientY-e.top)*l}}function We(a){if(a.button!==0)return;N.value=!0;const{x:e,y:t}=me(a);if(Q.value=a.clientX,ee.value=a.clientY,f.value=e,b.value=t,i.value==="text"){const l=C("Text:");if(l){const s=F();te(s),s.font=`bold ${S.value}px sans-serif`,s.textBaseline="middle",s.fillText(l,e,t),I()}N.value=!1}else["brush","eraser"].includes(i.value)&&(F().beginPath(),F().moveTo(e,t),ke(e,t))}function qe(a){const{x:e,y:t}=me(a);be.value=e,we.value=t,N.value&&(i.value==="pan"?(de.value+=a.clientX-Q.value,ce.value+=a.clientY-ee.value,Q.value=a.clientX,ee.value=a.clientY):["brush","eraser"].includes(i.value)?ke(e,t):["line","rect","circle"].includes(i.value)&&Je(e,t))}function ye(){N.value&&(N.value=!1,["line","rect","circle"].includes(i.value)&&Qe(me({clientX:Q.value,clientY:ee.value})),["pan","text"].includes(i.value)||I())}function F(){return h.value==="image"?L.value:R.value}function te(a){a.lineCap="round",a.lineJoin="round",a.lineWidth=S.value,i.value==="eraser"?a.globalCompositeOperation="destination-out":(a.globalCompositeOperation="source-over",a.globalAlpha=Ue.value,a.fillStyle=h.value==="mask"?"#FFF":W.value,a.strokeStyle=h.value==="mask"?"#FFF":W.value)}function ke(a,e){const t=F();te(t),t.lineTo(a,e),t.stroke(),t.beginPath(),t.moveTo(a,e)}function Je(a,e){const t=ue.value;t.clearRect(0,0,t.canvas.width,t.canvas.height),te(t),t.beginPath(),i.value==="line"?(t.moveTo(f.value,b.value),t.lineTo(a,e)):i.value==="rect"?t.rect(f.value,b.value,a-f.value,e-b.value):i.value==="circle"&&t.arc(f.value,b.value,Math.sqrt(Math.pow(a-f.value,2)+Math.pow(e-b.value,2)),0,2*Math.PI),t.stroke(),i.value!=="line"&&t.fill()}function Qe(a){ue.value.clearRect(0,0,E.value.width,E.value.height);const e=F();te(e),e.beginPath(),i.value==="line"?(e.moveTo(f.value,b.value),e.lineTo(a.x,a.y),e.stroke()):i.value==="rect"?(e.rect(f.value,b.value,a.x-f.value,a.y-b.value),e.fill(),e.stroke()):i.value==="circle"&&(e.arc(f.value,b.value,Math.sqrt(Math.pow(a.x-f.value,2)+Math.pow(a.y-b.value,2)),0,2*Math.PI),e.fill(),e.stroke()),e.globalAlpha=1,e.globalCompositeOperation="source-over"}function et(){const a=L.value,e=a.getImageData(0,0,a.canvas.width,a.canvas.height),t=e.data,l=q.value,s=J.value,u=128*(1-s);for(let r=0;r<t.length;r+=4)t[r]=t[r]*l*s+u,t[r+1]=t[r+1]*l*s+u,t[r+2]=t[r+2]*l*s+u;a.putImageData(e,0,0),I(),Y.addNotification("Adjustments applied.","success")}function tt(a){const e=L.value,t=e.canvas.width,l=e.canvas.height,s=document.createElement("canvas");s.width=t,s.height=l;const u=s.getContext("2d");u.fillStyle="#FFF",u.fillRect(0,0,t,l);const r=t*a,m=l*a;u.drawImage(e.canvas,(t-r)/2,(l-m)/2,r,m),e.clearRect(0,0,t,l),e.drawImage(s,0,0),R.value.fillStyle="#FFF",R.value.fillRect(0,0,t,(l-m)/2),R.value.fillRect(0,l-(l-m)/2,t,(l-m)/2),R.value.fillRect(0,(l-m)/2,(t-r)/2,m),R.value.fillRect(t-(t-r)/2,(l-m)/2,(t-r)/2,m),h.value="mask",I()}function j(a){const e=F(),t=e.canvas,l=document.createElement("canvas");l.width=t.width,l.height=t.height;const s=l.getContext("2d");if(a==="flip-h")s.scale(-1,1),s.drawImage(t,-t.width,0);else if(a==="flip-v")s.scale(1,-1),s.drawImage(t,0,-t.height);else if(a==="rotate-cw")l.width=t.height,l.height=t.width,s.translate(l.width/2,l.height/2),s.rotate(Math.PI/2),s.drawImage(t,-t.width/2,-t.height/2),ge(l.width,l.height);else if(a==="greyscale"||a==="invert"){const u=e.getImageData(0,0,t.width,t.height);for(let r=0;r<u.data.length;r+=4)if(a==="greyscale"){const m=(u.data[r]+u.data[r+1]+u.data[r+2])/3;u.data[r]=m,u.data[r+1]=m,u.data[r+2]=m}else u.data[r]=255-u.data[r],u.data[r+1]=255-u.data[r+1],u.data[r+2]=255-u.data[r+2];e.putImageData(u,0,0),I();return}e.clearRect(0,0,t.width,t.height),e.drawImage(l,0,0),I()}async function at(){M.value=!0;try{const a=c.value.toDataURL("image/png").split(",")[1],e=document.createElement("canvas");e.width=_.value.width,e.height=_.value.height;const t=e.getContext("2d");t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.drawImage(_.value,0,0);const l=e.toDataURL("image/png").split(",")[1],s=await oe.editImage({base_image_b64:a,mask:l,prompt:C.value,strength:Ze.value,seed:ze.value,model:H.value,width:c.value.width,height:c.value.height});s!=null&&s.id&&(pe.value=s.id)}catch{M.value=!1}}function nt(a){Y.openModal("enhancePrompt",{onConfirm:e=>{var t;ve.value=!0,M.value=!0,oe.enhanceImagePrompt({prompt:C.value,target:a,model:(t=G.user)==null?void 0:t.lollms_model_name,...e,image_b64s:[c.value.toDataURL().split(",")[1]]}).then(l=>{l!=null&&l.id&&(pe.value=l.id)})}})}function lt(){const a=c.value.toDataURL("image/png").split(",")[1];oe.saveCanvasAsNewImage({base_image_b64:a,prompt:C.value||"Edited",width:c.value.width,height:c.value.height,model:H.value})}function D(){if(!O.value||!c.value)return;const a=O.value.clientWidth,e=O.value.clientHeight,t=c.value.width,l=c.value.height;t&&(k.value=Math.min((a-40)/t,(e-40)/l,1),de.value=0,ce.value=0)}function st(a){(a.ctrlKey||i.value==="pan")&&(a.preventDefault(),k.value=Math.min(Math.max(.1,k.value-Math.sign(a.deltaY)*.1),5))}function ot(){k.value=Math.min(5,k.value+.1)}function rt(){k.value=Math.max(.1,k.value-.1)}function it(){se.push("/image-studio")}function I(){P.value<$.value.length-1&&($.value=$.value.slice(0,P.value+1)),$.value.push({image:c.value.toDataURL(),mask:_.value.toDataURL()}),P.value++,$.value.length>20&&($.value.shift(),P.value--)}function Ce(a){U.value&&(C.value=a.prompt||C.value,ve.value=!1,M.value=!1)}function Me(a){U.value&&a&&(xe(a.id),M.value=!1)}function _e(a){U.value&&a.id===pe.value&&(M.value=!1,ve.value=!1)}function Ie(a){if(a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA")return;const e={" ":"pan",b:"brush",e:"eraser",t:"text",w:"wand",l:"line",r:"rect",c:"circle"};e[a.key.toLowerCase()]&&(i.value=e[a.key.toLowerCase()]),(a.ctrlKey||a.metaKey)&&a.key.toLowerCase()==="z"&&undo(),(a.ctrlKey||a.metaKey)&&a.key.toLowerCase()==="y"&&redo()}return(a,e)=>(v(),p("div",Yt,[n("div",Gt,[n("div",Ot,[n("button",{onClick:it,class:"btn-icon",title:"Back"},[g(bt,{class:"w-5 h-5"})]),e[22]||(e[22]=n("div",{class:"h-6 w-px bg-gray-300 dark:bg-gray-600 mx-1 sm:mx-2"},null,-1)),n("div",Kt,[(v(),p(T,null,ae(He,t=>n("button",{key:t.id,onClick:l=>Xe(t.id),class:B(["p-1.5 sm:p-2 rounded-md transition-colors",i.value===t.id?"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"]),title:t.name},[(v(),Lt(Rt(t.icon),{class:"w-5 h-5"}))],10,Wt)),64))])]),n("div",qt,[n("div",Jt,[y(n("input",{type:"color","onUpdate:modelValue":e[0]||(e[0]=t=>W.value=t),class:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg cursor-pointer border-0 p-0 bg-transparent"},null,512),[[A,W.value]])]),["brush","eraser","line","rect","circle","text"].includes(i.value)?(v(),p("div",Qt,[n("span",ea,w(i.value==="text"?"Font":"Size"),1),y(n("input",{type:"range","onUpdate:modelValue":e[1]||(e[1]=t=>S.value=t),min:"1",max:"400",class:"w-16 sm:w-24 h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[A,S.value,void 0,{number:!0}]]),n("span",ta,w(S.value),1)])):Le("",!0),n("div",aa,[n("button",{onClick:e[2]||(e[2]=t=>h.value="image"),class:B(["px-2 sm:px-3 py-1 text-[10px] sm:text-xs font-black rounded transition-colors uppercase",h.value==="image"?"bg-white dark:bg-gray-700 shadow-sm text-blue-600 dark:text-blue-400":"text-gray-500"])},"Image",2),n("button",{onClick:e[3]||(e[3]=t=>h.value="mask"),class:B(["px-2 sm:px-3 py-1 text-[10px] sm:text-xs font-black rounded transition-colors uppercase",h.value==="mask"?"bg-white dark:bg-gray-700 shadow-sm text-blue-600 dark:text-blue-400":"text-gray-500"])},"Mask",2)])]),n("div",na,[n("button",{onClick:e[4]||(e[4]=(...t)=>a.undo&&a.undo(...t)),disabled:P.value<=0,class:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded disabled:opacity-20 transition-opacity"},[g(At,{class:"w-5 h-5"})],8,la),n("button",{onClick:e[5]||(e[5]=(...t)=>a.redo&&a.redo(...t)),disabled:P.value>=$.value.length-1,class:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded disabled:opacity-20 transition-opacity"},[g(Vt,{class:"w-5 h-5"})],8,sa),n("button",{onClick:lt,class:"btn btn-primary btn-sm gap-2"},[g(wt,{class:"w-4 h-4"}),e[23]||(e[23]=fe()),e[24]||(e[24]=n("span",{class:"hidden sm:inline"},"Save",-1))]),n("button",{onClick:e[6]||(e[6]=t=>V.value=!V.value),class:"lg:hidden btn btn-secondary p-2 ml-1"},[g(xt,{class:"w-5 h-5"})])])]),n("div",oa,[n("main",{ref_key:"containerRef",ref:O,class:"flex-grow bg-gray-200 dark:bg-black relative overflow-hidden flex items-center justify-center cursor-crosshair pattern-grid",onWheel:st,onMousedown:We,onMousemove:qe,onMouseup:ye,onMouseleave:ye},[n("div",{style:Re(De.value),class:"relative shadow-2xl origin-center canvas-stack transition-transform duration-75"},[n("canvas",{ref_key:"imageCanvasRef",ref:c,class:"block bg-white layer-canvas"},null,512),n("canvas",{ref_key:"maskCanvasRef",ref:_,class:B(["absolute inset-0 opacity-60 layer-canvas",{"pointer-events-none":h.value!=="mask"}])},null,2),n("canvas",{ref_key:"previewCanvasRef",ref:E,class:"absolute inset-0 pointer-events-none layer-canvas"},null,512),y(n("div",{class:"absolute pointer-events-none rounded-full border border-black/50 bg-white/20 z-50 transform -translate-x-1/2 -translate-y-1/2 shadow-sm",style:Re({width:`${S.value}px`,height:`${S.value}px`,left:`${be.value}px`,top:`${we.value}px`})},null,4),[[Se,je.value]])],4),n("div",ra,[n("button",{onClick:rt,class:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},[g(yt,{class:"w-4 h-4"})]),n("span",ia,w(Math.round(k.value*100))+"%",1),n("button",{onClick:ot,class:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},[g(kt,{class:"w-4 h-4"})]),n("button",{onClick:D,class:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded ml-1"},[g(Ct,{class:"w-4 h-4"})])])],544),n("aside",{class:B(["absolute inset-y-0 right-0 z-30 w-72 sm:w-80 bg-white dark:bg-gray-900 border-l dark:border-gray-800 transform transition-transform duration-300 lg:relative lg:translate-x-0 flex flex-col shadow-xl",V.value?"translate-x-0":"translate-x-full"])},[n("div",ua,[e[25]||(e[25]=n("h3",{class:"font-black text-[10px] uppercase tracking-widest text-gray-500"},"Editor Inspector",-1)),n("button",{onClick:e[7]||(e[7]=t=>V.value=!1),class:"lg:hidden p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors"},[g(Mt,{class:"w-5 h-5"})])]),n("div",da,[(v(),p(T,null,ae(Be,(t,l)=>n("div",{key:l,class:"p-4 border-b dark:border-gray-800 space-y-4"},[n("div",{class:"flex items-center justify-between cursor-pointer group",onClick:s=>K.value[l]=!K.value[l]},[n("span",va,w(l),1),g(Tt,{class:B(["w-3 h-3 transition-transform text-gray-500",{"rotate-180":K.value[l]}])},null,8,["class"])],8,ca),y(n("div",pa,[l==="Adjustments"?(v(),p("div",ga,[n("div",null,[n("div",ma,[e[26]||(e[26]=n("span",null,"BRIGHTNESS",-1)),n("span",null,w(Math.round(q.value*100))+"%",1)]),y(n("input",{type:"range","onUpdate:modelValue":e[8]||(e[8]=s=>q.value=s),min:"0",max:"2",step:"0.05",class:"w-full h-1.5 bg-gray-200 dark:bg-gray-800 rounded-lg appearance-none cursor-pointer"},null,512),[[A,q.value,void 0,{number:!0}]])]),n("div",null,[n("div",ha,[e[27]||(e[27]=n("span",null,"CONTRAST",-1)),n("span",null,w(Math.round(J.value*100))+"%",1)]),y(n("input",{type:"range","onUpdate:modelValue":e[9]||(e[9]=s=>J.value=s),min:"0",max:"2",step:"0.05",class:"w-full h-1.5 bg-gray-200 dark:bg-gray-800 rounded-lg appearance-none cursor-pointer"},null,512),[[A,J.value,void 0,{number:!0}]])]),n("div",fa,[n("button",{onClick:e[10]||(e[10]=s=>j("greyscale")),class:"btn btn-secondary text-[10px] py-1 font-bold"},"Greyscale"),n("button",{onClick:e[11]||(e[11]=s=>j("invert")),class:"btn btn-secondary text-[10px] py-1 font-bold"},"Invert")]),n("button",{onClick:et,class:"btn btn-primary w-full text-[10px] py-2 font-black uppercase tracking-widest"},"Apply Filters")])):l==="Canvas & Geometry"?(v(),p(T,{key:1},[n("div",ba,[n("button",{onClick:e[12]||(e[12]=s=>tt(.75)),class:"btn btn-secondary text-[10px] py-1.5 font-bold uppercase",title:"Scale image down and add blank canvas padding"},"Outpaint Pad"),n("button",{onClick:Ge,class:"btn btn-secondary text-[10px] py-1.5 font-bold uppercase"},"Reset 3D")]),n("div",wa,[n("div",xa,[e[28]||(e[28]=n("span",null,"Tilt X",-1)),n("span",null,w(Z.value)+"°",1)]),y(n("input",{type:"range","onUpdate:modelValue":e[13]||(e[13]=s=>Z.value=s),min:"-45",max:"45",class:"w-full h-1 bg-gray-200 dark:bg-gray-800 rounded-lg appearance-none cursor-pointer"},null,512),[[A,Z.value,void 0,{number:!0}]]),n("div",ya,[e[29]||(e[29]=n("span",null,"Swing Y",-1)),n("span",null,w(z.value)+"°",1)]),y(n("input",{type:"range","onUpdate:modelValue":e[14]||(e[14]=s=>z.value=s),min:"-45",max:"45",class:"w-full h-1 bg-gray-200 dark:bg-gray-800 rounded-lg appearance-none cursor-pointer"},null,512),[[A,z.value,void 0,{number:!0}]])]),n("div",ka,[n("button",{onClick:e[15]||(e[15]=s=>j("flip-h")),class:"btn btn-secondary p-2",title:"Flip Horizontal"},[g(x,{class:"w-4 h-4 mx-auto"})]),n("button",{onClick:e[16]||(e[16]=s=>j("flip-v")),class:"btn btn-secondary p-2",title:"Flip Vertical"},[g(Te,{class:"w-4 h-4 mx-auto"})]),n("button",{onClick:e[17]||(e[17]=s=>j("rotate-cw")),class:"btn btn-secondary p-2",title:"Rotate 90°"},[g(Ae,{class:"w-4 h-4 mx-auto"})])])],64)):(v(),p("div",Ca,[(v(!0),p(T,null,ae(t,s=>(v(),p("button",{key:s.name,onClick:u=>Ye(s.prompt),class:"px-2 py-1 bg-gray-50 dark:bg-gray-800 text-[9px] border dark:border-gray-700 rounded-lg hover:border-blue-500 transition-all uppercase font-black text-gray-600 dark:text-gray-300"},w(s.name),9,Ma))),128))]))],512),[[Se,!K.value[l]]])])),64)),n("div",_a,[n("div",null,[n("div",Ia,[e[30]||(e[30]=n("label",{class:"text-[10px] font-black text-gray-400 uppercase tracking-widest"},"AI Context Prompt",-1)),n("button",{onClick:e[18]||(e[18]=t=>nt("prompt")),class:"text-blue-500 hover:scale-110 transition-transform",disabled:M.value},[g($e,{class:"w-4 h-4"})],8,La)]),y(n("textarea",{"onUpdate:modelValue":e[19]||(e[19]=t=>C.value=t),rows:"3",class:"input-field w-full text-xs resize-none shadow-inner",placeholder:"Instructions for the AI..."},null,512),[[A,C.value]])]),n("div",null,[e[31]||(e[31]=n("label",{class:"text-[10px] font-black text-gray-400 uppercase tracking-widest"},"Model",-1)),y(n("select",{"onUpdate:modelValue":e[20]||(e[20]=t=>H.value=t),class:"input-field w-full text-xs mt-1"},[(v(!0),p(T,null,ae(Ne.value,t=>(v(),p("option",{key:t.id,value:t.id},w(t.name),9,Ra))),128))],512),[[_t,H.value]])])])]),n("div",Sa,[n("button",{onClick:at,class:"btn btn-primary w-full py-3 shadow-xl transform active:scale-95 transition-all",disabled:M.value},[M.value?(v(),p(T,{key:0},[g(It,{class:"w-5 h-5 mr-2 animate-spin"}),e[32]||(e[32]=fe(" GENERATING..."))],64)):(v(),p(T,{key:1},[g($e,{class:"w-5 h-5 mr-2"}),fe(" "+w(h.value==="mask"?"INPAINT MASK":"FULL GENERATE"),1)],64))],8,$a)])],2),V.value?(v(),p("div",{key:0,onClick:e[21]||(e[21]=t=>V.value=!1),class:"absolute inset-0 bg-black/50 z-20 lg:hidden backdrop-blur-xs"})):Le("",!0)])]))}},Ea=ne(Ta,[["__scopeId","data-v-4c46e5e1"]]);export{Ea as default};
