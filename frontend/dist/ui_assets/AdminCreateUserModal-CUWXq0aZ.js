import{r as c,b as A,a7 as L,au as T,J as s,c as b,o as d,aT as M,f as C,g as u,w as S,h as y,S as D,a as l,F as I,j as N,n as O,t as z,T as E,z as B,u as R,W as q,A as W,G as U,M as F,K as p,bo as G,O as _}from"./index-X76Zlg0l.js";import{u as K}from"./admin-B4p34gEf.js";import{_ as j}from"./GenericModal-ox4fsMOO.js";import{I as P}from"./IconUser-Bg6Dnzgn.js";import{a as J,I as $}from"./IconShieldCheck-CkM1Xi8a.js";const Y=["id"],H={class:"max-h-60 overflow-y-auto p-1"},Q=["onClick"],X={key:0,class:"px-3 py-2 text-sm text-gray-500 italic"},Z={key:0,class:"border-t border-gray-200 dark:border-gray-700"},w={__name:"SimpleSelectMenu",props:{items:{type:Array,default:()=>[]},modelValue:{type:[String,Number,null],default:null},placeholder:{type:String,default:"Select an option"}},emits:["update:modelValue"],setup(g,{emit:f}){const r=g,t=f,i=c(!1),m=c(null),x=c({}),h=A(()=>{const e=r.items.find(a=>a.value===r.modelValue);return e?e.label:r.placeholder});L(i,async e=>{if(e&&(await T(),m.value)){const a=m.value.getBoundingClientRect(),n=256;let v=a.left;a.left+n>window.innerWidth&&(v=a.right-n),x.value={position:"absolute",top:`${a.bottom+4}px`,left:`${v}px`,minWidth:`${a.width}px`}}});function k(e){t("update:modelValue",e),i.value=!1}const V={mounted:(e,a)=>{e.__vueClickOutside__=n=>{const v=document.getElementById(`menu-${e.id}`);!e.contains(n.target)&&(!v||!v.contains(n.target))&&a.value(n)},document.body.addEventListener("click",e.__vueClickOutside__)},unmounted:e=>{document.body.removeEventListener("click",e.__vueClickOutside__)}},o=`menu-trigger-${Math.random().toString(36).substr(2,9)}`;return(e,a)=>s((d(),b("div",{id:o,ref_key:"triggerRef",ref:m,class:"relative w-full"},[M(e.$slots,"button",{toggle:()=>i.value=!i.value,selectedLabel:h.value}),(d(),C(B,{to:"body"},[u(E,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:S(()=>[i.value?(d(),b("div",{key:0,id:`menu-${o}`,style:D(x.value),class:"w-64 z-[9999] rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5"},[l("ul",H,[(d(!0),b(I,null,N(g.items,n=>(d(),b("li",{key:n.value,onClick:v=>k(n.value),class:"text-gray-900 dark:text-gray-100 cursor-pointer select-none relative py-2 px-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"},[l("span",{class:O(["block truncate",{"font-semibold":n.value===g.modelValue}])},z(n.label),3)],8,Q))),128)),g.items.length===0?(d(),b("li",X," No options available. ")):y("",!0)]),e.$slots.footer?(d(),b("div",Z,[M(e.$slots,"footer")])):y("",!0)],12,Y)):y("",!0)]),_:3})]))])),[[V,()=>i.value=!1]])}},ee={class:"space-y-6"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"relative mt-1"},te={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},se={class:"relative mt-1"},ne={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},oe={class:"relative mt-1"},ie={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},re={class:"flex items-center gap-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800"},ue={class:"flex items-center gap-2"},de={for:"is-admin",class:"label mb-0 cursor-pointer flex items-center gap-2"},me={class:"flex items-center gap-2"},pe={for:"is-moderator",class:"label mb-0 cursor-pointer flex items-center gap-2"},_e={class:"border-t pt-4"},be={key:0,class:"space-y-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},fe={class:"flex items-center gap-2 cursor-pointer"},ye={class:"flex items-center gap-2 cursor-pointer"},xe={class:"flex items-center gap-2 cursor-pointer"},ke={class:"flex items-center gap-2 cursor-pointer"},we={class:"flex items-center gap-2 cursor-pointer"},he={class:"flex items-center gap-2 cursor-pointer"},Ve={class:"flex justify-end gap-3"},Ue=["disabled"],Le={__name:"AdminCreateUserModal",setup(g){const f=K(),r=R();q();const t=c({username:"",password:"",email:"",is_admin:!1,is_moderator:!1,user_ui_level:0,lollms_model_name:null,llm_ctx_size:null,llm_temperature:null,llm_top_k:null,llm_top_p:null,llm_repeat_penalty:null,llm_repeat_last_n:null,put_thoughts_in_context:!1,tti_binding_model_name:null,tts_binding_model_name:null,stt_binding_model_name:null,safe_store_vectorizer:null,rag_top_k:null,max_rag_len:null,rag_n_hops:null,rag_min_sim_percent:null,rag_use_graph:null,rag_graph_response_type:null,first_page:"feed",message_font_size:14,auto_title:!1,chat_active:!0,fun_mode:!1,show_token_counter:!0,receive_notification_emails:!0,is_searchable:!0,image_generation_enabled:!1,image_annotation_enabled:!1,image_editing_enabled:!1,activate_generated_images:!1,max_image_width:-1,max_image_height:-1,compress_images:!1,image_compression_quality:85,memory_enabled:!1,auto_memory_enabled:!1,herd_mode_enabled:!1,reasoning_activation:!1,reasoning_effort:null,reasoning_summary:!1,web_search_enabled:!1,web_search_deep_analysis:!1}),i=c(!1),m=c(!1),x=[{value:0,label:"Beginner"},{value:1,label:"Advanced"},{value:2,label:"Expert"}],h=[{value:"chunks_summary",label:"Chunks Summary"},{value:"direct",label:"Direct"},{value:"mixed",label:"Mixed"}],k=A(()=>f.adminAvailableLollmsModels.map(o=>({value:o.model_name,label:o.display_name||o.model_name})));L(()=>r.isModalOpen("adminCreateUser"),o=>{o&&(t.value={username:"",password:"",email:"",is_admin:!1,is_moderator:!1,user_ui_level:0,lollms_model_name:null,llm_ctx_size:null,llm_temperature:null,llm_top_k:null,llm_top_p:null,llm_repeat_penalty:null,llm_repeat_last_n:null,put_thoughts_in_context:!1,tti_binding_model_name:null,tts_binding_model_name:null,stt_binding_model_name:null,safe_store_vectorizer:null,rag_top_k:null,max_rag_len:null,rag_n_hops:null,rag_min_sim_percent:null,rag_use_graph:null,rag_graph_response_type:null,first_page:"feed",message_font_size:14,auto_title:!1,chat_active:!0,fun_mode:!1,show_token_counter:!0,receive_notification_emails:!0,is_searchable:!0,image_generation_enabled:!1,image_annotation_enabled:!1,image_editing_enabled:!1,activate_generated_images:!1,max_image_width:-1,max_image_height:-1,compress_images:!1,image_compression_quality:85,memory_enabled:!1,auto_memory_enabled:!1,herd_mode_enabled:!1,reasoning_activation:!1,reasoning_effort:null,reasoning_summary:!1,web_search_enabled:!1,web_search_deep_analysis:!1},m.value=!1,k.value.length===0&&f.fetchAdminAvailableLollmsModels())});async function V(){var o,e;if(!t.value.username.trim()||!t.value.password.trim()){r.addNotification("Username and password are required.","warning");return}i.value=!0;try{await f.createUser(t.value),r.closeModal("adminCreateUser"),r.addNotification("User created successfully.","success")}catch(a){console.error("Create user failed:",a);const n=((e=(o=a.response)==null?void 0:o.data)==null?void 0:e.detail)||"Failed to create user.";r.addNotification(n,"error")}finally{i.value=!1}}return(o,e)=>(d(),C(j,{modalName:"adminCreateUser",title:"Create New User",maxWidthClass:"max-w-4xl"},{body:S(()=>[l("div",ee,[l("div",le,[l("div",null,[e[22]||(e[22]=l("label",{for:"username",class:"label"},"Username *",-1)),l("div",ae,[l("div",te,[u(P,{class:"h-4 w-4 text-gray-400"})]),s(l("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=a=>t.value.username=a),type:"text",class:"input-field pl-10",placeholder:"Enter username",required:""},null,512),[[p,t.value.username]])])]),l("div",null,[e[23]||(e[23]=l("label",{for:"password",class:"label"},"Password *",-1)),l("div",se,[l("div",ne,[u(G,{class:"h-4 w-4 text-gray-400"})]),s(l("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=a=>t.value.password=a),type:"password",class:"input-field pl-10",placeholder:"Enter password",required:""},null,512),[[p,t.value.password]])])]),l("div",null,[e[24]||(e[24]=l("label",{for:"email",class:"label"},"Email",-1)),l("div",oe,[l("div",ie,[u(J,{class:"h-4 w-4 text-gray-400"})]),s(l("input",{id:"email","onUpdate:modelValue":e[2]||(e[2]=a=>t.value.email=a),type:"email",class:"input-field pl-10",placeholder:"user@example.com"},null,512),[[p,t.value.email]])])]),l("div",null,[e[25]||(e[25]=l("label",{for:"ui-level",class:"label"},"UI Level",-1)),u(w,{modelValue:t.value.user_ui_level,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.user_ui_level=a),options:x,class:"mt-1"},null,8,["modelValue"])])]),l("div",re,[l("div",ue,[s(l("input",{id:"is-admin","onUpdate:modelValue":e[4]||(e[4]=a=>t.value.is_admin=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.is_admin]]),l("label",de,[u($,{class:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e[26]||(e[26]=U(" Admin "))])]),l("div",me,[s(l("input",{id:"is-moderator","onUpdate:modelValue":e[5]||(e[5]=a=>t.value.is_moderator=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.is_moderator]]),l("label",pe,[u($,{class:"w-4 h-4 text-indigo-600 dark:text-indigo-400"}),e[27]||(e[27]=U(" Moderator "))])])]),l("div",_e,[l("button",{onClick:e[6]||(e[6]=a=>m.value=!m.value),type:"button",class:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline"},z(m.value?"▼":"▶")+" Advanced Settings ",1)]),m.value?(d(),b("div",be,[l("div",null,[e[32]||(e[32]=l("h4",{class:"font-semibold text-sm mb-3"},"LLM Settings",-1)),l("div",ve,[l("div",null,[e[28]||(e[28]=l("label",{class:"label"},"Model",-1)),u(w,{modelValue:t.value.lollms_model_name,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.lollms_model_name=a),options:[{value:null,label:"Use Default"},...k.value]},null,8,["modelValue","options"])]),l("div",null,[e[29]||(e[29]=l("label",{class:"label"},"Context Size",-1)),s(l("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.llm_ctx_size=a),type:"number",class:"input-field",placeholder:"Default"},null,512),[[p,t.value.llm_ctx_size,void 0,{number:!0}]])]),l("div",null,[e[30]||(e[30]=l("label",{class:"label"},"Temperature",-1)),s(l("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.llm_temperature=a),type:"number",step:"0.1",class:"input-field",placeholder:"Default"},null,512),[[p,t.value.llm_temperature,void 0,{number:!0}]])]),l("div",null,[e[31]||(e[31]=l("label",{class:"label"},"Top K",-1)),s(l("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.llm_top_k=a),type:"number",class:"input-field",placeholder:"Default"},null,512),[[p,t.value.llm_top_k,void 0,{number:!0}]])])])]),l("div",null,[e[37]||(e[37]=l("h4",{class:"font-semibold text-sm mb-3"},"RAG Settings",-1)),l("div",ce,[l("div",null,[e[33]||(e[33]=l("label",{class:"label"},"Top K",-1)),s(l("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.rag_top_k=a),type:"number",class:"input-field",placeholder:"Default"},null,512),[[p,t.value.rag_top_k,void 0,{number:!0}]])]),l("div",null,[e[34]||(e[34]=l("label",{class:"label"},"Max Length",-1)),s(l("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.max_rag_len=a),type:"number",class:"input-field",placeholder:"Default"},null,512),[[p,t.value.max_rag_len,void 0,{number:!0}]])]),l("div",null,[e[35]||(e[35]=l("label",{class:"label"},"Use Graph",-1)),u(w,{modelValue:t.value.rag_use_graph,"onUpdate:modelValue":e[13]||(e[13]=a=>t.value.rag_use_graph=a),options:[{value:null,label:"Default"},{value:!0,label:"Yes"},{value:!1,label:"No"}]},null,8,["modelValue"])]),l("div",null,[e[36]||(e[36]=l("label",{class:"label"},"Response Type",-1)),u(w,{modelValue:t.value.rag_graph_response_type,"onUpdate:modelValue":e[14]||(e[14]=a=>t.value.rag_graph_response_type=a),options:[{value:null,label:"Default"},...h]},null,8,["modelValue","options"])])])]),l("div",null,[e[44]||(e[44]=l("h4",{class:"font-semibold text-sm mb-3"},"Features",-1)),l("div",ge,[l("label",fe,[s(l("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>t.value.auto_title=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.auto_title]]),e[38]||(e[38]=l("span",{class:"text-sm"},"Auto Title",-1))]),l("label",ye,[s(l("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>t.value.fun_mode=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.fun_mode]]),e[39]||(e[39]=l("span",{class:"text-sm"},"Fun Mode",-1))]),l("label",xe,[s(l("input",{"onUpdate:modelValue":e[17]||(e[17]=a=>t.value.memory_enabled=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.memory_enabled]]),e[40]||(e[40]=l("span",{class:"text-sm"},"Memory",-1))]),l("label",ke,[s(l("input",{"onUpdate:modelValue":e[18]||(e[18]=a=>t.value.image_generation_enabled=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.image_generation_enabled]]),e[41]||(e[41]=l("span",{class:"text-sm"},"Image Gen",-1))]),l("label",we,[s(l("input",{"onUpdate:modelValue":e[19]||(e[19]=a=>t.value.web_search_enabled=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.web_search_enabled]]),e[42]||(e[42]=l("span",{class:"text-sm"},"Web Search",-1))]),l("label",he,[s(l("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>t.value.reasoning_activation=a),type:"checkbox",class:"checkbox"},null,512),[[_,t.value.reasoning_activation]]),e[43]||(e[43]=l("span",{class:"text-sm"},"Reasoning",-1))])])])])):y("",!0)])]),footer:S(()=>[l("div",Ve,[l("button",{onClick:e[21]||(e[21]=a=>W(r).closeModal("adminCreateUser")),type:"button",class:"btn btn-secondary"}," Cancel "),l("button",{onClick:V,type:"button",class:"btn btn-primary",disabled:i.value},[i.value?(d(),C(F,{key:0,class:"w-4 h-4 mr-2 animate-spin"})):y("",!0),e[45]||(e[45]=U(" Create User "))],8,Ue)])]),_:1}))}};export{Le as default};
