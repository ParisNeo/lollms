import{ao as E,u as V,L as u,c as x,m as N,a as U,o as l,w as g,b as a,d as A,t as d,a0 as b,ac as B,g as $,e as i,F as k,r as w,n as z,K as I,h as T,at as C}from"./index-DltwgrES.js";import{_ as F}from"./GenericModal-CoKmABee.js";const j={class:"space-y-4"},Z={class:"flex items-center space-x-2"},K={class:"relative"},Q={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg shadow-xl z-20"},R=["onClick"],W={class:"border dark:border-gray-600 rounded-md max-h-80 overflow-y-auto"},q={key:0,class:"p-3 space-y-2"},G={class:"border-b dark:border-gray-600 pb-2 mb-2"},H={class:"flex items-center text-sm font-medium cursor-pointer p-1"},J=["value"],P=["title"],X={key:1,class:"text-center italic text-gray-500 p-6"},Y={key:0},ee={key:1},te={class:"text-xs text-center text-gray-500"},se=["disabled"],re={__name:"ExportModal",setup(ae){const y=E(),m=V(),n=u(""),v=u("date_desc"),c=u(!1),S={date_desc:"Most Recent",date_asc:"Oldest First",title_asc:"Title (A-Z)",title_za:"Title (Z-A)"},h=x(()=>Object.values(y.discussions)),o=u([]),p=u(!1),D=x(()=>m.isModalOpen("export")),_=x(()=>h.value.filter(e=>(e.title||"").toLowerCase().includes(n.value.toLowerCase())).sort((e,t)=>{switch(v.value){case"date_asc":return new Date(e.last_activity_at||0)-new Date(t.last_activity_at||0);case"title_asc":return(e.title||"").localeCompare(t.title||"");case"title_za":return(t.title||"").localeCompare(e.title||"");case"date_desc":default:return new Date(t.last_activity_at||0)-new Date(e.last_activity_at||0)}})),f=x({get:()=>{const s=_.value.map(e=>e.id);return s.length>0&&s.every(e=>o.value.includes(e))},set:s=>{const e=_.value.map(t=>t.id);if(s){const t=new Set([...o.value,...e]);o.value=Array.from(t)}else{const t=new Set(e);o.value=o.value.filter(r=>!t.has(r))}}});N(D,s=>{s&&(n.value="",v.value="date_desc",o.value=h.value.map(e=>e.id))});function M(s){v.value=s,c.value=!1}async function O(){p.value=!0;try{await y.exportDiscussions(o.value),m.closeModal("export")}catch{}finally{p.value=!1}}const L={mounted:(s,e)=>{s.__vueClickOutside__=t=>{s===t.target||s.contains(t.target)||e.value(t)},document.body.addEventListener("click",s.__vueClickOutside__)},unmounted:s=>{document.body.removeEventListener("click",s.__vueClickOutside__)}};return(s,e)=>(l(),U(F,{modalName:"export",title:"Export Discussions",maxWidthClass:"max-w-xl"},{body:g(()=>[a("div",j,[a("div",Z,[b(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),placeholder:"Search...",class:"input-field flex-grow"},null,512),[[B,n.value]]),a("div",K,[a("button",{onClick:e[1]||(e[1]=t=>c.value=!c.value),class:"btn btn-secondary !px-3",title:"Sort options"},e[5]||(e[5]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12"})],-1)])),c.value?b((l(),i("div",Q,[(l(),i(k,null,w(S,(t,r)=>a("a",{key:r,href:"#",onClick:I(oe=>M(r),["prevent"]),class:z(["block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-blue-500 hover:text-white",{"font-bold text-blue-600 dark:text-blue-400":v.value===r}])},d(t),11,R)),64))])),[[L,()=>c.value=!1]]):$("",!0)])]),a("div",W,[_.value.length>0?(l(),i("div",q,[a("div",G,[a("label",H,[b(a("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,512),[[C,f.value]]),e[6]||(e[6]=T(" Select / Deselect All Visible "))])]),(l(!0),i(k,null,w(_.value,t=>(l(),i("label",{key:t.id,class:"flex items-center text-sm cursor-pointer p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700"},[b(a("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[3]||(e[3]=r=>o.value=r),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,8,J),[[C,o.value]]),a("span",{class:"truncate",title:t.title||"Untitled Discussion"},d(t.title||"Untitled Discussion"),9,P)]))),128))])):(l(),i("div",X,[n.value?(l(),i("p",Y,"No discussions match your search.")):(l(),i("p",ee,"No discussions to export."))]))]),a("p",te," Selected "+d(o.value.length)+" out of "+d(h.value.length)+" total discussions. ",1)])]),footer:g(()=>[a("button",{onClick:e[4]||(e[4]=t=>A(m).closeModal("export")),class:"btn btn-secondary"},"Cancel"),a("button",{onClick:O,class:"btn btn-primary",disabled:p.value||o.value.length===0},d(p.value?"Exporting...":`Export ${o.value.length} Discussion(s)`),9,se)]),_:1}))}};export{re as default};
