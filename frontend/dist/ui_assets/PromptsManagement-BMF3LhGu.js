import{a4 as q,e as n,o as l,b as e,g as p,t as c,n as Q,K as H,a as A,d3 as bt,d4 as kt,f as y,d5 as wt,d6 as Lt,h as b,aq as jt,aw as xt,aL as Nt,az as K,R as At,u as St,aH as ht,T as R,L as j,c as f,m as z,l as It,V as Ct,W as Dt,av as W,z as $t,a0 as M,ac as T,d as u,ar as P,F as x,r as N,d2 as zt,aG as B}from"./index-B_xFINIg.js";import{u as Tt}from"./admin-QNM067ca.js";import{I as Pt,A as Ut}from"./AppCardSkeleton-CP9ioeYZ.js";import{I as Et}from"./IconArrowUp-RraGQgJi.js";const Ot={class:"card"},Rt={class:"card-header"},Qt=["src","alt"],Zt={class:"flex-grow min-w-0"},Vt={class:"flex justify-between items-start"},Yt=["title"],Ft={class:"card-tags"},_t={key:0,class:"tag installed-tag"},Gt={key:1,class:"tag"},Wt={key:2,class:"tag"},Bt={key:3,class:"tag"},qt={class:"card-body"},Ht=["title"],Kt={key:0,class:"px-4 pb-2 text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1"},Jt=["title"],Xt={class:"card-footer"},te={class:"flex-1 min-w-0"},ee={key:1,class:"flex gap-2 w-full"},se={class:"flex-shrink-0 flex gap-1"},ae="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LjE3MiA0LjU4NmMxLjA3Mi0xLjA3MiAyLjgyNy0xLjA3MiAzLjkwNiAwIGwxLjkyOCAxLjkyOGMuMDkuMDkuMTQ2LjIxMy4xNDYuMzM3djEuMjE5Yy43MTMuMDU0IDEuMzk3LjIxOCAyLjAyOC40NzhsMS45MS0xLjA0Yy4xNTYtLjA4NS4zMy0uMTA0LjQ5OC0uMDVMMjAuNzUgOC4xN2MuMjU0LjA4NC4zOTQuMzQzLjM5NC42MjV2My40M2MwIC4yODItLjE0LjU0MS0uMzk0LjYyNWwtMi42NTQgMS40NDRjLS4xNjguMDktLjM0Mi4xMDgtLjUxLjA1M2wtMS45MS0xLjA0Yy0uNjMyLS4yNi0xLjMxNS0uNDI0LTIuMDI4LS40NzhWNS41NUw5LjE3MiA0LjU4NnpNNCAxMS4yNWMwLS45OTQuNTk2LTEuODYgMS40NDctMi4yNTlMMTAuMDMgNC40M2MtLjM2OS4wMjYtLjczLjEzOC0xLjA3Mi4zMzJsLTEuOTI4IDEuOTI4Yy0xLjA3MiAxLjA3Mi0xLjA3MiAyLjgyNyAwIDMuOTA2bDQuNTk2IDQuNTk2Yy4zNzQuMzc0LjU4Ni44OC41ODYgMS40MTR2My4yMDJjLS45NC4wNS0xLjg1NS4zNzktMi41My45NDNsLTEuNzM2IDEuNzM3YTEuNSAxLjUgMCAwMS0yLjEyMiAwTDMgMTkuNWExLjUgMS41IDAgMDEgMC0yLjEyMWwxLjczNy0xLjczN2MuNTY0LS41NjQgMS4yMzYtLjkxNCAxLjk0My0uOTk2YTQuNDgzIDQuNDgzIDAgMDEtLjY4LS44NDhWMTMuNWExLjUgMS41IDAgMDEtLjQ0LTEuMDYxTDEuNDQ3IDkuMDA5QTcuNSA3LjUgMCAwMSA0IDQuNUMyLjQ4IDEuNSA1LjMzNCAxLjUgNy4wMyA1LjAzaDEuOTQzYy4wMy4zNjIuMTE4LjcxLjI2IDEuMDQzTDQuNDMgMTAuODNjLS44NTEuNDUtMS40MyAxLjMyMi0xLjQzIDIuMjQ4djIuODQ4YzAgMS4zMy42NzIgMi41MzMgMS42ODggMy4yMThhLjc1Ljc1IDAgMTEtLjgyMiAxLjE4NEEzLjAwMiAzLjAwMiAwIDAgMSA0IDE2LjM0OFYxMS4yNXoiIGNsaXAtcnVsZT0iZXZlbm9kZCIgLz4KPC9zdmc+",oe={__name:"PromptCard",props:{prompt:{type:Object,required:!0},task:{type:Object,default:null},isStarred:{type:Boolean,default:!1}},emits:["star","install","update","uninstall","help","edit","view-task","cancel-install"],setup(r,{emit:m}){return(v,i)=>(l(),n("div",Ot,[e("div",Rt,[e("img",{src:r.prompt.icon||ae,alt:r.prompt.name,class:"card-icon"},null,8,Qt),e("div",Zt,[e("div",Vt,[e("h3",{class:"card-title",title:r.prompt.name},c(r.prompt.name),9,Yt),e("button",{onClick:i[0]||(i[0]=H(g=>v.$emit("star"),["stop"])),class:Q(["p-1.5 rounded-full transition-colors flex-shrink-0",r.isStarred?"bg-yellow-400/20 text-yellow-500":"text-gray-400 hover:text-yellow-500"])},[r.isStarred?(l(),A(bt,{key:0,class:"w-5 h-5"})):(l(),A(kt,{key:1,class:"w-5 h-5"}))],2)]),e("div",Ft,[r.prompt.is_installed?(l(),n("span",_t,"Installed")):p("",!0),r.prompt.author?(l(),n("span",Gt,"by "+c(r.prompt.author),1)):p("",!0),r.prompt.category?(l(),n("span",Wt,c(r.prompt.category),1)):p("",!0),r.prompt.version?(l(),n("span",Bt,"v"+c(r.prompt.version),1)):p("",!0)])])]),e("div",qt,[e("p",{class:"card-description",title:r.prompt.description},c(r.prompt.description),9,Ht)]),r.prompt.repository?(l(),n("div",Kt,[y(wt,{class:"w-3 h-3"}),e("span",{class:"truncate",title:`From: ${r.prompt.repository}`},c(r.prompt.repository),9,Jt)])):p("",!0),e("div",Xt,[e("div",te,[r.task?(l(),A(Lt,{key:0,task:r.task,onView:i[1]||(i[1]=g=>v.$emit("view-task",r.task.id)),onCancel:i[2]||(i[2]=g=>v.$emit("cancel-install"))},null,8,["task"])):(l(),n("div",ee,[r.prompt.is_installed?r.prompt.update_available?(l(),n("button",{key:1,onClick:i[4]||(i[4]=g=>v.$emit("update",r.prompt)),class:"btn btn-warning w-full"},[y(Pt,{class:"w-4 h-4 mr-2"}),i[9]||(i[9]=b("Update "))])):(l(),n("button",{key:2,onClick:i[5]||(i[5]=g=>v.$emit("edit",r.prompt)),class:"btn btn-secondary w-full"},[y(xt,{class:"w-4 h-4 mr-2"}),i[10]||(i[10]=b("Edit "))])):(l(),n("button",{key:0,onClick:i[3]||(i[3]=g=>v.$emit("install",r.prompt)),class:"btn btn-primary w-full"},[y(jt,{class:"w-4 h-4 mr-2"}),i[8]||(i[8]=b("Install "))]))]))]),e("div",se,[r.prompt.has_readme?(l(),n("button",{key:0,onClick:i[6]||(i[6]=g=>v.$emit("help",r.prompt)),class:"btn btn-secondary p-2",title:"Help"},[y(Nt,{class:"w-4 h-4"})])):p("",!0),r.prompt.is_installed?(l(),n("button",{key:1,onClick:i[7]||(i[7]=g=>v.$emit("uninstall",r.prompt)),class:"btn btn-danger-outline p-2",title:"Uninstall"},[y(K,{class:"w-4 h-4"})])):p("",!0)])])]))}},le=q(oe,[["__scopeId","data-v-2d5cc041"]]),ne={class:"space-y-6"},ie={class:"border-b border-gray-200 dark:border-gray-700"},re={class:"-mb-px flex space-x-6"},de={key:0},ue={class:"flex justify-between items-center mb-4"},ce={class:"flex gap-2"},pe={class:"space-y-4"},me={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},ye={class:"relative lg:col-span-1"},ve={class:"grid grid-cols-1 sm:grid-cols-3 lg:col-span-3 gap-4"},ge=["value"],Me=["value"],fe={class:"flex items-center gap-2"},be=["value"],ke={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},we={key:1,class:"empty-state-card"},Le={key:2},je={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},xe={key:0,class:"flex justify-between items-center mt-6"},Ne=["disabled"],Ae={class:"text-sm text-gray-600 dark:text-gray-400"},Se=["disabled"],he={key:1},Ie={class:"flex justify-between items-center mb-4"},Ce={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},De={class:"flex items-center gap-x-4"},$e={key:0},ze=["required"],Te={key:1},Pe=["required"],Ue={key:1,class:"text-center p-4"},Ee={key:2,class:"empty-state-card"},Oe={key:3,class:"space-y-4"},Re={class:"font-semibold"},Qe={class:"text-sm text-gray-500"},Ze={class:"text-xs text-gray-400"},Ve={class:"flex items-center gap-2"},Ye=["onClick"],Fe=["onClick"],_e={__name:"PromptsManagement",setup(r){const m=Tt(),v=At(),i=St(),g=ht(),{on:J,off:X}=Ct(),{promptFilters:o}=m,{promptZooRepositories:Z,isLoadingPromptZooRepositories:tt,zooPrompts:C,isLoadingZooPrompts:et}=R(m),{systemPrompts:V,isLoading:st}=R(g),{tasks:at}=R(v),k=j("zoo"),d=j({type:"git",name:"",url:"",path:""}),S=j(!1),w=j(null),h=j(JSON.parse(localStorage.getItem("starredPrompts")||"[]"));let Y=null;const U=j(null),D=f({get:()=>o.currentPage,set:a=>{o.currentPage=a}}),E=f(()=>C.value.total||0),F=f(()=>C.value.pages||1),ot=f(()=>{if(E.value===0)return"Showing 0-0 of 0";const a=(o.currentPage-1)*o.pageSize+1,t=Math.min(o.currentPage*o.pageSize,E.value);return`Showing ${a}-${t} of ${E.value}`});async function I(){const a={page:o.currentPage,page_size:o.pageSize,sort_by:o.sortKey,sort_order:o.sortOrder,category:o.selectedCategory!=="All"?o.selectedCategory:void 0,repository:o.selectedRepository!=="All"?o.selectedRepository:void 0,search_query:o.searchQuery||void 0,installation_status:o.installationStatusFilter!=="All"?o.installationStatusFilter:void 0};await m.fetchZooPrompts(a)}const _=f(()=>{const a=new Map;return(at.value||[]).forEach(t=>{var s;if((s=t==null?void 0:t.name)!=null&&s.startsWith("Installing prompt: ")&&(t.status==="running"||t.status==="pending")){const L=t.name.replace("Installing prompt: ","");a.set(L,t)}}),(C.value.items||[]).map(t=>({...t,task:a.get(t.folder_name)||null}))});function lt(){clearTimeout(Y),Y=setTimeout(()=>{o.currentPage!==1?o.currentPage=1:I()},300)}z(()=>[o.sortKey,o.sortOrder,o.selectedCategory,o.installationStatusFilter,o.selectedRepository],()=>{o.currentPage!==1?o.currentPage=1:I()}),z(()=>o.searchQuery,lt),z(()=>o.currentPage,I),z(h,a=>{localStorage.setItem("starredPrompts",JSON.stringify(a))},{deep:!0}),It(()=>{g.fetchPrompts(),m.fetchPromptZooRepositories(),I(),J("task:completed",G)}),Dt(()=>{X("task:completed",G)});const $=f(()=>Array.isArray(Z.value)?[...Z.value].sort((a,t)=>(a.name||"").localeCompare(t.name||"")):[]),nt=f(()=>["All","Starred",...C.value.categories||[]]),it=[{value:"name",label:"Name"},{value:"author",label:"Author"},{value:"last_update_date",label:"Last Updated"},{value:"creation_date",label:"Creation Date"}];function rt(a){return a?new Date(a).toLocaleString():"Never"}async function dt(){if(!d.value.name){i.addNotification("Repository name is required.","warning");return}const a={name:d.value.name};d.value.type==="git"?a.url=d.value.url:a.path=d.value.path,w.value="add";try{await m.addPromptZooRepository(a),d.value={type:"git",name:"",url:"",path:""},S.value=!1}finally{w.value=null}}async function ut(a){w.value=a.id;try{await m.pullPromptZooRepository(a.id)}finally{w.value=null}}async function ct(a){if(await i.showConfirmation({title:`Delete Repository '${a.name}'?`})){w.value=a.id;try{await m.deletePromptZooRepository(a.id)}finally{w.value=null}}}async function pt(a){await m.installZooPrompt({repository:a.repository,folder_name:a.folder_name})}async function mt(a){const t=V.value.find(s=>s.name===a.name);t&&await i.showConfirmation({title:`Uninstall '${a.name}'?`,message:"This will remove the prompt from the system."})&&(await m.deleteSystemPrompt(t.id),await I())}async function yt(a){const t=await m.fetchPromptReadme(a.repository,a.folder_name);i.openModal("sourceViewer",{title:`README: ${a.name}`,content:t,language:"markdown"})}function vt(a){const t=h.value.indexOf(a);t>-1?h.value.splice(t,1):h.value.push(a)}function gt(){i.openModal("generatePrompt",{isSystemPrompt:!0,onTaskSubmitted:a=>{U.value=a}})}function G(a){a&&a.id===U.value&&(U.value=null,i.isModalOpen("tasksManager")&&i.closeModal("tasksManager"),a.status==="completed"&&a.result?O(a.result):i.addNotification("Prompt generation did not complete successfully.","warning"))}async function Mt(a){const t=V.value.find(s=>s.name===a.name);t&&await m.updateSystemPromptFromZoo(t.id)}function O(a){i.openModal("editPrompt",{prompt:{...a},isSystemPrompt:!0})}async function ft(){const a=await m.refreshZooCache();a&&i.openModal("tasksManager",{initialTaskId:a.id})}return(a,t)=>(l(),n("div",ne,[e("div",ie,[e("nav",re,[e("button",{onClick:t[0]||(t[0]=s=>k.value="zoo"),class:Q(["tab-button",k.value==="zoo"?"active":"inactive"])},"Zoo",2),e("button",{onClick:t[1]||(t[1]=s=>k.value="source"),class:Q(["tab-button",k.value==="source"?"active":"inactive"])},"Repositories",2)])]),k.value==="zoo"?(l(),n("section",de,[e("div",ue,[t[18]||(t[18]=e("h3",{class:"text-xl font-semibold"},"Prompts Zoo",-1)),e("div",ce,[e("button",{onClick:ft,class:"btn btn-secondary",title:"Refresh Zoo Cache from all sources"},[y(W,{class:"w-4 h-4"})]),e("button",{onClick:gt,class:"btn btn-secondary"},[y($t,{class:"w-4 h-4 mr-2"}),t[17]||(t[17]=b(" Generate with AI "))]),e("button",{onClick:t[2]||(t[2]=s=>O({})),class:"btn btn-primary"},"Create New Prompt")])]),e("div",pe,[e("div",me,[e("div",ye,[M(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>u(o).searchQuery=s),type:"text",placeholder:"Search Prompts...",class:"input-field w-full pl-10"},null,512),[[T,u(o).searchQuery]]),t[19]||(t[19]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),e("div",ve,[M(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>u(o).installationStatusFilter=s),class:"input-field"},t[20]||(t[20]=[e("option",{value:"All"},"All Statuses",-1),e("option",{value:"Installed"},"Installed",-1),e("option",{value:"Uninstalled"},"Uninstalled",-1)]),512),[[P,u(o).installationStatusFilter]]),M(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>u(o).selectedCategory=s),class:"input-field"},[(l(!0),n(x,null,N(nt.value,s=>(l(),n("option",{key:s,value:s},c(s),9,ge))),128))],512),[[P,u(o).selectedCategory]]),M(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>u(o).selectedRepository=s),class:"input-field"},[t[21]||(t[21]=e("option",{value:"All"},"All Sources",-1)),(l(!0),n(x,null,N($.value,s=>(l(),n("option",{key:s.id,value:s.name},c(s.name),9,Me))),128))],512),[[P,u(o).selectedRepository]])])]),e("div",fe,[M(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>u(o).sortKey=s),class:"input-field w-48"},[(l(),n(x,null,N(it,s=>e("option",{key:s.value,value:s.value},"Sort by "+c(s.label),9,be)),64))],512),[[P,u(o).sortKey]]),e("button",{onClick:t[8]||(t[8]=s=>u(o).sortOrder=u(o).sortOrder==="asc"?"desc":"asc"),class:"btn btn-secondary p-2"},[u(o).sortOrder==="asc"?(l(),A(Et,{key:0,class:"w-5 h-5"})):(l(),A(zt,{key:1,class:"w-5 h-5"}))])]),u(et)||u(st)?(l(),n("div",ke,[(l(),n(x,null,N(6,s=>y(Ut,{key:s})),64))])):_.value.length===0?(l(),n("div",we,t[22]||(t[22]=[e("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(l(),n("div",Le,[e("div",je,[(l(!0),n(x,null,N(_.value,s=>(l(),A(le,{key:s.id||`${s.repository}/${s.folder_name}`,prompt:s,task:s.task,"is-starred":h.value.includes(s.name),onStar:L=>vt(s.name),onInstall:pt,onUninstall:mt,onHelp:yt,onUpdate:L=>Mt(s),onEdit:L=>O(s)},null,8,["prompt","task","is-starred","onStar","onUpdate","onEdit"]))),128))]),F.value>1?(l(),n("div",xe,[e("button",{onClick:t[9]||(t[9]=s=>D.value--),disabled:D.value===1,class:"btn btn-secondary"},"Previous",8,Ne),e("span",Ae,c(ot.value),1),e("button",{onClick:t[10]||(t[10]=s=>D.value++),disabled:D.value>=F.value,class:"btn btn-secondary"},"Next",8,Se)])):p("",!0)]))])])):p("",!0),k.value==="source"?(l(),n("section",he,[e("div",Ie,[t[23]||(t[23]=e("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),e("button",{onClick:t[11]||(t[11]=s=>S.value=!S.value),class:"btn btn-primary"},c(S.value?"Cancel":"Add"),1)]),S.value?(l(),n("div",Ce,[e("form",{onSubmit:H(dt,["prevent"]),class:"space-y-4"},[e("div",De,[e("label",null,[M(e("input",{type:"radio","onUpdate:modelValue":t[12]||(t[12]=s=>d.value.type=s),value:"git",class:"radio-input"},null,512),[[B,d.value.type]]),t[24]||(t[24]=b(" Git"))]),e("label",null,[M(e("input",{type:"radio","onUpdate:modelValue":t[13]||(t[13]=s=>d.value.type=s),value:"local",class:"radio-input"},null,512),[[B,d.value.type]]),t[25]||(t[25]=b(" Local"))])]),e("div",null,[t[26]||(t[26]=e("label",null,"Name",-1)),M(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>d.value.name=s),type:"text",class:"input-field",required:""},null,512),[[T,d.value.name]])]),d.value.type==="git"?(l(),n("div",$e,[t[27]||(t[27]=e("label",null,"URL",-1)),M(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>d.value.url=s),type:"url",class:"input-field",required:d.value.type==="git"},null,8,ze),[[T,d.value.url]])])):p("",!0),d.value.type==="local"?(l(),n("div",Te,[t[28]||(t[28]=e("label",null,"Path",-1)),M(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>d.value.path=s),type:"text",class:"input-field",required:d.value.type==="local"},null,8,Pe),[[T,d.value.path]])])):p("",!0),t[29]||(t[29]=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"btn btn-primary"},"Add")],-1))],32)])):p("",!0),u(tt)?(l(),n("div",Ue,"Loading...")):!$.value||$.value.length===0?(l(),n("div",Ee,t[30]||(t[30]=[e("p",null,"No repositories added.",-1)]))):(l(),n("div",Oe,[(l(!0),n(x,null,N($.value,s=>(l(),n("div",{key:s.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between"},[e("div",null,[e("p",Re,c(s.name),1),e("p",Qe,c(s.url),1),e("p",Ze,"Pulled: "+c(rt(s.last_pulled_at)),1)]),e("div",Ve,[e("button",{onClick:L=>ut(s),class:"btn btn-secondary btn-sm"},[y(W,{class:"w-4 h-4 mr-1"}),b(c(s.type==="git"?"Pull":"Rescan"),1)],8,Ye),s.is_deletable?(l(),n("button",{key:0,onClick:L=>ct(s),class:"btn btn-danger btn-sm"},[y(K,{class:"w-4 h-4"})],8,Fe)):p("",!0)])]))),128))]))])):p("",!0)]))}},He=q(_e,[["__scopeId","data-v-627a4ae3"]]);export{He as default};
