import{u as M,az as I,r as y,d as L,b as w,c as n,o as r,a as e,J as V,K as $,A as x,g as p,G as f,n as _,aM as q,f as k,al as T,M as R,t as c,F as B,j as U,h as C,av as j,aq as z}from"./index-CQBOoy6t.js";import{u as D}from"./admin-aF6xYx2X.js";const P={class:"space-y-6"},E={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},G={class:"flex items-center gap-2"},J=["disabled"],K=["disabled"],O={class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg overflow-hidden border dark:border-gray-700"},Q={class:"overflow-x-auto"},H={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},W={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},X={key:0},Y={key:1},Z={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono"},te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 font-mono"},ae={class:"px-6 py-4 whitespace-nowrap"},se={key:0,class:"text-[10px] text-orange-500 mt-1 flex items-center"},re={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ne={class:"flex justify-end gap-2"},ie=["onClick","disabled"],oe={key:1},le=["onClick","disabled"],xe={__name:"RequirementsManagement",setup(de){const i=D(),o=M(),{systemRequirements:g,isLoadingRequirements:m}=I(i),u=y(""),l=y(null),d=y(!1);L(()=>{i.fetchRequirements()});const h=w(()=>{if(!u.value)return g.value;const s=u.value.toLowerCase();return g.value.filter(t=>t.name.toLowerCase().includes(s))}),b=w(()=>g.value.some(s=>s.status!=="ok"));async function v(s,t){l.value=s.name;try{await i.installRequirement(s.name,t),o.addNotification(`Installation task started for ${s.name}`,"info")}catch(a){console.error(a),o.addNotification("Installation failed to start","error")}finally{l.value=null}}async function N(){if(!b.value){o.addNotification("All requirements are already satisfied.","info");return}d.value=!0;try{await i.fixAllRequirements(),o.addNotification("Fix all requirements task started. Check tasks for progress.","info")}catch(s){console.error(s),o.addNotification("Failed to start fix all requirements task","error")}finally{d.value=!1}}function S(s){switch(s){case"ok":return"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400";case"newer":return"text-orange-600 bg-orange-100 dark:bg-orange-900/30 dark:text-orange-400";case"older":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";case"missing":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";default:return"text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-400"}}function A(s){switch(s){case"ok":return"Match";case"newer":return"Newer";case"older":return"Outdated";case"missing":return"Missing";default:return"Unknown"}}return(s,t)=>(r(),n("div",P,[e("div",E,[t[3]||(t[3]=e("div",null,[e("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"},"System Requirements"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Monitor and manage python dependencies.")],-1)),e("div",G,[V(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),placeholder:"Search libraries...",class:"input-field-sm w-48"},null,512),[[$,u.value]]),e("button",{onClick:t[1]||(t[1]=a=>x(i).fetchRequirements()),class:"btn btn-secondary btn-sm",disabled:x(m)},[p(q,{class:_(["w-4 h-4 mr-2",{"animate-spin":x(m)}])},null,8,["class"]),t[2]||(t[2]=f(" Refresh "))],8,J),e("button",{onClick:N,class:"btn btn-primary btn-sm",disabled:d.value||!b.value,title:"Install correct versions for all requirements that are not satisfied"},[d.value?(r(),k(R,{key:1,class:"w-4 h-4 mr-2 animate-spin"})):(r(),k(T,{key:0,class:"w-4 h-4 mr-2"})),f(" "+c(d.value?"Fixing...":"Fix All"),1)],8,K)])]),e("div",O,[e("div",Q,[e("table",H,[t[7]||(t[7]=e("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Library"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Required"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Installed"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Status"),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",W,[x(m)?(r(),n("tr",X,t[4]||(t[4]=[e("td",{colspan:"5",class:"px-6 py-10 text-center text-gray-500"},"Loading requirements...",-1)]))):h.value.length===0?(r(),n("tr",Y,t[5]||(t[5]=[e("td",{colspan:"5",class:"px-6 py-10 text-center text-gray-500"},"No libraries found.",-1)]))):(r(!0),n(B,{key:2},U(h.value,a=>(r(),n("tr",{key:a.name,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",Z,c(a.name),1),e("td",ee,c(a.required_version),1),e("td",te,c(a.installed_version),1),e("td",ae,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",S(a.status)])},c(A(a.status)),3),a.status==="newer"?(r(),n("div",se,[p(j,{class:"w-3 h-3 mr-1"}),t[6]||(t[6]=f(" Potential incompatibility "))])):C("",!0)]),e("td",re,[e("div",ne,[a.status!=="ok"&&a.required_version!=="Any"?(r(),n("button",{key:0,onClick:F=>v(a,a.required_version),disabled:l.value===a.name,class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 disabled:opacity-50",title:"Install Required Version"},[l.value===a.name?(r(),k(R,{key:0,class:"w-5 h-5 animate-spin"})):(r(),n("span",oe,"Fix Version"))],8,ie)):C("",!0),e("button",{onClick:F=>v(a,null),disabled:l.value===a.name,class:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 disabled:opacity-50 ml-2",title:"Update to Latest (May be incompatible)"},[p(z,{class:"w-5 h-5"})],8,le)])])]))),128))])])])])]))}};export{xe as default};
