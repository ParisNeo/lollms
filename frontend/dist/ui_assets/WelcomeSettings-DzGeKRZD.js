import{a4 as le,u as se,T as oe,L as g,c as L,l as ne,m as D,e as r,o as n,b as t,a as re,g as k,d as m,K as p,a0 as C,ac as F,O as ie,t as y,n as f,cr as de,f as d,P,h as _,z as U,Y as V,F as j,r as W,aw as E,az as O,aq as ce,an as ue}from"./index-CZ57W16T.js";import{u as ge}from"./admin-oSQkGxSZ.js";import me from"./GenerateFunFactsModal-DtPUM8VH.js";import"./GenericModal-Bo823HoA.js";const fe={class:"space-y-10"},ve={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},be={key:0,class:"p-6 text-center text-gray-500"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"mt-2 flex items-center gap-x-4"},_e=["src"],xe=["disabled"],we={class:"pt-6 mt-6 border-t dark:border-gray-700 space-y-6"},he={class:"flex items-center justify-between p-4 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-100 dark:border-yellow-900/30 rounded-xl"},ke={key:0,class:"space-y-4 animate-fade-in"},Ce={class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},Fe={class:"flex items-center gap-2 mb-2 text-blue-600 dark:text-blue-400"},Se={class:"flex justify-end pt-4 border-t dark:border-gray-700"},Le=["disabled"],$e={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg flex flex-col h-[800px]"},Me={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center flex-wrap gap-2 flex-shrink-0"},Ne={class:"flex gap-2"},Ie={class:"p-6 grid grid-cols-1 lg:grid-cols-2 gap-8 flex-grow min-h-0"},Ae={class:"flex flex-col min-h-0 h-full"},Re={class:"flex justify-between items-center mb-4 flex-shrink-0"},Te={class:"flex items-center gap-2"},De={class:"border rounded-lg overflow-hidden dark:border-gray-700 flex-grow min-h-0 bg-gray-50 dark:bg-gray-900/50"},Pe={key:0,class:"p-4 text-center text-gray-500"},Ue={key:1,class:"divide-y dark:divide-gray-700 overflow-y-auto h-full"},Ve=["onClick"],je={class:"flex items-center gap-2 flex-shrink-0"},We=["onClick","title"],Ee=["onClick"],Oe=["onClick"],Be=["onClick"],Ge={class:"flex items-center gap-3 min-w-0 flex-grow pl-2 border-l dark:border-gray-700 ml-1"},Je={class:"flex flex-col min-h-0 h-full"},ze={class:"flex justify-between items-center mb-4 flex-shrink-0"},Ye={class:"font-semibold text-lg truncate pr-2"},qe={class:"flex items-center gap-2"},Ke=["disabled"],He=["disabled"],Qe={class:"border rounded-lg overflow-hidden dark:border-gray-700 flex-grow min-h-0 bg-gray-50 dark:bg-gray-900/50"},Xe={key:0,class:"p-4 text-center text-gray-500"},Ze={key:1,class:"p-10 text-center text-gray-500 italic flex flex-col items-center justify-center h-full"},et={key:2,class:"divide-y dark:divide-gray-700 overflow-y-auto h-full"},tt={class:"flex items-center gap-1 flex-shrink-0 mt-0.5"},at=["onClick"],lt=["onClick"],st={class:"text-sm flex-grow leading-relaxed border-l dark:border-gray-700 pl-3 ml-1"},ot={key:0,class:"p-8 text-center text-gray-400 text-sm italic"},nt={__name:"WelcomeSettings",setup(rt){const o=ge(),u=se(),{globalSettings:$,funFacts:B,funFactCategories:M,isLoadingFunFacts:G,isLoadingFunFactCategories:J}=oe(o),s=g({welcome_text:"",welcome_slogan:"",welcome_logo_url:"",force_welcome_message:!1,forced_welcome_message_title:"",forced_welcome_message_content:""}),x=g(!1),w=g(!1),v=g(!1),b=g(null),h=g(null);let S="{}";const i=g(null),N=L(()=>$.value.filter(a=>a.category==="Welcome Page")),I=L(()=>i.value?B.value.filter(a=>a.category.id===i.value):[]),z=L(()=>{if(!i.value)return"Select a Category";const a=M.value.find(e=>e.id===i.value);return a?a.name:"Select a Category"});ne(()=>{o.fetchGlobalSettings(),o.fetchFunFacts(),o.fetchFunFactCategories()}),D(()=>$.value,Y,{deep:!0,immediate:!0}),D(s,a=>{v.value=JSON.stringify(a)!==S},{deep:!0});function Y(){if(N.value.length>0){const a=N.value.reduce((e,l)=>(e[l.key]=l.value,e),{});s.value.welcome_text=a.welcome_text||"",s.value.welcome_slogan=a.welcome_slogan||"",s.value.welcome_logo_url=a.welcome_logo_url||"",s.value.force_welcome_message=a.force_welcome_message||!1,s.value.forced_welcome_message_title=a.forced_welcome_message_title||"System Announcement",s.value.forced_welcome_message_content=a.forced_welcome_message_content||"",S=JSON.stringify(s.value),v.value=!1,h.value=null,b.value=null}}function q(a){const e=a.target.files[0];if(e&&e.type.startsWith("image/")){b.value=e;const l=new FileReader;l.onload=c=>{h.value=c.target.result},l.readAsDataURL(e),v.value=!0}}async function K(){w.value=!0;try{await o.removeWelcomeLogo()}finally{w.value=!1}}async function H(){x.value=!0;try{const a={welcome_text:s.value.welcome_text,welcome_slogan:s.value.welcome_slogan,force_welcome_message:s.value.force_welcome_message,forced_welcome_message_title:s.value.forced_welcome_message_title,forced_welcome_message_content:s.value.forced_welcome_message_content},e=[o.updateGlobalSettings(a)];b.value&&e.push(o.uploadWelcomeLogo(b.value)),await Promise.all(e),S=JSON.stringify(s.value),v.value=!1,b.value=null,h.value=null}finally{x.value=!1}}function A(a=null){u.openModal("funFactCategory",{category:a,onSave:o.fetchFunFactCategories})}function R(a=null){if(!i.value&&!a){u.addNotification("Please select a category first.","warning");return}u.openModal("funFact",{fact:a,preselectedCategoryId:i.value,onSave:o.fetchFunFacts})}async function Q(a){await u.showConfirmation({title:"Delete Category?",message:`Permanently delete "${a.name}" and all facts inside?`,confirmText:"Delete All"})&&(await o.deleteFunFactCategory(a.id),i.value===a.id&&(i.value=null))}async function X(a){await u.showConfirmation({title:"Delete Fun Fact?",message:"Are you sure?",confirmText:"Delete"})&&await o.deleteFunFact(a.id)}async function Z(a){await o.exportCategory(a.id,a.name)}async function ee(a){const e=a.target.files[0];e&&await o.importCategoryFromFile(e),a.target.value=""}async function te(){await o.exportFunFacts()}function T(a=5){u.openModal("generateFunFacts",{categoryId:i.value,nFacts:a})}async function ae(a){const e=!a.is_active,l=a.is_active;a.is_active=e;try{await o.updateFunFactCategory(a.id,{is_active:e})}catch{a.is_active=l,u.addNotification("Failed to update category status.","error")}}return(a,e)=>(n(),r("div",fe,[t("div",ve,[e[20]||(e[20]=t("div",{class:"p-6 border-b dark:border-gray-700"},[t("h3",{class:"text-xl font-semibold"},"Welcome Page Branding"),t("p",{class:"text-sm text-gray-500 mt-1"},"Configure text and visuals for the login and splash screens.")],-1)),m(o).isLoadingSettings&&!Object.keys(s.value).length?(n(),r("div",be,"Loading...")):(n(),r("form",{key:1,onSubmit:p(H,["prevent"]),class:"p-6 space-y-6"},[t("div",pe,[t("div",null,[e[11]||(e[11]=t("label",{for:"welcome_text",class:"label"},"Main Branding Text",-1)),C(t("input",{id:"welcome_text","onUpdate:modelValue":e[0]||(e[0]=l=>s.value.welcome_text=l),type:"text",class:"input-field mt-1",placeholder:"LoLLMs"},null,512),[[F,s.value.welcome_text]])]),t("div",null,[e[12]||(e[12]=t("label",{for:"welcome_slogan",class:"label"},"Slogan",-1)),C(t("input",{id:"welcome_slogan","onUpdate:modelValue":e[1]||(e[1]=l=>s.value.welcome_slogan=l),type:"text",class:"input-field mt-1",placeholder:"One tool to rule them all"},null,512),[[F,s.value.welcome_slogan]])])]),t("div",null,[e[13]||(e[13]=t("label",{class:"label"},"Custom Logo",-1)),t("div",ye,[t("img",{src:h.value||s.value.welcome_logo_url||m(ie),alt:"Logo Preview",class:"h-16 w-16 object-contain rounded-md bg-gray-100 dark:bg-gray-700 p-1 border dark:border-gray-600"},null,8,_e),t("input",{type:"file",onChange:q,accept:"image/*",class:"hidden",ref:"logoInput"},null,544),t("button",{type:"button",onClick:e[2]||(e[2]=l=>a.$refs.logoInput.click()),class:"btn btn-secondary"},"Change"),s.value.welcome_logo_url?(n(),r("button",{key:0,type:"button",onClick:K,class:"btn btn-danger-outline",disabled:w.value},y(w.value?"Removing...":"Remove"),9,xe)):k("",!0)])]),t("div",we,[t("div",he,[e[14]||(e[14]=t("div",{class:"flex flex-col"},[t("span",{class:"text-sm font-bold text-yellow-800 dark:text-yellow-400 uppercase tracking-widest"},"System-wide Announcement"),t("span",{class:"text-xs text-gray-600 dark:text-gray-400 mt-1"},"Replace random fun facts with a specific message for all users.")],-1)),t("button",{onClick:e[3]||(e[3]=l=>s.value.force_welcome_message=!s.value.force_welcome_message),type:"button",class:f([s.value.force_welcome_message?"bg-yellow-500":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:f([s.value.force_welcome_message?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),s.value.force_welcome_message?(n(),r("div",ke,[t("div",null,[e[15]||(e[15]=t("label",{class:"label"},"Announcement Title",-1)),C(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.forced_welcome_message_title=l),type:"text",class:"input-field mt-1",placeholder:"Maintenance, New Feature, etc."},null,512),[[F,s.value.forced_welcome_message_title]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"label"},"Announcement Content (Markdown Supported)",-1)),C(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.forced_welcome_message_content=l),rows:"4",class:"input-field mt-1",placeholder:"Write your message here..."},null,512),[[F,s.value.forced_welcome_message_content]])]),t("div",Ce,[t("div",Fe,[d(P,{class:"w-4 h-4"}),e[17]||(e[17]=t("span",{class:"text-xs font-bold uppercase tracking-wider"},"Markdown Cheat Sheet",-1))]),e[18]||(e[18]=de('<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-[11px] font-mono leading-relaxed" data-v-f853ab7b><div data-v-f853ab7b><p class="text-gray-400 mb-1 font-sans" data-v-f853ab7b>Links</p><code class="text-blue-500" data-v-f853ab7b>[Text](URL)</code></div><div data-v-f853ab7b><p class="text-gray-400 mb-1 font-sans" data-v-f853ab7b>Images</p><code class="text-green-500" data-v-f853ab7b>![Alt](IMG_URL)</code></div><div data-v-f853ab7b><p class="text-gray-400 mb-1 font-sans" data-v-f853ab7b>Video (YouTube)</p><code class="text-red-500" data-v-f853ab7b>Just paste the full URL on a new line</code></div></div>',1))]),e[19]||(e[19]=t("div",{class:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-xs text-blue-800 dark:text-blue-300"}," ðŸ’¡ Users can click this message on the splash screen to keep it visible while they read. ",-1))])):k("",!0)]),t("div",Se,[t("button",{type:"submit",class:"btn btn-primary",disabled:x.value||!v.value},y(x.value?"Saving...":"Save Settings"),9,Le)])],32))]),t("div",$e,[t("div",Me,[e[21]||(e[21]=t("h3",{class:"text-xl font-semibold"},"Fun Facts Repository",-1)),t("div",Ne,[t("button",{onClick:e[6]||(e[6]=l=>a.$refs.importInput.click()),class:"btn btn-secondary btn-sm"},"Import Category"),t("input",{type:"file",ref:"importInput",onChange:ee,accept:".json",class:"hidden"},null,544),t("button",{onClick:te,class:"btn btn-secondary btn-sm"},"Export All")])]),t("div",Ie,[t("div",Ae,[t("div",Re,[e[24]||(e[24]=t("h4",{class:"font-semibold text-lg"},"Categories",-1)),t("div",Te,[t("button",{onClick:e[7]||(e[7]=l=>T(5)),class:"btn btn-secondary btn-sm"},[d(U,{class:"w-4 h-4 mr-1"}),e[22]||(e[22]=_(" AI Generate"))]),t("button",{onClick:e[8]||(e[8]=l=>A()),class:"btn btn-secondary btn-sm"},[d(V,{class:"w-4 h-4 mr-1"}),e[23]||(e[23]=_("New"))])])]),t("div",De,[m(J)?(n(),r("div",Pe,"Loading...")):(n(),r("ul",Ue,[(n(!0),r(j,null,W(m(M),l=>(n(),r("li",{key:l.id,onClick:c=>i.value=l.id,class:f(["p-3 flex items-center gap-3 cursor-pointer transition-colors group",i.value===l.id?"bg-blue-100 dark:bg-blue-900/50":"hover:bg-gray-100 dark:hover:bg-gray-800"])},[t("div",je,[t("button",{onClick:p(c=>ae(l),["stop"]),class:"focus:outline-none relative",title:l.is_active?"Deactivate Pack":"Activate Pack"},[t("div",{class:f(["w-9 h-5 rounded-full transition-colors duration-200 shadow-sm border dark:border-gray-600",l.is_active?"bg-green-500 border-green-600":"bg-gray-200 dark:bg-gray-700"])},[t("div",{class:f(["w-3.5 h-3.5 bg-white rounded-full absolute top-0.5 shadow-sm transition-transform duration-200",l.is_active?"translate-x-4.5 left-0.5":"translate-x-0.5 left-0.5"])},null,2)],2)],8,We),t("button",{onClick:p(c=>A(l),["stop"]),class:"p-1.5 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 text-gray-500 hover:text-blue-600 dark:text-gray-400 transition-colors",title:"Edit Category"},[d(E,{class:"w-4 h-4"})],8,Ee),t("button",{onClick:p(c=>Q(l),["stop"]),class:"p-1.5 rounded-full hover:bg-red-200 dark:hover:bg-red-900 text-gray-500 hover:text-red-600 dark:text-gray-400 transition-colors",title:"Delete Category"},[d(O,{class:"w-4 h-4"})],8,Oe),t("button",{onClick:p(c=>Z(l),["stop"]),class:"p-1.5 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 transition-colors",title:"Export JSON"},[d(ce,{class:"w-4 h-4"})],8,Be)]),t("div",Ge,[t("span",{class:"w-4 h-4 rounded-full flex-shrink-0 shadow-sm ring-1 ring-black/5 dark:ring-white/10",style:ue({backgroundColor:l.color})},null,4),t("span",{class:f(["font-medium text-sm truncate",{"line-through opacity-50":!l.is_active}])},y(l.name),3)])],10,Ve))),128))]))])]),t("div",Je,[t("div",ze,[t("h4",Ye,y(z.value),1),t("div",qe,[t("button",{onClick:e[9]||(e[9]=l=>T(1)),disabled:!i.value,class:"btn btn-secondary btn-sm"},[d(U,{class:"w-4 h-4 mr-1"}),e[25]||(e[25]=_(" Generate 1"))],8,Ke),t("button",{onClick:e[10]||(e[10]=l=>R()),disabled:!i.value,class:"btn btn-secondary btn-sm"},[d(V,{class:"w-4 h-4 mr-1"}),e[26]||(e[26]=_("New"))],8,He)])]),t("div",Qe,[m(G)?(n(),r("div",Xe,"Loading...")):i.value?(n(),r("ul",et,[(n(!0),r(j,null,W(I.value,l=>(n(),r("li",{key:l.id,class:"p-3 flex items-start gap-3 hover:bg-gray-100 dark:hover:bg-gray-800 group transition-colors"},[t("div",tt,[t("button",{onClick:c=>R(l),class:"p-1.5 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 text-gray-400 hover:text-blue-600 dark:text-gray-500 dark:hover:text-blue-300 transition-colors",title:"Edit Fact"},[d(E,{class:"w-4 h-4"})],8,at),t("button",{onClick:c=>X(l),class:"p-1.5 rounded-full hover:bg-red-200 dark:hover:bg-red-900 text-gray-400 hover:text-red-600 dark:text-gray-500 dark:hover:text-red-300 transition-colors",title:"Delete Fact"},[d(O,{class:"w-4 h-4"})],8,lt)]),t("p",st,y(l.content),1)]))),128)),I.value.length===0?(n(),r("li",ot," No facts in this category yet. ")):k("",!0)])):(n(),r("div",Ze,[d(P,{class:"w-10 h-10 mb-2 opacity-50"}),e[27]||(e[27]=_(" Select a category to view facts. "))]))])])])]),m(u).activeModal==="generateFunFacts"?(n(),re(me,{key:0})):k("",!0)]))}},gt=le(nt,[["__scopeId","data-v-f853ab7b"]]);export{gt as default};
