import{useAdminStore as w}from"./admin-DaSz6GoL.js";import{a5 as h,u as _,r as u,h as A,l as S,x as L,d as l,o as n,a as s,z as o,j as y,av as g,c as m,a0 as p,t as x,a1 as C,S as z}from"./index-CGf9GErn.js";import{I}from"./IconPlayCircle-B7kFmcQg.js";const T={class:"space-y-6"},j={class:"flex items-center justify-between"},B={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 overflow-hidden"},D={class:"p-6 border-b dark:border-gray-700 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},M=["disabled"],N={class:"p-6"},R={key:0,class:"flex flex-col items-center justify-center py-12 text-blue-600 dark:text-blue-400"},V={key:1,class:"space-y-4"},U={class:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 mb-2"},E={class:"text-gray-500"},F={class:"prose dark:prose-invert max-w-none bg-gray-50 dark:bg-gray-900/50 p-6 rounded-lg border dark:border-gray-700"},P={key:2,class:"text-center py-12 text-gray-500 dark:text-gray-400 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-lg"},K={__name:"LogsAndAnalysis",setup(q){const b=w(),i=h(),f=_(),r=u(null),t=u(!1),k=A(()=>i.tasks.filter(a=>a.name==="Analyze System Logs").sort((a,e)=>new Date(e.created_at)-new Date(a.created_at)));S(k,a=>{var c;const e=a[0];e?e.status==="running"||e.status==="pending"?t.value=!0:(t.value=!1,e.status==="completed"&&((c=e.result)!=null&&c.report)&&(r.value=e.result)):(t.value=!1,r.value=null)},{immediate:!0,deep:!0}),L(()=>{i.fetchTasks()});async function d(){try{await b.analyzeSystemLogs(),setTimeout(()=>i.fetchTasks(),500)}catch{}}function v(){f.openModal("systemLog")}return(a,e)=>(n(),l("div",T,[s("div",j,[e[1]||(e[1]=s("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"},"System Logs & Analysis",-1)),s("button",{onClick:v,class:"btn btn-secondary btn-sm flex items-center gap-2"},[o(g,{class:"w-4 h-4"}),e[0]||(e[0]=y(" View Raw Logs "))])]),s("div",B,[s("div",D,[e[2]||(e[2]=s("div",null,[s("h4",{class:"text-lg font-bold text-gray-900 dark:text-white"},"AI Log Analysis"),s("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Use the AI to scan recent tasks and logs for errors, warnings, and potential issues. ")],-1)),s("button",{onClick:d,disabled:t.value,class:"btn btn-primary flex items-center gap-2"},[t.value?(n(),m(p,{key:0,class:"w-5 h-5 animate-spin"})):(n(),m(I,{key:1,class:"w-5 h-5"})),y(" "+x(t.value?"Analyzing...":"Regenerate Analysis"),1)],8,M)]),s("div",N,[t.value?(n(),l("div",R,[o(p,{class:"w-10 h-10 animate-spin mb-3"}),e[3]||(e[3]=s("p",{class:"font-medium"},"Analyzing system logs...",-1))])):r.value?(n(),l("div",V,[s("div",U,[o(C,{class:"w-5 h-5"}),e[4]||(e[4]=s("span",{class:"font-semibold"},"Analysis Complete",-1)),e[5]||(e[5]=s("span",{class:"text-gray-400 mx-2"},"|",-1)),s("span",E,x(new Date(r.value.generated_at).toLocaleString()),1)]),s("div",F,[o(z,{content:r.value.report},null,8,["content"])])])):(n(),l("div",P,[o(g,{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3"}),e[6]||(e[6]=s("p",null,"No analysis report available.",-1)),s("button",{onClick:d,class:"text-blue-600 hover:underline mt-2"},"Start Analysis")]))])])]))}};export{K as default};
