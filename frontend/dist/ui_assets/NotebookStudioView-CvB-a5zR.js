import{ad as Oe,e as r,o as s,b as a,u as Me,ct as ze,Z as Le,a1 as Ge,g as Je,a2 as Z,L as h,c as M,k as z,j as Fe,a4 as We,a as I,l as b,d as g,P as _,Y as N,f as d,y as F,ac as ve,t as x,J as C,cs as He,an as H,cx as Xe,cm as ge,K as R,F as T,m as $,O as X,ax as qe,p as S,az as L,ap as P,C as Y,ao as Q,ck as ee,a6 as be,am as pe,a7 as fe,T as Ke,a8 as Ze,aC as Ye,aI as Qe,cu as et,R as tt,as as at,V as lt,ay as st,cy as ot,$ as rt}from"./index-x6ZZ9rZx.js";import{I as nt}from"./IconArchiveBox-Co6XjLYi.js";const it={},dt={width:"50px",height:"50px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ut(ye,p){return s(),r("svg",dt,p[0]||(p[0]=[a("path",{d:"M17 17H17.01M17.4 14H18C18.9319 14 19.3978 14 19.7654 14.1522C20.2554 14.3552 20.6448 14.7446 20.8478 15.2346C21 15.6022 21 16.0681 21 17C21 17.9319 21 18.3978 20.8478 18.7654C20.6448 19.2554 20.2554 19.6448 19.7654 19.8478C19.3978 20 18.9319 20 18 20H6C5.06812 20 4.60218 20 4.23463 19.8478C3.74458 19.6448 3.35523 19.2554 3.15224 18.7654C3 18.3978 3 17.9319 3 17C3 16.0681 3 15.6022 3.15224 15.2346C3.35523 14.7446 3.74458 14.3552 4.23463 14.1522C4.60218 14 5.06812 14 6 14H6.6M12 15V4M12 15L9 12M12 15L15 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const ct=Oe(it,[["render",ut]]),vt={class:"h-full w-full flex flex-col overflow-hidden bg-white dark:bg-gray-900"},gt={class:"flex items-center gap-2 w-full max-w-md pointer-events-auto"},bt={class:"flex items-center gap-1"},pt={class:"px-2 py-1 text-[10px] font-black uppercase bg-gray-100 dark:bg-gray-800 text-gray-500 rounded mr-2 border dark:border-gray-700"},ft={key:0,class:"flex bg-gray-100 dark:bg-gray-800 rounded p-0.5 mr-2"},yt={key:0,class:"absolute inset-0 bg-blue-500/10 border-4 border-dashed border-blue-500 rounded-lg z-50 flex items-center justify-center m-4 pointer-events-none"},mt={key:1,class:"bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 pt-1 px-4 flex-shrink-0"},xt={class:"flex items-center justify-between"},ht={class:"flex items-center gap-1 overflow-x-auto custom-scrollbar pb-0 no-scrollbar"},kt=["onClick"],wt=["onClick"],_t={class:"flex-grow flex min-h-0 relative"},Ct={class:"flex-grow flex flex-col min-w-0 border-r dark:border-gray-700 relative"},St={key:0,class:"absolute inset-0 z-30 bg-white/95 dark:bg-gray-900/95 flex flex-col backdrop-blur-sm"},It={class:"p-4 border-b dark:border-gray-700 flex items-center justify-between shadow-sm bg-white dark:bg-gray-800 flex-shrink-0"},Tt={class:"flex items-center gap-3"},$t={class:"font-bold text-sm text-gray-900 dark:text-gray-100"},Nt={class:"text-xs text-gray-500 dark:text-gray-400"},At={class:"text-xs font-mono text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded"},jt={class:"flex-grow overflow-hidden relative"},Dt={class:"text-gray-400 shrink-0"},Vt={key:1,class:"flex-grow overflow-hidden flex flex-col relative h-full"},Ut={key:0,class:"h-full flex overflow-hidden"},Rt={class:"w-64 bg-gray-100 dark:bg-gray-850 border-r dark:border-gray-700 flex flex-col flex-shrink-0"},Pt={class:"flex-grow overflow-y-auto custom-scrollbar p-2 space-y-2"},Bt=["onDragstart","onDrop"],Et=["onClick"],Ot={class:"flex items-center justify-between mb-1"},Mt={class:"text-[10px] font-bold text-gray-400"},zt=["onClick"],Lt={class:"text-xs font-bold truncate mb-1"},Gt={class:"h-16 bg-gray-100 dark:bg-gray-900 rounded overflow-hidden flex items-center justify-center"},Jt=["onClick"],Ft={class:"absolute bg-blue-500 text-white rounded-full p-0.5 shadow-sm"},Wt={class:"flex-grow bg-gray-200 dark:bg-gray-900 flex flex-col relative overflow-hidden"},Ht={class:"flex-grow flex items-center justify-center p-8 overflow-auto"},Xt={key:0,class:"bg-white dark:bg-gray-800 shadow-2xl rounded-xl w-full max-w-4xl aspect-video p-8 flex flex-col relative group overflow-hidden"},qt={key:0,class:"absolute inset-0"},Kt={key:0,class:"w-full h-full p-6 flex flex-col bg-gray-100 dark:bg-gray-900 absolute inset-0 z-30"},Zt={class:"flex justify-between items-center mb-4"},Yt={class:"flex justify-end gap-2"},Qt={key:1,class:"w-full h-full relative group/imgview"},ea={key:1,class:"flex items-center justify-center h-full text-gray-400 italic flex-col gap-2 bg-gray-100 dark:bg-gray-900"},ta={class:"absolute bottom-4 right-4 flex gap-2 opacity-0 group-hover/imgview:opacity-100 transition-opacity"},aa={key:2,class:"absolute bottom-4 left-4 h-16 flex gap-2 overflow-x-auto p-1 bg-white/50 dark:bg-black/20 rounded z-20 backdrop-blur-sm opacity-0 group-hover/imgview:opacity-100 transition-opacity"},la=["onClick"],sa=["onClick"],oa={key:1,class:"flex-grow flex gap-6 h-full"},ra={key:0,class:"w-1/2 flex flex-col gap-2 relative"},na={class:"relative flex-grow bg-gray-100 dark:bg-gray-900 rounded-lg overflow-hidden border dark:border-gray-700 group/img"},ia={key:0,class:"w-full h-full p-4 flex flex-col bg-gray-100 dark:bg-gray-800 absolute inset-0 z-20"},da={class:"flex justify-between items-center mb-2"},ua={key:2,class:"flex items-center justify-center h-full text-gray-400 italic flex-col gap-2"},ca={class:"absolute inset-0 bg-black/50 opacity-0 group-hover/img:opacity-100 transition-opacity flex items-center justify-center gap-2"},va={key:0,class:"h-16 flex gap-2 overflow-x-auto p-1 bg-white/50 dark:bg-black/20 rounded"},ga=["onClick"],ba=["onClick"],pa={key:1,class:"text-gray-500"},fa={class:"bg-white dark:bg-gray-800 border-t dark:border-gray-700 p-4"},ya={class:"flex gap-2"},ma={key:0,value:"update_slide_text"},xa={key:1,class:"h-full flex flex-col"},ha={class:"p-2 bg-gray-100 dark:bg-gray-800 border-b dark:border-gray-700 flex justify-between items-center"},ka={key:2,class:"h-full flex flex-col"},wa={class:"p-2 border-b dark:border-gray-700 flex justify-between items-center bg-white dark:bg-gray-900 flex-shrink-0"},_a={class:"flex gap-1 bg-gray-100 dark:bg-gray-800 rounded p-0.5 border dark:border-gray-700"},Ca={class:"flex-grow overflow-hidden relative"},Sa={key:0,class:"absolute inset-0 overflow-y-auto p-8 custom-scrollbar"},Ia={key:3,class:"h-full overflow-y-auto p-4 custom-scrollbar"},Ta={class:"flex justify-between items-center mb-4 border-b border-gray-300 dark:border-gray-700 pb-2"},$a={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Na=["onClick"],Aa={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-end p-2"},ja={class:"text-white text-xs truncate"},Da={key:1,class:"text-center text-gray-500 py-10 flex flex-col items-center"},Va={key:4,class:"h-full overflow-y-auto p-8 custom-scrollbar bg-gray-100 dark:bg-gray-900"},Ua={class:"mb-4"},Ra={class:"flex gap-6"},Pa={class:"text-2xl font-bold mb-4 border-b pb-2 dark:border-gray-700"},Ba={class:"list-disc pl-5 space-y-2 text-gray-700 dark:text-gray-300"},Ea={key:0,class:"w-1/2 flex flex-col gap-2"},Oa={class:"relative aspect-video bg-gray-200 dark:bg-gray-900 rounded-lg overflow-hidden border dark:border-gray-600"},Ma={key:1,class:"flex items-center justify-center h-full text-gray-400 italic"},za={key:2,class:"flex-grow flex items-center justify-center text-gray-400"},La={key:3,class:"p-3 border-t dark:border-gray-700 bg-white dark:bg-gray-900 flex-shrink-0 z-20"},Ga={class:"flex items-center gap-2 mb-2 overflow-x-auto pb-1 custom-scrollbar"},Ja=["onClick"],Fa={class:"flex gap-2 items-center"},Wa={class:"relative flex-grow"},Ha={class:"absolute right-1 top-1 bottom-1 flex items-center"},Xa=["value"],qa={class:"flex items-center"},Ka=["disabled"],Za={class:"w-64 flex-shrink-0 flex flex-col bg-gray-50 dark:bg-gray-900 border-l dark:border-gray-700"},Ya={class:"p-3 border-b dark:border-gray-700 flex justify-between items-center flex-shrink-0"},Qa={class:"flex gap-1"},el={class:"flex-grow overflow-y-auto p-2 space-y-2 custom-scrollbar"},tl={class:"flex items-center justify-between mb-2"},al={class:"flex items-center gap-2 min-w-0"},ll=["title"],sl={class:"flex items-center"},ol=["onClick"],rl=["onClick"],nl=["onClick"],il={key:0,class:"text-center py-10 text-[10px] uppercase font-bold text-gray-400 opacity-50 italic px-4"},dl={key:3,class:"h-full flex flex-col items-center justify-center text-gray-500 dark:text-gray-400"},vl={__name:"NotebookStudioView",setup(ye){const p=Me(),v=ze(),te=Le(),me=Ge(),xe=Je(),{activeNotebook:u}=Z(v),{tasks:ae}=Z(me),{user:he}=Z(xe),m=h(""),q=h(!1),le=h(null),G=h(!0),k=h(null),B=h(new Set),f=h(""),W=h(null),E=h(!1),j=h("designer"),i=h(0),A=h(!1),V=h(""),K=M(()=>{var l;return!!((l=he.value)!=null&&l.tti_binding_model_name)}),w=M(()=>{var l;return((l=u.value)==null?void 0:l.type)==="slides_making"}),se=M(()=>{var t;const l=((t=u.value)==null?void 0:t.type)||"generic",e=[];return l==="data_analysis"?(e.push({value:"analyze_data",label:"Analyze Data"}),e.push({value:"generate_visualization_code",label:"Generate Plot Code"})):l==="book_building"?(e.push({value:"generate_outline",label:"Generate Outline"}),e.push({value:"write_chapter",label:"Write Chapter"})):l==="slides_making"?(e.push({value:"presentation_outline",label:"Slide Outline"}),e.push({value:"generate_slides_text",label:"Generate Slides"})):l==="benchmarks"&&e.push({value:"generate_test_cases",label:"Gen Test Cases"}),e.push({value:"text",label:"Free Text Gen"}),K.value&&e.push({value:"images",label:"Generate Images"}),e}),D=M(()=>u.value?ae.value.find(l=>(l.name.includes(`Notebook ${u.value.id}`)||l.name.includes(u.value.id))&&(l.status==="running"||l.status==="pending")):null),c=M(()=>!u.value||!u.value.tabs?null:u.value.tabs.find(l=>l.id===k.value)||u.value.tabs[0]);z(u,l=>{l&&l.tabs&&l.tabs.length>0?(!k.value||!l.tabs.find(e=>e.id===k.value))&&(k.value=l.tabs[l.tabs.length-1].id):l&&(!l.tabs||l.tabs.length===0)&&v.addTab()},{immediate:!0}),z(()=>{var l,e;return(e=(l=u.value)==null?void 0:l.tabs)==null?void 0:e.length},(l,e)=>{l>e&&D.value&&(k.value=u.value.tabs[l-1].id)}),z(()=>{var l,e;return(e=(l=D.value)==null?void 0:l.logs)==null?void 0:e.length},()=>{rt(()=>{W.value&&(W.value.scrollTop=W.value.scrollHeight)})},{deep:!0}),z(ae,l=>{if(u.value){const e=l.find(t=>t.status==="completed"&&t.result&&t.result.notebook_id===u.value.id);e&&v.fetchNotebooks().then(()=>{v.selectNotebook(u.value.id),e.result.new_tab_id&&(k.value=e.result.new_tab_id)})}},{deep:!0});const n=M(()=>{if(!c.value)return{};if(c.value.type==="slides"||w.value)try{return typeof c.value.content=="string"?JSON.parse(c.value.content):c.value.content}catch{return{mode:"text",slides_data:[]}}return{}});z(()=>{var e,t,o;const l=(t=(e=n.value)==null?void 0:e.slides_data)==null?void 0:t[i.value];return{idx:i.value,imgIdx:l==null?void 0:l.selected_image_index,imagesLen:(o=l==null?void 0:l.images)==null?void 0:o.length}},l=>{var t,o,y;const e=(o=(t=n.value)==null?void 0:t.slides_data)==null?void 0:o[l.idx];if(e){const U=(y=e.images)==null?void 0:y[l.imgIdx||0];V.value=(U==null?void 0:U.prompt)||e.image_prompt||""}A.value=!1},{deep:!0,immediate:!0}),z([()=>{var l;return(l=u.value)==null?void 0:l.type},()=>{var l;return(l=n.value)==null?void 0:l.mode},j,se],([l,e,t,o])=>{l==="slides_making"&&t==="designer"?e==="image_only"?f.value="images":f.value!=="images"&&f.value!=="update_slide_text"&&(f.value="update_slide_text"):o&&o.length>0&&(o.some(U=>U.value===f.value)||(f.value=o[0].value))},{immediate:!0});async function ke(){p.openModal("notebookWizard")}async function we(l){l.is_loaded=!l.is_loaded,await v.saveActive()}async function _e(l){await p.showConfirmation({title:"Remove Source?"})&&(u.value.artefacts=u.value.artefacts.filter(e=>e.filename!==l),await v.saveActive())}async function Ce(l){p.openModal("sourceViewer",{title:l.filename,content:l.content,language:"markdown"})}async function Se(){if(!c.value)return;const{confirmed:l,value:e}=await p.showConfirmation({title:"Send to Chat",message:"Append current tab content to discussion context:",inputType:"select",inputOptions:Object.values(te.discussions).map(t=>({text:t.title,value:t.id})),confirmText:"Send"});if(l&&e){const t=c.value.content||(c.value.type==="gallery"?JSON.stringify(c.value.images):"");await te.appendToDataZone({discussionId:e,content:t}),p.addNotification("Content sent to chat.","success")}}function Ie(){le.value.click()}async function Te(l){const e=Array.from(l.target.files);!u.value||e.length===0||(p.addNotification(`Uploading ${e.length} source(s)...`,"info"),await Promise.all(e.map(t=>v.uploadSource(t))),l.target.value="")}async function $e(){if(!u.value)return;const{confirmed:l,value:e}=await p.showConfirmation({title:"Scrape URL",message:"Enter URL:",inputType:"text",confirmText:"Scrape"});l&&e&&await v.scrapeUrl(e)}async function Ne(){u.value&&(await v.selectNotebook(u.value.id),p.addNotification("Notebook refreshed.","success"))}async function Ae(){if(!c.value)return;const{confirmed:l,value:e}=await p.showConfirmation({title:"Convert to Source",message:"Enter title:",inputType:"text",confirmText:"Convert"});if(l&&e){const t=c.value.content||(c.value.type==="gallery"?JSON.stringify(c.value.images):"");await v.createTextArtefact(e,t)}}function je(l){k.value=l}async function De(){v.addTab(),setTimeout(()=>{u.value.tabs.length>0&&(k.value=u.value.tabs[u.value.tabs.length-1].id)},100)}function Ve(l){confirm("Delete this tab?")&&(v.removeTab(l),k.value===l&&(k.value=u.value.tabs.length>0?u.value.tabs[0].id:null))}function Ue(l){B.value.has(l)?B.value.delete(l):B.value.add(l)}function Re(){v.generateTitle()}function oe(l){p.openImageViewer({imageList:[{src:l,prompt:"Notebook Image"}],startIndex:0})}async function re(l){try{const e=await tt.get(`/api/notebooks/${u.value.id}/export`,{params:{format:l},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=t;const y=l==="json"?"json":"pptx";o.setAttribute("download",`${u.value.title}.${y}`),document.body.appendChild(o),o.click(),document.body.removeChild(o)}catch{p.addNotification("Export failed.","error")}}function O(){var t;const l=Array.from(B.value),e=E.value||w.value?k.value:null;if(E.value&&!k.value){p.addNotification("No active tab.","warning");return}if(f.value==="images"&&!m.value.trim()&&(!E.value||!((t=c.value)!=null&&t.title))){p.addNotification("Prompt required.","warning");return}if(w.value&&j.value==="designer"){if(!m.value.trim()){p.addNotification("Prompt required.","warning");return}f.value==="images"?m.value.startsWith("SLIDE_INDEX:")||(m.value=`SLIDE_INDEX:${i.value}| ${m.value}`):f.value==="update_slide_text"&&(m.value.startsWith("SLIDE_INDEX:")||(m.value=`SLIDE_INDEX:${i.value}| ${m.value}`))}!m.value.trim()&&f.value!=="images"&&f.value!=="generate_slides_text"||(v.processWithAi(m.value,l,f.value,e),m.value="",B.value.clear())}function ne(l,e){E.value=!0,f.value="images",m.value=`Create a high quality visual representation for the slide titled "${e}".`,O()}function ie(){V.value.trim()&&(f.value="images",m.value=V.value,O(),A.value=!1)}function de(l,e){const t=n.value;t.slides_data&&t.slides_data[l]&&(t.slides_data[l].selected_image_index=e,c.value.content=JSON.stringify(t),v.saveActive())}function ue(l){const e=n.value;e.slides_data||(e.slides_data=[]);const t={id:crypto.randomUUID(),layout:"TitleBody",title:"New Slide",bullets:["Add content here..."],images:[],selected_image_index:0};e.slides_data.splice(l+1,0,t),c.value.content=JSON.stringify(e),v.saveActive(),i.value=l+1}function Pe(l){const e=n.value;e.slides_data&&(e.slides_data.splice(l,1),c.value.content=JSON.stringify(e),v.saveActive(),i.value>=e.slides_data.length&&(i.value=Math.max(0,e.slides_data.length-1)))}function ce(l,e){const t=n.value,o=t.slides_data[l];!o||!o.images||(o.images.splice(e,1),o.selected_image_index>=o.images.length?o.selected_image_index=Math.max(0,o.images.length-1):e<o.selected_image_index&&o.selected_image_index--,c.value.content=JSON.stringify(t),v.saveActive())}const J=h(null);function Be(l,e){J.value=l,e.dataTransfer.effectAllowed="move"}function Ee(l){if(J.value===null||J.value===l)return;const e=n.value,t=e.slides_data.splice(J.value,1)[0];e.slides_data.splice(l,0,t),c.value.content=JSON.stringify(e),v.saveActive(),i.value=l,J.value=null}return Fe(()=>{v.fetchNotebooks(),p.setPageTitle({title:""})}),We(()=>{p.setPageTitle({title:""})}),(l,e)=>(s(),r("div",vt,[g(u)?(s(),I(ve,{key:0,to:"#global-header-title-target"},[a("div",gt,[_(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>g(u).title=t),onBlur:e[1]||(e[1]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"flex-grow bg-transparent border-b border-transparent hover:border-gray-300 focus:border-blue-500 focus:ring-0 text-center font-bold text-gray-800 dark:text-gray-200 transition-colors px-2 py-1 outline-none truncate"},null,544),[[N,g(u).title]]),a("button",{onClick:Re,class:"p-1.5 rounded-full hover:bg-purple-100 dark:hover:bg-purple-900/30 text-purple-500 transition-colors"},[d(F,{class:"w-4 h-4"})])])])):b("",!0),g(u)?(s(),I(ve,{key:1,to:"#global-header-actions-target"},[a("div",bt,[a("span",pt,x(g(u).type?g(u).type.replace("_"," "):"Generic"),1),w.value?(s(),r("div",ft,[a("button",{onClick:e[2]||(e[2]=t=>j.value="designer"),class:C(["px-2 py-1 text-xs font-bold rounded",j.value==="designer"?"bg-white dark:bg-gray-700 shadow text-blue-600":"text-gray-500"])},"Designer",2),a("button",{onClick:e[3]||(e[3]=t=>j.value="planner"),class:C(["px-2 py-1 text-xs font-bold rounded",j.value==="planner"?"bg-white dark:bg-gray-700 shadow text-purple-600":"text-gray-500"])},"Planner",2)])):b("",!0),a("button",{onClick:e[4]||(e[4]=t=>re("pptx")),class:"btn-icon p-2",title:"Export PPTX"},[d(He,{class:"w-4 h-4"})]),a("button",{onClick:e[5]||(e[5]=t=>re("json")),class:"btn-icon p-2",title:"Export JSON"},[d(ct,{class:"w-4 h-4"})]),a("button",{onClick:Ne,class:"btn-icon p-2",title:"Refresh"},[d(H,{class:"w-4 h-4"})]),w.value?b("",!0):(s(),r("button",{key:1,onClick:Ae,class:"btn-icon p-2",title:"Save Source"},[d(nt,{class:"w-4 h-4"})])),w.value?b("",!0):(s(),r("button",{key:2,onClick:Se,class:"btn-icon p-2",title:"Send Chat"},[d(Xe,{class:"w-4 h-4"})])),a("button",{onClick:e[6]||(e[6]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"btn-primary-flat p-2",title:"Save"},[d(ge,{class:"w-4 h-4"})])])])):b("",!0),g(u)?(s(),r("div",{key:2,class:"h-full flex flex-col relative",onDragover:e[41]||(e[41]=R(t=>q.value=!0,["prevent"])),onDragleave:e[42]||(e[42]=t=>q.value=!1),onDrop:e[43]||(e[43]=R((...t)=>l.handleDrop&&l.handleDrop(...t),["prevent"]))},[q.value?(s(),r("div",yt,e[44]||(e[44]=[a("p",{class:"text-2xl font-black text-blue-600 uppercase"},"Drop Research Sources Here",-1)]))):b("",!0),w.value?b("",!0):(s(),r("div",mt,[a("div",xt,[a("div",ht,[(s(!0),r(T,null,$(g(u).tabs,t=>(s(),r("div",{key:t.id,class:C(["group relative flex items-center gap-2 px-4 py-2 rounded-t-lg cursor-pointer transition-colors border-t border-x border-transparent hover:bg-gray-200 dark:hover:bg-gray-700 flex-shrink-0 text-xs font-medium uppercase tracking-wide",k.value===t.id?"bg-white dark:bg-gray-900 border-gray-300 dark:border-gray-600 text-blue-600 dark:text-blue-400 font-bold shadow-sm":"text-gray-500 hover:text-gray-700"])},[a("span",{onClick:o=>je(t.id),class:"truncate max-w-[120px]"},x(t.title),9,kt),a("button",{onClick:R(o=>Ve(t.id),["stop"]),class:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500"},[d(L,{class:"w-3 h-3"})],8,wt)],2))),128)),a("button",{onClick:De,class:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 mb-0.5 flex-shrink-0"},[d(X,{class:"w-4 h-4"})])])])])),a("div",_t,[a("div",Ct,[D.value?(s(),r("div",St,[a("div",It,[a("div",Tt,[d(qe,{class:"w-5 h-5 text-blue-600 animate-spin"}),a("div",null,[a("h3",$t,x(D.value.name),1),a("p",Nt,x(D.value.description),1)])]),a("div",At,x(D.value.progress)+"%",1)]),a("div",jt,[a("div",{ref_key:"logsContainer",ref:W,class:"absolute inset-0 overflow-y-auto p-4 font-mono text-xs text-gray-600 dark:text-gray-300 space-y-1"},[(s(!0),r(T,null,$(D.value.logs,(t,o)=>(s(),r("div",{key:o,class:"flex gap-2"},[a("span",Dt,"["+x(new Date(t.timestamp).toLocaleTimeString())+"]",1),a("span",{class:C({"text-red-500":t.level==="ERROR","text-yellow-500":t.level==="WARNING"})},x(t.message),3)]))),128))],512)])])):b("",!0),c.value?(s(),r("div",Vt,[w.value&&j.value==="designer"?(s(),r("div",Ut,[a("div",Rt,[e[47]||(e[47]=a("div",{class:"p-3 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},[a("h3",{class:"text-xs font-black uppercase text-gray-500 tracking-widest"},"Slides")],-1)),a("div",Pt,[(s(!0),r(T,null,$(n.value.slides_data,(t,o)=>(s(),r("div",{key:t.id,class:"relative group",draggable:"true",onDragstart:y=>Be(o,y),onDragover:e[7]||(e[7]=R(()=>{},["prevent"])),onDrop:y=>Ee(o)},[a("div",{onClick:y=>i.value=o,class:C(["p-2 bg-white dark:bg-gray-800 rounded border-2 cursor-pointer transition-all hover:shadow-md",i.value===o?"border-blue-500 ring-1 ring-blue-500":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"])},[a("div",Ot,[a("span",Mt,"#"+x(o+1),1),a("button",{onClick:R(y=>Pe(o),["stop"]),class:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-500"},[d(at,{class:"w-3 h-3"})],8,zt)]),a("div",Lt,x(t.title),1),a("div",Gt,[t.images&&t.images.length>0?(s(),I(P,{key:0,src:t.images[t.selected_image_index||0].path,class:"w-full h-full object-cover"},null,8,["src"])):(s(),I(Y,{key:1,class:"w-6 h-6 text-gray-300"}))])],10,Et),a("div",{class:"absolute -bottom-3 left-0 right-0 h-4 opacity-0 hover:opacity-100 flex items-center justify-center z-10 cursor-pointer",onClick:y=>ue(o)},[e[45]||(e[45]=a("div",{class:"h-0.5 w-full bg-blue-500"},null,-1)),a("div",Ft,[d(X,{class:"w-3 h-3"})])],8,Jt)],40,Bt))),128)),a("button",{onClick:e[8]||(e[8]=t=>{var o;return ue(((o=n.value.slides_data)==null?void 0:o.length)-1)}),class:"w-full py-3 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-gray-400 hover:text-blue-500 hover:border-blue-400 transition-colors flex items-center justify-center gap-2"},[d(X,{class:"w-4 h-4"}),e[46]||(e[46]=S(" Add Slide "))])])]),a("div",Wt,[a("div",Ht,[n.value.slides_data&&n.value.slides_data[i.value]?(s(),r("div",Xt,[n.value.mode==="image_only"?(s(),r("div",qt,[A.value?(s(),r("div",Kt,[a("div",Zt,[e[48]||(e[48]=a("h3",{class:"text-sm font-bold uppercase text-gray-500"},"Edit Image Prompt",-1)),a("button",{onClick:e[9]||(e[9]=t=>A.value=!1),class:"p-2 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-full",title:"Cancel"},[d(L,{class:"w-5 h-5"})])]),_(a("textarea",{"onUpdate:modelValue":e[10]||(e[10]=t=>V.value=t),class:"flex-grow w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg p-4 resize-none focus:ring-2 focus:ring-blue-500 mb-4 font-mono text-sm",placeholder:"Describe the image you want to generate..."},null,512),[[N,V.value]]),a("div",Yt,[a("button",{onClick:e[11]||(e[11]=t=>A.value=!1),class:"btn btn-secondary"},"Cancel"),a("button",{onClick:ie,class:"btn btn-primary"},[d(F,{class:"w-4 h-4 mr-2"}),e[49]||(e[49]=S(" Generate "))])])])):(s(),r("div",Qt,[n.value.slides_data[i.value].images&&n.value.slides_data[i.value].images.length>0?(s(),I(P,{key:0,src:n.value.slides_data[i.value].images[n.value.slides_data[i.value].selected_image_index||0].path,class:"w-full h-full object-cover"},null,8,["src"])):(s(),r("div",ea,[d(Y,{class:"w-12 h-12 opacity-50"}),e[50]||(e[50]=a("span",null,"No image generated",-1))])),a("div",ta,[a("button",{onClick:e[12]||(e[12]=t=>A.value=!0),class:"btn btn-secondary btn-sm shadow-lg backdrop-blur-md bg-white/80 dark:bg-black/60"},[d(Q,{class:"w-4 h-4 mr-1"}),e[51]||(e[51]=S(" Edit Prompt"))]),a("button",{onClick:e[13]||(e[13]=t=>ne(i.value,n.value.slides_data[i.value].title)),class:"btn btn-primary btn-sm shadow-lg"},[d(H,{class:"w-4 h-4 mr-1"}),e[52]||(e[52]=S(" Regenerate"))])]),n.value.slides_data[i.value].images&&n.value.slides_data[i.value].images.length>1?(s(),r("div",aa,[(s(!0),r(T,null,$(n.value.slides_data[i.value].images,(t,o)=>(s(),r("div",{key:o,class:"relative group/thumb flex-shrink-0 w-20 h-full"},[a("div",{onClick:y=>de(i.value,o),class:C(["w-full h-full rounded cursor-pointer border-2 transition-colors overflow-hidden",(n.value.slides_data[i.value].selected_image_index||0)===o?"border-blue-500":"border-transparent opacity-60 hover:opacity-100"])},[d(P,{src:t.path,class:"w-full h-full object-cover"},null,8,["src"])],10,la),a("button",{onClick:R(y=>ce(i.value,o),["stop"]),class:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center opacity-0 group-hover/thumb:opacity-100 transition-opacity hover:bg-red-600 shadow-sm",title:"Delete Variant"},[d(L,{class:"w-3 h-3"})],8,sa)]))),128))])):b("",!0)]))])):(s(),r("div",oa,[a("div",{class:C(n.value.slides_data[i.value].layout==="TitleImageBody"||n.value.mode==="hybrid"?"w-1/2":"w-full")},[_(a("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>n.value.slides_data[i.value].title=t),onBlur:e[15]||(e[15]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"text-3xl font-bold w-full bg-transparent border-none focus:ring-0 p-0 mb-4 text-gray-900 dark:text-gray-100 placeholder-gray-400",placeholder:"Slide Title"},null,544),[[N,n.value.slides_data[i.value].title]]),_(a("textarea",{"onUpdate:modelValue":e[16]||(e[16]=t=>n.value.slides_data[i.value].bullets=t),onBlur:e[17]||(e[17]=()=>{n.value.slides_data[i.value].bullets=Array.isArray(n.value.slides_data[i.value].bullets)?n.value.slides_data[i.value].bullets:n.value.slides_data[i.value].bullets.split(`
`),g(v).saveActive()}),class:"w-full h-64 bg-transparent border-none focus:ring-0 p-0 text-lg text-gray-700 dark:text-gray-300 resize-none list-disc",placeholder:`• Point 1
• Point 2`},null,544),[[N,n.value.slides_data[i.value].bullets]])],2),n.value.slides_data[i.value].layout==="TitleImageBody"||n.value.mode==="hybrid"?(s(),r("div",ra,[a("div",na,[A.value?(s(),r("div",ia,[a("div",da,[e[53]||(e[53]=a("h3",{class:"text-xs font-bold uppercase text-gray-500"},"Edit Prompt",-1)),a("button",{onClick:e[18]||(e[18]=t=>A.value=!1),class:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"},[d(L,{class:"w-4 h-4"})])]),_(a("textarea",{"onUpdate:modelValue":e[19]||(e[19]=t=>V.value=t),class:"flex-grow w-full text-xs bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded p-2 resize-none mb-2 font-mono"},null,512),[[N,V.value]]),a("button",{onClick:ie,class:"btn btn-primary btn-sm w-full"},[d(F,{class:"w-3 h-3 mr-1"}),e[54]||(e[54]=S(" Generate"))])])):b("",!0),n.value.slides_data[i.value].images&&n.value.slides_data[i.value].images.length>0?(s(),I(P,{key:1,src:n.value.slides_data[i.value].images[n.value.slides_data[i.value].selected_image_index||0].path,class:"w-full h-full object-cover"},null,8,["src"])):(s(),r("div",ua,[d(Y,{class:"w-12 h-12 opacity-50"}),e[55]||(e[55]=a("span",null,"No visual",-1))])),a("div",ca,[a("button",{onClick:e[20]||(e[20]=t=>A.value=!0),class:"btn btn-secondary btn-sm"},[d(Q,{class:"w-4 h-4 mr-1"}),e[56]||(e[56]=S(" Edit Prompt"))]),a("button",{onClick:e[21]||(e[21]=t=>ne(i.value,n.value.slides_data[i.value].title)),class:"btn btn-primary btn-sm"},[d(H,{class:"w-4 h-4 mr-1"}),e[57]||(e[57]=S(" Regen"))]),a("button",{onClick:e[22]||(e[22]=t=>{var o;return oe((o=n.value.slides_data[i.value].images[n.value.slides_data[i.value].selected_image_index||0])==null?void 0:o.path)}),class:"btn btn-secondary btn-sm"},[d(ee,{class:"w-4 h-4"})])])]),n.value.slides_data[i.value].images&&n.value.slides_data[i.value].images.length>1?(s(),r("div",va,[(s(!0),r(T,null,$(n.value.slides_data[i.value].images,(t,o)=>(s(),r("div",{key:o,class:"relative group/thumb flex-shrink-0 w-20 h-full"},[a("div",{onClick:y=>de(i.value,o),class:C(["w-full h-full rounded cursor-pointer border-2 transition-colors overflow-hidden",(n.value.slides_data[i.value].selected_image_index||0)===o?"border-blue-500":"border-transparent opacity-60 hover:opacity-100"])},[d(P,{src:t.path,class:"w-full h-full object-cover"},null,8,["src"])],10,ga),a("button",{onClick:R(y=>ce(i.value,o),["stop"]),class:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center opacity-0 group-hover/thumb:opacity-100 transition-opacity hover:bg-red-600 shadow-sm",title:"Delete Variant"},[d(L,{class:"w-3 h-3"})],8,ba)]))),128))])):b("",!0)])):b("",!0)]))])):(s(),r("div",pa,"Select a slide to edit."))]),a("div",fa,[a("div",ya,[_(a("select",{"onUpdate:modelValue":e[23]||(e[23]=t=>f.value=t),class:"bg-gray-100 dark:bg-gray-700 border-none rounded px-3 py-2 text-sm font-bold uppercase text-gray-600 dark:text-gray-300"},[n.value.mode!=="image_only"?(s(),r("option",ma,"Update Text")):b("",!0),e[58]||(e[58]=a("option",{value:"images"},"Update Image",-1))],512),[[be,f.value]]),_(a("input",{"onUpdate:modelValue":e[24]||(e[24]=t=>m.value=t),onKeyup:pe(O,["enter"]),placeholder:"Instructions for this slide...",class:"input-field flex-grow"},null,544),[[N,m.value]]),a("button",{onClick:O,class:"btn btn-primary"},[d(F,{class:"w-4 h-4 mr-2"}),e[59]||(e[59]=S(" Update Slide"))])])])])])):w.value&&j.value==="planner"?(s(),r("div",xa,[a("div",ha,[e[61]||(e[61]=a("h3",{class:"text-sm font-bold text-gray-600"},"Structure (JSON)",-1)),a("button",{onClick:e[25]||(e[25]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"btn-primary-flat btn-sm"},[d(ge,{class:"w-4 h-4 mr-1"}),e[60]||(e[60]=S(" Save JSON"))])]),d(fe,{modelValue:c.value.content,"onUpdate:modelValue":e[26]||(e[26]=t=>c.value.content=t),language:"json",class:"flex-grow"},null,8,["modelValue"])])):b("",!0),!w.value&&c.value.type==="markdown"?(s(),r("div",ka,[a("div",wa,[_(a("input",{"onUpdate:modelValue":e[27]||(e[27]=t=>c.value.title=t),onBlur:e[28]||(e[28]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"bg-transparent border-none text-sm font-bold text-gray-700 dark:text-gray-300 focus:ring-0 px-2 w-full",placeholder:"Tab Title"},null,544),[[N,c.value.title]]),a("div",_a,[a("button",{onClick:e[29]||(e[29]=t=>G.value=!0),class:C(["p-1 rounded",G.value?"bg-white dark:bg-gray-600 text-blue-600 shadow-sm":"text-gray-500"])},[d(ee,{class:"w-4 h-4"})],2),a("button",{onClick:e[30]||(e[30]=t=>G.value=!1),class:C(["p-1 rounded",G.value?"text-gray-500":"bg-white dark:bg-gray-600 text-blue-600 shadow-sm"])},[d(Q,{class:"w-4 h-4"})],2)])]),a("div",Ca,[G.value?(s(),r("div",Sa,[(s(),I(Ke,{content:c.value.content,key:c.value.id+c.value.content.length,class:"prose dark:prose-invert max-w-none"},null,8,["content"]))])):(s(),I(fe,{key:1,modelValue:c.value.content,"onUpdate:modelValue":e[31]||(e[31]=t=>c.value.content=t),onBlur:g(v).saveActive,class:"h-full"},null,8,["modelValue","onBlur"]))])])):!w.value&&c.value.type==="gallery"?(s(),r("div",Ia,[a("div",Ta,[_(a("input",{"onUpdate:modelValue":e[32]||(e[32]=t=>c.value.title=t),onBlur:e[33]||(e[33]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"bg-transparent border-none text-lg font-bold p-0 focus:ring-0 w-full",placeholder:"Gallery Title"},null,544),[[N,c.value.title]]),K.value?(s(),r("button",{key:0,onClick:e[34]||(e[34]=(...t)=>l.handleRegenerateImages&&l.handleRegenerateImages(...t)),class:"btn-secondary btn-sm flex-shrink-0",title:"Regenerate Images"},[d(H,{class:"w-4 h-4 mr-1"}),e[62]||(e[62]=S(" Regenerate"))])):b("",!0)]),c.value.images&&c.value.images.length>0?(s(),r("div",$a,[(s(!0),r(T,null,$(c.value.images,(t,o)=>(s(),r("div",{key:o,class:"relative group aspect-square rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800 border dark:border-gray-700 cursor-pointer",onClick:y=>oe(t.path)},[d(P,{src:t.path,class:"w-full h-full object-cover"},null,8,["src"]),a("div",Aa,[a("p",ja,x(t.prompt),1)])],8,Na))),128))])):(s(),r("div",Da,[e[63]||(e[63]=a("p",null,"No images generated.",-1)),K.value?(s(),r("button",{key:0,onClick:e[35]||(e[35]=(...t)=>l.handleRegenerateImages&&l.handleRegenerateImages(...t)),class:"mt-2 text-blue-500 hover:underline"},"Generate Images")):b("",!0)]))])):!w.value&&c.value.type==="slides"&&n.value.slides_data?(s(),r("div",Va,[a("div",Ua,[_(a("input",{"onUpdate:modelValue":e[36]||(e[36]=t=>c.value.title=t),onBlur:e[37]||(e[37]=(...t)=>g(v).saveActive&&g(v).saveActive(...t)),class:"w-full p-2 bg-transparent border-b text-xl font-bold",placeholder:"Presentation Title"},null,544),[[N,c.value.title]])]),(s(!0),r(T,null,$(n.value.slides_data,(t,o)=>(s(),r("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-6 shadow-md rounded-xl mb-8 border dark:border-gray-700 relative group"},[a("div",Ra,[a("div",{class:C(t.layout==="TitleImageBody"?"w-1/2":"w-full")},[a("h3",Pa,x(t.title),1),a("ul",Ba,[(s(!0),r(T,null,$(t.bullets,(y,U)=>(s(),r("li",{key:U},x(y),1))),128))])],2),t.layout==="TitleImageBody"?(s(),r("div",Ea,[a("div",Oa,[t.images&&t.images.length>0?(s(),I(P,{key:0,src:t.images[t.selected_image_index||0].path,class:"w-full h-full object-cover"},null,8,["src"])):(s(),r("div",Ma,"No image generated"))])])):b("",!0)])]))),128))])):b("",!0)])):(s(),r("div",za,"No tab selected.")),w.value?b("",!0):(s(),r("div",La,[a("div",Ga,[e[64]||(e[64]=a("span",{class:"text-[10px] font-bold text-gray-400 uppercase flex-shrink-0 tracking-wider"},"Input Context",-1)),(s(!0),r(T,null,$(g(u).tabs,t=>(s(),r("div",{key:"ctx-"+t.id,onClick:o=>Ue(t.id),class:C(["px-2 py-0.5 rounded text-[10px] cursor-pointer border transition-colors select-none whitespace-nowrap flex-shrink-0 uppercase font-bold",B.value.has(t.id)?"bg-blue-50 border-blue-200 text-blue-600":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 text-gray-500"])},x(t.title),11,Ja))),128))]),a("div",Fa,[a("div",Wa,[_(a("input",{"onUpdate:modelValue":e[38]||(e[38]=t=>m.value=t),placeholder:"Describe what you want to do...",class:"input-field w-full pr-32 !text-sm",onKeyup:pe(O,["enter"])},null,544),[[N,m.value]]),a("div",Ha,[_(a("select",{"onUpdate:modelValue":e[39]||(e[39]=t=>f.value=t),class:"bg-gray-100 dark:bg-gray-700 border-none text-[10px] rounded px-2 py-1 outline-none cursor-pointer text-gray-600 dark:text-gray-300 font-bold uppercase h-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},[(s(!0),r(T,null,$(se.value,t=>(s(),r("option",{key:t.value,value:t.value},x(t.label),9,Xa))),128))],512),[[be,f.value]])])]),a("div",qa,[_(a("input",{type:"checkbox",id:"modify-tab","onUpdate:modelValue":e[40]||(e[40]=t=>E.value=t),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"},null,512),[[Ze,E.value]]),e[65]||(e[65]=a("label",{for:"modify-tab",class:"ml-1 text-[10px] uppercase font-bold text-gray-500 cursor-pointer select-none"},"Update Active",-1))]),a("button",{onClick:O,disabled:!!D.value,class:"btn btn-primary gap-2 w-20 flex-shrink-0 justify-center"},[d(F,{class:"w-4 h-4"}),e[66]||(e[66]=S(" Go"))],8,Ka)])]))]),a("div",Za,[a("div",Ya,[e[67]||(e[67]=a("span",{class:"font-black text-[10px] uppercase text-gray-500 tracking-widest"},"Sources",-1)),a("div",Qa,[a("button",{onClick:Ie,class:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded text-gray-500",title:"Upload File"},[d(Ye,{class:"w-4 h-4"})]),a("input",{type:"file",ref_key:"fileInput",ref:le,onChange:Te,multiple:"",class:"hidden"},null,544),a("button",{onClick:$e,class:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded text-gray-500",title:"Scrape URL"},[d(Qe,{class:"w-4 h-4"})])])]),a("div",el,[(s(!0),r(T,null,$(g(u).artefacts,t=>(s(),r("div",{key:t.filename,class:"p-2.5 bg-white dark:bg-gray-800 rounded-lg border dark:border-gray-700 shadow-sm group hover:shadow-md transition-shadow"},[a("div",tl,[a("div",al,[d(lt,{class:"w-3.5 h-3.5 text-blue-400 shrink-0"}),a("span",{class:"text-xs truncate font-bold text-gray-700 dark:text-gray-300",title:t.filename},x(t.filename),9,ll)]),a("div",sl,[a("button",{onClick:o=>Ce(t),class:"text-gray-400 hover:text-blue-500 mr-1 opacity-0 group-hover:opacity-100 transition-opacity",title:"View Content"},[d(ee,{class:"w-3.5 h-3.5"})],8,ol),a("button",{onClick:o=>_e(t.filename),class:"text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity"},[d(L,{class:"w-3.5 h-3.5"})],8,rl)])]),a("button",{onClick:o=>we(t),class:C(["w-full flex items-center justify-between text-[9px] font-bold uppercase tracking-tighter px-2 py-1 rounded transition-colors",t.is_loaded?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 dark:bg-gray-700 text-gray-500"])},[a("span",null,x(t.is_loaded?"Active":"Inactive"),1),t.is_loaded?(s(),I(st,{key:0,class:"w-3 h-3"})):(s(),I(ot,{key:1,class:"w-3 h-3"}))],10,nl)]))),128)),g(u).artefacts.length===0?(s(),r("div",il,"No sources added.")):b("",!0)])])])],32)):(s(),r("div",dl,[d(et,{class:"w-16 h-16 mb-4 text-gray-300 dark:text-gray-600"}),e[69]||(e[69]=a("p",{class:"text-lg font-medium"},"Select a notebook from the sidebar to begin.",-1)),a("button",{onClick:ke,class:"mt-4 btn btn-primary flex items-center gap-2"},[d(X,{class:"w-4 h-4"}),e[68]||(e[68]=S(" Create New Notebook"))])]))]))}};export{vl as default};
