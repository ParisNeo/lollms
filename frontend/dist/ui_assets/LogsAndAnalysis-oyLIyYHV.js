import{u as w}from"./admin-BC4f1cK0.js";import{a1 as _,X as h,K as u,c as A,w as S,o as L,d as l,l as n,e as s,f as r,m as y,T as g,n as m,ax as p,t as x,ay as T,R as C}from"./index-DpO-4d8L.js";import{I}from"./IconPlayCircle-hbKin44_.js";const z={class:"space-y-6"},R={class:"flex items-center justify-between"},B={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border dark:border-gray-700 overflow-hidden"},D={class:"p-6 border-b dark:border-gray-700 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},M=["disabled"],N={class:"p-6"},V={key:0,class:"flex flex-col items-center justify-center py-12 text-blue-600 dark:text-blue-400"},j={key:1,class:"space-y-4"},U={class:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 mb-2"},E={class:"text-gray-500"},F={class:"prose dark:prose-invert max-w-none bg-gray-50 dark:bg-gray-900/50 p-6 rounded-lg border dark:border-gray-700"},K={key:2,class:"text-center py-12 text-gray-500 dark:text-gray-400 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-lg"},H={__name:"LogsAndAnalysis",setup(P){const b=w(),i=_(),f=h(),o=u(null),t=u(!1),k=A(()=>i.tasks.filter(a=>a.name==="Analyze System Logs").sort((a,e)=>new Date(e.created_at)-new Date(a.created_at)));S(k,a=>{var c;const e=a[0];e?e.status==="running"||e.status==="pending"?t.value=!0:(t.value=!1,e.status==="completed"&&((c=e.result)!=null&&c.report)&&(o.value=e.result)):(t.value=!1,o.value=null)},{immediate:!0,deep:!0}),L(()=>{i.fetchTasks()});async function d(){try{await b.analyzeSystemLogs(),setTimeout(()=>i.fetchTasks(),500)}catch{}}function v(){f.openModal("systemLog")}return(a,e)=>(n(),l("div",z,[s("div",R,[e[1]||(e[1]=s("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"},"System Logs & Analysis",-1)),s("button",{onClick:v,class:"btn btn-secondary btn-sm flex items-center gap-2"},[r(g,{class:"w-4 h-4"}),e[0]||(e[0]=y(" View Raw Logs "))])]),s("div",B,[s("div",D,[e[2]||(e[2]=s("div",null,[s("h4",{class:"text-lg font-bold text-gray-900 dark:text-white"},"AI Log Analysis"),s("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Use the AI to scan recent tasks and logs for errors, warnings, and potential issues. ")],-1)),s("button",{onClick:d,disabled:t.value,class:"btn btn-primary flex items-center gap-2"},[t.value?(n(),m(p,{key:0,class:"w-5 h-5 animate-spin"})):(n(),m(I,{key:1,class:"w-5 h-5"})),y(" "+x(t.value?"Analyzing...":"Regenerate Analysis"),1)],8,M)]),s("div",N,[t.value?(n(),l("div",V,[r(p,{class:"w-10 h-10 animate-spin mb-3"}),e[3]||(e[3]=s("p",{class:"font-medium"},"Analyzing system logs...",-1))])):o.value?(n(),l("div",j,[s("div",U,[r(T,{class:"w-5 h-5"}),e[4]||(e[4]=s("span",{class:"font-semibold"},"Analysis Complete",-1)),e[5]||(e[5]=s("span",{class:"text-gray-400 mx-2"},"|",-1)),s("span",E,x(new Date(o.value.generated_at).toLocaleString()),1)]),s("div",F,[r(C,{content:o.value.report},null,8,["content"])])])):(n(),l("div",K,[r(g,{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3"}),e[6]||(e[6]=s("p",null,"No analysis report available.",-1)),s("button",{onClick:d,class:"text-blue-600 hover:underline mt-2"},"Start Analysis")]))])])]))}};export{H as default};
