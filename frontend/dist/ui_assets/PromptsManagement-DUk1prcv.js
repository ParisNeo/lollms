import{_ as q,c as a,o as l,a as e,h as p,t as c,n as Q,p as H,f as A,eg as bt,eh as kt,g as y,ei as wt,ej as jt,G as b,ar as xt,E as Lt,D as Nt,X as J,R as At,u as St,bk as It,az as R,r as x,b as f,S as T,d as ht,aQ as Ct,e as Dt,aM as B,ae as $t,J as M,K as P,A as u,L as z,F as L,j as N,ef as Tt,aC as _}from"./index-BzYhVBtc.js";import{u as Pt}from"./admin-D4vFb8Ht.js";import{I as zt,A as Ut}from"./AppCardSkeleton-DfLc2tOf.js";import{I as Et}from"./IconArrowUp-B_8CH54b.js";const Ot={class:"card"},Rt={class:"card-header"},Qt=["src","alt"],Zt={class:"flex-grow min-w-0"},Vt={class:"flex justify-between items-start"},Yt=["title"],Ft={class:"card-tags"},Gt={key:0,class:"tag installed-tag"},Wt={key:1,class:"tag"},Bt={key:2,class:"tag"},_t={key:3,class:"tag"},qt={class:"card-body"},Ht=["title"],Jt={key:0,class:"px-4 pb-2 text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1"},Kt=["title"],Xt={class:"card-footer"},te={class:"flex-1 min-w-0"},ee={key:1,class:"flex gap-2 w-full"},se={class:"flex-shrink-0 flex gap-1"},oe="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LjE3MiA0LjU4NmMxLjA3Mi0xLjA3MiAyLjgyNy0xLjA3MiAzLjkwNiAwIGwxLjkyOCAxLjkyOGMuMDkuMDkuMTQ2LjIxMy4xNDYuMzM3djEuMjE5Yy43MTMuMDU0IDEuMzk3LjIxOCAyLjAyOC40NzhsMS45MS0xLjA0Yy4xNTYtLjA4NS4zMy0uMTA0LjQ5OC0uMDVMMjAuNzUgOC4xN2MuMjU0LjA4NC4zOTQuMzQzLjM5NC42MjV2My40M2MwIC4yODItLjE0LjU0MS0uMzk0LjYyNWwtMi42NTQgMS40NDRjLS4xNjguMDktLjM0Mi4xMDgtLjUxLjA1M2wtMS45MS0xLjA0Yy0uNjMyLS4yNi0xLjMxNS0uNDI0LTIuMDI4LS40NzhWNS41NUw5LjE3MiA0LjU4NnpNNCAxMS4yNWMwLS45OTQuNTk2LTEuODYgMS40NDctMi4yNTlMMTAuMDMgNC40M2MtLjM2OS4wMjYtLjczLjEzOC0xLjA3Mi4zMzJsLTEuOTI4IDEuOTI4Yy0xLjA3MiAxLjA3Mi0xLjA3MiAyLjgyNyAwIDMuOTA2bDQuNTk2IDQuNTk2Yy4zNzQuMzc0LjU4Ni44OC41ODYgMS40MTR2My4yMDJjLS45NC4wNS0xLjg1NS4zNzktMi41My45NDNsLTEuNzM2IDEuNzM3YTEuNSAxLjUgMCAwMS0yLjEyMiAwTDMgMTkuNWExLjUgMS41IDAgMDEgMC0yLjEyMWwxLjczNy0xLjczN2MuNTY0LS41NjQgMS4yMzYtLjkxNCAxLjk0My0uOTk2YTQuNDgzIDQuNDgzIDAgMDEtLjY4LS44NDhWMTMuNWExLjUgMS41IDAgMDEtLjQ0LTEuMDYxTDEuNDQ3IDkuMDA5QTcuNSA3LjUgMCAwMSA0IDQuNUMyLjQ4IDEuNSA1LjMzNCAxLjUgNy4wMyA1LjAzaDEuOTQzYy4wMy4zNjIuMTE4LjcxLjI2IDEuMDQzTDQuNDMgMTAuODNjLS44NTEuNDUtMS40MyAxLjMyMi0xLjQzIDIuMjQ4djIuODQ4YzAgMS4zMy42NzIgMi41MzMgMS42ODggMy4yMThhLjc1Ljc1IDAgMTEtLjgyMiAxLjE4NEEzLjAwMiAzLjAwMiAwIDAgMSA0IDE2LjM0OFYxMS4yNXoiIGNsaXAtcnVsZT0iZXZlbm9kZCIgLz4KPC9zdmc+",le={__name:"PromptCard",props:{prompt:{type:Object,required:!0},task:{type:Object,default:null},isStarred:{type:Boolean,default:!1}},emits:["star","install","update","uninstall","help","edit","view-task","cancel-install"],setup(i,{emit:m}){return(v,n)=>(l(),a("div",Ot,[e("div",Rt,[e("img",{src:i.prompt.icon||oe,alt:i.prompt.name,class:"card-icon"},null,8,Qt),e("div",Zt,[e("div",Vt,[e("h3",{class:"card-title",title:i.prompt.name},c(i.prompt.name),9,Yt),e("button",{onClick:n[0]||(n[0]=H(g=>v.$emit("star"),["stop"])),class:Q(["p-1.5 rounded-full transition-colors flex-shrink-0",i.isStarred?"bg-yellow-400/20 text-yellow-500":"text-gray-400 hover:text-yellow-500"])},[i.isStarred?(l(),A(bt,{key:0,class:"w-5 h-5"})):(l(),A(kt,{key:1,class:"w-5 h-5"}))],2)]),e("div",Ft,[i.prompt.is_installed?(l(),a("span",Gt,"Installed")):p("",!0),i.prompt.author?(l(),a("span",Wt,"by "+c(i.prompt.author),1)):p("",!0),i.prompt.category?(l(),a("span",Bt,c(i.prompt.category),1)):p("",!0),i.prompt.version?(l(),a("span",_t,"v"+c(i.prompt.version),1)):p("",!0)])])]),e("div",qt,[e("p",{class:"card-description",title:i.prompt.description},c(i.prompt.description),9,Ht)]),i.prompt.repository?(l(),a("div",Jt,[y(wt,{class:"w-3 h-3"}),e("span",{class:"truncate",title:`From: ${i.prompt.repository}`},c(i.prompt.repository),9,Kt)])):p("",!0),e("div",Xt,[e("div",te,[i.task?(l(),A(jt,{key:0,task:i.task,onView:n[1]||(n[1]=g=>v.$emit("view-task",i.task.id)),onCancel:n[2]||(n[2]=g=>v.$emit("cancel-install"))},null,8,["task"])):(l(),a("div",ee,[i.prompt.is_installed?i.prompt.update_available?(l(),a("button",{key:1,onClick:n[4]||(n[4]=g=>v.$emit("update",i.prompt)),class:"btn btn-warning w-full"},[y(zt,{class:"w-4 h-4 mr-2"}),n[9]||(n[9]=b("Update "))])):(l(),a("button",{key:2,onClick:n[5]||(n[5]=g=>v.$emit("edit",i.prompt)),class:"btn btn-secondary w-full"},[y(Lt,{class:"w-4 h-4 mr-2"}),n[10]||(n[10]=b("Edit "))])):(l(),a("button",{key:0,onClick:n[3]||(n[3]=g=>v.$emit("install",i.prompt)),class:"btn btn-primary w-full"},[y(xt,{class:"w-4 h-4 mr-2"}),n[8]||(n[8]=b("Install "))]))]))]),e("div",se,[i.prompt.has_readme?(l(),a("button",{key:0,onClick:n[6]||(n[6]=g=>v.$emit("help",i.prompt)),class:"btn btn-secondary p-2",title:"Help"},[y(Nt,{class:"w-4 h-4"})])):p("",!0),i.prompt.is_installed?(l(),a("button",{key:1,onClick:n[7]||(n[7]=g=>v.$emit("uninstall",i.prompt)),class:"btn btn-danger-outline p-2",title:"Uninstall"},[y(J,{class:"w-4 h-4"})])):p("",!0)])])]))}},ae=q(le,[["__scopeId","data-v-2d5cc041"]]),ne={class:"space-y-6"},ie={class:"border-b border-gray-200 dark:border-gray-700"},re={class:"-mb-px flex space-x-6"},de={key:0},ue={class:"flex justify-between items-center mb-4"},ce={class:"flex gap-2"},pe={class:"space-y-4"},me={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},ye={class:"relative lg:col-span-1"},ve={class:"grid grid-cols-1 sm:grid-cols-3 lg:col-span-3 gap-4"},ge=["value"],Me=["value"],fe={class:"flex items-center gap-2"},be=["value"],ke={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},we={key:1,class:"empty-state-card"},je={key:2},xe={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},Le={key:0,class:"flex justify-between items-center mt-6"},Ne=["disabled"],Ae={class:"text-sm text-gray-600 dark:text-gray-400"},Se=["disabled"],Ie={key:1},he={class:"flex justify-between items-center mb-4"},Ce={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},De={class:"flex items-center gap-x-4"},$e={key:0},Te=["required"],Pe={key:1},ze=["required"],Ue={key:1,class:"text-center p-4"},Ee={key:2,class:"empty-state-card"},Oe={key:3,class:"space-y-4"},Re={class:"font-semibold"},Qe={class:"text-sm text-gray-500"},Ze={class:"text-xs text-gray-400"},Ve={class:"flex items-center gap-2"},Ye=["onClick"],Fe=["onClick"],Ge={__name:"PromptsManagement",setup(i){const m=Pt(),v=At(),n=St(),g=It(),{on:K,off:X}=Ct(),{promptFilters:r}=m,{promptZooRepositories:Z,isLoadingPromptZooRepositories:tt,zooPrompts:C,isLoadingZooPrompts:et}=R(m),{systemPrompts:V,isLoading:st}=R(g),{tasks:ot}=R(v),k=x("zoo"),d=x({type:"git",name:"",url:"",path:""}),S=x(!1),w=x(null),I=x(JSON.parse(localStorage.getItem("starredPrompts")||"[]"));let Y=null;const U=x(null),D=f({get:()=>r.currentPage,set:o=>{r.currentPage=o}}),E=f(()=>C.value.total||0),F=f(()=>C.value.pages||1),lt=f(()=>{if(E.value===0)return"Showing 0-0 of 0";const o=(r.currentPage-1)*r.pageSize+1,t=Math.min(r.currentPage*r.pageSize,E.value);return`Showing ${o}-${t} of ${E.value}`});async function h(){await m.fetchZooPrompts()}const G=f(()=>{const o=new Map;return(ot.value||[]).forEach(t=>{var s;if((s=t==null?void 0:t.name)!=null&&s.startsWith("Installing prompt: ")&&(t.status==="running"||t.status==="pending")){const j=t.name.replace("Installing prompt: ","");o.set(j,t)}}),(C.value.items||[]).map(t=>({...t,task:o.get(t.folder_name)||null}))});function at(){clearTimeout(Y),Y=setTimeout(()=>{r.currentPage!==1?r.currentPage=1:h()},300)}T(()=>[r.sortKey,r.sortOrder,r.selectedCategory,r.installationStatusFilter,r.selectedRepository],()=>{r.currentPage!==1?r.currentPage=1:h()}),T(()=>r.searchQuery,at),T(()=>r.currentPage,h),T(I,o=>{localStorage.setItem("starredPrompts",JSON.stringify(o))},{deep:!0}),ht(()=>{g.fetchPrompts(),m.fetchPromptZooRepositories(),h(),K("task:completed",W)}),Dt(()=>{X("task:completed",W)});const $=f(()=>Array.isArray(Z.value)?[...Z.value].sort((o,t)=>(o.name||"").localeCompare(t.name||"")):[]),nt=f(()=>["All","Starred",...C.value.categories||[]]),it=[{value:"name",label:"Name"},{value:"author",label:"Author"},{value:"last_update_date",label:"Last Updated"},{value:"creation_date",label:"Creation Date"}];function rt(o){return o?new Date(o).toLocaleString():"Never"}async function dt(){if(!d.value.name){n.addNotification("Repository name is required.","warning");return}const o={name:d.value.name};d.value.type==="git"?o.url=d.value.url:o.path=d.value.path,w.value="add";try{await m.addPromptZooRepository(o),d.value={type:"git",name:"",url:"",path:""},S.value=!1}finally{w.value=null}}async function ut(o){w.value=o.id;try{await m.pullPromptZooRepository(o.id)}finally{w.value=null}}async function ct(o){if(await n.showConfirmation({title:`Delete Repository '${o.name}'?`})){w.value=o.id;try{await m.deletePromptZooRepository(o.id)}finally{w.value=null}}}async function pt(o){await m.installZooPrompt({repository:o.repository,folder_name:o.folder_name})}async function mt(o){const t=V.value.find(s=>s.name===o.name);t&&await n.showConfirmation({title:`Uninstall '${o.name}'?`,message:"This will remove the prompt from the system.",confirmText:"Uninstall"})&&(await m.deleteSystemPrompt(t.id),await h())}async function yt(o){const t=await m.fetchPromptReadme(o.repository,o.folder_name);n.openModal("sourceViewer",{title:`README: ${o.name}`,content:t,language:"markdown"})}function vt(o){const t=I.value.indexOf(o);t>-1?I.value.splice(t,1):I.value.push(o)}function gt(){n.openModal("generatePrompt",{isSystemPrompt:!0,onTaskSubmitted:o=>{U.value=o}})}function W(o){o&&o.id===U.value&&(U.value=null,n.isModalOpen("tasksManager")&&n.closeModal("tasksManager"),o.status==="completed"&&o.result?O(o.result):n.addNotification("Prompt generation did not complete successfully.","warning"))}async function Mt(o){const t=V.value.find(s=>s.name===o.name);t&&await m.updateSystemPromptFromZoo(t.id)}function O(o){n.openModal("editPrompt",{prompt:{...o},isSystemPrompt:!0})}async function ft(){const o=await m.refreshZooCache();o&&n.openModal("tasksManager",{initialTaskId:o.id})}return(o,t)=>(l(),a("div",ne,[e("div",ie,[e("nav",re,[e("button",{onClick:t[0]||(t[0]=s=>k.value="zoo"),class:Q(["tab-button",k.value==="zoo"?"active":"inactive"])},"Zoo",2),e("button",{onClick:t[1]||(t[1]=s=>k.value="source"),class:Q(["tab-button",k.value==="source"?"active":"inactive"])},"Repositories",2)])]),k.value==="zoo"?(l(),a("section",de,[e("div",ue,[t[18]||(t[18]=e("h3",{class:"text-xl font-semibold"},"Prompts Zoo",-1)),e("div",ce,[e("button",{onClick:ft,class:"btn btn-secondary",title:"Refresh Zoo Cache from all sources"},[y(B,{class:"w-4 h-4"})]),e("button",{onClick:gt,class:"btn btn-secondary"},[y($t,{class:"w-4 h-4 mr-2"}),t[17]||(t[17]=b(" Generate with AI "))]),e("button",{onClick:t[2]||(t[2]=s=>O({})),class:"btn btn-primary"},"Create New Prompt")])]),e("div",pe,[e("div",me,[e("div",ye,[M(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>u(r).searchQuery=s),type:"text",placeholder:"Search Prompts...",class:"input-field w-full pl-10"},null,512),[[P,u(r).searchQuery]]),t[19]||(t[19]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),e("div",ve,[M(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>u(r).installationStatusFilter=s),class:"input-field"},t[20]||(t[20]=[e("option",{value:"All"},"All Statuses",-1),e("option",{value:"Installed"},"Installed",-1),e("option",{value:"Uninstalled"},"Uninstalled",-1)]),512),[[z,u(r).installationStatusFilter]]),M(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>u(r).selectedCategory=s),class:"input-field"},[(l(!0),a(L,null,N(nt.value,s=>(l(),a("option",{key:s,value:s},c(s),9,ge))),128))],512),[[z,u(r).selectedCategory]]),M(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>u(r).selectedRepository=s),class:"input-field"},[t[21]||(t[21]=e("option",{value:"All"},"All Sources",-1)),(l(!0),a(L,null,N($.value,s=>(l(),a("option",{key:s.id,value:s.name},c(s.name),9,Me))),128))],512),[[z,u(r).selectedRepository]])])]),e("div",fe,[M(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>u(r).sortKey=s),class:"input-field w-48"},[(l(),a(L,null,N(it,s=>e("option",{key:s.value,value:s.value},"Sort by "+c(s.label),9,be)),64))],512),[[z,u(r).sortKey]]),e("button",{onClick:t[8]||(t[8]=s=>u(r).sortOrder=u(r).sortOrder==="asc"?"desc":"asc"),class:"btn btn-secondary p-2"},[u(r).sortOrder==="asc"?(l(),A(Et,{key:0,class:"w-5 h-5"})):(l(),A(Tt,{key:1,class:"w-5 h-5"}))])]),u(et)||u(st)?(l(),a("div",ke,[(l(),a(L,null,N(6,s=>y(Ut,{key:s})),64))])):G.value.length===0?(l(),a("div",we,t[22]||(t[22]=[e("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(l(),a("div",je,[e("div",xe,[(l(!0),a(L,null,N(G.value,s=>(l(),A(ae,{key:s.id||`${s.repository}/${s.folder_name}`,prompt:s,task:s.task,"is-starred":I.value.includes(s.name),onStar:j=>vt(s.name),onInstall:pt,onUninstall:mt,onHelp:yt,onUpdate:j=>Mt(s),onEdit:j=>O(s)},null,8,["prompt","task","is-starred","onStar","onUpdate","onEdit"]))),128))]),F.value>1?(l(),a("div",Le,[e("button",{onClick:t[9]||(t[9]=s=>D.value--),disabled:D.value===1,class:"btn btn-secondary"},"Previous",8,Ne),e("span",Ae,c(lt.value),1),e("button",{onClick:t[10]||(t[10]=s=>D.value++),disabled:D.value>=F.value,class:"btn btn-secondary"},"Next",8,Se)])):p("",!0)]))])])):p("",!0),k.value==="source"?(l(),a("section",Ie,[e("div",he,[t[23]||(t[23]=e("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),e("button",{onClick:t[11]||(t[11]=s=>S.value=!S.value),class:"btn btn-primary"},c(S.value?"Cancel":"Add"),1)]),S.value?(l(),a("div",Ce,[e("form",{onSubmit:H(dt,["prevent"]),class:"space-y-4"},[e("div",De,[e("label",null,[M(e("input",{type:"radio","onUpdate:modelValue":t[12]||(t[12]=s=>d.value.type=s),value:"git",class:"radio-input"},null,512),[[_,d.value.type]]),t[24]||(t[24]=b(" Git"))]),e("label",null,[M(e("input",{type:"radio","onUpdate:modelValue":t[13]||(t[13]=s=>d.value.type=s),value:"local",class:"radio-input"},null,512),[[_,d.value.type]]),t[25]||(t[25]=b(" Local"))])]),e("div",null,[t[26]||(t[26]=e("label",null,"Name",-1)),M(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>d.value.name=s),type:"text",class:"input-field",required:""},null,512),[[P,d.value.name]])]),d.value.type==="git"?(l(),a("div",$e,[t[27]||(t[27]=e("label",null,"URL",-1)),M(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>d.value.url=s),type:"url",class:"input-field",required:d.value.type==="git"},null,8,Te),[[P,d.value.url]])])):p("",!0),d.value.type==="local"?(l(),a("div",Pe,[t[28]||(t[28]=e("label",null,"Path",-1)),M(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>d.value.path=s),type:"text",class:"input-field",required:d.value.type==="local"},null,8,ze),[[P,d.value.path]])])):p("",!0),t[29]||(t[29]=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"btn btn-primary"},"Add")],-1))],32)])):p("",!0),u(tt)?(l(),a("div",Ue,"Loading...")):!$.value||$.value.length===0?(l(),a("div",Ee,t[30]||(t[30]=[e("p",null,"No repositories added.",-1)]))):(l(),a("div",Oe,[(l(!0),a(L,null,N($.value,s=>(l(),a("div",{key:s.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between"},[e("div",null,[e("p",Re,c(s.name),1),e("p",Qe,c(s.url),1),e("p",Ze,"Pulled: "+c(rt(s.last_pulled_at)),1)]),e("div",Ve,[e("button",{onClick:j=>ut(s),class:"btn btn-secondary btn-sm"},[y(B,{class:"w-4 h-4 mr-1"}),b(c(s.type==="git"?"Pull":"Rescan"),1)],8,Ye),s.is_deletable?(l(),a("button",{key:0,onClick:j=>ct(s),class:"btn btn-danger btn-sm"},[y(J,{class:"w-4 h-4"})],8,Fe)):p("",!0)])]))),128))]))])):p("",!0)]))}},He=q(Ge,[["__scopeId","data-v-0bb75b26"]]);export{He as default};
