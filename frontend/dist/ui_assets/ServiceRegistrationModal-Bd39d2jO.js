import{K as R,V,c as o,s as S,w as h,n as A,l as v,g as C,e as t,j as L,t as U,H as $,d as y,h as g,z as r,Q as c,f as T,X as B,p as n}from"./index-BaERX4Xe.js";import{_ as I}from"./GenericModal-BhrPHn5j.js";import{_ as E}from"./IconUploader-BZ12N5pf.js";const N={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},j={key:0},D={key:1,class:"space-y-4 p-4 border rounded-md dark:border-gray-600"},O={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},q={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},z={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},K=["disabled"],W={__name:"ServiceRegistrationModal",setup(P){const m=R(),u=V(),i=o(()=>m.modalData("serviceRegistration")),b=o(()=>{var l;return(l=i.value)==null?void 0:l.item}),f=o(()=>{var l;return((l=i.value)==null?void 0:l.itemType)||"app"}),w=o(()=>{var l;return((l=i.value)==null?void 0:l.ownerType)||"user"}),k=o(()=>{var l;return(l=i.value)==null?void 0:l.onRegistered}),d=o(()=>{var l;return!!((l=b.value)!=null&&l.id)}),M=o(()=>{const l=d.value?"Edit":"Register",e=w.value==="system"?"System":"Personal",s=f.value.toUpperCase();return`${l} ${e} ${s}`}),a=S({}),p=S(!1),x=()=>({name:"",url:"",icon:null,active:!0,authentication_type:"none",authentication_key:"",sso_redirect_uri:"",sso_user_infos_to_share:[],type:w.value,autostart:!1,allow_openai_api_access:!1});h(i,l=>{l?a.value={...x(),...l.item||{}}:a.value=x()},{immediate:!0,deep:!0});async function _(){p.value=!0;try{const l={...a.value};f.value==="app"?d.value?await u.updateApp(b.value.id,l):await u.addApp(l):d.value?await u.updateMcp(b.value.id,l):await u.addMcp(l),k.value&&k.value(),m.closeModal("serviceRegistration")}catch{}finally{p.value=!1}}return(l,e)=>(v(),A(I,{"modal-name":"serviceRegistration",title:M.value,maxWidthClass:"max-w-2xl"},{body:C(()=>[t("form",{onSubmit:$(_,["prevent"]),class:"space-y-6"},[t("div",N,[t("div",null,[e[10]||(e[10]=t("label",{for:"service-name",class:"label"},"Name",-1)),r(t("input",{id:"service-name","onUpdate:modelValue":e[0]||(e[0]=s=>a.value.name=s),type:"text",class:"input-field",required:""},null,512),[[c,a.value.name]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"service-url",class:"label"},"URL",-1)),r(t("input",{id:"service-url","onUpdate:modelValue":e[1]||(e[1]=s=>a.value.url=s),type:"url",class:"input-field",required:""},null,512),[[c,a.value.url]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"label"},"Icon",-1)),T(E,{modelValue:a.value.icon,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.icon=s)},null,8,["modelValue"])]),t("div",null,[e[14]||(e[14]=t("label",{for:"service-auth-type",class:"label"},"Authentication Type",-1)),r(t("select",{id:"service-auth-type","onUpdate:modelValue":e[3]||(e[3]=s=>a.value.authentication_type=s),class:"input-field"},e[13]||(e[13]=[t("option",{value:"none"},"None",-1),t("option",{value:"bearer"},"Bearer Token",-1),t("option",{value:"lollms_sso"},"LoLLMs SSO",-1)]),512),[[B,a.value.authentication_type]])]),a.value.authentication_type==="bearer"?(v(),y("div",j,[e[15]||(e[15]=t("label",{for:"service-auth-key",class:"label"},"Authentication Key",-1)),r(t("input",{id:"service-auth-key","onUpdate:modelValue":e[4]||(e[4]=s=>a.value.authentication_key=s),type:"password",class:"input-field",placeholder:"Enter Bearer token"},null,512),[[c,a.value.authentication_key]])])):g("",!0),a.value.authentication_type==="lollms_sso"?(v(),y("div",D,[e[17]||(e[17]=t("h4",{class:"font-semibold"},"SSO Configuration",-1)),t("div",null,[e[16]||(e[16]=t("label",{for:"sso-redirect-uri",class:"label"},"Redirect URI",-1)),r(t("input",{id:"sso-redirect-uri","onUpdate:modelValue":e[5]||(e[5]=s=>a.value.sso_redirect_uri=s),type:"url",class:"input-field",placeholder:"e.g., https://myapp.com/callback"},null,512),[[c,a.value.sso_redirect_uri]])])])):g("",!0),t("div",O,[e[18]||(e[18]=t("span",{class:"text-sm font-medium"},"Start on System Startup",-1)),t("button",{onClick:e[6]||(e[6]=s=>a.value.autostart=!a.value.autostart),type:"button",class:n([a.value.autostart?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:n([a.value.autostart?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),f.value==="app"?(v(),y("div",q,[e[19]||(e[19]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium"},"Allow Access to LoLLMs OpenAI-compatible API"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Exposes your active LLM to this app via a secure API.")],-1)),t("button",{onClick:e[7]||(e[7]=s=>a.value.allow_openai_api_access=!a.value.allow_openai_api_access),type:"button",class:n([a.value.allow_openai_api_access?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:n([a.value.allow_openai_api_access?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)])):g("",!0),t("div",z,[e[20]||(e[20]=t("span",{class:"text-sm font-medium"},"Active",-1)),t("button",{onClick:e[8]||(e[8]=s=>a.value.active=!a.value.active),type:"button",class:n([a.value.active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:n([a.value.active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)])],32)]),footer:C(()=>[t("button",{onClick:e[9]||(e[9]=s=>L(m).closeModal("serviceRegistration")),class:"btn btn-secondary"},"Cancel"),t("button",{onClick:_,class:"btn btn-primary",disabled:p.value},U(p.value?"Saving...":d.value?"Save Changes":"Register"),9,K)]),_:1},8,["title"]))}};export{W as default};
