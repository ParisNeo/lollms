import{u as M,aN as V,a8 as C,c,L as m,k as I,j as B,a as L,o as g,w,b as a,f as x,m as U,aG as $,d as F,t as N,T as y,a7 as O,e as h,F as Z,n as j,ap as q,aq as G}from"./index-CYIRZvEj.js";import{_ as W}from"./GenericModal-Q7SQyOMI.js";const z={class:"space-y-4 h-[70vh] flex flex-col"},A={class:"grid grid-cols-2 gap-4"},H=["value"],J={class:"flex-grow min-h-0 border rounded-md overflow-hidden dark:border-gray-700"},K={class:"flex justify-between items-center w-full"},P=["disabled"],Q={class:"flex gap-2"},R=["disabled"],te={__name:"NoteEditorModal",setup(X){const s=M(),p=V(),b=C(),d=c(()=>s.modalData("noteEditor")),o=c(()=>{var l;return(l=d.value)==null?void 0:l.note}),k=c(()=>{var l,e,t;return((l=d.value)==null?void 0:l.content)||((t=(e=d.value)==null?void 0:e.note)==null?void 0:t.content)}),S=c(()=>{var l,e,t;return((l=d.value)==null?void 0:l.title)||((t=(e=d.value)==null?void 0:e.note)==null?void 0:t.title)}),i=m(""),n=m(""),u=m(null),v=m(!1);function _(){o.value&&o.value.id?(i.value=o.value.title,n.value=o.value.content,u.value=o.value.group_id):(i.value=S.value||"New Note",n.value=k.value||"",u.value=null)}I(()=>s.isModalOpen("noteEditor"),l=>{l&&_()}),B(()=>{s.isModalOpen("noteEditor")&&_()});const T=c(()=>{const l=(e,t="")=>{let f=[];for(const r of e)f.push({value:r.id,text:t+r.name}),r.children&&r.children.length>0&&(f=f.concat(l(r.children,t+"- ")));return f};return[{value:null,text:"None (Top Level)"},...l(p.notesTree.groups)]});async function D(){if(!i.value.trim()){s.addNotification("Title is required.","warning");return}v.value=!0;try{o.value&&o.value.id?await p.updateNote(o.value.id,{title:i.value,content:n.value,group_id:u.value}):await p.createNote({title:i.value,content:n.value,group_id:u.value}),s.closeModal("noteEditor")}finally{v.value=!1}}async function E(){if(!b.currentDiscussionId){s.addNotification("No active discussion.","warning");return}await b.appendToDataZone({discussionId:b.currentDiscussionId,content:n.value})}return(l,e)=>(g(),L(W,{modalName:"noteEditor",title:o.value&&o.value.id?"Edit Note":"New Note",maxWidthClass:"max-w-4xl"},{body:w(()=>[a("div",z,[a("div",A,[a("div",null,[e[4]||(e[4]=a("label",{class:"block text-sm font-medium mb-1"},"Title",-1)),y(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),class:"input-field w-full",placeholder:"Note Title"},null,512),[[O,i.value]])]),a("div",null,[e[5]||(e[5]=a("label",{class:"block text-sm font-medium mb-1"},"Group",-1)),y(a("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),class:"input-field w-full"},[(g(!0),h(Z,null,j(T.value,t=>(g(),h("option",{key:t.value,value:t.value},N(t.text),9,H))),128))],512),[[q,u.value]])])]),a("div",J,[x(G,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value=t),class:"h-full"},null,8,["modelValue"])])])]),footer:w(()=>[a("div",K,[a("button",{onClick:E,class:"btn btn-secondary flex items-center gap-2",disabled:!n.value||!n.value.trim()},[x($,{class:"w-4 h-4"}),e[6]||(e[6]=U(" Import to Data Zone "))],8,P),a("div",Q,[a("button",{onClick:e[3]||(e[3]=t=>F(s).closeModal("noteEditor")),class:"btn btn-secondary"},"Cancel"),a("button",{onClick:D,class:"btn btn-primary",disabled:v.value},N(v.value?"Saving...":"Save"),9,R)])])]),_:1},8,["title"]))}};export{te as default};
