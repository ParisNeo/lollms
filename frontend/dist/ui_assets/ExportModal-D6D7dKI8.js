import{L as E,J as V,q as u,c as x,w as N,n as U,l as a,g,e as l,j as A,t as d,y as m,K as B,h as $,d as i,F as k,i as w,p as z,G as I,m as T,Y as C}from"./index-DAHZjTJM.js";import{_ as j}from"./GenericModal-PUod1r6l.js";const F={class:"space-y-4"},Z={class:"flex items-center space-x-2"},q={class:"relative"},G={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg shadow-xl z-20"},J=["onClick"],K={class:"border dark:border-gray-600 rounded-md max-h-80 overflow-y-auto"},Q={key:0,class:"p-3 space-y-2"},R={class:"border-b dark:border-gray-600 pb-2 mb-2"},W={class:"flex items-center text-sm font-medium cursor-pointer p-1"},Y=["value"],H=["title"],P={key:1,class:"text-center italic text-gray-500 p-6"},X={key:0},ee={key:1},te={class:"text-xs text-center text-gray-500"},se=["disabled"],ne={__name:"ExportModal",setup(le){const h=E(),b=V(),r=u(""),v=u("date_desc"),c=u(!1),S={date_desc:"Most Recent",date_asc:"Oldest First",title_asc:"Title (A-Z)",title_za:"Title (Z-A)"},y=x(()=>Object.values(h.discussions)),o=u([]),p=u(!1),D=x(()=>b.isModalOpen("export")),_=x(()=>y.value.filter(e=>(e.title||"").toLowerCase().includes(r.value.toLowerCase())).sort((e,t)=>{switch(v.value){case"date_asc":return new Date(e.last_activity_at||0)-new Date(t.last_activity_at||0);case"title_asc":return(e.title||"").localeCompare(t.title||"");case"title_za":return(t.title||"").localeCompare(e.title||"");case"date_desc":default:return new Date(t.last_activity_at||0)-new Date(e.last_activity_at||0)}})),f=x({get:()=>{const s=_.value.map(e=>e.id);return s.length>0&&s.every(e=>o.value.includes(e))},set:s=>{const e=_.value.map(t=>t.id);if(s){const t=new Set([...o.value,...e]);o.value=Array.from(t)}else{const t=new Set(e);o.value=o.value.filter(n=>!t.has(n))}}});N(D,s=>{s&&(r.value="",v.value="date_desc",o.value=y.value.map(e=>e.id))});function M(s){v.value=s,c.value=!1}async function O(){p.value=!0;try{await h.exportDiscussions(o.value),b.closeModal("export")}catch{}finally{p.value=!1}}const L={mounted:(s,e)=>{s.__vueClickOutside__=t=>{s===t.target||s.contains(t.target)||e.value(t)},document.body.addEventListener("click",s.__vueClickOutside__)},unmounted:s=>{document.body.removeEventListener("click",s.__vueClickOutside__)}};return(s,e)=>(a(),U(j,{modalName:"export",title:"Export Discussions",maxWidthClass:"max-w-xl"},{body:g(()=>[l("div",F,[l("div",Z,[m(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),placeholder:"Search...",class:"input-field flex-grow"},null,512),[[B,r.value]]),l("div",q,[l("button",{onClick:e[1]||(e[1]=t=>c.value=!c.value),class:"btn btn-secondary !px-3",title:"Sort options"},e[5]||(e[5]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12"})],-1)])),c.value?m((a(),i("div",G,[(a(),i(k,null,w(S,(t,n)=>l("a",{key:n,href:"#",onClick:I(oe=>M(n),["prevent"]),class:z(["block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-blue-500 hover:text-white",{"font-bold text-blue-600 dark:text-blue-400":v.value===n}])},d(t),11,J)),64))])),[[L,()=>c.value=!1]]):$("",!0)])]),l("div",K,[_.value.length>0?(a(),i("div",Q,[l("div",R,[l("label",W,[m(l("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,512),[[C,f.value]]),e[6]||(e[6]=T(" Select / Deselect All Visible "))])]),(a(!0),i(k,null,w(_.value,t=>(a(),i("label",{key:t.id,class:"flex items-center text-sm cursor-pointer p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700"},[m(l("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value=n),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,8,Y),[[C,o.value]]),l("span",{class:"truncate",title:t.title||"Untitled Discussion"},d(t.title||"Untitled Discussion"),9,H)]))),128))])):(a(),i("div",P,[r.value?(a(),i("p",X,"No discussions match your search.")):(a(),i("p",ee,"No discussions to export."))]))]),l("p",te," Selected "+d(o.value.length)+" out of "+d(y.value.length)+" total discussions. ",1)])]),footer:g(()=>[l("button",{onClick:e[4]||(e[4]=t=>A(b).closeModal("export")),class:"btn btn-secondary"},"Cancel"),l("button",{onClick:O,class:"btn btn-primary",disabled:p.value||o.value.length===0},d(p.value?"Exporting...":`Export ${o.value.length} Discussion(s)`),9,se)]),_:1}))}};export{ne as default};
