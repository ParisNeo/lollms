import{u as G,ag as h,T,c as f,L as g,l as A,a as P,o as i,w as I,b as t,d as N,t as w,n as m,f as v,h as b,z as W,aM as B,a2 as j,aN as z,aO as O,C as E,e as n,g as p,a0 as u,an as d,F as U,r as D,as as Q}from"./index-Htkm6tp6.js";import{_ as H}from"./GenericModal-Kg280xj0.js";import{u as X}from"./admin-BqVfPfYE.js";const J={class:"space-y-6"},K={class:"border-b border-gray-200 dark:border-gray-700"},Y={class:"-mb-px flex space-x-4 overflow-x-auto","aria-label":"Tabs"},Z={class:"mt-4"},_={key:0},ee={key:1},te={key:2},ae={key:3},re={key:4},le={key:5},oe=["value"],se={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 border-t dark:border-gray-700 pt-4"},ie=["value"],ne={key:0,class:"mt-2"},ue={class:"flex justify-end gap-3"},de=["disabled"],fe={__name:"GenerateFunFactsModal",setup(pe){const s=G(),k=X(),y=h(),{funFactCategories:C}=T(k),{ownedDataStores:V,sharedDataStores:$}=T(y),F=f(()=>s.modalData("generateFunFacts")),S=f(()=>{var o;return(o=F.value)==null?void 0:o.categoryId}),M=f(()=>{var o;return((o=F.value)==null?void 0:o.nFacts)||5}),L=f(()=>[...V.value,...$.value]),l=g("topic"),a=g({topic:"",text:"",url:"",searchQuery:"",datastoreId:"",datastoreQuery:"",wikiInput:"",categoryId:"",newCategoryName:"",nFacts:5}),x=g(!1),R=f(()=>{if(a.value.categoryId==="new")return a.value.newCategoryName;const o=C.value.find(e=>e.id===a.value.categoryId);return o?o.name:null});A(()=>{y.ownedDataStores.length===0&&y.fetchDataStores(),a.value.nFacts=M.value,S.value&&(a.value.categoryId=S.value)});async function q(){let o="",e=l.value;if(e==="topic"){if(!a.value.topic.trim()){s.addNotification("Topic is required.","warning");return}o=a.value.topic}else if(e==="wikipedia"){if(!a.value.wikiInput.trim()){s.addNotification("Wikipedia Topic or URL is required.","warning");return}o=a.value.wikiInput}else if(e==="text"){if(!a.value.text.trim()){s.addNotification("Text content is required.","warning");return}o=a.value.text}else if(e==="url"){if(!a.value.url.trim()){s.addNotification("URL is required.","warning");return}o=a.value.url}else if(e==="search"){if(!a.value.searchQuery.trim()){s.addNotification("Search query is required.","warning");return}o=a.value.searchQuery}else if(e==="datastore"){if(!a.value.datastoreId){s.addNotification("Please select a DataStore.","warning");return}if(!a.value.datastoreQuery.trim()){s.addNotification("Query/Topic for DataStore is required.","warning");return}o=a.value.datastoreQuery}const r=R.value;x.value=!0;try{const c={source_type:e,content:o,category:r,n_facts:a.value.nFacts,datastore_id:a.value.datastoreId||null};await k.generateFunFacts(c),s.addNotification("Generation task started. Check Tasks for progress.","success"),s.closeModal("generateFunFacts")}catch(c){console.error(c),s.addNotification("Failed to start generation.","error")}finally{x.value=!1}}return(o,e)=>(i(),P(H,{"modal-name":"generateFunFacts",title:"AI Fun Fact Generator","max-width-class":"max-w-3xl"},{body:I(()=>[t("div",J,[t("div",K,[t("nav",Y,[t("button",{onClick:e[0]||(e[0]=r=>l.value="topic"),class:m([l.value==="topic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap"])},[v(W,{class:"mr-2 h-5 w-5"}),e[17]||(e[17]=b(" Topic "))],2),t("button",{onClick:e[1]||(e[1]=r=>l.value="wikipedia"),class:m([l.value==="wikipedia"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap"])},[v(B,{class:"mr-2 h-5 w-5"}),e[18]||(e[18]=b(" Wikipedia "))],2),t("button",{onClick:e[2]||(e[2]=r=>l.value="text"),class:m([l.value==="text"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap"])},[v(j,{class:"mr-2 h-5 w-5"}),e[19]||(e[19]=b(" Raw Text "))],2),t("button",{onClick:e[3]||(e[3]=r=>l.value="url"),class:m([l.value==="url"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap"])},[v(z,{class:"mr-2 h-5 w-5"}),e[20]||(e[20]=b(" Web Page "))],2),t("button",{onClick:e[4]||(e[4]=r=>l.value="search"),class:m([l.value==="search"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap"])},[v(O,{class:"mr-2 h-5 w-5"}),e[21]||(e[21]=b(" Web Search "))],2),t("button",{onClick:e[5]||(e[5]=r=>l.value="datastore"),class:m([l.value==="datastore"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap"])},[v(E,{class:"mr-2 h-5 w-5"}),e[22]||(e[22]=b(" DataStore "))],2)])]),t("div",Z,[l.value==="topic"?(i(),n("div",_,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium mb-1"},"Topic",-1)),u(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=r=>a.value.topic=r),class:"input-field w-full",placeholder:"e.g. Quantum Physics, Cats, The Moon"},null,512),[[d,a.value.topic]]),e[24]||(e[24]=t("p",{class:"text-xs text-gray-500 mt-1"},"The AI will use its internal knowledge to generate facts about this topic.",-1))])):p("",!0),l.value==="wikipedia"?(i(),n("div",ee,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium mb-1"},"Wikipedia Topic or URL",-1)),u(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=r=>a.value.wikiInput=r),class:"input-field w-full",placeholder:"e.g. Marie Curie or https://en.wikipedia.org/wiki/Marie_Curie"},null,512),[[d,a.value.wikiInput]]),e[26]||(e[26]=t("p",{class:"text-xs text-gray-500 mt-1"}," Provide a specific topic title or a full Wikipedia URL. The system will retrieve the page content. Supports multiple languages via URL (e.g. fr.wikipedia.org). ",-1))])):p("",!0),l.value==="text"?(i(),n("div",te,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-1"},"Source Text",-1)),u(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=r=>a.value.text=r),rows:"5",class:"input-field w-full",placeholder:"Paste article or text content here..."},null,512),[[d,a.value.text]]),e[28]||(e[28]=t("p",{class:"text-xs text-gray-500 mt-1"},"Facts will be extracted solely from this text.",-1))])):p("",!0),l.value==="url"?(i(),n("div",ae,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-1"},"URL",-1)),u(t("input",{type:"url","onUpdate:modelValue":e[9]||(e[9]=r=>a.value.url=r),class:"input-field w-full",placeholder:"https://example.com/article"},null,512),[[d,a.value.url]]),e[30]||(e[30]=t("p",{class:"text-xs text-gray-500 mt-1"},"The system will scrape this page and extract facts.",-1))])):p("",!0),l.value==="search"?(i(),n("div",re,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium mb-1"},"Search Query",-1)),u(t("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=r=>a.value.searchQuery=r),class:"input-field w-full",placeholder:"e.g. Latest space discoveries 2024"},null,512),[[d,a.value.searchQuery]]),e[32]||(e[32]=t("p",{class:"text-xs text-gray-500 mt-1"},"The system will perform a web search and generate facts from the top results.",-1))])):p("",!0),l.value==="datastore"?(i(),n("div",le,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium mb-1"},"Select DataStore",-1)),u(t("select",{"onUpdate:modelValue":e[11]||(e[11]=r=>a.value.datastoreId=r),class:"input-field w-full mb-3"},[e[33]||(e[33]=t("option",{value:"",disabled:""},"-- Select --",-1)),(i(!0),n(U,null,D(L.value,r=>(i(),n("option",{key:r.id,value:r.id},w(r.name),9,oe))),128))],512),[[Q,a.value.datastoreId]]),e[35]||(e[35]=t("label",{class:"block text-sm font-medium mb-1"},"Topic/Query",-1)),u(t("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=r=>a.value.datastoreQuery=r),class:"input-field w-full",placeholder:"e.g. Company History, Project X details"},null,512),[[d,a.value.datastoreQuery]]),e[36]||(e[36]=t("p",{class:"text-xs text-gray-500 mt-1"},"The AI will retrieve relevant chunks from the selected DataStore to generate facts.",-1))])):p("",!0)]),t("div",se,[t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium mb-1"},"Target Category",-1)),u(t("select",{"onUpdate:modelValue":e[13]||(e[13]=r=>a.value.categoryId=r),class:"input-field w-full"},[e[37]||(e[37]=t("option",{value:""},"-- Auto-Detect / General --",-1)),e[38]||(e[38]=t("option",{value:"new"},"+ Create New Category",-1)),(i(!0),n(U,null,D(N(C),r=>(i(),n("option",{key:r.id,value:r.id},w(r.name),9,ie))),128))],512),[[Q,a.value.categoryId]]),a.value.categoryId==="new"?(i(),n("div",ne,[u(t("input",{type:"text","onUpdate:modelValue":e[14]||(e[14]=r=>a.value.newCategoryName=r),class:"input-field w-full",placeholder:"New Category Name"},null,512),[[d,a.value.newCategoryName]])])):p("",!0)]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium mb-1"},"Number of Facts",-1)),u(t("input",{type:"number","onUpdate:modelValue":e[15]||(e[15]=r=>a.value.nFacts=r),min:"1",max:"20",class:"input-field w-full"},null,512),[[d,a.value.nFacts,void 0,{number:!0}]])])])])]),footer:I(()=>[t("div",ue,[t("button",{onClick:e[16]||(e[16]=r=>N(s).closeModal("generateFunFacts")),class:"btn btn-secondary"},"Cancel"),t("button",{onClick:q,class:"btn btn-primary",disabled:x.value},w(x.value?"Starting Task...":"Generate Facts"),9,de)])]),_:1}))}};export{fe as default};
