import{u as N,aS as B,b as i,r as p,a7 as L,f as V,o as m,w as G,a as u,A as $,t as y,p as j,J as x,K as C,c as S,F,j as P,L as U}from"./index-CQBOoy6t.js";import{_ as E}from"./GenericModal-CGSnT6pn.js";const T=["value"],q={class:"flex justify-end gap-2"},A=["disabled"],K={__name:"DiscussionGroupModal",setup(H){const d=N(),v=B(),k=i(()=>d.modalData("discussionGroup")),s=p(null),f=p(null),a=p(""),o=p(null),n=p(!1),w=i(()=>v.discussionGroups);L(k,e=>{e?(s.value=e.group,f.value=e.parentGroup,a.value=e.group?e.group.name:"",o.value=e.group?e.group.parent_id:e.parentGroup?e.parentGroup.id:null):(s.value=null,f.value=null,a.value="",o.value=null)},{immediate:!0});const _=i(()=>s.value?"Edit Discussion Group":"New Discussion Group"),g=i(()=>a.value.trim().length>0);function b(e,t=null,l=0){let c=[];const M=e.filter(r=>r.parent_id===t);for(const r of M)s.value&&r.id===s.value.id||(c.push({value:r.id,text:`${"â€”".repeat(l)} ${r.name}`}),c=c.concat(b(e,r.id,l+1)));return c}const D=i(()=>[{value:null,text:"None (Top Level)"},...b(w.value)]);async function h(){if(!(!g.value||n.value)){n.value=!0;try{s.value?await v.updateGroup(s.value.id,a.value,o.value):await v.createGroup(a.value,o.value),d.closeModal("discussionGroup")}catch{}finally{n.value=!1}}}return(e,t)=>(m(),V(E,{modalName:"discussionGroup",title:_.value},{body:G(()=>[u("form",{onSubmit:j(h,["prevent"]),id:"discussion-group-form",class:"space-y-4 p-6"},[u("div",null,[t[3]||(t[3]=u("label",{for:"group-name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Group Name",-1)),x(u("input",{type:"text",id:"group-name","onUpdate:modelValue":t[0]||(t[0]=l=>a.value=l),class:"mt-1 input-field w-full",placeholder:"e.g., Work Projects",required:"",autofocus:""},null,512),[[C,a.value]])]),u("div",null,[t[4]||(t[4]=u("label",{for:"parent-group",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Parent Group",-1)),x(u("select",{id:"parent-group","onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l),class:"mt-1 input-field w-full"},[(m(!0),S(F,null,P(D.value,l=>(m(),S("option",{key:l.value,value:l.value},y(l.text),9,T))),128))],512),[[U,o.value]])])],32)]),footer:G(()=>[u("div",q,[u("button",{type:"button",onClick:t[2]||(t[2]=l=>$(d).closeModal("discussionGroup")),class:"btn btn-secondary"}," Cancel "),u("button",{type:"submit",form:"discussion-group-form",disabled:!g.value||n.value,class:"btn btn-primary"},y(n.value?"Saving...":"Save"),9,A)])]),_:1},8,["title"]))}};export{K as default};
