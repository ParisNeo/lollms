import{aS as L,u as V,r as u,b as x,S as A,f as N,o as a,w as g,a as o,A as U,t as d,J as b,K as B,h as $,c as i,F as k,j as w,n as z,p as I,G as T,O as C}from"./index-BzYhVBtc.js";import{_ as j}from"./GenericModal-CJPUG58e.js";const F={class:"space-y-4"},Z={class:"flex items-center space-x-2"},G={class:"relative"},J={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-gray-800 border dark:border-gray-600 rounded-lg shadow-xl z-20"},K=["onClick"],Q={class:"border dark:border-gray-600 rounded-md max-h-80 overflow-y-auto"},R={key:0,class:"p-3 space-y-2"},W={class:"border-b dark:border-gray-600 pb-2 mb-2"},q={class:"flex items-center text-sm font-medium cursor-pointer p-1"},H=["value"],P=["title"],X={key:1,class:"text-center italic text-gray-500 p-6"},Y={key:0},ee={key:1},te={class:"text-xs text-center text-gray-500"},se=["disabled"],re={__name:"ExportModal",setup(oe){const y=L(),m=V(),n=u(""),v=u("date_desc"),c=u(!1),S={date_desc:"Most Recent",date_asc:"Oldest First",title_asc:"Title (A-Z)",title_za:"Title (Z-A)"},h=x(()=>Object.values(y.discussions)),l=u([]),p=u(!1),D=x(()=>m.isModalOpen("export")),_=x(()=>h.value.filter(e=>(e.title||"").toLowerCase().includes(n.value.toLowerCase())).sort((e,t)=>{switch(v.value){case"date_asc":return new Date(e.last_activity_at||0)-new Date(t.last_activity_at||0);case"title_asc":return(e.title||"").localeCompare(t.title||"");case"title_za":return(t.title||"").localeCompare(e.title||"");case"date_desc":default:return new Date(t.last_activity_at||0)-new Date(e.last_activity_at||0)}})),f=x({get:()=>{const s=_.value.map(e=>e.id);return s.length>0&&s.every(e=>l.value.includes(e))},set:s=>{const e=_.value.map(t=>t.id);if(s){const t=new Set([...l.value,...e]);l.value=Array.from(t)}else{const t=new Set(e);l.value=l.value.filter(r=>!t.has(r))}}});A(D,s=>{s&&(n.value="",v.value="date_desc",l.value=h.value.map(e=>e.id))});function M(s){v.value=s,c.value=!1}async function O(){p.value=!0;try{await y.exportDiscussions(l.value),m.closeModal("export")}catch{}finally{p.value=!1}}const E={mounted:(s,e)=>{s.__vueClickOutside__=t=>{s===t.target||s.contains(t.target)||e.value(t)},document.body.addEventListener("click",s.__vueClickOutside__)},unmounted:s=>{document.body.removeEventListener("click",s.__vueClickOutside__)}};return(s,e)=>(a(),N(j,{modalName:"export",title:"Export Discussions",maxWidthClass:"max-w-xl"},{body:g(()=>[o("div",F,[o("div",Z,[b(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),placeholder:"Search...",class:"input-field flex-grow"},null,512),[[B,n.value]]),o("div",G,[o("button",{onClick:e[1]||(e[1]=t=>c.value=!c.value),class:"btn btn-secondary !px-3",title:"Sort options"},e[5]||(e[5]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12"})],-1)])),c.value?b((a(),i("div",J,[(a(),i(k,null,w(S,(t,r)=>o("a",{key:r,href:"#",onClick:I(le=>M(r),["prevent"]),class:z(["block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-blue-500 hover:text-white",{"font-bold text-blue-600 dark:text-blue-400":v.value===r}])},d(t),11,K)),64))])),[[E,()=>c.value=!1]]):$("",!0)])]),o("div",Q,[_.value.length>0?(a(),i("div",R,[o("div",W,[o("label",q,[b(o("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,512),[[C,f.value]]),e[6]||(e[6]=T(" Select / Deselect All Visible "))])]),(a(!0),i(k,null,w(_.value,t=>(a(),i("label",{key:t.id,class:"flex items-center text-sm cursor-pointer p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700"},[b(o("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[3]||(e[3]=r=>l.value=r),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"},null,8,H),[[C,l.value]]),o("span",{class:"truncate",title:t.title||"Untitled Discussion"},d(t.title||"Untitled Discussion"),9,P)]))),128))])):(a(),i("div",X,[n.value?(a(),i("p",Y,"No discussions match your search.")):(a(),i("p",ee,"No discussions to export."))]))]),o("p",te," Selected "+d(l.value.length)+" out of "+d(h.value.length)+" total discussions. ",1)])]),footer:g(()=>[o("button",{onClick:e[4]||(e[4]=t=>U(m).closeModal("export")),class:"btn btn-secondary"},"Cancel"),o("button",{onClick:O,class:"btn btn-primary",disabled:p.value||l.value.length===0},d(p.value?"Exporting...":`Export ${l.value.length} Discussion(s)`),9,se)]),_:1}))}};export{re as default};
