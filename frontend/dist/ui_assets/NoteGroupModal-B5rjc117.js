import{J as N,aw as _,c as p,q as d,w as h,n as M,l as c,g,e as o,j as B,t as y,G as D,y as b,K as V,d as x,F as C,i as F,W as L}from"./index-Dw1feZsf.js";import{_ as T}from"./GenericModal-DSpuqT2f.js";const U=["value"],j={class:"flex justify-end gap-2"},q=["disabled"],J={__name:"NoteGroupModal",setup(E){const v=N(),m=_(),G=p(()=>v.modalData("noteGroup")),a=d(null),u=d(""),n=d(null),s=d(!1);h(G,e=>{e?(a.value=e.group,u.value=e.group?e.group.name:"",n.value=e.group?e.group.parent_id:e.parentGroup?e.parentGroup.id:null):(a.value=null,u.value="",n.value=null)},{immediate:!0});const w=p(()=>a.value?"Edit Note Group":"New Note Group"),f=p(()=>u.value.trim().length>0),S=p(()=>{const e=(t,l="")=>{let i=[];for(const r of t)a.value&&r.id===a.value.id||(i.push({value:r.id,text:l+r.name}),r.children&&r.children.length>0&&(i=i.concat(e(r.children,l+"- "))));return i};return[{value:null,text:"None (Top Level)"},...e(m.notesTree.groups)]});async function k(){if(!(!f.value||s.value)){s.value=!0;try{a.value?await m.updateGroup(a.value.id,u.value,n.value):await m.createGroup(u.value,n.value),v.closeModal("noteGroup")}finally{s.value=!1}}}return(e,t)=>(c(),M(T,{modalName:"noteGroup",title:w.value},{body:g(()=>[o("form",{onSubmit:D(k,["prevent"]),id:"note-group-form",class:"space-y-4 p-6"},[o("div",null,[t[3]||(t[3]=o("label",{for:"group-name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Group Name",-1)),b(o("input",{type:"text",id:"group-name","onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),class:"mt-1 input-field w-full",placeholder:"e.g., Research",required:"",autofocus:""},null,512),[[V,u.value]])]),o("div",null,[t[4]||(t[4]=o("label",{for:"parent-group",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Parent Group",-1)),b(o("select",{id:"parent-group","onUpdate:modelValue":t[1]||(t[1]=l=>n.value=l),class:"mt-1 input-field w-full"},[(c(!0),x(C,null,F(S.value,l=>(c(),x("option",{key:l.value,value:l.value},y(l.text),9,U))),128))],512),[[L,n.value]])])],32)]),footer:g(()=>[o("div",j,[o("button",{type:"button",onClick:t[2]||(t[2]=l=>B(v).closeModal("noteGroup")),class:"btn btn-secondary"}," Cancel "),o("button",{type:"submit",form:"note-group-form",disabled:!f.value||s.value,class:"btn btn-primary"},y(s.value?"Saving...":"Save"),9,q)])]),_:1},8,["title"]))}};export{J as default};
