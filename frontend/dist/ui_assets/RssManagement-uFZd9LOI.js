import{L as o,u as A,j as V,e as n,o as i,l as T,b as e,t as d,P as y,Y as _,a8 as $,K as D,f as v,p as h,J as x,an as E,O as L,F as M,m as U,ao as j,as as I,R as f}from"./index-x6ZZ9rZx.js";import{u as B}from"./admin-BhxeX2xU.js";const q={class:"space-y-6"},P={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},z={class:"text-xl font-semibold mb-4"},J={class:"flex items-center"},K={class:"flex justify-end gap-2"},O={type:"submit",class:"btn btn-primary"},Y={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},G={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center"},H={class:"flex items-center gap-2"},Q=["disabled"],W={key:0,class:"p-6 text-center text-gray-500"},X={key:1,class:"p-6 text-center text-gray-500"},Z={key:2,class:"divide-y dark:divide-gray-700"},ee={class:"font-semibold"},se={class:"text-sm text-gray-500 font-mono"},te={class:"flex gap-2 flex-shrink-0"},ae=["onClick"],le=["onClick"],de={__name:"RssManagement",setup(ne){const p=o([]),b=o(!1),r=o(!1),c=o(!1),a=o({id:null,name:"",url:"",is_active:!0}),m=A(),w=B(),u=o(!1);async function g(){b.value=!0;try{const l=await f.get("/api/admin/rss-feeds");p.value=l.data}catch{m.addNotification("Failed to load RSS feeds.","error")}finally{b.value=!1}}function k(){c.value=!1,a.value={id:null,name:"",url:"",is_active:!0},r.value=!0}function S(l){c.value=!0,a.value={...l},r.value=!0}async function F(){try{c.value?(await f.put(`/api/admin/rss-feeds/${a.value.id}`,a.value),m.addNotification("Feed updated.","success")):(await f.post("/api/admin/rss-feeds",a.value),m.addNotification("Feed added.","success")),await g(),r.value=!1}catch{}}async function C(l){(await m.showConfirmation({title:`Delete Feed '${l.name}'?`,message:"This will also delete all news articles from this source. This action cannot be undone.",confirmText:"Delete"})).confirmed&&(await f.delete(`/api/admin/rss-feeds/${l.id}`),await g())}async function N(){u.value=!0;try{await w.triggerRssScraping()}finally{u.value=!1}}return V(g),(l,s)=>(i(),n("div",q,[r.value?(i(),n("div",P,[e("h3",z,d(c.value?"Edit RSS Feed":"Add New RSS Feed"),1),e("form",{onSubmit:D(F,["prevent"]),class:"space-y-4"},[e("div",null,[s[4]||(s[4]=e("label",{class:"label"},"Name",-1)),y(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>a.value.name=t),type:"text",class:"input-field",required:"",placeholder:"e.g., Tech News"},null,512),[[_,a.value.name]])]),e("div",null,[s[5]||(s[5]=e("label",{class:"label"},"URL",-1)),y(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.value.url=t),type:"url",class:"input-field",required:"",placeholder:"https://example.com/rss.xml"},null,512),[[_,a.value.url]])]),e("div",J,[y(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>a.value.is_active=t),type:"checkbox",id:"is_active_checkbox",class:"h-4 w-4 rounded"},null,512),[[$,a.value.is_active]]),s[6]||(s[6]=e("label",{for:"is_active_checkbox",class:"ml-2"},"Active",-1))]),e("div",K,[e("button",{type:"button",onClick:s[3]||(s[3]=t=>r.value=!1),class:"btn btn-secondary"},"Cancel"),e("button",O,d(c.value?"Save Changes":"Add Feed"),1)])],32)])):T("",!0),e("div",Y,[e("div",G,[s[8]||(s[8]=e("h3",{class:"text-xl font-semibold"},"RSS Feed Sources",-1)),e("div",H,[e("button",{onClick:N,class:"btn btn-secondary btn-sm",disabled:u.value},[v(E,{class:x(["w-4 h-4 mr-1",{"animate-spin":u.value}])},null,8,["class"]),h(" "+d(u.value?"Scraping...":"Scrape Now"),1)],8,Q),e("button",{onClick:k,class:"btn btn-primary btn-sm"},[v(L,{class:"w-4 h-4 mr-1"}),s[7]||(s[7]=h("Add Feed"))])])]),b.value?(i(),n("div",W,"Loading feeds...")):p.value.length===0?(i(),n("div",X,"No RSS feeds configured. Add one to get started.")):(i(),n("ul",Z,[(i(!0),n(M,null,U(p.value,t=>(i(),n("li",{key:t.id,class:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("div",null,[e("p",ee,[h(d(t.name)+" ",1),e("span",{class:x(["text-xs px-2 py-0.5 rounded-full ml-2",t.is_active?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":"bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-300"])},d(t.is_active?"Active":"Inactive"),3)]),e("p",se,d(t.url),1)]),e("div",te,[e("button",{onClick:R=>S(t),class:"btn-icon",title:"Edit"},[v(j,{class:"w-4 h-4"})],8,ae),e("button",{onClick:R=>C(t),class:"btn-icon-danger",title:"Delete"},[v(I,{class:"w-4 h-4"})],8,le)])]))),128))]))])]))}};export{de as default};
