import{D as Je,g as M,d as w,f as n,ah as Mt,x as _t,a as Rt,u as Lt,r as l,c as Ge,o as St,aa as Ut,I as Pt,q as Dt,S as Et,A as p,P as Bt,F as pe,B as He,h as fe,i as I,v as E,t as V,p as Q,U as $t,k as me,cU as Tt,O as Ke,au as zt,af as Vt,a3 as qe,ab as Le,z as At,J as Nt,b as Ft,av as jt,K as Ot,cq as u}from"./index-GJY6etPD.js";import{I as Wt,a as Yt}from"./IconRedo-BxA1vHRl.js";import{I as Xt}from"./IconMinus-Bu2JcVti.js";import{I as Gt}from"./IconMaximize-C1EvP3T_.js";const Ht={},Kt={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function qt(Se,le){return w(),M("svg",Kt,le[0]||(le[0]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"},null,-1)]))}const Jt=Je(Ht,[["render",qt]]),Zt={class:"h-full flex flex-col bg-gray-100 dark:bg-gray-900 overflow-hidden relative select-none"},Qt={class:"h-16 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between px-4 z-20 shadow-sm gap-4"},ea={class:"flex items-center gap-2"},ta={class:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1 gap-1"},aa=["onClick","title"],na={class:"flex items-center gap-4 flex-grow justify-center"},la={class:"flex items-center gap-2",title:"Primary Color"},sa={key:0,class:"flex items-center gap-2"},oa={class:"text-xs w-6 font-mono"},ia={key:1,class:"flex items-center gap-2"},ra={class:"text-xs w-8 font-mono"},ua={key:2,class:"flex items-center gap-2"},ca={class:"text-xs w-6 font-mono"},da={class:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1 gap-1"},va={class:"flex items-center gap-2"},ga=["disabled"],pa=["disabled"],fa=["title"],ma={class:"flex-grow flex min-h-0 relative"},ha={class:"absolute bottom-4 left-4 bg-white/90 dark:bg-gray-800/90 backdrop-blur rounded-lg shadow p-2 flex items-center gap-2 z-10 border border-gray-200 dark:border-gray-700"},ba={class:"text-xs font-mono w-12 text-center"},wa={class:"w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col z-20 shadow-xl"},ya={class:"p-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 flex justify-between items-center"},xa={key:0,class:"flex items-center text-xs text-blue-500 animate-pulse"},ka={class:"flex-grow overflow-y-auto p-4 space-y-5 custom-scrollbar"},Ca={class:"space-y-3"},Ia={class:"flex justify-between items-center mb-1"},Ma=["disabled"],_a={class:"flex justify-between items-center mb-1"},Ra=["disabled"],La={class:"space-y-4 pt-4 border-t dark:border-gray-700"},Sa={class:"label flex justify-between"},Ua={class:"text-gray-500"},Pa={class:"label flex justify-between"},Da={class:"text-gray-500"},Ea=["value"],Ba={class:"flex gap-2"},$a={class:"p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50"},Ta=["disabled"],za={__name:"ImageEditorView",props:{id:{type:String,default:null}},setup(Se){const le={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M5 19L19 5"})])},Ze={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("circle",{cx:"12",cy:"12",r:"9"})])},Qe={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"})])},et={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M19 11L12 17L5 11"}),u("path",{d:"M12 17V3"})])},tt={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M15 4V2"}),u("path",{d:"M15 16V14"}),u("path",{d:"M8 9h2"}),u("path",{d:"M20 9h2"}),u("path",{d:"M17.8 11.8L19 13"}),u("path",{d:"M10.6 5.2L12 6.6"}),u("path",{d:"M11.6 12.2l-8.4 8.6"})])},at={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M14 4l6 6-11 11-6 1L4 16 15 5z"}),u("path",{d:"M14 4l-4 4"})])},nt={render:()=>u("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M20 20H7L3 16C2 15 2 13 3 12L13 2L22 11L20 20Z"}),u("path",{d:"M11 11L20 20"})])},he=Se,Ue=Et(),se=Mt(),lt=_t(),A=Rt(),oe=Lt(),{on:be,off:we}=Ut(),g=l(!1),ie=l(null),c=l(null),_=l(null),B=l(null),R=l(null),Y=l(null),ye=l(null),f=l("image"),o=l("brush"),X=l("#000000"),G=l(40),N=l(1),ee=l(10),U=l(1),xe=l(0),ke=l(0),$=l(""),F=l(""),re=l(.75),ue=l(7.5),ce=l(-1),te=l(""),m=l(!1),T=l(!1),j=l(null),Pe=l(""),De=l("description"),O=l(!1),Ce=l(0),Ie=l(0),Ee=l(0),Be=l(0),y=l(0),x=l(0),L=l([]),h=l(-1),st=[{id:"pan",name:"Pan (Space)",icon:Jt},{id:"brush",name:"Brush (B)",icon:Ot},{id:"eraser",name:"Eraser (E)",icon:nt},{id:"fill",name:"Fill (F)",icon:et},{id:"wand",name:"Magic Wand (W)",icon:tt},{id:"line",name:"Line (L)",icon:le},{id:"rect",name:"Rectangle (R)",icon:Qe},{id:"circle",name:"Circle (C)",icon:Ze},{id:"pipette",name:"Pipette (I)",icon:at}],ot=Ge(()=>lt.availableTtiModels),it=Ge(()=>["brush","eraser","circle"].includes(o.value)&&o.value!=="pan");function rt(a){o.value=a}function $e(a){g.value&&(a.prompt&&($.value=a.prompt),a.negative_prompt&&(F.value=a.negative_prompt),T.value&&(T.value=!1,m.value=!1,j.value=null,A.addNotification("Prompt enhanced.","success")))}function Te(a){g.value&&m.value&&!T.value&&a&&a.id&&(Ve(a.id).then(()=>{g.value&&A.addNotification("Result loaded into editor.","success")}),m.value=!1,j.value=null,f.value==="mask"&&clearMask())}function ze(a){if(g.value&&j.value&&a.id===j.value){if(a.name.startsWith("Enhancing prompt")&&a.status==="completed"&&a.result){let e=a.result;if(typeof e=="string")try{e=JSON.parse(e)}catch{}e&&(e.prompt||e.negative_prompt)&&(e.prompt&&($.value=e.prompt),e.negative_prompt&&(F.value=e.negative_prompt),A.addNotification("Prompt enhanced.","success"))}a.status==="failed"&&A.addNotification(`Task failed: ${a.error||"Unknown error"}`,"error"),m.value=!1,T.value=!1,j.value=null}}let H=null;St(async()=>{g.value=!0,be("prompt:enhanced",$e),be("image:generated",Te),be("task:completed",ze),c.value&&(R.value=c.value.getContext("2d",{willReadFrequently:!0})),_.value&&(Y.value=_.value.getContext("2d",{willReadFrequently:!0})),B.value&&(ye.value=B.value.getContext("2d")),he.id==="new"?ut():he.id&&await Ve(he.id),oe.user&&(te.value=oe.user.iti_binding_model_name||oe.user.tti_binding_model_name||""),window.addEventListener("keydown",Xe),window.addEventListener("resize",ae)}),Pt(()=>{g.value=!1,we("prompt:enhanced",$e),we("image:generated",Te),we("task:completed",ze),window.removeEventListener("keydown",Xe),window.removeEventListener("resize",ae),H&&URL.revokeObjectURL(H)});function ut(a=1024,e=1024){Ae(a,e),R.value.fillStyle="#FFFFFF",R.value.fillRect(0,0,a,e),K(),ae()}async function Ve(a){if(g.value)try{const e=await Dt.get(`/api/image-studio/${a}/file`,{responseType:"blob"});if(!g.value)return;H&&URL.revokeObjectURL(H),H=URL.createObjectURL(e.data);const t=new Image;if(await new Promise((i,d)=>{t.onload=i,t.onerror=d,t.src=H}),!g.value)return;Ae(t.naturalWidth,t.naturalHeight),R.value.drawImage(t,0,0);const s=se.images.find(i=>i.id===a);s&&($.value=s.prompt||"",F.value=s.negative_prompt||""),K(),ae()}catch(e){if(!g.value)return;console.error("Load failed",e),A.addNotification("Failed to load image. It may have been deleted or access denied.","error"),Ue.push("/image-studio")}}function Ae(a,e){[c,_,B].forEach(t=>{t.value&&(t.value.width=a,t.value.height=e)})}function Me(a){if(!c.value)return{x:0,y:0};const e=c.value.getBoundingClientRect(),t=c.value.width/e.width,s=c.value.height/e.height;return{x:(a.clientX-e.left)*t,y:(a.clientY-e.top)*s}}function ct(a){if(a.button!==0)return;O.value=!0;const{x:e,y:t}=Me(a);if(Ce.value=a.clientX,Ie.value=a.clientY,y.value=e,x.value=t,o.value==="pipette"){pt(e,t),O.value=!1;return}if(o.value==="fill"){ft(Math.floor(e),Math.floor(t)),K(),O.value=!1;return}if(o.value==="wand"){mt(Math.floor(e),Math.floor(t)),K(),O.value=!1;return}if(["brush","eraser"].includes(o.value)){const s=f.value==="image"?R.value:Y.value;s.beginPath(),s.moveTo(e,t),Fe(e,t)}}function dt(a){const{x:e,y:t}=Me(a);if(Ee.value=e,Be.value=t,!!O.value){if(o.value==="pan"){xe.value+=a.clientX-Ce.value,ke.value+=a.clientY-Ie.value,Ce.value=a.clientX,Ie.value=a.clientY;return}["brush","eraser"].includes(o.value)?Fe(e,t):["line","rect","circle"].includes(o.value)&&vt(e,t)}}function Ne(a){if(O.value){if(O.value=!1,["line","rect","circle"].includes(o.value)){const{x:e,y:t}=Me(a);gt(e,t)}o.value!=="pan"&&o.value!=="pipette"&&K()}}function de(){return f.value==="image"?R.value:Y.value}function _e(a){a.lineCap="round",a.lineJoin="round",a.lineWidth=G.value,o.value==="eraser"?a.globalCompositeOperation="destination-out":(a.globalCompositeOperation="source-over",a.globalAlpha=N.value,a.fillStyle=f.value==="mask"?`rgba(255,255,255,${N.value})`:X.value,a.strokeStyle=f.value==="mask"?`rgba(255,255,255,${N.value})`:X.value)}function Fe(a,e){const t=de();_e(t),t.lineTo(a,e),t.stroke(),t.beginPath(),t.moveTo(a,e)}function vt(a,e){const t=ye.value,s=B.value.width,i=B.value.height;if(t.clearRect(0,0,s,i),_e(t),t.beginPath(),o.value==="line")t.moveTo(y.value,x.value),t.lineTo(a,e);else if(o.value==="rect")t.rect(y.value,x.value,a-y.value,e-x.value);else if(o.value==="circle"){const d=Math.sqrt(Math.pow(a-y.value,2)+Math.pow(e-x.value,2));t.arc(y.value,x.value,d,0,2*Math.PI)}t.stroke(),o.value!=="line"&&t.fill()}function gt(a,e){ye.value.clearRect(0,0,B.value.width,B.value.height);const t=de();if(_e(t),t.beginPath(),o.value==="line")t.moveTo(y.value,x.value),t.lineTo(a,e),t.stroke();else if(o.value==="rect")t.rect(y.value,x.value,a-y.value,e-x.value),t.fill(),t.stroke();else if(o.value==="circle"){const s=Math.sqrt(Math.pow(a-y.value,2)+Math.pow(e-x.value,2));t.arc(y.value,x.value,s,0,2*Math.PI),t.fill(),t.stroke()}t.globalAlpha=1,t.globalCompositeOperation="source-over"}function pt(a,e){const t=R.value.getImageData(a,e,1,1).data,s="#"+("000000"+(t[0]<<16|t[1]<<8|t[2]).toString(16)).slice(-6);X.value=s}function ft(a,e){const t=de(),s=t.canvas.width,i=t.canvas.height;if(a<0||e<0||a>=s||e>=i)return;const d=t.getImageData(0,0,s,i),r=d.data,P=(e*s+a)*4,b=r[P],W=r[P+1],ve=r[P+2],ge=r[P+3];let q,J,Z;const S=X.value.replace("#","");q=parseInt(S.substring(0,2),16),J=parseInt(S.substring(2,4),16),Z=parseInt(S.substring(4,6),16);const ne=Math.round(N.value*255);if(f.value==="mask"&&(q=255,J=255,Z=255),Re(b,W,ve,ge,q,J,Z,ne,0))return;const k=[[a,e]],D=ee.value;for(;k.length;){const[C,v]=k.pop(),z=(v*s+C)*4;C<0||v<0||C>=s||v>=i||Re(r[z],r[z+1],r[z+2],r[z+3],b,W,ve,ge,D)&&(r[z]=q,r[z+1]=J,r[z+2]=Z,r[z+3]=ne,k.push([C+1,v],[C-1,v],[C,v+1],[C,v-1]))}t.putImageData(d,0,0)}function mt(a,e){const t=R.value,s=Y.value,i=t.canvas.width,d=t.canvas.height,r=t.getImageData(0,0,i,d).data,P=s.getImageData(0,0,i,d),b=P.data,W=(e*i+a)*4,ve=r[W],ge=r[W+1],q=r[W+2],J=r[W+3],Z=ee.value,S=[[a,e]],ne=new Uint8Array(i*d);for(;S.length;){const[k,D]=S.pop(),C=D*i+k;if(ne[C])continue;ne[C]=1;const v=C*4;Re(r[v],r[v+1],r[v+2],r[v+3],ve,ge,q,J,Z)&&(b[v]=255,b[v+1]=255,b[v+2]=255,b[v+3]=255,k+1<i&&S.push([k+1,D]),k-1>=0&&S.push([k-1,D]),D+1<d&&S.push([k,D+1]),D-1>=0&&S.push([k,D-1]))}s.putImageData(P,0,0)}function Re(a,e,t,s,i,d,r,P,b){return Math.abs(a-i)<=b&&Math.abs(e-d)<=b&&Math.abs(t-r)<=b&&Math.abs(s-P)<=b}function K(){h.value<L.value.length-1&&(L.value=L.value.slice(0,h.value+1)),L.value.push({image:c.value.toDataURL(),mask:_.value.toDataURL()}),h.value++,L.value.length>20&&(L.value.shift(),h.value--)}function je(a){const e=new Image;e.onload=()=>{R.value.clearRect(0,0,c.value.width,c.value.height),R.value.drawImage(e,0,0)},e.src=a.image;const t=new Image;t.onload=()=>{Y.value.clearRect(0,0,_.value.width,_.value.height),Y.value.drawImage(t,0,0)},t.src=a.mask}function Oe(){h.value>0&&(h.value--,je(L.value[h.value]))}function We(){h.value<L.value.length-1&&(h.value++,je(L.value[h.value]))}function ht(){const a=de();a.clearRect(0,0,a.canvas.width,a.canvas.height),K()}async function bt(){if(g.value){m.value=!0;try{const a=c.value.toDataURL("image/png").split(",")[1],e=document.createElement("canvas");e.width=_.value.width,e.height=_.value.height;const t=e.getContext("2d");t.fillStyle="#000000",t.fillRect(0,0,e.width,e.height),t.drawImage(_.value,0,0);const s=e.toDataURL("image/png").split(",")[1],i=await se.editImage({base_image_b64:a,mask:s,prompt:$.value,negative_prompt:F.value,strength:re.value,cfg_scale:ue.value,seed:ce.value,model:te.value,width:c.value.width,height:c.value.height});i&&i.id&&(j.value=i.id)}catch{g.value&&(A.addNotification("Generation failed","error"),m.value=!1)}}}function Ye(a){A.openModal("enhancePrompt",{instructions:Pe.value,mode:De.value,onConfirm:({instructions:e,mode:t})=>{Pe.value=e,De.value=t,wt(a,{instructions:e,mode:t})}})}async function wt(a,e={}){var i;if(!g.value)return;T.value=!0,m.value=!0;let t=null;try{t=[c.value.toDataURL("image/png").split(",")[1]]}catch{}const s={prompt:$.value,negative_prompt:F.value,target:a,model:(i=oe.user)==null?void 0:i.lollms_model_name,instructions:e.instructions||"",mode:e.mode||"description",image_b64s:t};try{const d=await se.enhanceImagePrompt(s);d&&d.id&&(j.value=d.id)}catch{g.value&&(m.value=!1,T.value=!1)}}function yt(){Ue.push("/image-studio")}function xt(){if(!g.value)return;const a=c.value.toDataURL("image/png").split(",")[1];se.saveCanvasAsNewImage({base_image_b64:a,prompt:$.value||"Edited",width:c.value.width,height:c.value.height,model:te.value})}function ae(){if(!ie.value||!c.value)return;const a=ie.value.clientWidth,e=ie.value.clientHeight,t=c.value.width,s=c.value.height;if(t===0)return;const i=Math.min((a-40)/t,(e-40)/s,1);U.value=i,xe.value=0,ke.value=0}function kt(a){(a.ctrlKey||o.value==="pan")&&(a.preventDefault(),U.value=Math.min(Math.max(.1,U.value-Math.sign(a.deltaY)*.1),5))}function Ct(){U.value=Math.min(5,U.value+.1)}function It(){U.value=Math.max(.1,U.value-.1)}function Xe(a){if(a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA")return;const e={" ":"pan",b:"brush",e:"eraser",f:"fill",w:"wand",l:"line",r:"rect",c:"circle",i:"pipette"};e[a.key.toLowerCase()]&&(o.value=e[a.key.toLowerCase()]),(a.ctrlKey||a.metaKey)&&a.key.toLowerCase()==="z"&&Oe(),(a.ctrlKey||a.metaKey)&&a.key.toLowerCase()==="y"&&We()}return(a,e)=>(w(),M("div",Zt,[n("div",Qt,[n("div",ea,[n("button",{onClick:yt,class:"btn-icon",title:"Back to Gallery"},[p(Bt,{class:"w-5 h-5"})]),e[15]||(e[15]=n("div",{class:"h-6 w-px bg-gray-300 dark:bg-gray-600 mx-2"},null,-1)),n("div",ta,[(w(),M(pe,null,He(st,t=>n("button",{key:t.id,onClick:s=>rt(t.id),class:Q(["p-2 rounded-md transition-colors relative group",o.value===t.id?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"]),title:t.name},[(w(),Ft(jt(t.icon),{class:"w-5 h-5"}))],10,aa)),64))])]),n("div",na,[n("div",la,[I(n("input",{type:"color","onUpdate:modelValue":e[0]||(e[0]=t=>X.value=t),class:"w-8 h-8 rounded cursor-pointer border-0 p-0 bg-transparent"},null,512),[[E,X.value]])]),["brush","eraser","line","rect","circle"].includes(o.value)?(w(),M("div",sa,[e[16]||(e[16]=n("span",{class:"text-xs font-medium uppercase text-gray-500"},"Size",-1)),I(n("input",{type:"range","onUpdate:modelValue":e[1]||(e[1]=t=>G.value=t),min:"1",max:"200",class:"w-24 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-600"},null,512),[[E,G.value,void 0,{number:!0}]]),n("span",oa,V(G.value),1)])):fe("",!0),o.value!=="eraser"&&o.value!=="wand"&&o.value!=="pan"&&o.value!=="pipette"?(w(),M("div",ia,[e[17]||(e[17]=n("span",{class:"text-xs font-medium uppercase text-gray-500"},"Opacity",-1)),I(n("input",{type:"range","onUpdate:modelValue":e[2]||(e[2]=t=>N.value=t),min:"0",max:"1",step:"0.05",class:"w-24 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-600"},null,512),[[E,N.value,void 0,{number:!0}]]),n("span",ra,V(Math.round(N.value*100))+"%",1)])):fe("",!0),["fill","wand"].includes(o.value)?(w(),M("div",ua,[e[18]||(e[18]=n("span",{class:"text-xs font-medium uppercase text-gray-500"},"Tolerance",-1)),I(n("input",{type:"range","onUpdate:modelValue":e[3]||(e[3]=t=>ee.value=t),min:"0",max:"100",class:"w-24 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-600"},null,512),[[E,ee.value,void 0,{number:!0}]]),n("span",ca,V(ee.value),1)])):fe("",!0),e[19]||(e[19]=n("div",{class:"h-6 w-px bg-gray-300 dark:bg-gray-600 mx-2"},null,-1)),n("div",da,[n("button",{onClick:e[4]||(e[4]=t=>f.value="image"),class:Q(["px-3 py-1.5 text-xs font-medium rounded transition-colors",f.value==="image"?"bg-white dark:bg-gray-600 shadow-sm":"text-gray-500"])},"Image",2),n("button",{onClick:e[5]||(e[5]=t=>f.value="mask"),class:Q(["px-3 py-1.5 text-xs font-medium rounded transition-colors",f.value==="mask"?"bg-white dark:bg-gray-600 shadow-sm":"text-gray-500"])},"Mask",2)])]),n("div",va,[n("button",{onClick:Oe,disabled:h.value<=0,class:"btn-icon",title:"Undo (Ctrl+Z)"},[p(Wt,{class:"w-5 h-5"})],8,ga),n("button",{onClick:We,disabled:h.value>=L.value.length-1,class:"btn-icon",title:"Redo (Ctrl+Y)"},[p(Yt,{class:"w-5 h-5"})],8,pa),n("button",{onClick:ht,class:"btn-icon text-red-500 hover:text-red-600",title:`Clear ${f.value==="mask"?"Mask":"Image"}`},[p($t,{class:"w-5 h-5"})],8,fa),n("button",{onClick:xt,class:"btn btn-secondary btn-sm gap-2"},[p(Tt,{class:"w-4 h-4"}),e[20]||(e[20]=me(" Save"))])])]),n("div",ma,[n("div",{ref_key:"containerRef",ref:ie,class:"flex-grow bg-gray-200 dark:bg-gray-900 relative overflow-hidden flex items-center justify-center cursor-crosshair pattern-grid",onWheel:kt,onMousedown:ct,onMousemove:dt,onMouseup:Ne,onMouseleave:Ne},[n("div",{style:Ke({transform:`translate(${xe.value}px, ${ke.value}px) scale(${U.value})`}),class:"relative shadow-2xl origin-center transition-transform duration-75 canvas-stack"},[n("canvas",{ref_key:"imageCanvasRef",ref:c,class:"block bg-white layer-canvas"},null,512),n("canvas",{ref_key:"maskCanvasRef",ref:_,class:Q(["absolute inset-0 opacity-60 layer-canvas",{"pointer-events-none":f.value!=="mask"}])},null,2),n("canvas",{ref_key:"previewCanvasRef",ref:B,class:"absolute inset-0 pointer-events-none layer-canvas"},null,512),I(n("div",{class:"absolute pointer-events-none rounded-full border border-black/50 bg-white/20 z-50 transform -translate-x-1/2 -translate-y-1/2",style:Ke({width:`${G.value}px`,height:`${G.value}px`,left:`${Ee.value}px`,top:`${Be.value}px`})},null,4),[[zt,it.value]])],4),n("div",ha,[n("button",{onClick:It,class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},[p(Xt,{class:"w-4 h-4"})]),n("span",ba,V(Math.round(U.value*100))+"%",1),n("button",{onClick:Ct,class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},[p(Vt,{class:"w-4 h-4"})]),n("button",{onClick:ae,class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded ml-1",title:"Fit"},[p(Gt,{class:"w-4 h-4"})])])],544),n("div",wa,[n("div",ya,[e[22]||(e[22]=n("h3",{class:"font-semibold text-sm"},"Generation Settings",-1)),m.value?(w(),M("div",xa,[p(qe,{class:"w-3 h-3 mr-1"}),e[21]||(e[21]=me(" Busy... "))])):fe("",!0)]),n("div",ka,[n("div",Ca,[n("div",null,[n("div",Ia,[e[23]||(e[23]=n("label",{class:"text-xs font-bold text-gray-500 uppercase"},"Prompt",-1)),n("button",{onClick:e[6]||(e[6]=t=>Ye("prompt")),class:"text-blue-500 hover:text-blue-600 p-1",title:"Enhance Prompt",disabled:m.value},[p(Le,{class:Q(["w-4 h-4",{"animate-pulse":T.value}])},null,8,["class"])],8,Ma)]),I(n("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>$.value=t),rows:"4",class:"input-field w-full text-sm resize-none",placeholder:"Describe the result..."},null,512),[[E,$.value]])]),n("div",null,[n("div",_a,[e[24]||(e[24]=n("label",{class:"text-xs font-bold text-gray-500 uppercase"},"Negative Prompt",-1)),n("button",{onClick:e[8]||(e[8]=t=>Ye("negative_prompt")),class:"text-red-500 hover:text-red-600 p-1",title:"Enhance Negative",disabled:m.value},[p(Le,{class:Q(["w-4 h-4",{"animate-pulse":T.value}])},null,8,["class"])],8,Ra)]),I(n("textarea",{"onUpdate:modelValue":e[9]||(e[9]=t=>F.value=t),rows:"3",class:"input-field w-full text-sm resize-none",placeholder:"What to avoid..."},null,512),[[E,F.value]])])]),n("div",La,[n("div",null,[n("label",Sa,[e[25]||(e[25]=n("span",null,"Denoising Strength",-1)),n("span",Ua,V(re.value),1)]),I(n("input",{type:"range","onUpdate:modelValue":e[10]||(e[10]=t=>re.value=t),min:"0.05",max:"1.0",step:"0.05",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"},null,512),[[E,re.value,void 0,{number:!0}]])]),n("div",null,[n("label",Pa,[e[26]||(e[26]=n("span",null,"Guidance Scale",-1)),n("span",Da,V(ue.value),1)]),I(n("input",{type:"range","onUpdate:modelValue":e[11]||(e[11]=t=>ue.value=t),min:"1",max:"20",step:"0.5",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"},null,512),[[E,ue.value,void 0,{number:!0}]])]),n("div",null,[e[28]||(e[28]=n("label",{class:"label"},"Model",-1)),I(n("select",{"onUpdate:modelValue":e[12]||(e[12]=t=>te.value=t),class:"input-field w-full text-sm mt-1"},[e[27]||(e[27]=n("option",{disabled:"",value:""},"Select Model",-1)),(w(!0),M(pe,null,He(ot.value,t=>(w(),M("option",{key:t.id,value:t.id},V(t.name),9,Ea))),128))],512),[[At,te.value]])]),n("div",null,[e[29]||(e[29]=n("label",{class:"label"},"Seed",-1)),n("div",Ba,[I(n("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>ce.value=t),type:"number",class:"input-field flex-grow text-sm",placeholder:"-1"},null,512),[[E,ce.value,void 0,{number:!0}]]),n("button",{onClick:e[14]||(e[14]=t=>ce.value=-1),class:"btn btn-secondary px-2"},[p(Nt,{class:"w-4 h-4"})])])])])]),n("div",$a,[n("button",{onClick:bt,class:"btn btn-primary w-full py-3",disabled:m.value},[m.value?(w(),M(pe,{key:0},[p(qe,{class:"w-5 h-5 mr-2 animate-spin"}),e[30]||(e[30]=me(" Processing..."))],64)):(w(),M(pe,{key:1},[p(Le,{class:"w-5 h-5 mr-2"}),me(" "+V(f.value==="mask"?"Inpaint Masked":"Generate from Img"),1)],64))],8,Ta)])])])]))}},ja=Je(za,[["__scopeId","data-v-538ef8b4"]]);export{ja as default};
