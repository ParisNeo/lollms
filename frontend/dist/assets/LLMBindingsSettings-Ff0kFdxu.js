import{S as G,q as J,s as P,r as p,x as w,w as H,o as K,c as o,b as l,d as c,g as t,t as d,h as B,A as y,j as R,v as L,F as _,i as S,e as C,L as W,B as V,M as Q,N as X,n as b,f as Y,k as Z,W as ee}from"./index-CcOm1HS3.js";const te={class:"space-y-8"},se={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},ne={class:"text-xl font-semibold mb-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le=["disabled"],ie=["value"],oe={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},de={class:"text-sm text-gray-600 dark:text-gray-400"},re=["for"],ue={key:0,class:"text-red-500"},ce={key:0},me={class:"relative"},fe=["type","id","onUpdate:modelValue","required","placeholder"],ge=["onClick","title"],ve={key:1,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},pe={class:"flex-grow flex flex-col pr-4"},ye={class:"text-sm text-gray-500 dark:text-gray-400"},_e=["onClick"],be={class:"text-xs text-gray-500 mt-1"},xe={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},he={class:"flex justify-end gap-3"},ke=["disabled"],we={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},Be={class:"flex items-center gap-4"},Se={key:0,class:"text-center p-6"},Ce={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},Me={key:2,class:"space-y-4"},Ae={class:"flex items-start gap-4"},Te=["title"],De={class:"flex-grow"},Fe={class:"flex justify-between items-center"},Ne={class:"font-bold text-lg text-gray-900 dark:text-white"},$e={class:"flex gap-3"},Le=["onClick"],Ve=["onClick"],je={class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},Oe={key:0},Ee={class:"font-semibold capitalize"},Ue={key:0},ze={key:1},Ie={key:0},Ge={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},Je=["onClick"],Ke={__name:"LLMBindingsSettings",setup(Pe){const u=G(),M=J(),{bindings:A,availableBindingTypes:x,isLoadingBindings:j,globalSettings:T}=P(u),f=p(!1),g=p(null),h=p(!1),m=p({}),D=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),n=p(D()),v=w(()=>g.value!==null),k=w(()=>n.value.name?x.value.find(a=>a.binding_name===n.value.name):null),q=w(()=>{if(!k.value)return[];const a=k.value.input_parameters||[],s=new Set(a.map(i=>i.name)),e=Object.keys(n.value.config||{}).filter(i=>!s.has(i)&&i!=="model_name").map(i=>({name:i,type:typeof n.value.config[i]=="boolean"?"bool":typeof n.value.config[i]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...a.filter(i=>i.name!=="model_name"),...e]});H(()=>n.value.name,(a,s)=>{if(a!==s&&!v.value){const e=x.value.find(r=>r.binding_name===a),i={};e&&e.input_parameters&&e.input_parameters.forEach(r=>{i[r.name]=r.default}),n.value.config=i}});const F=w({get(){if(!Array.isArray(T.value))return"mixed";const a=T.value.find(s=>s.key==="model_display_mode");return a?a.value:"mixed"},set(a){u.updateGlobalSettings({model_display_mode:a})}});K(()=>{u.fetchBindings(),u.fetchAvailableBindingTypes(),u.fetchGlobalSettings()});function N(){g.value=null,n.value=D(),m.value={},f.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function O(a){g.value=a,n.value=JSON.parse(JSON.stringify(a)),n.value.config||(n.value.config={}),m.value={},f.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function $(){f.value=!1,g.value=null}async function E(){if(!n.value.alias.trim()||!n.value.name){M.addNotification("Alias and Binding Type are required fields.","warning");return}h.value=!0;try{const a={alias:n.value.alias,name:n.value.name,config:n.value.config||{},is_active:n.value.is_active,default_model_name:n.value.default_model_name||null};v.value?await u.updateBinding(g.value.id,a):await u.addBinding(a),$()}catch(a){console.error("Submit failed:",a.message)}finally{h.value=!1}}async function U(a){await M.showConfirmation({title:`Delete Binding '${a.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await u.deleteBinding(a.id)}function z(a){M.openModal("manageModels",{binding:a,bindingType:"llm"})}function I(a){const s=x.value.find(e=>e.binding_name===a);return s?s.title:a}return(a,s)=>(l(),o("div",te,[f.value?(l(),o("div",se,[t("h3",ne,d(v.value?"Edit Binding":"Add New Binding"),1),t("form",{onSubmit:Y(E,["prevent"]),class:"space-y-6"},[t("div",ae,[t("div",null,[s[4]||(s[4]=t("label",{for:"alias",class:"block text-sm font-medium"},[y("Alias "),t("span",{class:"text-red-500"},"*")],-1)),B(t("input",{type:"text",id:"alias","onUpdate:modelValue":s[0]||(s[0]=e=>n.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_ollama"},null,512),[[R,n.value.alias]]),s[5]||(s[5]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[s[7]||(s[7]=t("label",{for:"name",class:"block text-sm font-medium"},[y("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),B(t("select",{id:"name","onUpdate:modelValue":s[1]||(s[1]=e=>n.value.name=e),class:"input-field mt-1",required:"",disabled:v.value},[s[6]||(s[6]=t("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),o(_,null,S(C(x),e=>(l(),o("option",{key:e.binding_name,value:e.binding_name},d(e.title),9,ie))),128))],8,le),[[L,n.value.name]])])]),k.value?(l(),o("div",oe,[t("p",de,d(k.value.description),1),(l(!0),o(_,null,S(q.value,e=>(l(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[y(d(e.name.replace(/_/g," "))+" ",1),e.mandatory?(l(),o("span",ue,"*")):c("",!0)],8,re),["str","int","float"].includes(e.type)?(l(),o("div",ce,[t("div",me,[B(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!m.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":i=>n.value.config[e.name]=i,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,fe),[[W,n.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(l(),o("button",{key:0,type:"button",onClick:i=>m.value[e.name]=!m.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:m.value[e.name]?"Hide":"Show"},[m.value[e.name]?(l(),V(Q,{key:0,class:"w-5 h-5"})):(l(),V(X,{key:1,class:"w-5 h-5"}))],8,ge)):c("",!0)])])):e.type==="bool"?(l(),o("div",ve,[t("span",pe,[t("span",ye,d(e.description),1)]),t("button",{onClick:i=>n.value.config[e.name]=!n.value.config[e.name],type:"button",class:b([n.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:b([n.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,_e)])):c("",!0),t("p",be,d(e.description),1)]))),128))])):c("",!0),t("div",xe,[s[8]||(s[8]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, users cannot see or use models from this binding.")],-1)),t("button",{onClick:s[2]||(s[2]=e=>n.value.is_active=!n.value.is_active),type:"button",class:b([n.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:b([n.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",he,[t("button",{type:"button",onClick:$,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:h.value},d(h.value?"Saving...":v.value?"Save Changes":"Add Binding"),9,ke)])],32)])):c("",!0),t("div",null,[t("div",we,[s[11]||(s[11]=t("h2",{class:"text-2xl font-bold"},"LLM Bindings",-1)),t("div",Be,[t("div",null,[s[10]||(s[10]=t("label",{for:"model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),B(t("select",{id:"model-display-mode","onUpdate:modelValue":s[3]||(s[3]=e=>F.value=e),class:"input-field mt-1"},s[9]||(s[9]=[t("option",{value:"mixed"},"Mixed (Alias or Original)",-1),t("option",{value:"aliased"},"Aliased Only",-1),t("option",{value:"original"},"Original Names Only",-1)]),512),[[L,F.value]])]),f.value?c("",!0):(l(),o("button",{key:0,onClick:N,class:"btn btn-primary self-end"},"+ Add New Binding"))])]),C(j)?(l(),o("div",Se,"Loading bindings...")):C(A).length===0&&!f.value?(l(),o("div",Ce,[s[12]||(s[12]=t("p",null,"No LLM bindings configured yet.",-1)),t("button",{onClick:N,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(l(),o("div",Me,[(l(!0),o(_,null,S(C(A),e=>(l(),o("div",{key:e.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[t("div",Ae,[t("span",{class:b(["mt-1 h-3 w-3 rounded-full flex-shrink-0",e.is_active?"bg-green-500":"bg-gray-400"]),title:e.is_active?"Active":"Inactive"},null,10,Te),t("div",De,[t("div",Fe,[t("h4",Ne,d(e.alias),1),t("div",$e,[t("button",{onClick:i=>O(e),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,Le),t("button",{onClick:i=>U(e),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,Ve)])]),t("p",je,d(I(e.name)),1),t("div",qe,[(l(!0),o(_,null,S(e.config,(i,r)=>(l(),o(_,{key:r},[i&&r!=="model_name"?(l(),o("p",Oe,[t("span",Ee,d(r.replace(/_/g," "))+":",1),r.includes("key")||r.includes("token")?(l(),o("span",Ue,"********")):(l(),o("span",ze,d(i),1))])):c("",!0)],64))),128)),e.default_model_name?(l(),o("p",Ie,[s[13]||(s[13]=t("span",{class:"font-semibold"},"Default Model:",-1)),y(" "+d(e.default_model_name),1)])):c("",!0)])])]),t("div",Ge,[t("button",{onClick:i=>z(e),class:"btn btn-secondary btn-sm flex items-center gap-2"},[Z(ee,{class:"w-4 h-4"}),s[14]||(s[14]=y(" Manage Models "))],8,Je)])]))),128))]))])]))}};export{Ke as default};
