import{u as M,f as T,a as U,s as N,r as v,o as B,g as $,c as l,b as o,d as e,i as h,w as F,e as k,h as Y,F as m,k as p,t as r,j as u,m as P,v as j}from"./index-D5hRrNn1.js";const L={label:"Your Personalities"},z=["value"],I={label:"Public Personalities"},O=["value"],R={class:"text-right"},q=["disabled"],G={class:"mb-8"},H={class:"flex justify-between items-center mb-2"},J={class:"max-h-60 overflow-y-auto border dark:border-gray-600 rounded p-2 space-y-1"},K={key:0,class:"italic text-sm text-gray-500 p-2"},Q={class:"space-x-2"},W=["onClick"],X=["onClick"],Z={class:"max-h-60 overflow-y-auto border dark:border-gray-600 rounded p-2 space-y-1"},ee={key:0,class:"italic text-sm text-gray-500 p-2"},te={class:"text-xs text-gray-500"},se=["onClick"],ae={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},le={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-lg"},oe={class:"text-lg font-bold mb-4"},ne={class:"mt-2"},ie={class:"flex justify-end space-x-2 mt-4"},de={__name:"PersonalitiesSettings",setup(re){const w=M(),d=T(),A=U(),{user:c}=N(w),{userPersonalities:x,publicPersonalities:g}=N(d),n=v(""),b=v(!1),y=v(!1),f=v(!1),i=v(null),C=()=>{c.value&&(n.value=c.value.active_personality_id||"",y.value=!1)};B(()=>{d.fetchPersonalities(),C()}),$(c,C),$(n,a=>{c.value&&(y.value=(a||null)!==(c.value.active_personality_id||null))});async function S(){b.value=!0;try{await w.updateUserPreferences({active_personality_id:n.value||null}),y.value=!1}catch{}finally{b.value=!1}}function _(a=null){i.value=a?{...a}:{name:"",category:"",description:"",prompt_text:"",is_public:!1},f.value=!0}async function E(a){const t=a.id?d.updatePersonality:d.addPersonality;try{await t(a),f.value=!1}catch{}}async function V(a){await A.showConfirmation({title:`Delete ${a.name}`,message:"Are you sure you want to delete this personality? This cannot be undone.",confirmText:"Delete"})&&(await d.deletePersonality(a.id),n.value===a.id&&(n.value="",S()))}return(a,t)=>(o(),l(m,null,[e("section",null,[t[10]||(t[10]=e("h4",{class:"text-lg font-semibold mb-4 border-b dark:border-gray-600 pb-2"},"Personalities",-1)),e("form",{onSubmit:F(S,["prevent"]),class:"space-y-4 max-w-md mb-8"},[e("div",null,[t[7]||(t[7]=e("label",{for:"activePersonality",class:"block text-sm font-medium"},"Active Personality",-1)),k(e("select",{id:"activePersonality","onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s),class:"input-field mt-1"},[t[6]||(t[6]=e("option",{value:""},"None (Default)",-1)),e("optgroup",L,[(o(!0),l(m,null,p(u(x),s=>(o(),l("option",{key:s.id,value:s.id},r(s.name),9,z))),128))]),e("optgroup",I,[(o(!0),l(m,null,p(u(g),s=>(o(),l("option",{key:s.id,value:s.id},r(s.name),9,O))),128))])],512),[[Y,n.value]])]),e("div",R,[e("button",{type:"submit",class:"btn btn-primary",disabled:b.value||!y.value},r(b.value?"Saving...":"Save Active Personality"),9,q)])],32),e("div",G,[e("div",H,[t[8]||(t[8]=e("h5",{class:"text-md font-semibold"},"Manage Your Personalities",-1)),e("button",{onClick:t[1]||(t[1]=s=>_()),class:"btn btn-secondary !text-xs !py-1"},"+ Create New")]),e("div",J,[u(x).length===0?(o(),l("p",K,"You haven't created any personalities yet.")):h("",!0),(o(!0),l(m,null,p(u(x),s=>(o(),l("div",{key:s.id,class:"flex justify-between items-center py-1.5 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-sm"},[e("span",null,r(s.name),1),e("div",Q,[e("button",{onClick:D=>_(s),class:"text-blue-500 hover:text-blue-700"},"Edit",8,W),e("button",{onClick:D=>V(s),class:"text-red-500 hover:text-red-700"},"Delete",8,X)])]))),128))])]),e("div",null,[t[9]||(t[9]=e("h5",{class:"text-md font-semibold mb-2"},"Available Public Personalities",-1)),e("div",Z,[u(g).length===0?(o(),l("p",ee,"No public personalities available.")):h("",!0),(o(!0),l(m,null,p(u(g),s=>(o(),l("div",{key:s.id,class:"flex justify-between items-center py-1.5 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-sm"},[e("span",null,[P(r(s.name)+" ",1),e("em",te,"by "+r(s.author||"System"),1)]),e("button",{onClick:D=>_(s),class:"text-blue-500 hover:text-blue-700"},"Clone & Edit",8,se)]))),128))])])]),f.value?(o(),l("div",ae,[e("div",le,[e("h3",oe,r(i.value.id?"Edit":"Create")+" Personality",1),e("p",null,[t[11]||(t[11]=P("Name: ")),k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.name=s),class:"input-field"},null,512),[[j,i.value.name]])]),e("p",ne,[t[12]||(t[12]=P("Prompt: ")),k(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.value.prompt_text=s),rows:"5",class:"input-field"},null,512),[[j,i.value.prompt_text]])]),e("div",ie,[e("button",{onClick:t[4]||(t[4]=s=>f.value=!1),class:"btn btn-secondary"},"Cancel"),e("button",{onClick:t[5]||(t[5]=s=>E(i.value)),class:"btn btn-primary"},"Save")])])])):h("",!0)],64))}};export{de as default};
