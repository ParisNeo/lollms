import{u as $,a as j,c as A,r,o as J,w as S,b as q,d as G,e as c,f as e,g as U,h as L,_ as O,t as _,i as n,v as b,j as V,k as h,l as w,m as T}from"./index-9wbqBHSN.js";import{_ as D,a as F}from"./IconEyeOff-D-ba05it.js";const z={key:0,class:"space-y-10"},R={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},W={class:"border-t border-gray-200 dark:border-gray-700 p-4 sm:p-6"},H={class:"flex-shrink-0 flex flex-col items-center space-y-2 w-full md:w-40"},K=["disabled"],Q={class:"flex-grow space-y-6"},X={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Y={class:"space-y-4 pt-4 border-t dark:border-gray-600"},Z={class:"relative flex items-start"},ee={class:"flex h-6 items-center"},te={class:"relative flex items-start"},ae={class:"flex h-6 items-center"},se={class:"flex justify-end"},le=["disabled"],re={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},ie={class:"border-t border-gray-200 dark:border-gray-700"},oe={class:"mt-1 relative"},ne=["type"],de={class:"mt-1 relative"},ue=["type"],me={class:"mt-1 relative"},ce=["type"],pe={class:"flex justify-end"},fe=["disabled"],xe={__name:"AccountSettings",setup(ve){const d=$(),u=j(),l=A(()=>d.user),s=r({first_name:"",family_name:"",email:"",birth_date:"",receive_notification_emails:!0,is_searchable:!0}),p=r(!1),k=r(!1);let P="{}";const i=r({current_password:"",new_password:""}),f=r(""),v=r(!1),y=r(!1),m=r(!1),g=r(!1),x=r(null);function N(){l.value&&(s.value.first_name=l.value.first_name||"",s.value.family_name=l.value.family_name||"",s.value.email=l.value.email||"",s.value.birth_date=l.value.birth_date||"",s.value.receive_notification_emails=l.value.receive_notification_emails,s.value.is_searchable=l.value.is_searchable,P=JSON.stringify(s.value))}J(N),S(l,N,{deep:!0}),S(s,o=>{k.value=JSON.stringify(o)!==P},{deep:!0});async function I(){p.value=!0;try{await d.updateUserProfile(s.value)}catch{}finally{p.value=!1}}async function M(){if(i.value.new_password!==f.value){u.addNotification("New passwords do not match.","error");return}if(i.value.new_password.length<8){u.addNotification("New password must be at least 8 characters long.","error");return}v.value=!0;try{await d.changePassword(i.value),i.value.current_password="",i.value.new_password="",f.value=""}catch{}finally{v.value=!1}}const B=()=>{var o;(o=x.value)==null||o.click()},E=async o=>{const t=o.target.files[0];if(!t)return;g.value=!0,u.addNotification("Uploading icon...","info");const a=new FormData;a.append("file",t);try{const C=await T.put("/api/auth/me/icon",a,{headers:{"Content-Type":"multipart/form-data"}});d.user&&(d.user.icon=C.data.icon_url),u.addNotification("Icon updated successfully!","success")}catch{u.addNotification("Icon upload failed.","error")}finally{g.value=!1,x.value&&(x.value.value="")}};return(o,t)=>l.value?(c(),q("div",z,[e("div",R,[t[18]||(t[18]=e("div",{class:"p-4 sm:p-6"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Profile"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},"Manage your public profile and personal information.")],-1)),e("div",W,[e("form",{onSubmit:U(I,["prevent"]),class:"flex flex-col md:flex-row gap-8"},[e("div",H,[L(O,{icon:l.value.icon,username:l.value.username,"size-class":"h-28 w-28"},null,8,["icon","username"]),e("input",{type:"file",ref_key:"fileInput",ref:x,onChange:E,accept:"image/png, image/jpeg, image/webp",class:"hidden"},null,544),e("button",{type:"button",onClick:B,disabled:g.value,class:"btn btn-secondary w-full"},_(g.value?"Uploading...":"Change Icon"),9,K),t[11]||(t[11]=e("p",{class:"text-xs text-center text-gray-500 dark:text-gray-400"},"Max 5MB (JPG, PNG, WEBP)",-1))]),e("div",Q,[e("div",X,[e("div",null,[t[12]||(t[12]=e("label",{for:"firstName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"First Name",-1)),n(e("input",{type:"text",id:"firstName","onUpdate:modelValue":t[0]||(t[0]=a=>s.value.first_name=a),class:"input-field mt-1",placeholder:"Jane"},null,512),[[b,s.value.first_name]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"familyName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Family Name",-1)),n(e("input",{type:"text",id:"familyName","onUpdate:modelValue":t[1]||(t[1]=a=>s.value.family_name=a),class:"input-field mt-1",placeholder:"Doe"},null,512),[[b,s.value.family_name]])])]),e("div",null,[t[14]||(t[14]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email Address",-1)),n(e("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.email=a),class:"input-field mt-1",placeholder:"you@example.com"},null,512),[[b,s.value.email]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"birthDate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Birth Date",-1)),n(e("input",{type:"date",id:"birthDate","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.birth_date=a),class:"input-field mt-1"},null,512),[[b,s.value.birth_date]])]),e("div",Y,[e("div",Z,[e("div",ee,[n(e("input",{id:"is_searchable","onUpdate:modelValue":t[4]||(t[4]=a=>s.value.is_searchable=a),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-600"},null,512),[[V,s.value.is_searchable]])]),t[16]||(t[16]=e("div",{class:"ml-3 text-sm leading-6"},[e("label",{for:"is_searchable",class:"font-medium text-gray-900 dark:text-gray-100"},"Profile Searchability"),e("p",{class:"text-gray-500 dark:text-gray-400"},"Allow other users to find your profile in searches.")],-1))]),e("div",te,[e("div",ae,[n(e("input",{id:"receive_notification_emails","onUpdate:modelValue":t[5]||(t[5]=a=>s.value.receive_notification_emails=a),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-600"},null,512),[[V,s.value.receive_notification_emails]])]),t[17]||(t[17]=e("div",{class:"ml-3 text-sm leading-6"},[e("label",{for:"receive_notification_emails",class:"font-medium text-gray-900 dark:text-gray-100"},"Notification Emails"),e("p",{class:"text-gray-500 dark:text-gray-400"},"Receive emails for important events like password resets.")],-1))])]),e("div",se,[e("button",{type:"submit",class:"btn btn-primary",disabled:p.value||!k.value},_(p.value?"Saving...":"Save Profile"),9,le)])])],32)])]),e("div",re,[t[22]||(t[22]=e("div",{class:"px-4 py-5 sm:p-6"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Change Password"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},"Ensure your account is using a long, random password to stay secure.")],-1)),e("div",ie,[e("form",{onSubmit:U(M,["prevent"]),class:"p-4 sm:p-6 space-y-6"},[e("div",null,[t[19]||(t[19]=e("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Current Password",-1)),e("div",oe,[n(e("input",{type:y.value?"text":"password",id:"currentPassword","onUpdate:modelValue":t[6]||(t[6]=a=>i.value.current_password=a),required:"",class:"input-field pr-10",autocomplete:"current-password"},null,8,ne),[[h,i.value.current_password]]),e("button",{type:"button",onClick:t[7]||(t[7]=a=>y.value=!y.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[y.value?(c(),w(D,{key:0,class:"w-5 h-5"})):(c(),w(F,{key:1,class:"w-5 h-5"}))])])]),e("div",null,[t[20]||(t[20]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Password",-1)),e("div",de,[n(e("input",{type:m.value?"text":"password",id:"newPassword","onUpdate:modelValue":t[8]||(t[8]=a=>i.value.new_password=a),required:"",minlength:"8",class:"input-field pr-10",autocomplete:"new-password"},null,8,ue),[[h,i.value.new_password]]),e("button",{type:"button",onClick:t[9]||(t[9]=a=>m.value=!m.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[m.value?(c(),w(D,{key:0,class:"w-5 h-5"})):(c(),w(F,{key:1,class:"w-5 h-5"}))])])]),e("div",null,[t[21]||(t[21]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Confirm New Password",-1)),e("div",me,[n(e("input",{type:m.value?"text":"password",id:"confirmPassword","onUpdate:modelValue":t[10]||(t[10]=a=>f.value=a),required:"",class:"input-field pr-10",autocomplete:"new-password"},null,8,ce),[[h,f.value]])])]),e("div",pe,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},_(v.value?"Changing...":"Change Password"),9,fe)])],32)])])])):G("",!0)}};export{xe as default};
