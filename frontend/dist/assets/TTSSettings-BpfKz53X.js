import{a as Z,z as g,r as b,bJ as ee,bK as te,bL as se,bM as ae,bN as le,o as oe,c as o,b as l,g as t,B as z,t as m,k as O,m as J,h as C,d as T,N as ne,e as B,j as ie,F as $,i as E,n as D,T as re,bQ as ue,S as ge,u as me,q as pe,s as Y,w as F,bO as be,a2 as ye,cm as H,f as W,bP as _e,v as X,A as j,G as xe,bS as he}from"./index-BzJSkIlv.js";const ke={class:"relative w-full"},we={class:"truncate"},Se={class:"p-2 border-b dark:border-gray-700"},Te={class:"flex-grow overflow-y-auto"},Ce={key:0,class:"p-4 text-center text-sm text-gray-500"},Le={key:1,class:"p-4 text-center text-sm text-gray-500"},Ve={key:2,class:"py-1"},Me=["onClick"],Oe={__name:"LanguageSelector",props:{modelValue:{type:String,default:"auto"},includeAuto:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(I,{emit:U}){const y=I,p=U,L=Z(),R=g(()=>L.languages),P=g(()=>L.isLoadingLanguages),n=b(!1),_=b(null),V=b(null),h=b(""),{floatingStyles:k}=ee(_,V,{placement:"bottom-start",whileElementsMounted:te,middleware:[se(5),ae(),le({padding:5})]}),A={mounted:(i,v)=>{i.clickOutsideEvent=f=>{const r=_.value;i===f.target||i.contains(f.target)||r!=null&&r.contains(f.target)||v.value()},document.addEventListener("mousedown",i.clickOutsideEvent)},unmounted:i=>{document.removeEventListener("mousedown",i.clickOutsideEvent)}},w=g(()=>{const i=[...R.value];return y.includeAuto&&i.unshift({value:"auto",label:"Auto-detect"}),i}),S=g(()=>w.value.find(i=>i.value===y.modelValue)||null),N=g(()=>{if(!h.value)return w.value;const i=h.value.toLowerCase();return w.value.filter(v=>v.label.toLowerCase().includes(i)||v.value.toLowerCase().includes(i))});function G(i){p("update:modelValue",i),n.value=!1,h.value=""}return oe(()=>{R.value.length===0&&L.fetchLanguages()}),(i,v)=>(l(),o("div",ke,[t("button",{ref_key:"triggerRef",ref:_,onClick:v[0]||(v[0]=f=>n.value=!n.value),type:"button",class:"input-field flex items-center justify-between"},[t("span",we,m(S.value?S.value.label:"Select Language"),1),v[2]||(v[2]=t("svg",{class:"w-4 h-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))],512),(l(),z(ue,{to:"body"},[O(re,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:J(()=>[n.value?C((l(),o("div",{key:0,ref_key:"floatingRef",ref:V,style:ne(B(k)),class:"z-50 w-64 origin-top-left rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5 dark:ring-gray-700 focus:outline-none flex flex-col max-h-[50vh]"},[t("div",Se,[C(t("input",{"onUpdate:modelValue":v[1]||(v[1]=f=>h.value=f),type:"text",placeholder:"Search language...",class:"input-field-sm w-full"},null,512),[[ie,h.value]])]),t("div",Te,[P.value?(l(),o("div",Ce,"Loading...")):N.value.length===0?(l(),o("div",Le,"No matches found.")):(l(),o("ul",Ve,[(l(!0),o($,null,E(N.value,f=>(l(),o("li",{key:f.value,onClick:r=>G(f.value),class:D(["px-3 py-2 text-sm cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",{"bg-blue-100 dark:bg-blue-900/50 font-semibold":I.modelValue===f.value}])},m(f.label),11,Me))),128))]))])],4)),[[A,()=>n.value=!1]]):T("",!0)]),_:1})]))]))}},$e={class:"space-y-8"},Ee={class:"relative"},Re={class:"flex items-center space-x-3 truncate"},Ae=["src"],Ue={key:1,class:"w-8 h-8 flex-shrink-0 text-gray-500 dark:text-gray-400 flex items-center justify-center bg-gray-200 dark:bg-gray-700 rounded-md"},Ne={class:"min-w-0 text-left"},Fe={class:"block font-semibold truncate"},je={class:"p-2 sticky top-0 bg-white dark:bg-gray-800 z-10 border-b dark:border-gray-700"},ze={class:"p-1 flex-grow overflow-y-auto"},Be={key:0,class:"text-center p-4 text-sm text-gray-500"},De={key:1,class:"text-center p-4 text-sm text-gray-500"},Ie={class:"px-2 py-1.5 text-xs font-bold text-gray-600 dark:text-gray-300"},Pe=["onClick"],Ge={class:"flex items-center space-x-3 truncate"},Je=["src"],qe={class:"truncate text-left"},Ke={class:"font-medium truncate text-sm"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ye=["value"],He={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},We={key:0,class:"p-4 border rounded-lg dark:border-gray-700 space-y-4"},Xe={class:"font-medium"},Ze={class:"font-mono text-blue-600 dark:text-blue-400"},et={key:0,class:"text-sm text-gray-500"},tt={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},st=["for"],at={class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},lt=["id","onUpdate:modelValue"],ot=["value"],nt=["type","step","id","onUpdate:modelValue","placeholder"],it={key:2,class:"mt-1"},rt=["onClick"],ut={key:2,class:"flex justify-end gap-3 pt-4 border-t dark:border-gray-600"},dt=["disabled"],ct={key:1,class:"p-4 border border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg text-sm text-yellow-800 dark:text-yellow-200 flex items-center gap-3"},vt={class:"flex justify-end pt-4 border-t dark:border-gray-600"},ft=["disabled"],gt={__name:"TTSSettings",setup(I){const U=me(),y=Z();pe();const{user:p}=Y(U),{availableTtsModels:L,availableTtsModelsGrouped:R,userVoices:P}=Y(y),n=b({}),_=b(!1),V=b(!1);let h="{}";const k=b(!1),A=b(null),w=b(null),S=b(""),{floatingStyles:N}=ee(A,w,{placement:"bottom-start",whileElementsMounted:te,middleware:[se(5),ae(),le({padding:5})]}),G={mounted:(s,e)=>{s.clickOutsideEvent=u=>{const c=A.value;s===u.target||s.contains(u.target)||c!=null&&c.contains(u.target)||e.value()},document.addEventListener("mousedown",s.clickOutsideEvent)},unmounted:s=>{document.removeEventListener("mousedown",s.clickOutsideEvent)}};F(k,s=>{s&&be(()=>{const e=w.value;if(e){const u=e.querySelector(".menu-item-button.selected");u&&u.scrollIntoView({block:"nearest"})}})});const i=g({get:()=>n.value.tts_binding_model_name,set:s=>{n.value.tts_binding_model_name=s}}),v=g({get:()=>n.value.active_voice_id,set:s=>{n.value.active_voice_id=s}}),f=g({get:()=>n.value.ai_response_language||"auto",set:s=>{n.value.ai_response_language=s}}),r=g(()=>!i.value||L.value.length===0?null:L.value.find(s=>s.id===i.value)||null),M=g(()=>{var e,u;if(!((u=(e=r.value)==null?void 0:e.binding_params)!=null&&u.parameters))return[];const s=["voice","language","model"];return r.value.binding_params.parameters.filter(c=>!s.includes(c.name))}),de=g(()=>!p.value||!i.value||!p.value.tts_models_config?{}:p.value.tts_models_config[i.value]||{}),q=g(()=>{var s;return(s=r.value)!=null&&s.alias?r.value.alias.allow_parameters_override!==!1:!0}),K=g(()=>{if(!S.value)return R.value;const s=S.value.toLowerCase(),e=[];for(const u of R.value)if(u.items){const c=u.items.filter(x=>x.name.toLowerCase().includes(s));c.length>0&&e.push({...u,items:c})}return e});function ce(s){i.value=s,k.value=!1}const Q=()=>{if(p.value){const s={};r.value&&M.value.forEach(e=>{s[e.name]=de.value[e.name]??e.default}),n.value={...s,tts_binding_model_name:p.value.tts_binding_model_name,active_voice_id:p.value.active_voice_id,ai_response_language:p.value.ai_response_language||"auto"},h=JSON.stringify(n.value),V.value=!1}};F(r,Q,{immediate:!0,deep:!0}),F(p,Q,{deep:!0}),F(n,s=>{V.value=JSON.stringify(s)!==JSON.stringify(h)},{deep:!0});async function ve(){_.value=!0;try{const s={tts_binding_model_name:n.value.tts_binding_model_name,active_voice_id:n.value.active_voice_id,ai_response_language:n.value.ai_response_language},e=p.value.tts_models_config||{},u={};M.value.forEach(x=>{n.value[x.name]!==x.default&&(u[x.name]=n.value[x.name])});const c={...e,[i.value]:u};Object.keys(c[i.value]||{}).length===0&&delete c[i.value],s.tts_models_config=c,await U.updateUserPreferences(s)}finally{_.value=!1}}function fe(){const s={};r.value&&(M.value.forEach(e=>{s[e.name]=e.default}),n.value={...n.value,...s})}return oe(()=>{y.availableTtsModels.length===0&&y.fetchAvailableTtsModels(),y.userVoices.length===0&&y.fetchUserVoices()}),(s,e)=>{var c,x;const u=ye("router-link");return l(),o("div",$e,[e[16]||(e[16]=t("div",null,[t("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," Speech Generation (TTS) Parameters "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure default parameters for your selected Text-to-Speech model. ")],-1)),t("form",{onSubmit:W(ve,["prevent"]),class:"space-y-6"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-base font-medium mb-2"},"Active Speech Generation Model",-1)),t("div",Ee,[t("button",{ref_key:"ttsTriggerRef",ref:A,onClick:e[0]||(e[0]=a=>k.value=!k.value),type:"button",class:"toolbox-select truncate w-full flex items-center justify-between"},[t("div",Re,[(c=r.value)!=null&&c.icon_base64?(l(),o("img",{key:0,src:r.value.icon_base64,class:"h-8 w-8 rounded-md object-cover"},null,8,Ae)):(l(),o("span",Ue,[O(H,{class:"w-5 h-5"})])),t("div",Ne,[t("span",Fe,m(((x=r.value)==null?void 0:x.name)||"Select a Speech Model"),1)])]),e[5]||(e[5]=t("svg",{class:"w-4 h-4 text-gray-400 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))],512),(l(),z(ue,{to:"body"},[O(re,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:J(()=>[k.value?C((l(),o("div",{key:0,ref_key:"ttsFloatingRef",ref:w,style:ne(B(N)),class:"z-50 w-80 origin-top-left rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5 dark:ring-gray-700 focus:outline-none py-1 flex flex-col max-h-[50vh]"},[t("div",je,[C(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>S.value=a),onClick:e[2]||(e[2]=W(()=>{},["stop"])),placeholder:"Search TTS models...",class:"input-field-sm w-full"},null,512),[[ie,S.value]])]),t("div",ze,[B(y).isLoadingTtsModels?(l(),o("div",Be,"Loading TTS models...")):K.value.length===0?(l(),o("div",De,"No TTS models found.")):T("",!0),(l(!0),o($,null,E(K.value,a=>(l(),o("div",{key:a.label},[t("h4",Ie,m(a.label),1),(l(!0),o($,null,E(a.items,d=>(l(),o("button",{key:d.id,onClick:mt=>ce(d.id),class:D(["menu-item-button",{selected:i.value===d.id}])},[t("div",Ge,[d.icon_base64?(l(),o("img",{key:0,src:d.icon_base64,class:"h-6 w-6 rounded-md object-cover flex-shrink-0"},null,8,Je)):(l(),z(H,{key:1,class:"w-6 h-6 text-gray-500 dark:text-gray-400 flex-shrink-0"})),t("div",qe,[t("p",Ke,m(d.name),1)])]),i.value===d.id?(l(),z(_e,{key:0,class:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0"})):T("",!0)],10,Pe))),128))]))),128))])],4)),[[G,()=>k.value=!1]]):T("",!0)]),_:1})]))])]),t("div",Qe,[t("div",null,[e[7]||(e[7]=t("label",{for:"aiResponseLanguage",class:"block text-base font-medium mb-2"},"AI Response Language",-1)),O(Oe,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=a=>f.value=a),id:"aiResponseLanguage","include-auto":!0},null,8,["modelValue"]),e[8]||(e[8]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"The language for AI text responses and speech generation. 'Auto' uses the interface language.",-1))]),t("div",null,[e[13]||(e[13]=t("label",{for:"active-voice",class:"block text-base font-medium mb-2"},"Active Voice",-1)),C(t("select",{id:"active-voice","onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),class:"input-field w-full"},[e[9]||(e[9]=t("option",{value:null},"Default Voice",-1)),(l(!0),o($,null,E(B(P),a=>(l(),o("option",{key:a.id,value:a.id},m(a.alias)+" ("+m(a.language)+") ",9,Ye))),128))],512),[[X,v.value]]),t("p",He,[e[11]||(e[11]=j("Select a custom voice from your ")),O(u,{to:"/voices-studio",class:"text-blue-600 hover:underline"},{default:J(()=>e[10]||(e[10]=[j("Voices Studio")])),_:1}),e[12]||(e[12]=j("."))])])]),i.value&&r.value&&q.value?(l(),o("div",We,[t("h4",Xe,[e[14]||(e[14]=j("Configuration for: ")),t("span",Ze,m(r.value.name),1)]),M.value.length===0?(l(),o("div",et," This model has no parameters exposed for user configuration. ")):(l(),o("div",tt,[(l(!0),o($,null,E(M.value,a=>(l(),o("div",{key:a.name},[t("label",{for:`tts-param-${a.name}`,class:"block text-sm font-medium capitalize"},m(a.name.replace(/_/g," ")),9,st),t("p",at,m(a.description),1),a.options?C((l(),o("select",{key:0,id:`tts-param-${a.name}`,"onUpdate:modelValue":d=>n.value[a.name]=d,class:"input-field mt-1"},[(l(!0),o($,null,E(a.options,d=>(l(),o("option",{key:d,value:d},m(d),9,ot))),128))],8,lt)),[[X,n.value[a.name]]]):["str","int","float"].includes(a.type)?C((l(),o("input",{key:1,type:a.type==="str"?"text":"number",step:a.type==="float"?"0.01":"1",id:`tts-param-${a.name}`,"onUpdate:modelValue":d=>n.value[a.name]=d,class:"input-field mt-1",placeholder:`Default: ${a.default}`},null,8,nt)),[[xe,n.value[a.name]]]):a.type==="bool"?(l(),o("div",it,[t("button",{onClick:d=>n.value[a.name]=!n.value[a.name],type:"button",class:D([n.value[a.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:D([n.value[a.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,rt)])):T("",!0)]))),128))])),M.value.length>0?(l(),o("div",ut,[t("button",{type:"button",onClick:fe,class:"btn btn-secondary",disabled:_.value},"Reset to Defaults",8,dt)])):T("",!0)])):i.value&&r.value&&!q.value?(l(),o("div",ct,[O(he,{class:"w-5 h-5 flex-shrink-0"}),e[15]||(e[15]=t("span",null,"An administrator has locked the parameters for this model alias. Your personal settings will be ignored.",-1))])):T("",!0),t("div",vt,[t("button",{type:"submit",class:"btn btn-primary",disabled:_.value||!V.value},m(_.value?"Saving...":"Save TTS Settings"),9,ft)])],32)])}}},bt=ge(gt,[["__scopeId","data-v-a7db96a9"]]);export{bt as default};
