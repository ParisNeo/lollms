import{aj as C,s as V,o as D,c as h,b as r,e as d,f as t,d as k,p as n,h as m,y as S,ak as G,t as a,al as A,D as y,am as M,F as f,x as w,r as $,a as B,m as R}from"./index-B-Hw0D2f.js";import U from"./IconGpu-LRxbnTMz.js";import N from"./IconHardDrive-CH340zpT.js";const j={class:"space-y-6"},I={class:"flex items-center justify-between"},F=["disabled"],H={key:0,class:"text-center p-8"},L={key:1,class:"space-y-6"},T={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},E={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},O={class:"flex items-center"},q={class:"mt-2 text-2xl font-bold text-gray-900 dark:text-white"},J={class:"text-sm text-gray-500 dark:text-gray-400"},K={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},Q={class:"flex items-center"},W={class:"mt-2 text-2xl font-bold text-gray-900 dark:text-white"},X={class:"text-sm text-gray-500 dark:text-gray-400"},Y={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},Z={class:"flex items-center"},tt={key:0,class:"mt-2 text-2xl font-bold text-gray-900 dark:text-white"},et={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},st={key:2,class:"mt-2 text-lg text-gray-500 dark:text-gray-400"},at={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},lt={class:"flex items-center mb-2"},rt={class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},dt={class:"font-medium text-gray-900 dark:text-white"},ot={class:"font-medium text-gray-900 dark:text-white"},nt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-3"},it={class:"flex items-center mb-2"},ut={class:"font-semibold text-gray-800 dark:text-gray-200"},gt={key:0,class:"ml-3 text-xs font-semibold px-2 py-0.5 rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300"},ct={key:1,class:"ml-2 text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"},_t={class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},mt={class:"font-medium text-gray-900 dark:text-white"},yt={class:"font-medium text-gray-900 dark:text-white"},xt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-3"},bt={class:"flex items-center mb-2"},pt={class:"font-semibold text-gray-800 dark:text-gray-200"},vt={class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},ht={class:"font-medium text-gray-900 dark:text-white"},kt={class:"font-medium text-gray-900 dark:text-white"},ft={class:"font-medium text-gray-900 dark:text-white"},wt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-3"},Mt={key:1,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md text-center text-gray-500 dark:text-gray-400"},$t={key:2,class:"text-center p-8"},St={__name:"SystemStatus",setup(P){const _=C(),{systemStatus:l,isLoadingSystemStatus:x}=V(_);D(()=>{l.value||_.fetchSystemStatus()});const b=h(()=>{var o;return((o=l.value)==null?void 0:o.gpus)||[]}),v=h(()=>b.value.reduce((o,e)=>o+e.vram_used_gb,0)),c=h(()=>b.value.reduce((o,e)=>o+e.vram_total_gb,0)),u=h(()=>c.value>0?v.value/c.value*100:0),g=h(()=>{if(!l.value||!l.value.disks)return null;let o=l.value.disks.find(e=>e.is_data_disk);return!o&&l.value.disks.length>0&&(o=l.value.disks[0]),o}),i=o=>o==null?"N/A":`${o.toFixed(1)} GB`,p=o=>o==null?"N/A":`${o.toFixed(2)}%`;return(o,e)=>(d(),r("div",j,[t("div",I,[e[1]||(e[1]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"System Status",-1)),t("button",{onClick:e[0]||(e[0]=(...s)=>n(_).fetchSystemStatus&&n(_).fetchSystemStatus(...s)),class:"btn btn-secondary btn-sm",disabled:n(x)},[m(G,{class:S(["w-4 h-4",{"animate-spin":n(x)}])},null,8,["class"])],8,F)]),n(x)&&!n(l)?(d(),r("div",H,e[2]||(e[2]=[t("p",null,"Loading system status...",-1)]))):n(l)?(d(),r("div",L,[t("div",T,[t("div",E,[t("div",O,[m(U,{class:"w-6 h-6 mr-3 text-gray-400"}),e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"GPU VRAM",-1))]),t("p",q,a(c.value>0?`${i(v.value)} / ${i(c.value)}`:"N/A"),1),t("p",J,a(c.value>0?`(${p(u.value)})`:"No compatible GPU found"),1)]),t("div",K,[t("div",Q,[m(A,{class:"w-6 h-6 mr-3 text-gray-400"}),e[4]||(e[4]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"CPU RAM",-1))]),t("p",W,a(i(n(l).cpu_ram_used_gb))+" / "+a(i(n(l).cpu_ram_total_gb)),1),t("p",X,"("+a(p(n(l).cpu_ram_usage_percent))+")",1)]),t("div",Y,[t("div",Z,[m(N,{class:"w-6 h-6 mr-3 text-gray-400"}),e[5]||(e[5]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"Data Disk",-1))]),g.value?(d(),r("p",tt,a(i(g.value.used_gb))+" / "+a(i(g.value.total_gb)),1)):k("",!0),g.value?(d(),r("p",et,"("+a(p(g.value.usage_percent))+")",1)):(d(),r("p",st,"No disk info"))])]),t("div",at,[t("div",lt,[m(A,{class:"w-5 h-5 mr-2 text-gray-400"}),e[6]||(e[6]=t("h4",{class:"font-semibold text-gray-800 dark:text-gray-200"},"CPU RAM Usage Details",-1))]),t("div",rt,[t("p",null,[e[7]||(e[7]=y("Available: ")),t("span",dt,a(i(n(l).cpu_ram_available_gb)),1)]),t("p",null,[e[8]||(e[8]=y("Usage: ")),t("span",ot,a(i(n(l).cpu_ram_used_gb))+" / "+a(i(n(l).cpu_ram_total_gb))+" ("+a(p(n(l).cpu_ram_usage_percent))+")",1)])]),t("div",nt,[t("div",{class:"bg-gradient-to-r from-blue-400 to-purple-500 h-2.5 rounded-full",style:M({width:n(l).cpu_ram_usage_percent+"%"})},null,4)])]),(d(!0),r(f,null,w(n(l).disks,s=>(d(),r("div",{key:s.mount_point,class:S(["p-4 rounded-lg shadow-md border-l-4",{"bg-white dark:bg-gray-800 border-transparent":!s.is_app_disk&&!s.is_data_disk,"bg-blue-50 dark:bg-blue-900/20 border-blue-500":s.is_data_disk&&!s.is_app_disk,"bg-green-50 dark:bg-green-900/20 border-green-500":s.is_app_disk&&!s.is_data_disk,"bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 border-purple-500":s.is_app_disk&&s.is_data_disk}])},[t("div",it,[m(N,{class:"w-5 h-5 mr-2 text-gray-400"}),t("h4",ut,"Disk: "+a(s.mount_point),1),s.is_data_disk?(d(),r("span",gt,"Data")):k("",!0),s.is_app_disk?(d(),r("span",ct,"App")):k("",!0)]),t("div",_t,[t("p",null,[e[9]||(e[9]=y("Available: ")),t("span",mt,a(i(s.available_gb)),1)]),t("p",null,[e[10]||(e[10]=y("Usage: ")),t("span",yt,a(i(s.used_gb))+" / "+a(i(s.total_gb))+" ("+a(p(s.usage_percent))+")",1)])]),t("div",xt,[t("div",{class:"bg-gradient-to-r from-cyan-400 to-teal-500 h-2.5 rounded-full",style:M({width:s.usage_percent+"%"})},null,4)])],2))),128)),b.value.length>0?(d(!0),r(f,{key:0},w(b.value,(s,z)=>(d(),r("div",{key:s.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},[t("div",bt,[m(U,{class:"w-5 h-5 mr-2 text-gray-400"}),t("h4",pt,"GPU "+a(z+1)+" Usage Details",1)]),t("div",vt,[t("p",null,[e[11]||(e[11]=y("Model: ")),t("span",ht,a(s.name),1)]),t("p",null,[e[12]||(e[12]=y("Available VRAM: ")),t("span",kt,a(i(s.vram_total_gb-s.vram_used_gb)),1)]),t("p",null,[e[13]||(e[13]=y("Usage: ")),t("span",ft,a(i(s.vram_used_gb))+" / "+a(i(s.vram_total_gb))+" ("+a(p(s.vram_usage_percent))+")",1)])]),t("div",wt,[t("div",{class:"bg-gradient-to-r from-indigo-500 to-pink-500 h-2.5 rounded-full",style:M({width:s.vram_usage_percent+"%"})},null,4)])]))),128)):(d(),r("div",Mt,e[14]||(e[14]=[t("p",null,"No NVIDIA GPU detected or pynvml library not installed on the server.",-1)])))])):n(x)?k("",!0):(d(),r("div",$t,e[15]||(e[15]=[t("p",{class:"text-red-500"},"Failed to load system status. Please check server logs.",-1)])))]))}},At={class:"space-y-12"},Ut={class:"space-y-6"},Nt={class:"flex items-center justify-between"},Dt=["disabled"],Pt={key:0,class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5"},zt={key:1,class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5"},Ct={class:"flex items-center"},Vt={class:"flex-shrink-0"},Gt={class:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Bt=["d"],Rt={class:"ml-5 w-0 flex-1"},jt={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},It={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ft={key:2,class:"text-center p-10 bg-white dark:bg-gray-800 rounded-lg shadow"},Et={__name:"Dashboard",setup(P){const _=$(null),l=$(!0),x=B(),b=$([{key:"total_users",label:"Total Users",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{key:"active_users_24h",label:"Active in 24h",icon:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},{key:"new_users_7d",label:"New in 7d",icon:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"},{key:"pending_approval",label:"Pending Approval",icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},{key:"pending_password_resets",label:"Password Resets",icon:"M15 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}]);async function v(){l.value=!0;try{const c=await R.get("/api/admin/stats");_.value=c.data}catch{x.addNotification("Could not load dashboard statistics.","error")}finally{l.value=!1}}return D(v),(c,u)=>(d(),r("div",At,[t("div",Ut,[t("div",Nt,[u[2]||(u[2]=t("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," Application Overview ",-1)),t("button",{onClick:v,class:"btn btn-secondary btn-sm",disabled:l.value},[(d(),r("svg",{xmlns:"http://www.w3.org/2000/svg",class:S(["h-4 w-4",{"animate-spin":l.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},u[0]||(u[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h5M20 20v-5h-5M4 4l16 16"},null,-1)]),2)),u[1]||(u[1]=t("span",{class:"ml-2"},"Refresh",-1))],8,Dt)]),l.value?(d(),r("div",Pt,[(d(),r(f,null,w(5,g=>t("div",{key:g,class:"bg-white dark:bg-gray-800/50 rounded-lg shadow p-5 animate-pulse"},u[3]||(u[3]=[t("div",{class:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"},null,-1),t("div",{class:"h-10 bg-gray-200 dark:bg-gray-700 rounded w-1/2"},null,-1)]))),64))])):_.value?(d(),r("div",zt,[(d(!0),r(f,null,w(b.value,g=>(d(),r("div",{key:g.key,class:"bg-white dark:bg-gray-800 rounded-lg shadow p-5 flex flex-col justify-between"},[t("div",null,[t("div",Ct,[t("div",Vt,[(d(),r("svg",Gt,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:g.icon},null,8,Bt)]))]),t("div",Rt,[t("dl",null,[t("dt",jt,a(g.label),1),t("dd",null,[t("div",It,a(_.value[g.key]),1)])])])])])]))),128))])):(d(),r("div",Ft,u[4]||(u[4]=[t("p",{class:"text-gray-500"},"Could not load dashboard data.",-1)])))]),m(St)]))}};export{Et as default};
