import{x as me,C as pe,b as o,e as r,f as e,y as N,d as c,F as L,m as V,t as S,u as fe,a as ye,q as ve,s as be,r as v,c as ge,o as xe,h as _,v as T,p as Y,w as J,n as O,l as R,g as ke,i as we,D as H,E as _e,j as k}from"./index-JJuGAYEB.js";function he(m){if(!m)return"Never";const s=new Date,g=new Date(m),h=Math.floor((s-g)/1e3);if(h<2)return"Just now";if(h<60)return`${h}s ago`;const $=Math.floor(h/60);if($<60)return`${$}m ago`;const p=Math.floor($/60);if(p<24)return`${p}h ago`;const l=Math.floor(p/24);return l<7?`${l}d ago`:g.toLocaleDateString()}const Ue={name:"UserTable",props:{users:{type:Array,required:!0},isLoading:{type:Boolean,default:!1},activeSessions:{type:Array,default:()=>[]},sortKey:{type:String,required:!0},sortDir:{type:String,required:!0}},emits:["delete-user","reset-password","get-reset-link","activate-user","deactivate-user","edit-user","sort-by"],computed:{...pe(fe,{currentUser:m=>m.user})},methods:{formatTimeAgo:he,canPerformAction(m){return this.currentUser?m.id!==this.currentUser.id:!1},getSortIcon(m){return this.sortKey!==m?"opacity-20":this.sortDir==="asc"?"transform rotate-180":""}}},Se={class:"overflow-x-auto"},Ce={class:"min-w-full divide-y dark:divide-gray-600"},$e={class:"bg-gray-50 dark:bg-gray-700"},Ae={scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},Ne={scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},De={scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},Me={class:"bg-white dark:bg-gray-800 divide-y dark:divide-gray-700"},Le={key:0},Ie={key:1},Pe={class:"px-4 py-2 text-sm"},Fe={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300"},Te={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"},Re={key:2,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"},Ve={class:"px-4 py-2 text-sm font-medium text-gray-900 dark:text-gray-100"},Ee={class:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400"},qe={class:"flex items-center space-x-2"},Be={key:0,class:"h-2 w-2 rounded-full bg-green-500 animate-pulse",title:"Online now"},ze=["title"],Oe={class:"px-4 py-2 text-sm"},je={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300"},Ge={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-200"},Ke=["title"],We={class:"px-4 py-2 text-sm space-x-2 whitespace-nowrap"},Ye=["onClick"],Je=["onClick"],He=["onClick"],Qe=["onClick"],Xe=["onClick"],Ze=["onClick"];function et(m,s,g,h,$,p){return r(),o("div",Se,[e("table",Ce,[e("thead",$e,[e("tr",null,[e("th",Ae,[e("button",{onClick:s[0]||(s[0]=l=>m.$emit("sort-by","event")),class:"flex items-center space-x-1 group"},[s[4]||(s[4]=e("span",null,"Status",-1)),(r(),o("svg",{class:N(["w-4 h-4 text-gray-400 group-hover:opacity-100 transition-opacity",p.getSortIcon("event")]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s[3]||(s[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),e("th",Ne,[e("button",{onClick:s[1]||(s[1]=l=>m.$emit("sort-by","username")),class:"flex items-center space-x-1 group"},[s[6]||(s[6]=e("span",null,"Username",-1)),(r(),o("svg",{class:N(["w-4 h-4 text-gray-400 group-hover:opacity-100 transition-opacity",p.getSortIcon("username")]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s[5]||(s[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),e("th",De,[e("button",{onClick:s[2]||(s[2]=l=>m.$emit("sort-by","last_activity_at")),class:"flex items-center space-x-1 group"},[s[8]||(s[8]=e("span",null,"Last Seen",-1)),(r(),o("svg",{class:N(["w-4 h-4 text-gray-400 group-hover:opacity-100 transition-opacity",p.getSortIcon("last_activity_at")]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s[7]||(s[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),s[9]||(s[9]=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Admin",-1)),s[10]||(s[10]=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"LLM Model",-1)),s[11]||(s[11]=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Actions",-1))])]),e("tbody",Me,[g.isLoading?(r(),o("tr",Le,s[12]||(s[12]=[e("td",{colspan:"6",class:"px-4 py-4 text-center text-sm italic text-gray-500"},"Loading users...",-1)]))):!g.users||g.users.length===0?(r(),o("tr",Ie,s[13]||(s[13]=[e("td",{colspan:"6",class:"px-4 py-4 text-center text-sm italic text-gray-500"},"No users found.",-1)]))):c("",!0),(r(!0),o(L,null,V(g.users,l=>(r(),o("tr",{key:l.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150"},[e("td",Pe,[l.password_reset_token?(r(),o("span",Fe,"Reset Requested")):l.is_active?(r(),o("span",Re,"Active")):(r(),o("span",Te,"Needs Approval"))]),e("td",Ve,S(l.username),1),e("td",Ee,[e("div",qe,[g.activeSessions.includes(l.username)?(r(),o("span",Be)):c("",!0),e("span",{title:l.last_activity_at?new Date(l.last_activity_at).toLocaleString():"Never"},S(p.formatTimeAgo(l.last_activity_at)),9,ze)])]),e("td",Oe,[l.is_admin?(r(),o("span",je,"Yes")):(r(),o("span",Ge,"No"))]),e("td",{class:"px-4 py-2 text-xs truncate text-gray-500 dark:text-gray-400",title:l.lollms_model_name},S(l.lollms_model_name||"-"),9,Ke),e("td",We,[e("button",{onClick:d=>m.$emit("edit-user",l),class:"btn btn-primary !py-1 !px-2 text-xs",title:"Edit User"},"Edit",8,Ye),l.is_active?c("",!0):(r(),o("button",{key:0,onClick:d=>m.$emit("activate-user",l.id),class:"btn btn-success !py-1 !px-2 text-xs",title:"Activate User"},"Activate",8,Je)),l.is_active&&p.canPerformAction(l)?(r(),o("button",{key:1,onClick:d=>m.$emit("deactivate-user",l.id),class:"btn btn-warning !py-1 !px-2 text-xs",title:"Deactivate User"},"Deactivate",8,He)):c("",!0),p.canPerformAction(l)?(r(),o("button",{key:2,onClick:d=>m.$emit("reset-password",l.id),class:"btn btn-secondary !py-1 !px-2 text-xs",title:"Reset Password"},"Reset Pass",8,Qe)):c("",!0),p.canPerformAction(l)?(r(),o("button",{key:3,onClick:d=>m.$emit("get-reset-link",l.id,l.username),class:"btn btn-secondary !py-1 !px-2 text-xs",title:"Get Password Reset Link"},"Get Link",8,Xe)):c("",!0),p.canPerformAction(l)?(r(),o("button",{key:4,onClick:d=>m.$emit("delete-user",l.id),class:"btn btn-danger !py-1 !px-2 text-xs",title:"Delete User"},"Delete",8,Ze)):c("",!0)])]))),128))])])])}const tt=me(Ue,[["render",et]]),st={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},at={class:"-mb-px flex space-x-6","aria-label":"Tabs"},ot={key:0},rt={key:0,class:"flex justify-end mb-6"},it={key:1,class:"bg-gray-100 dark:bg-gray-700/50 p-4 rounded-lg shadow-sm mb-6"},nt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},lt={class:"flex items-center"},dt={class:"text-right space-x-2"},ut=["disabled"],ct={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},mt={class:"space-y-4"},pt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ft=["disabled"],yt={key:0,disabled:"",value:""},vt={key:1,disabled:"",value:""},bt=["value"],gt=["disabled"],xt={class:"flex justify-end items-center space-x-4"},kt=["disabled"],wt=["disabled"],_t={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm"},ht={class:"flex justify-between items-center mb-3 border-b dark:border-gray-600 pb-2"},Ut={class:"flex items-center space-x-2"},St=["disabled"],Ct={key:0},$t={key:1},At={key:1},Nt={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm"},Dt={class:"flex justify-between items-center mb-4 border-b dark:border-gray-600 pb-3"},Mt={class:"space-x-2"},Lt=["disabled"],It=["disabled"],Pt={key:0},Ft={key:1},Tt={key:0,class:"text-center p-8 text-gray-500"},Rt={class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"},Vt={class:"space-y-6 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-md"},Et=["for"],qt={class:"mt-2"},Bt=["for"],zt=["onUpdate:modelValue","id"],Ot={class:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-200"},jt=["onUpdate:modelValue","id"],Gt={key:0,value:"direct"},Kt={key:1,value:"admin_approval"},Wt={key:2,value:"manual"},Yt={key:3,value:"automatic"},Jt=["type","step","onUpdate:modelValue","placeholder","id"],Ht={class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},Qt={class:"bg-gray-200 dark:bg-gray-600 px-1 rounded"},Xt={key:2},Zt={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm"},es={class:"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6"},ts={class:"mt-6"},ss={class:"mt-2 flex items-center"},as={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},os={class:"mt-6 flex justify-end"},rs=["disabled"],is={key:0},ns={key:1},us={__name:"AdminPanel",setup(m){const s=ye(),g=ve(),{availableLollmsModels:h,isLoadingLollmsModels:$}=be(g),p=v([]),l=v([]),d=v(!1),I=v(!1),y=v({username:"",password:"",email:"",lollms_model_name:"",safe_store_vectorizer:"",is_admin:!1}),u=v({}),E=v({}),b=v(!1),C=v(null),P=v(!1),w=v("users"),q=v(null),A=v("event"),D=v("desc"),Q=ge(()=>{const a=[...p.value],t=i=>i.password_reset_token?3:i.is_active?l.value.includes(i.username)?1:0:2;return a.sort((i,f)=>{const n=D.value==="asc"?1:-1;if(A.value==="event"){const K=t(i),W=t(f);if(K!==W)return(W-K)*n;const ce=i.last_activity_at?new Date(i.last_activity_at):0;return((f.last_activity_at?new Date(f.last_activity_at):0)-ce)*n}let x,M;switch(A.value){case"id":return(i.id-f.id)*n;case"username":x=i.username.toLowerCase(),M=f.username.toLowerCase();break;case"last_activity_at":x=i.last_activity_at?new Date(i.last_activity_at):0,M=f.last_activity_at?new Date(f.last_activity_at):0;break;default:x=i[A.value],M=f[A.value]}return x<M?-1*n:x>M?1*n:0}),a});function X(a){A.value===a?D.value=D.value==="asc"?"desc":"asc":(A.value=a,D.value="desc")}async function B(a){w.value!==a&&(w.value=a,await j())}async function j(){w.value==="users"?(await U(),await z(),h.value.length===0&&g.fetchAdminAvailableLollmsModels()):w.value==="settings"&&await z()}async function U(){d.value=!0;try{const[a,t]=await Promise.all([k.get("/api/admin/users"),k.get("/api/admin/active-sessions")]);p.value=a.data,l.value=t.data}catch{s.addNotification("Failed to load user data.","error")}finally{d.value=!1}}async function z(){b.value=!0;try{const t=(await k.get("/api/admin/settings")).data,i={},f={};t.forEach(n=>{n.key.includes("password")?i[n.key]="":i[n.key]=n.value,f[n.key]={...n}}),u.value=i,E.value=f}catch{s.addNotification("Failed to load global settings.","error")}finally{b.value=!1}}function Z(){const a={};for(const t in E.value)t.includes("password")?a[t]="":a[t]=E.value[t].value;u.value=a,s.addNotification("Changes have been discarded.","info")}async function F(){if(!isSettingsChanged.value)return s.addNotification("No changes to save.","info"),!1;b.value=!0;try{const a={...u.value};return a.smtp_password===""&&delete a.smtp_password,await k.put("/api/admin/settings",{configs:a}),s.addNotification("Global settings updated successfully.","success"),await z(),!0}catch{return!1}finally{b.value=!1}}async function ee(){if(!y.value.username||!y.value.password||!y.value.email){s.addNotification("Username, email, and password are required.","warning");return}d.value=!0;try{await k.post("/api/admin/users",y.value),s.addNotification(`User '${y.value.username}' created successfully.`,"success"),G(),await U()}catch{}finally{d.value=!1}}function te(a){s.openModal("adminUserEdit",{user:a,onUserUpdated:()=>{U()}})}async function se(a){if(await s.showConfirmation({title:"Delete User",message:"Are you sure you want to delete this user? This will also remove all their data and cannot be undone.",confirmText:"Delete",confirmClass:"btn-danger"})){d.value=!0;try{await k.delete(`/api/admin/users/${a}`),s.addNotification("User deleted successfully.","success"),await U()}catch{}finally{d.value=!1}}}function ae(a){const t=p.value.find(i=>i.id===a);t?s.openModal("resetPassword",{user:t,onPasswordReset:U}):s.addNotification("Could not find the specified user to reset password.","error")}async function oe(a,t){d.value=!0;try{const i=await k.post(`/api/admin/users/${a}/generate-reset-link`);s.openModal("passwordResetLink",{link:i.data.reset_link,username:t}),await U()}catch{}finally{d.value=!1}}async function re(a){d.value=!0;try{await k.post(`/api/admin/users/${a}/activate`),s.addNotification("User has been activated successfully.","success"),await U()}catch{}finally{d.value=!1}}async function ie(a){d.value=!0;try{await k.post(`/api/admin/users/${a}/deactivate`),s.addNotification("User has been deactivated successfully.","success"),await U()}catch{}finally{d.value=!1}}function G(){y.value={username:"",password:"",email:"",lollms_model_name:"",safe_store_vectorizer:"",is_admin:!1},I.value=!1}function ne(a){C.value=a.target.files[0]||null}async function le(){if(!C.value){s.addNotification("Please select a file to import.","warning");return}if(C.value.name!=="webui.db"){s.addNotification("Invalid file name. Please select the 'webui.db' file.","error");return}P.value=!0;const a=new FormData;a.append("file",C.value);try{const t=await k.post("/api/admin/import-openwebui",a,{headers:{"Content-Type":"multipart/form-data"}});s.addNotification(t.data.message,"success",8e3),C.value=null,q.value&&(q.value.value="")}catch{}finally{P.value=!1}}function de(){const a=p.value.map(t=>t.email).filter(Boolean).join(",");a?window.location.href=`mailto:${a}`:s.addNotification("No users with email addresses found.","warning")}async function ue(){const a=u.value.force_model_name;if(!a){s.addNotification("Please select a model to force first in the settings below.","warning");return}if(isSettingsChanged.value&&(s.addNotification("You have unsaved changes. Saving settings before applying...","info"),!await F())){s.addNotification("Could not save settings. Aborting force apply.","error");return}if(await s.showConfirmation({title:"Force Settings on All Users?",message:`This will overwrite the current model and context size for ALL users with the values you've configured (${a}). This action cannot be undone. Are you sure?`,confirmText:"Yes, Force Settings",confirmClass:"btn-warning"})){b.value=!0;const i={model_name:a,context_size:u.value.force_context_size};try{await k.post("/api/admin/force-settings-once",i),s.addNotification("Settings have been applied to all users.","success")}catch{}finally{b.value=!1}}}return xe(()=>{j()}),(a,t)=>(r(),o("div",null,[t[30]||(t[30]=e("h4",{class:"text-lg font-semibold mb-4"},"Administration",-1)),e("div",st,[e("nav",at,[e("button",{onClick:t[0]||(t[0]=i=>B("users")),class:N([[w.value==="users"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-300":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-500"],"whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors duration-200"])}," User Management ",2),e("button",{onClick:t[1]||(t[1]=i=>B("settings")),class:N([[w.value==="settings"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-300":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-500"],"whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors duration-200"])}," Global Settings ",2),e("button",{onClick:t[2]||(t[2]=i=>B("import")),class:N([[w.value==="import"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-300":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-500"],"whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm transition-colors duration-200"])}," Data Import ",2)])]),w.value==="users"?(r(),o("div",ot,[I.value?c("",!0):(r(),o("div",rt,[e("button",{onClick:t[3]||(t[3]=i=>I.value=!0),class:"btn btn-primary"},"Add New User")])),I.value?(r(),o("section",it,[t[15]||(t[15]=e("h2",{class:"text-md font-semibold mb-3 border-b dark:border-gray-600 pb-2"},"Add New User",-1)),e("form",{onSubmit:J(ee,["prevent"]),class:"space-y-4"},[e("div",nt,[e("div",null,[t[11]||(t[11]=e("label",{for:"newUsername",class:"block text-sm font-medium"},"Username",-1)),_(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=i=>y.value.username=i),id:"newUsername",required:"",minlength:"3",class:"input-field mt-1"},null,512),[[T,y.value.username]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"newEmail",class:"block text-sm font-medium"},"Email",-1)),_(e("input",{type:"email","onUpdate:modelValue":t[5]||(t[5]=i=>y.value.email=i),id:"newEmail",required:"",class:"input-field mt-1"},null,512),[[T,y.value.email]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"newPassword",class:"block text-sm font-medium"},"Password (min 8 chars)",-1)),_(e("input",{type:"password","onUpdate:modelValue":t[6]||(t[6]=i=>y.value.password=i),id:"newPassword",required:"",minlength:"8",class:"input-field mt-1"},null,512),[[T,y.value.password]])])]),e("div",lt,[_(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=i=>y.value.is_admin=i),id:"newUserIsAdmin",class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,512),[[Y,y.value.is_admin]]),t[14]||(t[14]=e("label",{for:"newUserIsAdmin",class:"ml-2 block text-sm"},"Grant Administrator Privileges",-1))]),e("div",dt,[e("button",{type:"button",onClick:G,class:"btn btn-secondary"},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:d.value},"Add User",8,ut)])],32)])):c("",!0),e("section",ct,[t[20]||(t[20]=e("h2",{class:"text-md font-semibold mb-3 border-b dark:border-gray-600 pb-2"},"Global User Overrides",-1)),e("div",mt,[e("div",null,[t[17]||(t[17]=e("label",{for:"forceMode",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Force Model Mode",-1)),_(e("select",{id:"forceMode","onUpdate:modelValue":t[8]||(t[8]=i=>u.value.force_model_mode=i),class:"input-field mt-1 max-w-md"},t[16]||(t[16]=[e("option",{value:"disabled"},"Disabled",-1),e("option",{value:"force_once"},"Force Once (Set User Preference)",-1),e("option",{value:"force_always"},"Force Always (Session Override)",-1)]),512),[[O,u.value.force_model_mode]])]),e("div",pt,[e("div",null,[t[18]||(t[18]=e("label",{for:"forceModelName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Model to Force",-1)),_(e("select",{id:"forceModelName","onUpdate:modelValue":t[9]||(t[9]=i=>u.value.force_model_name=i),class:"input-field mt-1",disabled:R($)||u.value.force_model_mode==="disabled"},[R($)?(r(),o("option",yt,"Loading models...")):R(h).length===0?(r(),o("option",vt,"No models available")):c("",!0),(r(!0),o(L,null,V(R(h),i=>(r(),o("option",{key:i.id,value:i.id},S(i.name),9,bt))),128))],8,ft),[[O,u.value.force_model_name]])]),e("div",null,[t[19]||(t[19]=e("label",{for:"forceCtxSize",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Context Size to Force",-1)),_(e("input",{type:"number",id:"forceCtxSize","onUpdate:modelValue":t[10]||(t[10]=i=>u.value.force_context_size=i),class:"input-field mt-1",disabled:u.value.force_model_mode==="disabled"},null,8,gt),[[T,u.value.force_context_size,void 0,{number:!0}]])])]),e("div",xt,[u.value.force_model_mode==="force_once"?(r(),o("button",{key:0,type:"button",onClick:ue,class:"btn btn-warning",disabled:b.value}," Apply to All Users Now ",8,kt)):c("",!0),e("button",{onClick:F,class:"btn btn-primary",disabled:!a.isSettingsChanged||b.value},"Save Overrides",8,wt)])])]),e("section",_t,[e("div",ht,[t[21]||(t[21]=e("h2",{class:"text-md font-semibold"},"Manage Existing Users",-1)),e("div",Ut,[e("button",{onClick:de,class:"btn btn-secondary !py-1 !px-2 text-xs"},"Email All Users"),e("button",{onClick:U,class:"btn btn-secondary !py-1 !px-2 text-xs",disabled:d.value},[d.value?(r(),o("span",Ct,"Refreshing...")):(r(),o("span",$t,"Refresh List"))],8,St)])]),ke(tt,{users:Q.value,"active-sessions":l.value,isLoading:d.value,"sort-key":A.value,"sort-dir":D.value,onSortBy:X,onEditUser:te,onDeleteUser:se,onResetPassword:ae,onGetResetLink:oe,onActivateUser:re,onDeactivateUser:ie},null,8,["users","active-sessions","isLoading","sort-key","sort-dir"])])])):c("",!0),w.value==="settings"?(r(),o("div",At,[e("section",Nt,[e("div",Dt,[t[22]||(t[22]=e("h2",{class:"text-md font-semibold"},"Application Settings",-1)),e("div",Mt,[e("button",{onClick:Z,class:"btn btn-secondary",disabled:!a.isSettingsChanged||b.value},"Reset",8,Lt),e("button",{onClick:F,class:"btn btn-primary",disabled:!a.isSettingsChanged||b.value},[b.value?(r(),o("span",Pt,"Saving...")):(r(),o("span",Ft,"Save Changes"))],8,It)])]),b.value?(r(),o("div",Tt," Loading settings... ")):(r(),o("form",{key:1,onSubmit:J(F,["prevent"]),class:"space-y-8"},[(r(!0),o(L,null,V(a.categorizedSettings,(i,f)=>(r(),o("div",{key:f},[f!=="Global LLM Overrides"?(r(),o(L,{key:0},[e("h3",Rt,S(f),1),e("div",Vt,[(r(!0),o(L,null,V(i,n=>(r(),o("div",{key:n.key},[e("label",{for:`setting-${n.key}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},S(n.description),9,Et),e("div",qt,[n.type==="boolean"?(r(),o("label",{key:0,for:`setting-${n.key}`,class:"relative inline-flex items-center cursor-pointer"},[_(e("input",{type:"checkbox","onUpdate:modelValue":x=>u.value[n.key]=x,class:"sr-only peer",id:`setting-${n.key}`},null,8,zt),[[Y,u.value[n.key]]]),t[23]||(t[23]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-500 peer-checked:bg-blue-600"},null,-1)),e("span",Ot,S(u.value[n.key]?"Enabled":"Disabled"),1)],8,Bt)):n.key==="registration_mode"||n.key==="password_recovery_mode"?_((r(),o("select",{key:1,"onUpdate:modelValue":x=>u.value[n.key]=x,id:`setting-${n.key}`,class:"input-field max-w-sm"},[n.key==="registration_mode"?(r(),o("option",Gt,"Direct (instantly active)")):c("",!0),n.key==="registration_mode"?(r(),o("option",Kt,"Admin Approval")):c("",!0),n.key==="password_recovery_mode"?(r(),o("option",Wt,"Manual (Admin Notified)")):c("",!0),n.key==="password_recovery_mode"?(r(),o("option",Yt,"Automatic (Email)")):c("",!0)],8,jt)),[[O,u.value[n.key]]]):_((r(),o("input",{key:2,type:n.key.includes("password")?"password":n.type==="string"?"text":"number",step:n.type==="float"?"0.1":"1","onUpdate:modelValue":x=>u.value[n.key]=x,placeholder:n.key.includes("password")?"Enter new password to change":"",id:`setting-${n.key}`,class:"input-field max-w-sm"},null,8,Jt)),[[we,u.value[n.key]]])]),e("p",Ht,[t[24]||(t[24]=H("Key: ")),e("code",Qt,S(n.key),1)])]))),128))])],64)):c("",!0)]))),128))],32))])])):c("",!0),w.value==="import"?(r(),o("div",Xt,[e("section",Zt,[t[28]||(t[28]=e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Import from OpenWebUI",-1)),t[29]||(t[29]=e("p",{class:"mt-2 max-w-2xl text-sm text-gray-500 dark:text-gray-400"}," Migrate users and their discussion histories from an OpenWebUI instance. ",-1)),e("div",es,[t[27]||(t[27]=_e('<div class="prose dark:prose-invert text-sm max-w-none"><p><strong>Instructions:</strong></p><ol><li>Locate your OpenWebUI data directory (e.g., inside the Docker container at <code>/app/backend/data</code>).</li><li>Find the main database file named <strong><code>webui.db</code></strong>.</li><li>Click &quot;Select File&quot; and upload that single <code>webui.db</code> file.</li><li>Click &quot;Start Import&quot;. The process runs in the background and may take several minutes. Check the server logs for detailed progress.</li></ol><p class="font-semibold text-yellow-600 dark:text-yellow-400"> Important: This tool migrates users based on their email. If a user with the same email already exists, their core data will be skipped, but their discussions will still be imported. Passwords will be migrated seamlessly. </p></div>',1)),e("div",ts,[t[26]||(t[26]=e("label",{for:"file-upload",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," OpenWebUI Database File ",-1)),e("div",ss,[e("input",{ref_key:"fileInputRef",ref:q,onChange:ne,type:"file",accept:".db",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900/50 dark:file:text-blue-300 dark:hover:file:bg-blue-900"},null,544)]),C.value?(r(),o("div",as,[t[25]||(t[25]=H(" Selected: ")),e("strong",null,S(C.value.name),1)])):c("",!0)]),e("div",os,[e("button",{onClick:le,disabled:P.value||!C.value,class:"btn btn-primary"},[P.value?(r(),o("span",is,"Importing...")):(r(),o("span",ns,"Start Import"))],8,rs)])])])])):c("",!0)]))}};export{us as default};
