import{B as fe,ak as be,ao as ge,a as _e,az as ke,s as U,r as n,c as _,w as T,o as he,b as o,e as l,f as s,h as y,d as b,A as C,x as f,F as k,z as A,t as g,aq as xe,H as G,i as h,v as $,y as Pe,l as we,ap as J,C as E,g as W,T as Se,G as Ce,aA as Ae}from"./index-Dm_PsB8S.js";import{A as $e,a as Ie}from"./AppCardSkeleton-74CYO1kX.js";import"./IconArrowUpCircle-BE4JLDiP.js";const Re={class:"space-y-6"},Me={class:"border-b border-gray-200 dark:border-gray-700"},Te={class:"-mb-px flex space-x-6","aria-label":"Sub Tabs"},Ne={key:0},Ze={key:0,class:"text-center p-4"},Ve={key:1,class:"empty-state-card"},De={key:2,class:"space-y-3"},Le={class:"flex items-center gap-3 flex-grow truncate"},Ue=["src"],Ee={class:"font-medium truncate"},je={class:"flex items-center gap-x-2 flex-shrink-0"},ze=["onClick"],Be=["onClick"],Fe={key:1},qe={class:"space-y-4"},He={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Oe=["value"],Ge={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},Je={key:1,class:"empty-state-card"},We={key:2},Ke={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},Qe={class:"mt-6 flex justify-between items-center"},Xe={class:"text-sm text-gray-500"},Ye={class:"flex gap-2"},et=["disabled"],tt=["disabled"],st={key:2},at={class:"flex justify-between items-center mb-4"},lt={class:"flex items-center gap-2"},ot=["disabled"],nt={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},it=["disabled"],rt={key:0,class:"text-center p-4"},dt={key:1,class:"empty-state-card"},ut={key:2,class:"space-y-4"},ct={class:"flex-grow truncate"},mt={class:"font-semibold"},pt={class:"text-sm text-gray-500 font-mono truncate"},vt={class:"text-xs text-gray-400 mt-1"},yt={class:"flex items-center gap-x-2"},ft=["onClick","disabled"],bt=["onClick","disabled"],gt={__name:"PromptsManagement",setup(_t){const i=be(),K=ge(),m=_e(),j=ke(),{promptZooRepositories:z,isLoadingPromptZooRepositories:Q,zooPrompts:x,isLoadingZooPrompts:X}=U(i),{systemPrompts:N,isLoading:Y}=U(j),{tasks:ee}=U(K),r=n("installed"),p=n({name:"",url:""}),P=n(!1),u=n(null),I=n(!1),R=n(""),w=n("All"),Z=n("All"),B=n("last_update_date"),F=n("desc"),S=n(JSON.parse(localStorage.getItem("starredPrompts")||"[]")),c=n(1),V=n(24);let q=null;const H=_(()=>x.value.total||0),te=_(()=>x.value.pages||1),se=_(()=>{const a=(c.value-1)*V.value+1,e=Math.min(c.value*V.value,H.value);return`Showing ${a}-${e} of ${H.value}`});async function M(){const a={page:c.value,page_size:V.value,sort_by:B.value,sort_order:F.value,category:w.value!=="All"?w.value:void 0,search_query:R.value||void 0,installation_status:Z.value!=="All"?Z.value:void 0};await i.fetchZooPrompts(a)}function ae(){clearTimeout(q),q=setTimeout(()=>{c.value=1,M()},300)}T([B,F,w,Z,r],()=>{r.value==="available"&&(c.value=1,M())}),T(R,ae),T(c,M),T(S,a=>{localStorage.setItem("starredPrompts",JSON.stringify(a))},{deep:!0}),he(()=>{j.fetchPrompts(),i.fetchPromptZooRepositories(),M()});const D=_(()=>{if(!Array.isArray(x.value.items))return[];const a=new Map;return ee.value.forEach(e=>{var t;if((t=e==null?void 0:e.name)!=null&&t.startsWith("Installing prompt: ")){const v=e.name.replace("Installing prompt: ","");a.set(v,e)}}),x.value.items.map(e=>({...e,task:a.get(e.folder_name)||null}))}),L=_(()=>Array.isArray(z.value)?[...z.value].sort((a,e)=>(a.name||"").localeCompare(e.name||"")):[]),le=_(()=>{const a=new Set(x.value.items.map(e=>e.category).filter(Boolean));return["All",...Array.from(a).sort()]});function oe(a){return a?new Date(a).toLocaleString():"Never"}async function ne(){if(!(!p.value.name||!p.value.url)){u.value="add";try{await i.addPromptZooRepository(p.value),p.value={name:"",url:""},P.value=!1}finally{u.value=null}}}async function ie(a){u.value=a.id;try{await i.pullPromptZooRepository(a.id)}finally{u.value=null}}async function re(){I.value=!0;try{await i.pullAllPromptZooRepositories()}finally{I.value=!1}}async function de(a){if(await m.showConfirmation({title:`Delete Repository '${a.name}'?`})){u.value=a.id;try{await i.deletePromptZooRepository(a.id)}finally{u.value=null}}}async function ue(a){await i.installZooPrompt({repository:a.repository,folder_name:a.folder_name})}async function ce(a){const e=await i.fetchPromptReadme(a.repository,a.folder_name);m.openModal("sourceViewer",{title:`README: ${a.name}`,content:e,language:"markdown"})}function me(a){const e=S.value.indexOf(a);e>-1?S.value.splice(e,1):S.value.push(a)}const d=n(null);function pe(){d.value={name:"",content:"",category:"",author:"",description:"",icon:null},m.openModal("editSystemPrompt")}function ve(a){d.value={...a},m.openModal("editSystemPrompt")}async function O(){if(!d.value)return;const{id:a,...e}=d.value;try{a?await i.updateSystemPrompt(a,e):await i.createSystemPrompt(e),m.closeModal("editSystemPrompt")}catch{}}async function ye(a){await m.showConfirmation({title:`Delete '${a.name}'?`})&&await i.deleteSystemPrompt(a.id)}return(a,e)=>(l(),o(k,null,[s("div",Re,[s("div",Me,[s("nav",Te,[s("button",{onClick:e[0]||(e[0]=t=>r.value="installed"),class:C(["tab-button",r.value==="installed"?"active":"inactive"])},"Installed",2),s("button",{onClick:e[1]||(e[1]=t=>r.value="available"),class:C(["tab-button",r.value==="available"?"active":"inactive"])},"Available from Zoo",2),s("button",{onClick:e[2]||(e[2]=t=>r.value="repositories"),class:C(["tab-button",r.value==="repositories"?"active":"inactive"])},"Repositories",2)])]),r.value==="installed"?(l(),o("section",Ne,[s("div",{class:"flex justify-between items-center mb-4"},[e[14]||(e[14]=s("h3",{class:"text-xl font-semibold"},"Installed System Prompts",-1)),s("button",{onClick:pe,class:"btn btn-primary"},"Add Prompt")]),f(Y)?(l(),o("div",Ze,"Loading...")):!f(N)||f(N).length===0?(l(),o("div",Ve,e[15]||(e[15]=[s("p",null,"No system prompts installed.",-1)]))):(l(),o("div",De,[(l(!0),o(k,null,A(f(N),t=>(l(),o("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm flex items-center justify-between gap-4"},[s("div",Le,[t.icon?(l(),o("img",{key:0,src:t.icon,class:"h-8 w-8 rounded-md flex-shrink-0 object-cover",alt:"Icon"},null,8,Ue)):b("",!0),s("p",Ee,g(t.name),1)]),s("div",je,[s("button",{onClick:v=>ve(t),class:"btn btn-secondary btn-sm p-2",title:"Edit"},[y(xe,{class:"w-4 h-4"})],8,ze),s("button",{onClick:v=>ye(t),class:"btn btn-danger btn-sm p-2",title:"Delete"},[y(G,{class:"w-4 h-4"})],8,Be)])]))),128))]))])):b("",!0),r.value==="available"?(l(),o("section",Fe,[s("div",qe,[s("div",He,[h(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>R.value=t),placeholder:"Search Prompts...",class:"input-field"},null,512),[[$,R.value]]),h(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>w.value=t),class:"input-field"},[e[16]||(e[16]=s("option",{value:"All"},"All Categories",-1)),(l(!0),o(k,null,A(le.value,t=>(l(),o("option",{key:t,value:t},g(t),9,Oe))),128))],512),[[Pe,w.value]])]),f(X)?(l(),o("div",Ge,[(l(),o(k,null,A(6,t=>y($e,{key:t})),64))])):!D.value||D.value.length===0?(l(),o("div",Je,e[17]||(e[17]=[s("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(l(),o("div",We,[s("div",Ke,[(l(!0),o(k,null,A(D.value,t=>(l(),we(Ie,{key:`${t.repository}/${t.folder_name}`,app:t,task:t.task,"is-starred":S.value.includes(t.name),"item-type-name":"Prompt",onStar:v=>me(t.name),onInstall:v=>ue(t),onHelp:v=>ce(t)},null,8,["app","task","is-starred","onStar","onInstall","onHelp"]))),128))]),s("div",Qe,[s("p",Xe,g(se.value),1),s("div",Ye,[s("button",{onClick:e[5]||(e[5]=t=>c.value--),disabled:c.value<=1,class:"btn btn-secondary"},"Prev",8,et),s("button",{onClick:e[6]||(e[6]=t=>c.value++),disabled:c.value>=te.value,class:"btn btn-secondary"},"Next",8,tt)])])]))])])):b("",!0),r.value==="repositories"?(l(),o("section",st,[s("div",at,[e[19]||(e[19]=s("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),s("div",lt,[s("button",{onClick:re,class:"btn btn-secondary",disabled:I.value},[y(J,{class:C(["w-4 h-4",{"animate-spin":I.value}])},null,8,["class"]),e[18]||(e[18]=s("span",{class:"ml-2"},"Pull All",-1))],8,ot),s("button",{onClick:e[7]||(e[7]=t=>P.value=!P.value),class:"btn btn-primary"},g(P.value?"Cancel":"Add"),1)])]),y(Se,{name:"form-fade"},{default:E(()=>[P.value?(l(),o("div",nt,[s("form",{onSubmit:W(ne,["prevent"]),class:"flex gap-4"},[h(s("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>p.value.name=t),type:"text",placeholder:"Name",class:"input-field flex-1",required:""},null,512),[[$,p.value.name]]),h(s("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>p.value.url=t),type:"url",placeholder:"Git URL",class:"input-field flex-grow-[2]",required:""},null,512),[[$,p.value.url]]),s("button",{type:"submit",class:"btn btn-primary",disabled:u.value==="add"},"Add",8,it)],32)])):b("",!0)]),_:1}),f(Q)?(l(),o("div",rt,"Loading...")):!L.value||L.value.length===0?(l(),o("div",dt,e[20]||(e[20]=[s("p",null,"No repositories added.",-1)]))):(l(),o("div",ut,[(l(!0),o(k,null,A(L.value,t=>(l(),o("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between gap-4"},[s("div",ct,[s("p",mt,g(t.name),1),s("p",pt,g(t.url),1),s("p",vt,"Updated: "+g(oe(t.last_pulled_at)),1)]),s("div",yt,[s("button",{onClick:v=>ie(t),class:"btn btn-secondary btn-sm",disabled:u.value===t.id},[y(J,{class:C(["w-4 h-4",{"animate-spin":u.value===t.id}])},null,8,["class"]),e[21]||(e[21]=Ce(" Pull"))],8,ft),t.is_deletable?(l(),o("button",{key:0,onClick:v=>de(t),class:"btn btn-danger btn-sm",disabled:u.value===t.id},[y(G,{class:"w-4 h-4"})],8,bt)):b("",!0)])]))),128))]))])):b("",!0)]),y(Ae,{modalName:"editSystemPrompt",title:d.value&&d.value.id?"Edit System Prompt":"Add System Prompt",onClose:e[13]||(e[13]=t=>f(m).closeModal("editSystemPrompt"))},{body:E(()=>[d.value?(l(),o("form",{key:0,onSubmit:W(O,["prevent"]),class:"space-y-4"},[s("div",null,[e[22]||(e[22]=s("label",{for:"prompt-name",class:"block text-sm font-medium"},"Name",-1)),h(s("input",{id:"prompt-name","onUpdate:modelValue":e[10]||(e[10]=t=>d.value.name=t),type:"text",class:"input-field mt-1",required:""},null,512),[[$,d.value.name]])]),s("div",null,[e[23]||(e[23]=s("label",{for:"prompt-content",class:"block text-sm font-medium"},"Content",-1)),h(s("textarea",{id:"prompt-content","onUpdate:modelValue":e[11]||(e[11]=t=>d.value.content=t),rows:"10",class:"input-field mt-1"},null,512),[[$,d.value.content]])])],32)):b("",!0)]),footer:E(()=>[s("button",{onClick:e[12]||(e[12]=t=>f(m).closeModal("editSystemPrompt")),class:"btn btn-secondary"},"Cancel"),s("button",{onClick:O,class:"btn btn-primary"},"Save")]),_:1},8,["title"])],64))}},Pt=fe(gt,[["__scopeId","data-v-3c8c7c8a"]]);export{Pt as default};
