import{O as D,a as F,s as c,r as p,z as S,o as I,w as k,c as l,b as n,g as e,f as V,d as h,n as w,h as v,v as A,F as B,i as M,t as d,e as C,j}from"./index-Bhj2RcFI.js";const N={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},O={class:"space-y-8"},T={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},U={key:0,class:"space-y-6 pt-6 border-t dark:border-gray-600"},E=["value"],$=["value"],z={key:0},G={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},J={class:"flex justify-end"},R=["disabled"],q={key:1,class:"p-6 text-center"},H={class:"text-gray-500"},W={__name:"AiBotSettings",setup(K){const i=D(),u=F(),{globalSettings:b}=c(i),{availableLollmsModels:g,publicPersonalities:y}=c(u),a=p({ai_bot_enabled:!1,ai_bot_binding_model:"",ai_bot_personality_id:"",ai_bot_system_prompt:""}),r=p(!1),m=p(!1);let f="{}";const _=S(()=>b.value.filter(o=>o.category==="AI Bot")),L=S(()=>y.value.map(o=>({id:o.id,name:`${o.name} (by ${o.author})`})));I(()=>{b.value.length===0?i.fetchGlobalSettings():x(),g.value.length===0&&u.fetchAdminAvailableLollmsModels(),y.value.length===0&&u.fetchPersonalities()}),k(()=>b.value,x,{deep:!0}),k(a,o=>{m.value=JSON.stringify(o)!==f},{deep:!0});function x(){const o={};_.value.length>0&&(_.value.forEach(t=>{o[t.key]=t.value}),a.value={...a.value,...o},f=JSON.stringify(a.value),m.value=!1)}async function P(){r.value=!0;try{await i.updateGlobalSettings({...a.value})}finally{r.value=!1}}return(o,t)=>(n(),l("div",N,[t[13]||(t[13]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," AI Bot Settings "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure the automated AI assistant that responds to @lollms mentions. ")],-1)),Object.keys(a.value).length?(n(),l("form",{key:0,onSubmit:V(P,["prevent"]),class:"p-6"},[e("div",O,[e("div",T,[t[4]||(t[4]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable AI Bot"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Allow the bot to reply to @lollms mentions.")],-1)),e("button",{onClick:t[0]||(t[0]=s=>a.value.ai_bot_enabled=!a.value.ai_bot_enabled),type:"button",class:w([a.value.ai_bot_enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:w([a.value.ai_bot_enabled?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),a.value.ai_bot_enabled?(n(),l("div",U,[e("div",null,[t[6]||(t[6]=e("label",{for:"bot-model",class:"block text-sm font-medium"},"Bot Model",-1)),v(e("select",{id:"bot-model","onUpdate:modelValue":t[1]||(t[1]=s=>a.value.ai_bot_binding_model=s),class:"input-field mt-1"},[t[5]||(t[5]=e("option",{value:""},"-- Select a Model --",-1)),(n(!0),l(B,null,M(C(g),s=>(n(),l("option",{key:s.id,value:s.id},d(s.name),9,E))),128))],512),[[A,a.value.ai_bot_binding_model]]),t[7]||(t[7]=e("p",{class:"mt-1 text-xs text-gray-500"},"The model the bot will use to generate replies.",-1))]),e("div",null,[t[9]||(t[9]=e("label",{for:"bot-personality",class:"block text-sm font-medium"},"Bot Personality",-1)),v(e("select",{id:"bot-personality","onUpdate:modelValue":t[2]||(t[2]=s=>a.value.ai_bot_personality_id=s),class:"input-field mt-1"},[t[8]||(t[8]=e("option",{value:""},"-- Use Default System Prompt --",-1)),(n(!0),l(B,null,M(L.value,s=>(n(),l("option",{key:s.id,value:s.id},d(s.name),9,$))),128))],512),[[A,a.value.ai_bot_personality_id]]),t[10]||(t[10]=e("p",{class:"mt-1 text-xs text-gray-500"},"Select a personality to define the bot's behavior.",-1))]),a.value.ai_bot_personality_id?h("",!0):(n(),l("div",z,[t[11]||(t[11]=e("label",{for:"bot-prompt",class:"block text-sm font-medium"},"Default System Prompt",-1)),v(e("textarea",{id:"bot-prompt","onUpdate:modelValue":t[3]||(t[3]=s=>a.value.ai_bot_system_prompt=s),rows:"6",class:"input-field mt-1"},null,512),[[j,a.value.ai_bot_system_prompt]]),t[12]||(t[12]=e("p",{class:"mt-1 text-xs text-gray-500"},"The system prompt used if no personality is selected.",-1))]))])):h("",!0)]),e("div",G,[e("div",J,[e("button",{type:"submit",class:"btn btn-primary",disabled:r.value||!m.value},d(r.value?"Saving...":"Save Settings"),9,R)])])],32)):(n(),l("div",q,[e("p",H,d(C(i).isLoadingSettings?"Loading settings...":"Could not load AI Bot settings."),1)]))]))}};export{W as default};
