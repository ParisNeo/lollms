import{u as M,f as A,a as N,s as k,r as f,n as V,o as $,g as w,c as o,b as n,d as e,p as B,_ as E,t as m,w as z,i as P,j as b,F as C,k as S}from"./index-BNoCzhvc.js";const F={class:"text-right"},T=["disabled"],U={class:"mb-8"},Y={class:"flex justify-between items-center mb-2"},G={class:"max-h-60 overflow-y-auto border dark:border-gray-600 rounded p-2 space-y-1"},I={key:0,class:"italic text-sm text-gray-500 p-2"},L={class:"flex items-center space-x-3"},R=["src"],q={key:1,class:"h-8 w-8 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-400"},H={class:"space-x-2"},J=["onClick"],K=["onClick"],O={class:"max-h-60 overflow-y-auto border dark:border-gray-600 rounded p-2 space-y-1"},Q={key:0,class:"italic text-sm text-gray-500 p-2"},W={class:"flex items-center space-x-3"},X=["src"],Z={key:1,class:"h-8 w-8 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-400"},ee={class:"block text-xs text-gray-500"},te=["onClick"],oe={__name:"PersonalitiesSettings",setup(se){const g=M(),v=A(),h=N(),{user:i}=k(g),{userPersonalities:r,publicPersonalities:d}=k(v),l=f(""),u=f(!1),c=f(!1),j=V(()=>{const a=[];return r.value.length>0&&a.push({isGroup:!0,label:"Your Personalities",items:r.value.map(t=>({id:t.id,name:t.name,icon_base64:t.icon_base64}))}),d.value.length>0&&a.push({isGroup:!0,label:"Public Personalities",items:d.value.map(t=>({id:t.id,name:t.name,icon_base64:t.icon_base64}))}),a}),x=()=>{i.value&&(l.value=i.value.active_personality_id||null,c.value=!1)};$(()=>{v.fetchPersonalities(),x()}),w(i,x),w(l,a=>{i.value&&(c.value=(a||null)!==(i.value.active_personality_id||null))});async function _(){u.value=!0;try{await g.updateUserPreferences({active_personality_id:l.value||null}),c.value=!1}catch{}finally{u.value=!1}}function y(a=null){const t=a&&a.owner_username!==i.value.username;let s;t?s={...a,id:null,owner_username:null,is_public:!1}:s=a?{...a}:{name:"",category:"",description:"",prompt_text:"",is_public:!1,icon_base64:null},h.openModal("personalityEditor",{personality:s})}async function D(a){await h.showConfirmation({title:`Delete ${a.name}`,message:"Are you sure you want to delete this personality? This cannot be undone.",confirmText:"Delete"})&&(await v.deletePersonality(a.id),l.value===a.id&&(l.value=null,_()))}return(a,t)=>(n(),o("section",null,[t[7]||(t[7]=e("h4",{class:"text-lg font-semibold mb-4 border-b dark:border-gray-600 pb-2"},"Personalities",-1)),e("form",{onSubmit:z(_,["prevent"]),class:"space-y-4 max-w-md mb-8"},[e("div",null,[t[2]||(t[2]=e("label",{for:"activePersonality",class:"block text-sm font-medium mb-1"},"Active Personality",-1)),B(E,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=s=>l.value=s),items:j.value,placeholder:"None (Default)"},null,8,["modelValue","items"])]),e("div",F,[e("button",{type:"submit",class:"btn btn-primary",disabled:u.value||!c.value},m(u.value?"Saving...":"Save Active Personality"),9,T)])],32),e("div",U,[e("div",Y,[t[3]||(t[3]=e("h5",{class:"text-md font-semibold"},"Manage Your Personalities",-1)),e("button",{onClick:t[1]||(t[1]=s=>y()),class:"btn btn-secondary !text-xs !py-1"},"+ Create New")]),e("div",G,[b(r).length===0?(n(),o("p",I,"You haven't created any personalities yet.")):P("",!0),(n(!0),o(C,null,S(b(r),s=>(n(),o("div",{key:s.id,class:"flex justify-between items-center py-1.5 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-sm"},[e("div",L,[s.icon_base64?(n(),o("img",{key:0,src:s.icon_base64,class:"h-8 w-8 rounded-md object-cover bg-gray-200 dark:bg-gray-700"},null,8,R)):(n(),o("div",q,t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)]))),e("span",null,m(s.name),1)]),e("div",H,[e("button",{onClick:p=>y(s),class:"font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"},"Edit",8,J),e("button",{onClick:p=>D(s),class:"font-medium text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300"},"Delete",8,K)])]))),128))])]),e("div",null,[t[6]||(t[6]=e("h5",{class:"text-md font-semibold mb-2"},"Available Public Personalities",-1)),e("div",O,[b(d).length===0?(n(),o("p",Q,"No public personalities available.")):P("",!0),(n(!0),o(C,null,S(b(d),s=>(n(),o("div",{key:s.id,class:"flex justify-between items-center py-1.5 px-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded text-sm"},[e("div",W,[s.icon_base64?(n(),o("img",{key:0,src:s.icon_base64,class:"h-8 w-8 rounded-md object-cover bg-gray-200 dark:bg-gray-700"},null,8,X)):(n(),o("div",Z,t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)]))),e("div",null,[e("span",null,m(s.name),1),e("em",ee,"by "+m(s.author||"System"),1)])]),e("button",{onClick:p=>y(s),class:"font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300"},"Clone & Edit",8,te)]))),128))])])]))}};export{oe as default};
