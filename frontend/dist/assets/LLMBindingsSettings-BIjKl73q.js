import{l as G,m as J,s as H,r as _,c as w,w as K,o as P,a as i,b as a,k as c,d as e,t as d,p as B,g,v as R,q as N,F as p,i as C,e as S,x as Q,y as F,_ as W,z as X,n as b,A as Y,f as Z,B as ee}from"./index-CyHS5TN7.js";const te={class:"space-y-8"},se={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},ne={class:"text-xl font-semibold mb-4"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ae=["disabled"],ie=["value"],oe={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},de={class:"text-sm text-gray-600 dark:text-gray-400"},re=["for"],ue={key:0,class:"text-red-500"},ce={key:0},me={class:"relative"},fe=["type","id","onUpdate:modelValue","required","placeholder"],ge=["onClick","title"],ve={key:1,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},ye={class:"flex-grow flex flex-col pr-4"},_e={class:"text-sm text-gray-500 dark:text-gray-400"},pe=["onClick"],be={class:"text-xs text-gray-500 mt-1"},xe={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},he={class:"flex justify-end gap-3"},ke=["disabled"],we={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},Be={class:"flex items-center gap-4"},Ce={key:0,class:"text-center p-6"},Se={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},Me={key:2,class:"space-y-4"},Ae={class:"flex items-start gap-4"},Te=["title"],$e={class:"flex-grow"},De={class:"flex justify-between items-center"},Ve={class:"font-bold text-lg text-gray-900 dark:text-white"},Le={class:"flex gap-3"},Ne=["onClick"],Fe=["onClick"],qe={class:"text-sm text-gray-500 dark:text-gray-400"},je={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},Ee={key:0},Oe={class:"font-semibold capitalize"},Ue={key:0},ze={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},Ie=["onClick"],He={__name:"LLMBindingsSettings",setup(Ge){const u=G(),M=J(),{bindings:A,availableBindingTypes:x,isLoadingBindings:q,globalSettings:T}=H(u),f=_(!1),v=_(null),h=_(!1),m=_({}),$=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),n=_($()),k=w(()=>v.value!==null),y=w(()=>n.value.name?x.value.find(l=>l.binding_name===n.value.name):null),j=w(()=>!y.value||!y.value.input_parameters?[]:y.value.input_parameters.filter(l=>l.name!=="model_name"));K(()=>n.value.name,(l,s)=>{if(l!==s){const t=x.value.find(r=>r.binding_name===l),o={};t&&t.input_parameters&&t.input_parameters.forEach(r=>{o[r.name]=r.default}),n.value.config=o}});const D=w({get(){if(!Array.isArray(T.value))return"mixed";const l=T.value.find(s=>s.key==="model_display_mode");return l?l.value:"mixed"},set(l){u.updateGlobalSettings({model_display_mode:l})}});P(()=>{u.fetchBindings(),u.fetchAvailableBindingTypes(),u.fetchGlobalSettings()});function V(){v.value=null,n.value=$(),m.value={},f.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function E(l){v.value=l,n.value=JSON.parse(JSON.stringify(l)),n.value.config||(n.value.config={}),m.value={},f.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function L(){f.value=!1,v.value=null}async function O(){if(!n.value.alias.trim()||!n.value.name){M.addNotification("Alias and Binding Type are required fields.","warning");return}h.value=!0;try{const l={alias:n.value.alias,name:n.value.name,config:n.value.config||{},is_active:n.value.is_active,default_model_name:n.value.default_model_name||null};k.value?await u.updateBinding(v.value.id,l):await u.addBinding(l),L()}catch(l){console.error("Submit failed:",l.message)}finally{h.value=!1}}async function U(l){await M.showConfirmation({title:`Delete Binding '${l.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await u.deleteBinding(l.id)}function z(l){M.openModal("manageModels",{binding:l})}function I(l){const s=x.value.find(t=>t.binding_name===l);return s?s.title:l}return(l,s)=>(a(),i("div",te,[f.value?(a(),i("div",se,[e("h3",ne,d(k.value?"Edit Binding":"Add New Binding"),1),e("form",{onSubmit:Y(O,["prevent"]),class:"space-y-6"},[e("div",le,[e("div",null,[s[4]||(s[4]=e("label",{for:"alias",class:"block text-sm font-medium"},[g("Alias "),e("span",{class:"text-red-500"},"*")],-1)),B(e("input",{type:"text",id:"alias","onUpdate:modelValue":s[0]||(s[0]=t=>n.value.alias=t),class:"input-field mt-1",required:"",placeholder:"e.g., local_ollama"},null,512),[[R,n.value.alias]]),s[5]||(s[5]=e("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),e("div",null,[s[7]||(s[7]=e("label",{for:"name",class:"block text-sm font-medium"},[g("Binding Type "),e("span",{class:"text-red-500"},"*")],-1)),B(e("select",{id:"name","onUpdate:modelValue":s[1]||(s[1]=t=>n.value.name=t),class:"input-field mt-1",required:"",disabled:k.value},[s[6]||(s[6]=e("option",{disabled:"",value:""},"Select a type",-1)),(a(!0),i(p,null,C(S(x),t=>(a(),i("option",{key:t.binding_name,value:t.binding_name},d(t.title),9,ie))),128))],8,ae),[[N,n.value.name]])])]),y.value?(a(),i("div",oe,[e("p",de,d(y.value.description),1),(a(!0),i(p,null,C(j.value,t=>(a(),i("div",{key:t.name,class:"space-y-1"},[e("label",{for:`param-${t.name}`,class:"block text-sm font-medium capitalize"},[g(d(t.name.replace(/_/g," "))+" ",1),t.mandatory?(a(),i("span",ue,"*")):c("",!0)],8,re),["str","int","float"].includes(t.type)?(a(),i("div",ce,[e("div",me,[B(e("input",{type:(t.name.includes("key")||t.name.includes("token"))&&!m.value[t.name]?"password":"text",id:`param-${t.name}`,"onUpdate:modelValue":o=>n.value.config[t.name]=o,class:"input-field",required:t.mandatory,placeholder:t.description,autocomplete:"off"},null,8,fe),[[Q,n.value.config[t.name]]]),t.name.includes("key")||t.name.includes("token")?(a(),i("button",{key:0,type:"button",onClick:o=>m.value[t.name]=!m.value[t.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:m.value[t.name]?"Hide":"Show"},[m.value[t.name]?(a(),F(W,{key:0,class:"w-5 h-5"})):(a(),F(X,{key:1,class:"w-5 h-5"}))],8,ge)):c("",!0)])])):t.type==="bool"?(a(),i("div",ve,[e("span",ye,[e("span",_e,d(t.description),1)]),e("button",{onClick:o=>n.value.config[t.name]=!n.value.config[t.name],type:"button",class:b([n.value.config[t.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:b([n.value.config[t.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,pe)])):c("",!0),e("p",be,d(t.description),1)]))),128))])):c("",!0),e("div",xe,[s[8]||(s[8]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, users cannot see or use models from this binding.")],-1)),e("button",{onClick:s[2]||(s[2]=t=>n.value.is_active=!n.value.is_active),type:"button",class:b([n.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:b([n.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),e("div",he,[e("button",{type:"button",onClick:L,class:"btn btn-secondary"},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:h.value},d(h.value?"Saving...":k.value?"Save Changes":"Add Binding"),9,ke)])],32)])):c("",!0),e("div",null,[e("div",we,[s[11]||(s[11]=e("h2",{class:"text-2xl font-bold"},"LLM Bindings",-1)),e("div",Be,[e("div",null,[s[10]||(s[10]=e("label",{for:"model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),B(e("select",{id:"model-display-mode","onUpdate:modelValue":s[3]||(s[3]=t=>D.value=t),class:"input-field mt-1"},s[9]||(s[9]=[e("option",{value:"mixed"},"Mixed (Alias or Original)",-1),e("option",{value:"aliased"},"Aliased Only",-1),e("option",{value:"original"},"Original Names Only",-1)]),512),[[N,D.value]])]),f.value?c("",!0):(a(),i("button",{key:0,onClick:V,class:"btn btn-primary self-end"},"+ Add New Binding"))])]),S(q)?(a(),i("div",Ce,"Loading bindings...")):S(A).length===0&&!f.value?(a(),i("div",Se,[s[12]||(s[12]=e("p",null,"No LLM bindings configured yet.",-1)),e("button",{onClick:V,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(a(),i("div",Me,[(a(!0),i(p,null,C(S(A),t=>(a(),i("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[e("div",Ae,[e("span",{class:b(["mt-1 h-3 w-3 rounded-full flex-shrink-0",t.is_active?"bg-green-500":"bg-gray-400"]),title:t.is_active?"Active":"Inactive"},null,10,Te),e("div",$e,[e("div",De,[e("h4",Ve,d(t.alias),1),e("div",Le,[e("button",{onClick:o=>E(t),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,Ne),e("button",{onClick:o=>U(t),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,Fe)])]),e("p",qe,d(I(t.name)),1),e("div",je,[(a(!0),i(p,null,C(t.config,(o,r)=>(a(),i(p,{key:r},[o&&!(r.includes("key")||r.includes("token")||r==="model_name")?(a(),i("p",Ee,[e("span",Oe,d(r.replace(/_/g," "))+":",1),g(" "+d(o),1)])):c("",!0)],64))),128)),t.default_model_name?(a(),i("p",Ue,[s[13]||(s[13]=e("span",{class:"font-semibold"},"Default Model:",-1)),g(" "+d(t.default_model_name),1)])):c("",!0)])])]),e("div",ze,[e("button",{onClick:o=>z(t),class:"btn btn-secondary btn-sm flex items-center gap-2"},[Z(ee,{class:"w-4 h-4"}),s[14]||(s[14]=g(" Manage Models "))],8,Ie)])]))),128))]))])]))}};export{He as default};
