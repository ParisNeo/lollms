import{bK as Z,a as ee,s as te,r as u,c as x,o as le,w as N,d as a,f as i,g as e,x as f,h as w,j,v as D,e as T,bR as se,t as b,i as c,C as k,H as oe,Q as A,F as R,z as E,A as ne,a2 as ae,bS as ie,L as P,I as W}from"./index-DfcQWugT.js";const re={class:"space-y-12"},ce={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},de={key:0,class:"p-6 text-center text-gray-500"},ue={class:"mt-2 flex items-center gap-x-4"},ge=["src"],ve=["disabled"],me={class:"flex justify-end pt-4 border-t dark:border-gray-700"},fe=["disabled"],be={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},ye={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center flex-wrap gap-2"},pe={class:"flex gap-2"},_e={class:"p-6 grid grid-cols-1 lg:grid-cols-2 gap-8"},we={class:"flex justify-between items-center mb-2"},he={class:"flex items-center gap-2"},xe={class:"border rounded-lg overflow-hidden dark:border-gray-700 max-h-96 overflow-y-auto"},ke={key:0,class:"p-4 text-center text-gray-500"},Ce={key:1,class:"divide-y dark:divide-gray-700"},Fe=["onClick"],Se={class:"flex items-center gap-3"},Le=["title"],$e={class:"flex items-center gap-1 flex-shrink-0"},Ie=["onClick"],Me=["onClick"],Ne=["onClick"],je={class:"flex justify-between items-center mb-2"},De=["title"],Te=["disabled"],Ae={class:"border rounded-lg overflow-hidden dark:border-gray-700 max-h-96 overflow-y-auto"},Re={key:0,class:"p-4 text-center text-gray-500"},Ee={key:1,class:"p-4 text-center text-sm text-gray-500 italic"},Pe={key:2,class:"divide-y dark:divide-gray-700"},We=["title"],Ve={class:"flex items-center gap-1 flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"},Ue=["onClick"],Ge=["onClick"],Oe={key:0,class:"p-4 text-center text-sm text-gray-500 italic"},Je={__name:"WelcomeSettings",setup(ze){const o=Z(),g=ee(),{globalSettings:C,funFacts:V,funFactCategories:F,isLoadingFunFacts:U,isLoadingFunFactCategories:G}=te(o),n=u({welcome_text:"",welcome_slogan:"",welcome_logo_url:""}),y=u(!1),p=u(!1),v=u(!1),m=u(null),_=u(null);let h="{}";const r=u(null),S=x(()=>C.value.filter(l=>l.category==="Welcome Page")),L=x(()=>r.value?V.value.filter(l=>l.category.id===r.value):[]),$=x(()=>{if(!r.value)return"Select a Category";const l=F.value.find(t=>t.id===r.value);return l?l.name:"Select a Category"});le(()=>{o.fetchGlobalSettings(),o.fetchFunFacts(),o.fetchFunFactCategories()}),N(()=>C.value,O,{deep:!0,immediate:!0}),N(n,l=>{v.value=JSON.stringify(l)!==h},{deep:!0});function O(){if(S.value.length>0){const l=S.value.reduce((t,s)=>(t[s.key]=s.value,t),{});n.value.welcome_text=l.welcome_text||"",n.value.welcome_slogan=l.welcome_slogan||"",n.value.welcome_logo_url=l.welcome_logo_url||"",h=JSON.stringify(n.value),v.value=!1,_.value=null,m.value=null}}function z(l){const t=l.target.files[0];if(t&&t.type.startsWith("image/")){m.value=t;const s=new FileReader;s.onload=d=>{_.value=d.target.result},s.readAsDataURL(t),v.value=!0}}async function B(){p.value=!0;try{await o.removeWelcomeLogo()}finally{p.value=!1}}async function J(){y.value=!0;try{const l={welcome_text:n.value.welcome_text,welcome_slogan:n.value.welcome_slogan},t=[o.updateGlobalSettings(l)];m.value&&t.push(o.uploadWelcomeLogo(m.value)),await Promise.all(t),h=JSON.stringify(n.value),v.value=!1,m.value=null,_.value=null}finally{y.value=!1}}function I(l=null){g.openModal("funFactCategory",{category:l,onSave:o.fetchFunFactCategories})}function M(l=null){if(!r.value&&!l){g.addNotification("Please select a category first.","warning");return}g.openModal("funFact",{fact:l,preselectedCategoryId:r.value,onSave:o.fetchFunFacts})}async function H(l){await g.showConfirmation({title:"Delete Category and its Facts?",message:`This will permanently delete "${l.name}" and all facts inside it. This action cannot be undone.`,confirmText:"Delete All"})&&(await o.deleteFunFactCategory(l.id),r.value===l.id&&(r.value=null))}async function K(l){await g.showConfirmation({title:"Delete Fun Fact?",message:"Are you sure you want to delete this fact?",confirmText:"Delete"})&&await o.deleteFunFact(l.id)}async function Q(l){await o.exportCategory(l.id,l.name)}async function q(l){const t=l.target.files[0];t&&await o.importCategoryFromFile(t),l.target.value=""}async function X(){await o.exportFunFacts()}function Y(){g.openModal("generateFunFacts")}return(l,t)=>(i(),a("div",re,[e("div",ce,[t[9]||(t[9]=e("div",{class:"p-6 border-b dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold"},"Welcome Page Settings")],-1)),f(o).isLoadingSettings&&!Object.keys(n.value).length?(i(),a("div",de,"Loading settings...")):(i(),a("form",{key:1,onSubmit:w(J,["prevent"]),class:"p-6 space-y-6"},[e("div",null,[t[6]||(t[6]=e("label",{for:"welcome_text",class:"label"},"Main Welcome Text",-1)),j(e("input",{id:"welcome_text","onUpdate:modelValue":t[0]||(t[0]=s=>n.value.welcome_text=s),type:"text",class:"input-field mt-1"},null,512),[[D,n.value.welcome_text]])]),e("div",null,[t[7]||(t[7]=e("label",{for:"welcome_slogan",class:"label"},"Slogan",-1)),j(e("input",{id:"welcome_slogan","onUpdate:modelValue":t[1]||(t[1]=s=>n.value.welcome_slogan=s),type:"text",class:"input-field mt-1"},null,512),[[D,n.value.welcome_slogan]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"label"},"Custom Logo",-1)),e("div",ue,[e("img",{src:_.value||n.value.welcome_logo_url||f(se),alt:"Logo Preview",class:"h-16 w-16 object-contain rounded-md bg-gray-100 dark:bg-gray-700 p-1 border dark:border-gray-600"},null,8,ge),e("input",{type:"file",onChange:z,accept:"image/*",class:"hidden",ref:"logoInput"},null,544),e("button",{type:"button",onClick:t[2]||(t[2]=s=>l.$refs.logoInput.click()),class:"btn btn-secondary"},"Change"),n.value.welcome_logo_url?(i(),a("button",{key:0,type:"button",onClick:B,class:"btn btn-danger-outline",disabled:p.value},b(p.value?"Removing...":"Remove"),9,ve)):T("",!0)])]),e("div",me,[e("button",{type:"submit",class:"btn btn-primary",disabled:y.value||!v.value},b(y.value?"Saving...":"Save Settings"),9,fe)])],32))]),e("div",be,[e("div",ye,[t[10]||(t[10]=e("h3",{class:"text-xl font-semibold"},"Fun Facts Management",-1)),e("div",pe,[e("button",{onClick:t[3]||(t[3]=s=>l.$refs.importInput.click()),class:"btn btn-secondary btn-sm"},"Import Category"),e("input",{type:"file",ref:"importInput",onChange:q,accept:".json",class:"hidden"},null,544),e("button",{onClick:X,class:"btn btn-secondary btn-sm"},"Export All")])]),e("div",_e,[e("div",null,[e("div",we,[t[13]||(t[13]=e("h4",{class:"font-semibold"},"Categories",-1)),e("div",he,[e("button",{onClick:Y,class:"btn btn-secondary btn-sm"},[c(oe,{class:"w-4 h-4 mr-1"}),t[11]||(t[11]=k(" Generate with AI"))]),e("button",{onClick:t[4]||(t[4]=s=>I()),class:"btn btn-secondary btn-sm"},[c(A,{class:"w-4 h-4 mr-1"}),t[12]||(t[12]=k("New"))])])]),e("div",xe,[f(G)?(i(),a("div",ke,"Loading...")):(i(),a("ul",Ce,[(i(!0),a(R,null,E(f(F),s=>(i(),a("li",{key:s.id,onClick:d=>r.value=s.id,class:ne(["p-3 flex items-center justify-between cursor-pointer transition-colors",r.value===s.id?"bg-blue-100 dark:bg-blue-900/50":"hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[e("div",Se,[e("span",{class:"w-5 h-5 rounded-full flex-shrink-0",style:ae({backgroundColor:s.color})},null,4),e("span",{class:"font-medium text-sm truncate",title:s.name},b(s.name),9,Le)]),e("div",$e,[e("button",{onClick:w(d=>Q(s),["stop"]),class:"btn-icon",title:"Export"},[c(ie,{class:"w-4 h-4"})],8,Ie),e("button",{onClick:w(d=>I(s),["stop"]),class:"btn-icon",title:"Edit"},[c(P,{class:"w-4 h-4"})],8,Me),e("button",{onClick:w(d=>H(s),["stop"]),class:"btn-icon-danger",title:"Delete"},[c(W,{class:"w-4 h-4"})],8,Ne)])],10,Fe))),128))]))])]),e("div",null,[e("div",je,[e("h4",{class:"font-semibold truncate pr-2",title:$.value},b($.value),9,De),e("button",{onClick:t[5]||(t[5]=s=>M()),disabled:!r.value,class:"btn btn-secondary btn-sm"},[c(A,{class:"w-4 h-4 mr-1"}),t[14]||(t[14]=k("New"))],8,Te)]),e("div",Ae,[f(U)?(i(),a("div",Re,"Loading...")):r.value?(i(),a("ul",Pe,[(i(!0),a(R,null,E(L.value,s=>(i(),a("li",{key:s.id,class:"p-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 group"},[e("p",{class:"text-sm flex-grow pr-2",title:s.content},b(s.content),9,We),e("div",Ve,[e("button",{onClick:d=>M(s),class:"btn-icon",title:"Edit"},[c(P,{class:"w-4 h-4"})],8,Ue),e("button",{onClick:d=>K(s),class:"btn-icon-danger",title:"Delete"},[c(W,{class:"w-4 h-4"})],8,Ge)])]))),128)),r.value&&L.value.length===0?(i(),a("li",Oe,"No facts in this category yet.")):T("",!0)])):(i(),a("div",Ee,"Select a category to view its facts."))])])])])]))}};export{Je as default};
