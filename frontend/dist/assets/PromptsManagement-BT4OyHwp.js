import{a2 as Se,a5 as Ce,aj as Ae,m as $e,aw as Ie,a6 as j,f as o,c as _,ae as N,a7 as Me,ax as Re,ay as Te,a as n,o as l,e as a,j as p,h as v,a4 as C,q as K,az as Ne,a8 as g,F as h,i as A,t as f,an as Ue,s as Q,g as k,v as $,af as Ze,b as De,ak as X,w as E,ad as Y,ai as Ve,aA as Le}from"./index-D7WRMwdF.js";import je from"./IconArrowUpCircle-BNZNXUY6.js";import{A as Ee,a as Fe}from"./AppCardSkeleton-BdN4ZCsC.js";const qe={class:"space-y-6"},ze={class:"border-b border-gray-200 dark:border-gray-700"},Be={class:"-mb-px flex space-x-6","aria-label":"Sub Tabs"},Oe={key:0},Ge={class:"flex justify-between items-center mb-4"},He={class:"flex items-center gap-2"},Je={key:0,class:"text-center p-4"},We={key:1,class:"empty-state-card"},Ke={key:2,class:"space-y-3"},Qe={class:"flex items-center gap-3 flex-grow truncate"},Xe=["src"],Ye={class:"flex-grow truncate"},et={class:"font-medium truncate"},tt={key:0,class:"text-xs text-gray-500 flex items-center gap-2"},st={key:0,class:"text-yellow-600 dark:text-yellow-400 font-semibold"},at={class:"flex items-center gap-x-2 flex-shrink-0"},lt=["onClick"],nt=["onClick"],ot=["onClick"],it={key:1},rt={class:"space-y-4"},dt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ut=["value"],ct={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},mt={key:1,class:"empty-state-card"},pt={key:2},vt={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},ft={class:"mt-6 flex justify-between items-center"},yt={class:"text-sm text-gray-500"},bt={class:"flex gap-2"},gt=["disabled"],_t=["disabled"],ht={key:2},kt={class:"flex justify-between items-center mb-4"},wt={class:"flex items-center gap-2"},xt=["disabled"],Pt={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},St=["disabled"],Ct={key:0,class:"text-center p-4"},At={key:1,class:"empty-state-card"},$t={key:2,class:"space-y-4"},It={class:"flex-grow truncate"},Mt={class:"font-semibold"},Rt={class:"text-sm text-gray-500 font-mono truncate"},Tt={class:"text-xs text-gray-400 mt-1"},Nt={class:"flex items-center gap-x-2"},Ut=["onClick","disabled"],Zt=["onClick","disabled"],Dt={__name:"PromptsManagement",setup(Vt){const i=Ce(),ee=Ae(),r=$e(),F=Ie(),{on:te,off:se}=Re(),{promptZooRepositories:q,isLoadingPromptZooRepositories:ae,zooPrompts:w,isLoadingZooPrompts:le}=j(i),{systemPrompts:I,isLoading:ne}=j(F),{tasks:oe}=j(ee),d=o("installed"),y=o({name:"",url:""}),x=o(!1),c=o(null),M=o(!1),R=o(""),P=o("All"),U=o("All"),z=o("last_update_date"),B=o("desc"),S=o(JSON.parse(localStorage.getItem("starredPrompts")||"[]")),m=o(1),Z=o(24);let O=null;const D=o(null),G=_(()=>w.value.total||0),ie=_(()=>w.value.pages||1),re=_(()=>{const s=(m.value-1)*Z.value+1,e=Math.min(m.value*Z.value,G.value);return`Showing ${s}-${e} of ${G.value}`});async function T(){const s={page:m.value,page_size:Z.value,sort_by:z.value,sort_order:B.value,category:P.value!=="All"?P.value:void 0,search_query:R.value||void 0,installation_status:U.value!=="All"?U.value:void 0};await i.fetchZooPrompts(s)}function de(){clearTimeout(O),O=setTimeout(()=>{m.value=1,T()},300)}N([z,B,P,U,d],()=>{d.value==="available"&&(m.value=1,T())}),N(R,de),N(m,T),N(S,s=>{localStorage.setItem("starredPrompts",JSON.stringify(s))},{deep:!0}),Me(()=>{F.fetchPrompts(),i.fetchPromptZooRepositories(),T(),te("task:completed",H)}),Te(()=>{se("task:completed",H)});const V=_(()=>{if(!Array.isArray(w.value.items))return[];const s=new Map;return oe.value.forEach(e=>{var t;if((t=e==null?void 0:e.name)!=null&&t.startsWith("Installing prompt: ")){const b=e.name.replace("Installing prompt: ","");s.set(b,e)}}),w.value.items.map(e=>({...e,task:s.get(e.folder_name)||null}))}),L=_(()=>Array.isArray(q.value)?[...q.value].sort((s,e)=>(s.name||"").localeCompare(e.name||"")):[]),ue=_(()=>w.value.categories||["All"]);function ce(s){return s?new Date(s).toLocaleString():"Never"}async function me(){if(!(!y.value.name||!y.value.url)){c.value="add";try{await i.addPromptZooRepository(y.value),y.value={name:"",url:""},x.value=!1}finally{c.value=null}}}async function pe(s){c.value=s.id;try{await i.pullPromptZooRepository(s.id)}finally{c.value=null}}async function ve(){M.value=!0;try{await i.pullAllPromptZooRepositories()}finally{M.value=!1}}async function fe(s){if(await r.showConfirmation({title:`Delete Repository '${s.name}'?`})){c.value=s.id;try{await i.deletePromptZooRepository(s.id)}finally{c.value=null}}}async function ye(s){await i.installZooPrompt({repository:s.repository,folder_name:s.folder_name})}async function be(s){const e=I.value.find(t=>t.name===s.name);if(!e){r.addNotification(`Cannot find installed prompt '${s.name}' to uninstall. Please refresh.`,"error");return}await r.showConfirmation({title:`Uninstall '${s.name}'?`,message:"This will remove the prompt from the system."})&&await i.deleteSystemPrompt(e.id)}async function ge(s){const e=await i.fetchPromptReadme(s.repository,s.folder_name);r.openModal("sourceViewer",{title:`README: ${s.name}`,content:e,language:"markdown"})}function _e(s){r.openModal("sourceViewer",{title:`Details: ${s.name}`,content:s.description||"No description available.",language:"text"})}function he(s){const e=S.value.indexOf(s);e>-1?S.value.splice(e,1):S.value.push(s)}const u=o(null);function ke(){u.value={name:"",content:"",category:"",author:"",description:"",icon:null},r.openModal("editSystemPrompt")}function we(){r.openModal("generatePrompt",{isSystemPrompt:!0,onTaskSubmitted:s=>{D.value=s}})}function H(s){s&&s.id===D.value&&(D.value=null,r.isModalOpen("tasksManager")&&r.closeModal("tasksManager"),s.status==="completed"&&s.result?J(s.result):r.addNotification("System prompt generation did not complete successfully.","warning"))}async function xe(s){await i.updateSystemPromptFromZoo(s.id)}function J(s){u.value={...s},r.openModal("editSystemPrompt")}async function W(){if(!u.value)return;const{id:s,...e}=u.value;try{s?await i.updateSystemPrompt(s,e):await i.createSystemPrompt(e),r.closeModal("editSystemPrompt")}catch{}}async function Pe(s){await r.showConfirmation({title:`Delete '${s.name}'?`})&&await i.deleteSystemPrompt(s.id)}return(s,e)=>(l(),n(h,null,[a("div",qe,[a("div",ze,[a("nav",Be,[a("button",{onClick:e[0]||(e[0]=t=>d.value="installed"),class:C(["tab-button",d.value==="installed"?"active":"inactive"])},"Installed",2),a("button",{onClick:e[1]||(e[1]=t=>d.value="available"),class:C(["tab-button",d.value==="available"?"active":"inactive"])},"Available from Zoo",2),a("button",{onClick:e[2]||(e[2]=t=>d.value="repositories"),class:C(["tab-button",d.value==="repositories"?"active":"inactive"])},"Repositories",2)])]),d.value==="installed"?(l(),n("section",Oe,[a("div",Ge,[e[14]||(e[14]=a("h3",{class:"text-xl font-semibold"},"Installed System Prompts",-1)),a("div",He,[a("button",{onClick:we,class:"btn btn-secondary"},[p(Ne,{class:"w-4 h-4 mr-2"}),e[13]||(e[13]=K(" Generate with AI "))]),a("button",{onClick:ke,class:"btn btn-primary"},"Add Prompt")])]),g(ne)?(l(),n("div",Je,"Loading...")):!g(I)||g(I).length===0?(l(),n("div",We,e[15]||(e[15]=[a("p",null,"No system prompts installed.",-1)]))):(l(),n("div",Ke,[(l(!0),n(h,null,A(g(I),t=>(l(),n("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm flex items-center justify-between gap-4"},[a("div",Qe,[t.icon?(l(),n("img",{key:0,src:t.icon,class:"h-8 w-8 rounded-md flex-shrink-0 object-cover",alt:"Icon"},null,8,Xe)):v("",!0),a("div",Ye,[a("p",et,f(t.name),1),t.version?(l(),n("div",tt,[a("span",null,"v"+f(t.version),1),t.update_available?(l(),n("span",st,"(repo: v"+f(t.repo_version)+")",1)):v("",!0)])):v("",!0)])]),a("div",at,[t.update_available?(l(),n("button",{key:0,onClick:b=>xe(t),class:"btn btn-warning btn-sm p-2",title:"Update"},[p(je,{class:"w-4 h-4"})],8,lt)):v("",!0),a("button",{onClick:b=>J(t),class:"btn btn-secondary btn-sm p-2",title:"Edit"},[p(Ue,{class:"w-4 h-4"})],8,nt),a("button",{onClick:b=>Pe(t),class:"btn btn-danger btn-sm p-2",title:"Delete"},[p(Q,{class:"w-4 h-4"})],8,ot)])]))),128))]))])):v("",!0),d.value==="available"?(l(),n("section",it,[a("div",rt,[a("div",dt,[k(a("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>R.value=t),placeholder:"Search Prompts...",class:"input-field"},null,512),[[$,R.value]]),k(a("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>P.value=t),class:"input-field"},[e[16]||(e[16]=a("option",{value:"All"},"All Categories",-1)),(l(!0),n(h,null,A(ue.value,t=>(l(),n("option",{key:t,value:t},f(t),9,ut))),128))],512),[[Ze,P.value]])]),g(le)?(l(),n("div",ct,[(l(),n(h,null,A(6,t=>p(Ee,{key:t})),64))])):!V.value||V.value.length===0?(l(),n("div",mt,e[17]||(e[17]=[a("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(l(),n("div",pt,[a("div",vt,[(l(!0),n(h,null,A(V.value,t=>(l(),De(Fe,{key:`${t.repository}/${t.folder_name}`,app:t,task:t.task,"is-starred":S.value.includes(t.name),"item-type-name":"Prompt",onStar:b=>he(t.name),onInstall:ye,onUninstall:be,onHelp:ge,onDetails:_e},null,8,["app","task","is-starred","onStar"]))),128))]),a("div",ft,[a("p",yt,f(re.value),1),a("div",bt,[a("button",{onClick:e[5]||(e[5]=t=>m.value--),disabled:m.value<=1,class:"btn btn-secondary"},"Prev",8,gt),a("button",{onClick:e[6]||(e[6]=t=>m.value++),disabled:m.value>=ie.value,class:"btn btn-secondary"},"Next",8,_t)])])]))])])):v("",!0),d.value==="repositories"?(l(),n("section",ht,[a("div",kt,[e[19]||(e[19]=a("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),a("div",wt,[a("button",{onClick:ve,class:"btn btn-secondary",disabled:M.value},[p(X,{class:C(["w-4 h-4",{"animate-spin":M.value}])},null,8,["class"]),e[18]||(e[18]=a("span",{class:"ml-2"},"Pull All",-1))],8,xt),a("button",{onClick:e[7]||(e[7]=t=>x.value=!x.value),class:"btn btn-primary"},f(x.value?"Cancel":"Add"),1)])]),p(Ve,{name:"form-fade"},{default:E(()=>[x.value?(l(),n("div",Pt,[a("form",{onSubmit:Y(me,["prevent"]),class:"flex gap-4"},[k(a("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>y.value.name=t),type:"text",placeholder:"Name",class:"input-field flex-1",required:""},null,512),[[$,y.value.name]]),k(a("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>y.value.url=t),type:"url",placeholder:"Git URL",class:"input-field flex-grow-[2]",required:""},null,512),[[$,y.value.url]]),a("button",{type:"submit",class:"btn btn-primary",disabled:c.value==="add"},"Add",8,St)],32)])):v("",!0)]),_:1}),g(ae)?(l(),n("div",Ct,"Loading...")):!L.value||L.value.length===0?(l(),n("div",At,e[20]||(e[20]=[a("p",null,"No repositories added.",-1)]))):(l(),n("div",$t,[(l(!0),n(h,null,A(L.value,t=>(l(),n("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between gap-4"},[a("div",It,[a("p",Mt,f(t.name),1),a("p",Rt,f(t.url),1),a("p",Tt,"Updated: "+f(ce(t.last_pulled_at)),1)]),a("div",Nt,[a("button",{onClick:b=>pe(t),class:"btn btn-secondary btn-sm",disabled:c.value===t.id},[p(X,{class:C(["w-4 h-4",{"animate-spin":c.value===t.id}])},null,8,["class"]),e[21]||(e[21]=K(" Pull"))],8,Ut),t.is_deletable?(l(),n("button",{key:0,onClick:b=>fe(t),class:"btn btn-danger btn-sm",disabled:c.value===t.id},[p(Q,{class:"w-4 h-4"})],8,Zt)):v("",!0)])]))),128))]))])):v("",!0)]),p(Le,{modalName:"editSystemPrompt",title:u.value&&u.value.id?"Edit System Prompt":"Add System Prompt"},{body:E(()=>[u.value?(l(),n("form",{key:0,onSubmit:Y(W,["prevent"]),class:"space-y-4"},[a("div",null,[e[22]||(e[22]=a("label",{for:"prompt-name",class:"block text-sm font-medium"},"Name",-1)),k(a("input",{id:"prompt-name","onUpdate:modelValue":e[10]||(e[10]=t=>u.value.name=t),type:"text",class:"input-field mt-1",required:""},null,512),[[$,u.value.name]])]),a("div",null,[e[23]||(e[23]=a("label",{for:"prompt-content",class:"block text-sm font-medium"},"Content",-1)),k(a("textarea",{id:"prompt-content","onUpdate:modelValue":e[11]||(e[11]=t=>u.value.content=t),rows:"10",class:"input-field mt-1"},null,512),[[$,u.value.content]])])],32)):v("",!0)]),footer:E(()=>[a("button",{onClick:e[12]||(e[12]=t=>g(r).closeModal("editSystemPrompt")),class:"btn btn-secondary"},"Cancel"),a("button",{onClick:W,class:"btn btn-primary"},"Save")]),_:1},8,["title"])],64))}},Ft=Se(Dt,[["__scopeId","data-v-5ef11cd4"]]);export{Ft as default};
