import{r as o,a as A,c7 as V,o as T,b as n,d as i,g as $,h as e,t as d,l as y,v as _,p as D,P as E,e as m,j as h,n as x,ce as M,k as U,F as j,m as I,c5 as L,a5 as B,W as f}from"./index-DnjdbnqE.js";const q={class:"space-y-6"},P={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},z={class:"text-xl font-semibold mb-4"},W={class:"flex items-center"},G={class:"flex justify-end gap-2"},H={type:"submit",class:"btn btn-primary"},J={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},K={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center"},O={class:"flex items-center gap-2"},Q=["disabled"],X={key:0,class:"p-6 text-center text-gray-500"},Y={key:1,class:"p-6 text-center text-gray-500"},Z={key:2,class:"divide-y dark:divide-gray-700"},ee={class:"font-semibold"},se={class:"text-sm text-gray-500 font-mono"},te={class:"flex gap-2 flex-shrink-0"},ae=["onClick"],le=["onClick"],oe={__name:"RssManagement",setup(ne){const p=o([]),b=o(!1),r=o(!1),c=o(!1),a=o({id:null,name:"",url:"",is_active:!0}),v=A(),k=V(),u=o(!1);async function g(){b.value=!0;try{const l=await f.get("/api/admin/rss-feeds");p.value=l.data}catch{v.addNotification("Failed to load RSS feeds.","error")}finally{b.value=!1}}function w(){c.value=!1,a.value={id:null,name:"",url:"",is_active:!0},r.value=!0}function S(l){c.value=!0,a.value={...l},r.value=!0}async function F(){try{c.value?(await f.put(`/api/admin/rss-feeds/${a.value.id}`,a.value),v.addNotification("Feed updated.","success")):(await f.post("/api/admin/rss-feeds",a.value),v.addNotification("Feed added.","success")),await g(),r.value=!1}catch{}}async function C(l){(await v.showConfirmation({title:`Delete Feed '${l.name}'?`,message:"This will also delete all news articles from this source. This action cannot be undone.",confirmText:"Delete"})).confirmed&&(await f.delete(`/api/admin/rss-feeds/${l.id}`),await g())}async function N(){u.value=!0;try{await k.triggerRssScraping()}finally{u.value=!1}}return T(g),(l,s)=>(i(),n("div",q,[r.value?(i(),n("div",P,[e("h3",z,d(c.value?"Edit RSS Feed":"Add New RSS Feed"),1),e("form",{onSubmit:E(F,["prevent"]),class:"space-y-4"},[e("div",null,[s[4]||(s[4]=e("label",{class:"label"},"Name",-1)),y(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>a.value.name=t),type:"text",class:"input-field",required:"",placeholder:"e.g., Tech News"},null,512),[[_,a.value.name]])]),e("div",null,[s[5]||(s[5]=e("label",{class:"label"},"URL",-1)),y(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.value.url=t),type:"url",class:"input-field",required:"",placeholder:"https://example.com/rss.xml"},null,512),[[_,a.value.url]])]),e("div",W,[y(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>a.value.is_active=t),type:"checkbox",id:"is_active_checkbox",class:"h-4 w-4 rounded"},null,512),[[D,a.value.is_active]]),s[6]||(s[6]=e("label",{for:"is_active_checkbox",class:"ml-2"},"Active",-1))]),e("div",G,[e("button",{type:"button",onClick:s[3]||(s[3]=t=>r.value=!1),class:"btn btn-secondary"},"Cancel"),e("button",H,d(c.value?"Save Changes":"Add Feed"),1)])],32)])):$("",!0),e("div",J,[e("div",K,[s[8]||(s[8]=e("h3",{class:"text-xl font-semibold"},"RSS Feed Sources",-1)),e("div",O,[e("button",{onClick:N,class:"btn btn-secondary btn-sm",disabled:u.value},[m(M,{class:x(["w-4 h-4 mr-1",{"animate-spin":u.value}])},null,8,["class"]),h(" "+d(u.value?"Scraping...":"Scrape Now"),1)],8,Q),e("button",{onClick:w,class:"btn btn-primary btn-sm"},[m(U,{class:"w-4 h-4 mr-1"}),s[7]||(s[7]=h("Add Feed"))])])]),b.value?(i(),n("div",X,"Loading feeds...")):p.value.length===0?(i(),n("div",Y,"No RSS feeds configured. Add one to get started.")):(i(),n("ul",Z,[(i(!0),n(j,null,I(p.value,t=>(i(),n("li",{key:t.id,class:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("div",null,[e("p",ee,[h(d(t.name)+" ",1),e("span",{class:x(["text-xs px-2 py-0.5 rounded-full ml-2",t.is_active?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300":"bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-300"])},d(t.is_active?"Active":"Inactive"),3)]),e("p",se,d(t.url),1)]),e("div",te,[e("button",{onClick:R=>S(t),class:"btn-icon",title:"Edit"},[m(L,{class:"w-4 h-4"})],8,ae),e("button",{onClick:R=>C(t),class:"btn-icon-danger",title:"Delete"},[m(B,{class:"w-4 h-4"})],8,le)])]))),128))]))])]))}};export{oe as default};
