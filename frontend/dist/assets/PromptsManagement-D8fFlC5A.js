import{B as be,ak as ge,ao as _e,a as ke,az as we,s as B,r as n,c as y,w as N,o as xe,D as F,b as o,e as a,f as t,h as b,d as g,A,i as m,v as C,y as q,F as _,z as R,t as v,l as E,x as W,ap as X,C as O,g as Y,T as he,H as Pe}from"./index-DzRMTtAM.js";import{A as Se,a as Ae}from"./AppCardSkeleton-7x3_Lq5_.js";import"./IconArrowUpCircle-D5FUiqCN.js";const Ce={class:"space-y-6"},Re={class:"border-b border-gray-200 dark:border-gray-700"},Ie={class:"-mb-px flex space-x-6","aria-label":"Sub Tabs"},$e={key:0},Te={key:1},Ue={class:"space-y-4"},Me={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ne={class:"relative lg:col-span-1"},Ve={class:"grid grid-cols-2 lg:col-span-2 gap-4"},Ze=["value"],De={class:"flex items-center gap-2"},Le=["value"],ze={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6"},je={key:1,class:"empty-state-card"},Be={key:2},Fe={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6"},qe={class:"mt-6 flex justify-between items-center"},Ee={class:"text-sm text-gray-500"},Oe={class:"flex gap-2"},He=["disabled"],Ge=["disabled"],Je={key:2},Ke={class:"flex justify-between items-center mb-4 flex-wrap gap-2"},Qe={class:"flex items-center gap-2"},We=["disabled"],Xe={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6 overflow-hidden"},Ye={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},et={class:"md:col-span-2"},tt={class:"flex justify-end"},st=["disabled"],lt={key:0,class:"text-center p-4"},at={key:1,class:"empty-state-card"},ot={key:2,class:"space-y-4"},nt={class:"flex-grow truncate"},it={class:"font-semibold"},rt={class:"text-sm text-gray-500 font-mono truncate"},dt={class:"text-xs text-gray-400 mt-1"},ut={class:"flex items-center gap-x-2 flex-shrink-0"},ct=["onClick","disabled"],pt=["onClick","disabled"],mt={__name:"PromptsManagement",setup(vt){const i=ge(),ee=_e(),V=ke(),Z=we(),{promptZooRepositories:H,isLoadingPromptZooRepositories:te,zooPrompts:I,isLoadingZooPrompts:se}=B(i),{systemPrompts:ft,isLoading:yt}=B(Z),{tasks:bt}=B(ee),u=n("installed"),c=n({name:"",url:""}),k=n(!1),r=n(null),$=n(!1),T=n(""),w=n("All"),x=n("All"),U=n("last_update_date"),h=n("desc"),P=n(JSON.parse(localStorage.getItem("starredPrompts")||"[]")),d=n(1),D=n(24);let G=null;const le=[{value:"last_update_date",label:"Last Updated"},{value:"creation_date",label:"Creation Date"},{value:"name",label:"Name"},{value:"author",label:"Author"}],J=y(()=>I.value.total||0),ae=y(()=>I.value.pages||1),oe=y(()=>{const l=(d.value-1)*D.value+1,e=Math.min(d.value*D.value,J.value);return`Showing ${l}-${e} of ${J.value}`});async function S(){const l={page:d.value,page_size:D.value,sort_by:U.value,sort_order:h.value,category:w.value!=="All"?w.value:void 0,search_query:T.value||void 0,installation_status:x.value!=="All"?x.value:void 0};await i.fetchZooPrompts(l)}function ne(){clearTimeout(G),G=setTimeout(()=>{d.value=1,S()},300)}N([U,h,w,x],()=>{d.value=1,S()}),N(T,ne),N(d,S),N(P,l=>{localStorage.setItem("starredPrompts",JSON.stringify(l))},{deep:!0}),xe(()=>{Z.fetchPrompts(),i.fetchPromptZooRepositories(),S()});const L=y(()=>{if(!Array.isArray(I.value.items))return[];let l=I.value.items;const e=new Map;return l.map(f=>({...f,task:e.get(f.folder_name)||null}))}),z=y(()=>Array.isArray(H.value)?[...H.value].sort((l,e)=>(l.name||"").localeCompare(e.name||"")):[]),ie=y(()=>["All",...i.zooPrompts.categories]);function re(l){const e=P.value.indexOf(l);e>-1?P.value.splice(e,1):P.value.push(l)}function de(l){return l?new Date(l).toLocaleString():"Never"}async function ue(){if(!c.value.name||!c.value.url){V.addNotification("Repository name and URL are required.","warning");return}r.value="add";try{await i.addPromptZooRepository(c.value.name,c.value.url),c.value={name:"",url:""},k.value=!1}finally{r.value=null}}async function ce(l){r.value=l.id;try{await i.pullPromptZooRepository(l.id)}finally{r.value=null}}async function pe(){$.value=!0;try{await i.pullAllPromptZooRepositories()}finally{$.value=!1}}async function me(l){if(await V.showConfirmation({title:`Delete Repository '${l.name}'?`,message:"This will remove the repository and its cached files.",confirmText:"Delete"})){r.value=l.id;try{await i.deletePromptZooRepository(l.id)}finally{r.value=null}}}async function ve(l){try{await i.installZooPrompt({repository:l.repository,folder_name:l.folder_name}),await S(),await Z.fetchPrompts()}catch{}}async function fe(l){const e=await i.fetchPromptReadme(l.repository,l.folder_name);V.openModal("sourceViewer",{title:`README: ${l.name}`,content:e,language:"markdown"})}const j=n(!1),p=n(null);async function K(){if(!p.value)return;const{id:l,name:e,content:f}=p.value;try{l?await i.updateSystemPrompt(l,{name:e,content:f}):await i.createSystemPrompt({name:e,content:f}),j.value=!1}catch{}}return(l,e)=>{const f=F("IconArrowUp"),Q=F("IconArrowDown"),ye=F("GenericModal");return a(),o(_,null,[t("div",Ce,[t("div",Re,[t("nav",Ie,[t("button",{onClick:e[0]||(e[0]=s=>u.value="installed"),class:A(["tab-button",u.value==="installed"?"active":"inactive"])},"Installed",2),t("button",{onClick:e[1]||(e[1]=s=>u.value="available"),class:A(["tab-button",u.value==="available"?"active":"inactive"])},"Available from Zoo",2),t("button",{onClick:e[2]||(e[2]=s=>u.value="repositories"),class:A(["tab-button",u.value==="repositories"?"active":"inactive"])},"Repositories",2)])]),u.value==="installed"?(a(),o("section",$e)):g("",!0),u.value==="available"?(a(),o("section",Te,[t("div",Ue,[t("div",Me,[t("div",Ne,[m(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>T.value=s),placeholder:"Search Prompts...",class:"input-field w-full pl-10"},null,512),[[C,T.value]]),e[17]||(e[17]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),t("div",Ve,[m(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),class:"input-field"},e[18]||(e[18]=[t("option",{value:"All"},"All Statuses",-1),t("option",{value:"Installed"},"Installed",-1),t("option",{value:"Uninstalled"},"Uninstalled",-1)]),512),[[q,x.value]]),m(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>w.value=s),class:"input-field"},[(a(!0),o(_,null,R(ie.value,s=>(a(),o("option",{key:s,value:s},v(s),9,Ze))),128))],512),[[q,w.value]])])]),t("div",De,[m(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>U.value=s),class:"input-field w-48"},[(a(),o(_,null,R(le,s=>t("option",{key:s.value,value:s.value},"Sort by "+v(s.label),9,Le)),64))],512),[[q,U.value]]),t("button",{onClick:e[7]||(e[7]=s=>h.value=h.value==="asc"?"desc":"asc"),class:"btn btn-secondary p-2"},[h.value==="asc"?(a(),E(f,{key:0,class:"w-5 h-5"})):(a(),E(Q,{key:1,class:"w-5 h-5"}))])]),W(se)?(a(),o("div",ze,[(a(),o(_,null,R(8,s=>b(Se,{key:s})),64))])):!L.value||L.value.length===0?(a(),o("div",je,e[19]||(e[19]=[t("h4",{class:"font-semibold"},"No Prompts Found",-1),t("p",{class:"text-sm"},"No prompts match your criteria. Add and pull a repository or adjust filters.",-1)]))):(a(),o("div",Be,[t("div",Fe,[(a(!0),o(_,null,R(L.value,s=>(a(),E(Ae,{key:`${s.repository}/${s.folder_name}`,app:s,task:s.task,"is-starred":P.value.includes(s.name),"item-type-name":"Prompt",onStar:M=>re(s.name),onInstall:M=>ve(s),onHelp:M=>fe(s)},null,8,["app","task","is-starred","onStar","onInstall","onHelp"]))),128))]),t("div",qe,[t("p",Ee,v(oe.value),1),t("div",Oe,[t("button",{onClick:e[8]||(e[8]=s=>d.value--),disabled:d.value<=1,class:"btn btn-secondary"},"Previous",8,He),t("button",{onClick:e[9]||(e[9]=s=>d.value++),disabled:d.value>=ae.value,class:"btn btn-secondary"},"Next",8,Ge)])])]))])])):g("",!0),u.value==="repositories"?(a(),o("section",Je,[t("div",Ke,[e[21]||(e[21]=t("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),t("div",Qe,[t("button",{onClick:pe,class:"btn btn-secondary",disabled:$.value},[b(X,{class:A(["w-4 h-4",{"animate-spin":$.value}])},null,8,["class"]),e[20]||(e[20]=t("span",{class:"ml-2"},"Pull All",-1))],8,We),t("button",{onClick:e[10]||(e[10]=s=>k.value=!k.value),class:"btn btn-primary"},v(k.value?"Cancel":"Add Repository"),1)])]),b(he,{name:"form-fade"},{default:O(()=>[k.value?(a(),o("div",Xe,[t("form",{onSubmit:Y(ue,["prevent"]),class:"space-y-4"},[t("div",Ye,[t("div",null,[e[22]||(e[22]=t("label",{for:"repo-name-prompt",class:"block text-sm font-medium"},"Name",-1)),m(t("input",{id:"repo-name-prompt","onUpdate:modelValue":e[11]||(e[11]=s=>c.value.name=s),type:"text",class:"input-field mt-1",required:""},null,512),[[C,c.value.name]])]),t("div",et,[e[23]||(e[23]=t("label",{for:"repo-url-prompt",class:"block text-sm font-medium"},"Git URL",-1)),m(t("input",{id:"repo-url-prompt","onUpdate:modelValue":e[12]||(e[12]=s=>c.value.url=s),type:"url",class:"input-field mt-1",required:""},null,512),[[C,c.value.url]])])]),t("div",tt,[t("button",{type:"submit",class:"btn btn-primary",disabled:r.value==="add"},v(r.value==="add"?"Adding...":"Add"),9,st)])],32)])):g("",!0)]),_:1}),W(te)?(a(),o("div",lt,"Loading...")):!z.value||z.value.length===0?(a(),o("div",at,e[24]||(e[24]=[t("p",null,"No repositories added.",-1)]))):(a(),o("div",ot,[(a(!0),o(_,null,R(z.value,s=>(a(),o("div",{key:s.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex flex-col md:flex-row md:items-center justify-between gap-4"},[t("div",nt,[t("p",it,v(s.name),1),t("p",rt,v(s.url),1),t("p",dt,"Last updated: "+v(de(s.last_pulled_at)),1)]),t("div",ut,[t("button",{onClick:M=>ce(s),class:"btn btn-secondary btn-sm",disabled:r.value===s.id},[b(X,{class:A(["w-4 h-4",{"animate-spin":r.value===s.id}])},null,8,["class"]),e[25]||(e[25]=t("span",{class:"ml-1"},"Pull",-1))],8,ct),s.is_deletable?(a(),o("button",{key:0,onClick:M=>me(s),class:"btn btn-danger btn-sm",disabled:r.value===s.id},[b(Pe,{class:"w-4 h-4"})],8,pt)):g("",!0)])]))),128))]))])):g("",!0)]),b(ye,{modalName:"editSystemPrompt",title:p.value&&p.value.id?"Edit System Prompt":"Add System Prompt",onClose:e[16]||(e[16]=s=>j.value=!1)},{body:O(()=>[p.value?(a(),o("form",{key:0,onSubmit:Y(K,["prevent"]),class:"space-y-4"},[t("div",null,[e[26]||(e[26]=t("label",{for:"prompt-name",class:"block text-sm font-medium"},"Name",-1)),m(t("input",{id:"prompt-name","onUpdate:modelValue":e[13]||(e[13]=s=>p.value.name=s),type:"text",class:"input-field mt-1",required:""},null,512),[[C,p.value.name]])]),t("div",null,[e[27]||(e[27]=t("label",{for:"prompt-content",class:"block text-sm font-medium"},"Content",-1)),m(t("textarea",{id:"prompt-content","onUpdate:modelValue":e[14]||(e[14]=s=>p.value.content=s),rows:"10",class:"input-field mt-1"},null,512),[[C,p.value.content]])])],32)):g("",!0)]),footer:O(()=>[t("button",{onClick:e[15]||(e[15]=s=>j.value=!1),class:"btn btn-secondary"},"Cancel"),t("button",{onClick:K,class:"btn btn-primary"},"Save")]),_:1},8,["title"])],64)}}},wt=be(mt,[["__scopeId","data-v-95e6fb86"]]);export{wt as default};
