import{W as L,G as J,s as P,r as f,k as h,w as I,o as K,c as i,b as l,d as g,g as e,t as r,h as k,J as w,j as Q,v as $,F as p,i as B,e as A,O as W,y as G,P as Z,Q as H,n as C,f as X,z as Y,Z as ee}from"./index-B7cXW6rX.js";const te={class:"space-y-8"},se={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},ae={class:"text-xl font-semibold mb-4"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le=["disabled"],ie=["value"],oe={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},de={class:"text-sm text-gray-600 dark:text-gray-400"},re=["for"],ue={key:0,class:"text-red-500"},ce={class:"relative"},me=["type","id","onUpdate:modelValue","required","placeholder"],ge=["onClick"],ve={class:"text-xs text-gray-500 mt-1"},fe={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},pe={class:"flex justify-end gap-3"},ye=["disabled"],_e={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},be={class:"flex items-center gap-4"},xe={key:0},he={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},ke={key:2,class:"space-y-4"},we={class:"flex items-start gap-4"},Be={class:"flex-grow"},Ae={class:"flex justify-between items-center"},Se={class:"font-bold text-lg"},Ce={class:"flex gap-3"},Me=["onClick"],Re=["onClick"],Te={class:"text-sm text-gray-500"},Ve={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},De={key:0},$e={class:"font-semibold capitalize"},Ge={key:0},Fe={key:1},Ne={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},Ee=["onClick"],ze={__name:"RAGBindingsSettings",setup(Oe){const u=L(),S=J(),{ragBindings:M,availableRagBindingTypes:y,isLoadingRagBindings:F,globalSettings:R}=P(u),c=f(!1),v=f(null),_=f(!1),m=f({}),T=()=>({id:null,alias:"",name:"",config:{},default_model_name:null,is_active:!0}),a=f(T()),b=h(()=>v.value!==null),x=h(()=>a.value.name?y.value.find(n=>n.name===a.value.name):null),N=h(()=>x.value?x.value.input_parameters||[]:[]),V=h({get(){if(!Array.isArray(R.value))return"mixed";const n=R.value.find(s=>s.key==="rag_model_display_mode");return n?n.value:"mixed"},set(n){u.updateGlobalSettings({rag_model_display_mode:n})}});I(()=>a.value.name,(n,s)=>{if(n!==s){const t=y.value.find(d=>d.name===n),o={};t&&t.input_parameters&&t.input_parameters.forEach(d=>{o[d.name]=d.default!==void 0?d.default:""}),a.value.config=o}}),K(()=>{u.fetchRagBindings(),u.fetchAvailableRagBindingTypes(),u.fetchGlobalSettings()});function E(){v.value=null,a.value=T(),m.value={},c.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function O(n){v.value=n,a.value=JSON.parse(JSON.stringify(n)),a.value.config||(a.value.config={}),m.value={},c.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function D(){c.value=!1,v.value=null}async function j(){if(!a.value.alias.trim()||!a.value.name){S.addNotification("Alias and Vectorizer Type are required.","warning");return}_.value=!0;try{const n={alias:a.value.alias,name:a.value.name,config:a.value.config||{},is_active:a.value.is_active,default_model_name:a.value.default_model_name||null};b.value?await u.updateRagBinding(v.value.id,n):await u.addRagBinding(n),D()}finally{_.value=!1}}async function z(n){await S.showConfirmation({title:`Delete RAG Binding '${n.alias}'?`,confirmText:"Delete"})&&await u.deleteRagBinding(n.id)}function U(n){const s=y.value.find(t=>t.name===n);return s?s.title:n}function q(n){S.openModal("manageModels",{binding:n,bindingType:"rag"})}return(n,s)=>(l(),i("div",te,[c.value?(l(),i("div",se,[e("h3",ae,r(b.value?"Edit RAG Binding":"Add New RAG Binding"),1),e("form",{onSubmit:X(j,["prevent"]),class:"space-y-6"},[e("div",ne,[e("div",null,[s[4]||(s[4]=e("label",{for:"alias",class:"block text-sm font-medium"},[w("Alias "),e("span",{class:"text-red-500"},"*")],-1)),k(e("input",{type:"text",id:"alias","onUpdate:modelValue":s[0]||(s[0]=t=>a.value.alias=t),class:"input-field mt-1",required:"",placeholder:"e.g., local_embeddings"},null,512),[[Q,a.value.alias]])]),e("div",null,[s[6]||(s[6]=e("label",{for:"name",class:"block text-sm font-medium"},[w("Vectorizer Type "),e("span",{class:"text-red-500"},"*")],-1)),k(e("select",{id:"name","onUpdate:modelValue":s[1]||(s[1]=t=>a.value.name=t),class:"input-field mt-1",required:"",disabled:b.value},[s[5]||(s[5]=e("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),i(p,null,B(A(y),t=>(l(),i("option",{key:t.name,value:t.name},r(t.title),9,ie))),128))],8,le),[[$,a.value.name]])])]),x.value?(l(),i("div",oe,[e("p",de,r(x.value.description),1),(l(!0),i(p,null,B(N.value,t=>(l(),i("div",{key:t.name,class:"space-y-1"},[e("label",{for:`param-${t.name}`,class:"block text-sm font-medium capitalize"},[w(r(t.name.replace(/_/g," "))+" ",1),t.mandatory?(l(),i("span",ue,"*")):g("",!0)],8,re),e("div",ce,[k(e("input",{type:(t.name.includes("key")||t.name.includes("token"))&&!m.value[t.name]?"password":"text",id:`param-${t.name}`,"onUpdate:modelValue":o=>a.value.config[t.name]=o,class:"input-field",required:t.mandatory,placeholder:t.default},null,8,me),[[W,a.value.config[t.name]]]),t.name.includes("key")||t.name.includes("token")?(l(),i("button",{key:0,type:"button",onClick:o=>m.value[t.name]=!m.value[t.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500"},[m.value[t.name]?(l(),G(Z,{key:0,class:"w-5 h-5"})):(l(),G(H,{key:1,class:"w-5 h-5"}))],8,ge)):g("",!0)]),e("p",ve,r(t.description),1)]))),128))])):g("",!0),e("div",fe,[s[7]||(s[7]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium"},"Active"),e("span",{class:"text-sm text-gray-500"},"Enable this binding for use in Data Stores.")],-1)),e("button",{onClick:s[2]||(s[2]=t=>a.value.is_active=!a.value.is_active),type:"button",class:C([a.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:C([a.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),e("div",pe,[e("button",{type:"button",onClick:D,class:"btn btn-secondary"},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:_.value},r(_.value?"Saving...":b.value?"Save Changes":"Create Binding"),9,ye)])],32)])):g("",!0),e("div",null,[e("div",_e,[s[10]||(s[10]=e("h2",{class:"text-2xl font-bold"},"RAG Bindings",-1)),e("div",be,[e("div",null,[s[9]||(s[9]=e("label",{for:"rag-model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),k(e("select",{id:"rag-model-display-mode","onUpdate:modelValue":s[3]||(s[3]=t=>V.value=t),class:"input-field mt-1"},s[8]||(s[8]=[e("option",{value:"mixed"},"Mixed (Alias or Original)",-1),e("option",{value:"aliased"},"Aliased Only",-1),e("option",{value:"original"},"Original Names Only",-1)]),512),[[$,V.value]])]),c.value?g("",!0):(l(),i("button",{key:0,onClick:E,class:"btn btn-primary self-end"},"+ Add RAG Binding"))])]),A(F)?(l(),i("div",xe,"Loading...")):A(M).length===0&&!c.value?(l(),i("div",he,s[11]||(s[11]=[e("p",null,"No RAG bindings configured.",-1)]))):(l(),i("div",ke,[(l(!0),i(p,null,B(A(M),t=>(l(),i("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[e("div",we,[e("span",{class:C(["mt-1 h-3 w-3 rounded-full flex-shrink-0",t.is_active?"bg-green-500":"bg-gray-400"])},null,2),e("div",Be,[e("div",Ae,[e("h4",Se,r(t.alias),1),e("div",Ce,[e("button",{onClick:o=>O(t),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,Me),e("button",{onClick:o=>z(t),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,Re)])]),e("p",Te,r(U(t.name)),1),e("div",Ve,[(l(!0),i(p,null,B(t.config,(o,d)=>(l(),i(p,{key:d},[o?(l(),i("p",De,[e("span",$e,r(d.replace(/_/g," "))+":",1),d.includes("key")||d.includes("token")?(l(),i("span",Ge,"********")):(l(),i("span",Fe,r(o),1))])):g("",!0)],64))),128))])])]),e("div",Ne,[e("button",{onClick:o=>q(t),class:"btn btn-secondary btn-sm flex items-center gap-2"},[Y(ee,{class:"w-4 h-4"}),s[12]||(s[12]=w(" Manage Models "))],8,Ee)])]))),128))]))])]))}};export{ze as default};
