import{a2 as Ae,a5 as Re,aj as $e,m as Ie,ay as Me,a6 as F,f as r,c as h,ae as R,a7 as Ne,az as Ue,aA as Te,a as o,o as l,e as s,j as y,h as u,a4 as k,q as T,aB as Ve,a8 as x,F as w,i as $,t as c,am as Ze,s as Q,g as b,v as P,af as De,b as Le,ak as X,w as j,ad as Y,al as ee,ai as qe,aC as Fe}from"./index-DDbhq0Yj.js";import je from"./IconArrowUpCircle-6j9RmgYP.js";import{A as ze,a as Ee}from"./AppCardSkeleton-FkXhpgDs.js";import"./IconGlobeAlt-D-QC2vaS.js";import"./IconPlayCircle-rACS19Yc.js";const Be={class:"space-y-6"},Ge={class:"border-b border-gray-200 dark:border-gray-700"},Oe={class:"-mb-px flex space-x-6","aria-label":"Sub Tabs"},He={key:0},Je={class:"flex justify-between items-center mb-4"},We={class:"flex items-center gap-2"},Ke={key:0,class:"text-center p-4"},Qe={key:1,class:"empty-state-card"},Xe={key:2,class:"space-y-3"},Ye={class:"flex items-center gap-3 flex-grow truncate"},et=["src"],tt={class:"flex-grow truncate"},st={class:"font-medium truncate"},at={key:0,class:"text-xs text-gray-500 flex items-center gap-2"},lt={key:0,class:"text-yellow-600 dark:text-yellow-400 font-semibold"},ot={class:"flex items-center gap-x-2 flex-shrink-0"},nt=["onClick"],it=["onClick"],rt=["onClick"],dt={key:1},ut={class:"space-y-4"},ct={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},mt=["value"],pt={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},vt={key:1,class:"empty-state-card"},ft={key:2},yt={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},bt={class:"mt-6 flex justify-between items-center"},gt={class:"text-sm text-gray-500"},_t={class:"flex gap-2"},ht=["disabled"],xt=["disabled"],kt={key:2},wt={class:"flex justify-between items-center mb-4"},Pt={class:"flex items-center gap-2"},St=["disabled"],Ct={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6 overflow-hidden"},At={class:"flex items-center gap-x-4 border-b pb-4 dark:border-gray-700"},Rt={class:"flex items-center gap-x-2 cursor-pointer text-sm font-medium"},$t={class:"flex items-center gap-x-2 cursor-pointer text-sm font-medium"},It={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Mt={key:0,class:"md:col-span-2"},Nt=["required"],Ut={key:1,class:"md:col-span-2"},Tt=["required"],Vt={class:"flex justify-end"},Zt=["disabled"],Dt={key:0,class:"text-center p-4"},Lt={key:1,class:"empty-state-card"},qt={key:2,class:"space-y-4"},Ft={class:"flex-grow truncate"},jt={class:"flex items-center gap-2"},zt={class:"font-semibold"},Et={class:"text-sm text-gray-500"},Bt=["title"],Gt={class:"text-xs text-gray-400 mt-1"},Ot={class:"flex items-center gap-x-2 flex-shrink-0"},Ht=["onClick","disabled"],Jt=["onClick","disabled"],Wt={__name:"PromptsManagement",setup(Kt){const d=Re(),te=$e(),i=Ie(),z=Me(),{on:se,off:ae}=Ue(),{promptZooRepositories:E,isLoadingPromptZooRepositories:le,zooPrompts:g,isLoadingZooPrompts:oe}=F(d),{systemPrompts:I,isLoading:ne}=F(z),{tasks:ie}=F(te),m=r("installed"),n=r({type:"git",name:"",url:"",path:""}),S=r(!1),v=r(null),M=r(!1),N=r(""),C=r("All"),V=r("All"),B=r("last_update_date"),G=r("desc"),A=r(JSON.parse(localStorage.getItem("starredPrompts")||"[]")),f=r(1),Z=r(24);let O=null;const D=r(null),H=h(()=>g.value.total||0),re=h(()=>g.value.pages||1),de=h(()=>{const a=(f.value-1)*Z.value+1,e=Math.min(f.value*Z.value,H.value);return`Showing ${a}-${e} of ${H.value}`}),ue=h(()=>g.value.items?g.value.items.reduce((a,e)=>(a[e.repository]=(a[e.repository]||0)+1,a),{}):{});async function U(){const a={page:f.value,page_size:Z.value,sort_by:B.value,sort_order:G.value,category:C.value!=="All"?C.value:void 0,search_query:N.value||void 0,installation_status:V.value!=="All"?V.value:void 0};await d.fetchZooPrompts(a)}function ce(){clearTimeout(O),O=setTimeout(()=>{f.value=1,U()},300)}R(()=>n.value.type,a=>{a==="git"?n.value.path="":n.value.url=""}),R([B,G,C,V,m],()=>{m.value==="available"&&(f.value=1,U())}),R(N,ce),R(f,U),R(A,a=>{localStorage.setItem("starredPrompts",JSON.stringify(a))},{deep:!0}),Ne(()=>{z.fetchPrompts(),d.fetchPromptZooRepositories(),U(),se("task:completed",J)}),Te(()=>{ae("task:completed",J)});const L=h(()=>{if(!Array.isArray(g.value.items))return[];const a=new Map;return ie.value.forEach(e=>{var t;if((t=e==null?void 0:e.name)!=null&&t.startsWith("Installing prompt: ")){const _=e.name.replace("Installing prompt: ","");a.set(_,e)}}),g.value.items.map(e=>({...e,task:a.get(e.folder_name)||null}))}),q=h(()=>Array.isArray(E.value)?[...E.value].sort((a,e)=>(a.name||"").localeCompare(e.name||"")):[]),me=h(()=>g.value.categories||["All"]);function pe(a){return a?new Date(a).toLocaleString():"Never"}async function ve(){if(!n.value.name){i.addNotification("Repository name is required.","warning");return}const a={name:n.value.name};if(n.value.type==="git"){if(!n.value.url){i.addNotification("Git URL is required.","warning");return}a.url=n.value.url}else{if(!n.value.path){i.addNotification("Local Folder Path is required.","warning");return}a.path=n.value.path}v.value="add";try{await d.addPromptZooRepository(a),n.value={type:"git",name:"",url:"",path:""},S.value=!1}finally{v.value=null}}async function fe(a){v.value=a.id;try{await d.pullPromptZooRepository(a.id)}finally{v.value=null}}async function ye(){M.value=!0;try{await d.pullAllPromptZooRepositories()}finally{M.value=!1}}async function be(a){if(await i.showConfirmation({title:`Delete Repository '${a.name}'?`})){v.value=a.id;try{await d.deletePromptZooRepository(a.id)}finally{v.value=null}}}async function ge(a){await d.installZooPrompt({repository:a.repository,folder_name:a.folder_name})}async function _e(a){const e=I.value.find(t=>t.name===a.name);if(!e){i.addNotification(`Cannot find installed prompt '${a.name}' to uninstall. Please refresh.`,"error");return}await i.showConfirmation({title:`Uninstall '${a.name}'?`,message:"This will remove the prompt from the system."})&&await d.deleteSystemPrompt(e.id)}async function he(a){const e=await d.fetchPromptReadme(a.repository,a.folder_name);i.openModal("sourceViewer",{title:`README: ${a.name}`,content:e,language:"markdown"})}function xe(a){i.openModal("sourceViewer",{title:`Details: ${a.name}`,content:a.description||"No description available.",language:"text"})}function ke(a){const e=A.value.indexOf(a);e>-1?A.value.splice(e,1):A.value.push(a)}const p=r(null);function we(){p.value={name:"",content:"",category:"",author:"",description:"",icon:null},i.openModal("editSystemPrompt")}function Pe(){i.openModal("generatePrompt",{isSystemPrompt:!0,onTaskSubmitted:a=>{D.value=a}})}function J(a){a&&a.id===D.value&&(D.value=null,i.isModalOpen("tasksManager")&&i.closeModal("tasksManager"),a.status==="completed"&&a.result?W(a.result):i.addNotification("System prompt generation did not complete successfully.","warning"))}async function Se(a){await d.updateSystemPromptFromZoo(a.id)}function W(a){p.value={...a},i.openModal("editSystemPrompt")}async function K(){if(!p.value)return;const{id:a,...e}=p.value;try{a?await d.updateSystemPrompt(a,e):await d.createSystemPrompt(e),i.closeModal("editSystemPrompt")}catch{}}async function Ce(a){await i.showConfirmation({title:`Delete '${a.name}'?`})&&await d.deleteSystemPrompt(a.id)}return(a,e)=>(l(),o(w,null,[s("div",Be,[s("div",Ge,[s("nav",Oe,[s("button",{onClick:e[0]||(e[0]=t=>m.value="installed"),class:k(["tab-button",m.value==="installed"?"active":"inactive"])},"Installed",2),s("button",{onClick:e[1]||(e[1]=t=>m.value="available"),class:k(["tab-button",m.value==="available"?"active":"inactive"])},"Available from Zoo",2),s("button",{onClick:e[2]||(e[2]=t=>m.value="repositories"),class:k(["tab-button",m.value==="repositories"?"active":"inactive"])},"Repositories",2)])]),m.value==="installed"?(l(),o("section",He,[s("div",Je,[e[17]||(e[17]=s("h3",{class:"text-xl font-semibold"},"Installed System Prompts",-1)),s("div",We,[s("button",{onClick:Pe,class:"btn btn-secondary"},[y(Ve,{class:"w-4 h-4 mr-2"}),e[16]||(e[16]=T(" Generate with AI "))]),s("button",{onClick:we,class:"btn btn-primary"},"Add Prompt")])]),x(ne)?(l(),o("div",Ke,"Loading...")):!x(I)||x(I).length===0?(l(),o("div",Qe,e[18]||(e[18]=[s("p",null,"No system prompts installed.",-1)]))):(l(),o("div",Xe,[(l(!0),o(w,null,$(x(I),t=>(l(),o("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-3 rounded-lg shadow-sm flex items-center justify-between gap-4"},[s("div",Ye,[t.icon?(l(),o("img",{key:0,src:t.icon,class:"h-8 w-8 rounded-md flex-shrink-0 object-cover",alt:"Icon"},null,8,et)):u("",!0),s("div",tt,[s("p",st,c(t.name),1),t.version?(l(),o("div",at,[s("span",null,"v"+c(t.version),1),t.update_available?(l(),o("span",lt,"(repo: v"+c(t.repo_version)+")",1)):u("",!0)])):u("",!0)])]),s("div",ot,[t.update_available?(l(),o("button",{key:0,onClick:_=>Se(t),class:"btn btn-warning btn-sm p-2",title:"Update"},[y(je,{class:"w-4 h-4"})],8,nt)):u("",!0),s("button",{onClick:_=>W(t),class:"btn btn-secondary btn-sm p-2",title:"Edit"},[y(Ze,{class:"w-4 h-4"})],8,it),s("button",{onClick:_=>Ce(t),class:"btn btn-danger btn-sm p-2",title:"Delete"},[y(Q,{class:"w-4 h-4"})],8,rt)])]))),128))]))])):u("",!0),m.value==="available"?(l(),o("section",dt,[s("div",ut,[s("div",ct,[b(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>N.value=t),placeholder:"Search Prompts...",class:"input-field"},null,512),[[P,N.value]]),b(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>C.value=t),class:"input-field"},[e[19]||(e[19]=s("option",{value:"All"},"All Categories",-1)),(l(!0),o(w,null,$(me.value,t=>(l(),o("option",{key:t,value:t},c(t),9,mt))),128))],512),[[De,C.value]])]),x(oe)?(l(),o("div",pt,[(l(),o(w,null,$(6,t=>y(ze,{key:t})),64))])):!L.value||L.value.length===0?(l(),o("div",vt,e[20]||(e[20]=[s("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(l(),o("div",ft,[s("div",yt,[(l(!0),o(w,null,$(L.value,t=>(l(),Le(Ee,{key:`${t.repository}/${t.folder_name}`,app:t,task:t.task,"is-starred":A.value.includes(t.name),"item-type-name":"Prompt",onStar:_=>ke(t.name),onInstall:ge,onUninstall:_e,onHelp:he,onDetails:xe},null,8,["app","task","is-starred","onStar"]))),128))]),s("div",bt,[s("p",gt,c(de.value),1),s("div",_t,[s("button",{onClick:e[5]||(e[5]=t=>f.value--),disabled:f.value<=1,class:"btn btn-secondary"},"Prev",8,ht),s("button",{onClick:e[6]||(e[6]=t=>f.value++),disabled:f.value>=re.value,class:"btn btn-secondary"},"Next",8,xt)])])]))])])):u("",!0),m.value==="repositories"?(l(),o("section",kt,[s("div",wt,[e[22]||(e[22]=s("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),s("div",Pt,[s("button",{onClick:ye,class:"btn btn-secondary",disabled:M.value},[y(X,{class:k(["w-4 h-4",{"animate-spin":M.value}])},null,8,["class"]),e[21]||(e[21]=s("span",{class:"ml-2"},"Pull All",-1))],8,St),s("button",{onClick:e[7]||(e[7]=t=>S.value=!S.value),class:"btn btn-primary"},c(S.value?"Cancel":"Add"),1)])]),y(qe,{name:"form-fade"},{default:j(()=>[S.value?(l(),o("div",Ct,[s("form",{onSubmit:Y(ve,["prevent"]),class:"space-y-4"},[s("div",At,[s("label",Rt,[b(s("input",{type:"radio","onUpdate:modelValue":e[8]||(e[8]=t=>n.value.type=t),value:"git",class:"radio-input"},null,512),[[ee,n.value.type]]),e[23]||(e[23]=T(" Git Repository"))]),s("label",$t,[b(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>n.value.type=t),value:"local",class:"radio-input"},null,512),[[ee,n.value.type]]),e[24]||(e[24]=T(" Local Folder"))])]),s("div",It,[s("div",null,[e[25]||(e[25]=s("label",{for:"repo-name-prompt",class:"block text-sm font-medium mb-1"},"Name",-1)),b(s("input",{id:"repo-name-prompt","onUpdate:modelValue":e[10]||(e[10]=t=>n.value.name=t),type:"text",class:"input-field",placeholder:"e.g., Official Prompts Zoo",required:""},null,512),[[P,n.value.name]])]),n.value.type==="git"?(l(),o("div",Mt,[e[26]||(e[26]=s("label",{for:"repo-url-prompt",class:"block text-sm font-medium mb-1"},"Git URL",-1)),b(s("input",{id:"repo-url-prompt","onUpdate:modelValue":e[11]||(e[11]=t=>n.value.url=t),type:"url",class:"input-field",placeholder:"https://github.com/ParisNeo/lollms_prompts_zoo.git",required:n.value.type==="git"},null,8,Nt),[[P,n.value.url]])])):u("",!0),n.value.type==="local"?(l(),o("div",Ut,[e[27]||(e[27]=s("label",{for:"repo-path-prompt",class:"block text-sm font-medium mb-1"},"Full Folder Path",-1)),b(s("input",{id:"repo-path-prompt","onUpdate:modelValue":e[12]||(e[12]=t=>n.value.path=t),type:"text",class:"input-field",placeholder:"e.g., C:\\lollms-zoos\\my-prompts-zoo",required:n.value.type==="local"},null,8,Tt),[[P,n.value.path]])])):u("",!0)]),s("div",Vt,[s("button",{type:"submit",class:"btn btn-primary",disabled:v.value==="add"},"Add",8,Zt)])],32)])):u("",!0)]),_:1}),x(le)?(l(),o("div",Dt,"Loading...")):!q.value||q.value.length===0?(l(),o("div",Lt,e[28]||(e[28]=[s("p",null,"No repositories added.",-1)]))):(l(),o("div",qt,[(l(!0),o(w,null,$(q.value,t=>(l(),o("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex flex-col md:flex-row items-center justify-between gap-4"},[s("div",Ft,[s("div",jt,[s("span",{class:k(["px-2 py-0.5 text-xs font-semibold rounded-full",t.type==="git"?"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300":"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"])},c(t.type),3),s("p",zt,c(t.name),1),s("span",Et,"("+c(ue.value[t.name]||0)+" items)",1)]),s("p",{class:"text-sm text-gray-500 font-mono truncate mt-1",title:t.url},c(t.url),9,Bt),s("p",Gt,"Updated: "+c(pe(t.last_pulled_at)),1)]),s("div",Ot,[s("button",{onClick:_=>fe(t),class:"btn btn-secondary btn-sm",disabled:v.value===t.id},[y(X,{class:k(["w-4 h-4",{"animate-spin":v.value===t.id}])},null,8,["class"]),T(" "+c(t.type==="git"?"Pull":"Rescan"),1)],8,Ht),t.is_deletable?(l(),o("button",{key:0,onClick:_=>be(t),class:"btn btn-danger btn-sm",disabled:v.value===t.id},[y(Q,{class:"w-4 h-4"})],8,Jt)):u("",!0)])]))),128))]))])):u("",!0)]),y(Fe,{modalName:"editSystemPrompt",title:p.value&&p.value.id?"Edit System Prompt":"Add System Prompt"},{body:j(()=>[p.value?(l(),o("form",{key:0,onSubmit:Y(K,["prevent"]),class:"space-y-4"},[s("div",null,[e[29]||(e[29]=s("label",{for:"prompt-name",class:"block text-sm font-medium"},"Name",-1)),b(s("input",{id:"prompt-name","onUpdate:modelValue":e[13]||(e[13]=t=>p.value.name=t),type:"text",class:"input-field mt-1",required:""},null,512),[[P,p.value.name]])]),s("div",null,[e[30]||(e[30]=s("label",{for:"prompt-content",class:"block text-sm font-medium"},"Content",-1)),b(s("textarea",{id:"prompt-content","onUpdate:modelValue":e[14]||(e[14]=t=>p.value.content=t),rows:"10",class:"input-field mt-1"},null,512),[[P,p.value.content]])])],32)):u("",!0)]),footer:j(()=>[s("button",{onClick:e[15]||(e[15]=t=>x(i).closeModal("editSystemPrompt")),class:"btn btn-secondary"},"Cancel"),s("button",{onClick:K,class:"btn btn-primary"},"Save")]),_:1},8,["title"])],64))}},ss=Ae(Wt,[["__scopeId","data-v-e10b4a84"]]);export{ss as default};
