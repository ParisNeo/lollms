import{n as N,a as M,u as I,s as w,r as g,c as m,o as L,w as _,b as i,e as r,f as e,g as P,i as k,v as V,t as n,d as z,F as B,x as E,y as A,j as U,D as $,h as j,E as F,p as O}from"./index-D5GW3Kqg.js";const R={class:"space-y-10"},q={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},Y={key:0,class:"p-6 text-center"},G={key:1},H={class:"p-4 sm:p-6"},J={class:"flex-grow w-full"},Q=["disabled"],W={class:"border-t border-gray-200 dark:border-gray-700"},X={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},Z={key:1},ee={key:0,class:"px-4 sm:px-6 py-2 bg-blue-50 dark:bg-blue-900/20 flex items-center justify-between transition-all"},te={class:"flex items-center gap-4"},se={class:"text-sm font-semibold text-blue-800 dark:text-blue-200"},ae={role:"list",class:"divide-y divide-gray-200 dark:divide-gray-700"},le=["value"],oe={class:"flex-grow ml-2"},ie={class:"text-sm font-semibold text-gray-900 dark:text-white"},re={class:"text-sm text-gray-500 dark:text-gray-400 font-mono"},ne={class:"text-xs text-gray-500 dark:text-gray-400 text-right"},de=["onClick"],ye={__name:"ApiKeysSettings",setup(ce){const o=N(),d=M(),K=I(),{apiKeys:c}=w(o),{user:f}=w(K),u=g(""),y=g(!1),a=g(new Set),p=m(()=>f.value?f.value.openai_api_service_enabled:!1),h=m(()=>c.value.length>0),v=m({get:()=>h.value&&a.value.size===c.value.length,set:t=>{t?a.value=new Set(c.value.map(s=>s.id)):a.value.clear()}});L(()=>{p.value&&o.apiKeys.length===0&&o.fetchApiKeys()}),_(p,t=>{t&&o.apiKeys.length===0&&o.fetchApiKeys()}),_(c,()=>{a.value.clear()});function b(t){return t?new Date(t).toLocaleString():"Never"}async function S(){if(!u.value.trim()){d.addNotification("Please provide an alias for the new key.","warning");return}y.value=!0;try{const t=await o.addApiKey(u.value.trim());d.openModal("newApiKey",{keyData:t}),u.value=""}catch{}finally{y.value=!1}}async function D(t){await d.showConfirmation({title:`Delete key '${t.alias}'?`,message:"This will permanently revoke the key. This action cannot be undone.",confirmText:"Delete Key"})&&await o.deleteSingleApiKey(t.id)}async function T(){const t=Array.from(a.value);if(t.length===0){d.addNotification("No keys selected for deletion.","warning");return}await d.showConfirmation({title:`Delete ${t.length} API Key(s)?`,message:"This will permanently revoke the selected keys. This action cannot be undone.",confirmText:"Delete Selected"})&&await o.deleteMultipleApiKeys(t)}function C(){v.value=!v.value}return(t,s)=>(r(),i("div",R,[e("div",q,[s[5]||(s[5]=e("div",{class:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"API Keys"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"}," Manage your API keys for accessing the LoLLMs backend with OpenAI-compatible tools. ")],-1)),p.value?(r(),i("div",G,[e("div",H,[e("form",{onSubmit:P(S,["prevent"]),class:"flex flex-col sm:flex-row items-start sm:items-end gap-4"},[e("div",J,[s[3]||(s[3]=e("label",{for:"keyAlias",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Key Alias",-1)),k(e("input",{type:"text",id:"keyAlias","onUpdate:modelValue":s[0]||(s[0]=l=>u.value=l),class:"input-field mt-1",placeholder:"e.g., My Research Tool",required:""},null,512),[[V,u.value]])]),e("button",{type:"submit",class:"btn btn-primary w-full sm:w-auto",disabled:y.value},n(y.value?"Creating...":"Create New Key"),9,Q)],32)]),e("div",W,[h.value?(r(),i("div",Z,[a.value.size>0?(r(),i("div",ee,[e("div",te,[e("span",se,n(a.value.size)+" selected",1),e("button",{onClick:C,class:"text-sm font-medium text-blue-600 hover:underline"},n(v.value?"Deselect All":"Select All"),1)]),e("button",{onClick:T,class:"btn btn-danger btn-sm"}," Delete Selected ")])):z("",!0),e("ul",ae,[(r(!0),i(B,null,E(O(c),l=>(r(),i("li",{key:l.id,class:A(["px-4 py-4 sm:px-6 flex items-center gap-4 group transition-colors duration-150",{"bg-blue-50 dark:bg-blue-900/40":a.value.has(l.id)}])},[k(e("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":s[1]||(s[1]=x=>a.value=x),class:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,8,le),[[U,a.value]]),e("div",oe,[e("p",ie,n(l.alias),1),e("p",re,[$(n(l.key_prefix),1),s[4]||(s[4]=e("span",null,"...",-1))])]),e("div",ne,[e("p",null,"Last used: "+n(b(l.last_used_at)),1),e("p",null,"Created: "+n(b(l.created_at)),1)]),e("button",{onClick:x=>D(l),class:A(["p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-600 dark:hover:bg-red-900/50 dark:hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100":a.value.size>0}]),title:"Delete this key"},[j(F,{class:"h-5 w-5"})],10,de)],2))),128))])])):(r(),i("div",X," You have not created any API keys yet. "))])])):(r(),i("div",Y,s[2]||(s[2]=[e("div",{class:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-lg"},[e("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"}," The OpenAI-compatible API service is currently disabled by the administrator. ")],-1)])))])]))}};export{ye as default};
