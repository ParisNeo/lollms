import{r,b as n,e as l,f as e,d as M,t as g,x as Y,k as Z,a as G,u as J,s as A,o as K,l as Q,c as P,g as W,A as X,w as ee,h as _,v as F,i as te,T as ae,F as E,p as T,z as I}from"./index-kPhRu8Ig.js";const oe={class:"bg-white dark:bg-gray-800/80 shadow rounded-lg p-4 flex flex-col transition hover:shadow-md"},le={class:"flex-grow flex items-center gap-x-4"},se={class:"h-12 w-12 rounded-md flex-shrink-0 bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden"},ne=["src"],re={key:1,class:"w-7 h-7 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},ie={class:"truncate"},de={class:"font-semibold text-gray-900 dark:text-white truncate"},ue={class:"text-xs text-gray-500 dark:text-gray-400 font-mono truncate"},ce={key:0,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end items-center gap-x-3 text-sm"},L={__name:"McpCard",props:{mcp:{type:Object,required:!0},isEditable:{type:Boolean,default:!1}},emits:["edit","delete"],setup(u,{emit:i}){const d=u,y=i,p=r(!1);function h(){p.value=!0}function f(){y("edit",d.mcp)}function a(){y("delete",d.mcp)}return(c,m)=>(l(),n("div",oe,[e("div",le,[e("div",se,[u.mcp.icon&&!p.value?(l(),n("img",{key:0,src:u.mcp.icon,onError:h,alt:"Server Icon",class:"h-full w-full object-cover"},null,40,ne)):(l(),n("svg",re,m[0]||(m[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Z"},null,-1)])))]),e("div",ie,[e("p",de,g(u.mcp.name),1),e("p",ue,g(u.mcp.url),1)])]),u.isEditable?(l(),n("div",ce,[e("button",{onClick:f,class:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-500 dark:hover:text-blue-400"},"Edit"),e("button",{onClick:a,class:"font-medium text-red-600 hover:text-red-500 dark:text-red-500 dark:hover:text-red-400"},"Delete")])):M("",!0)]))}},me={class:"space-y-10"},ve={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},ge={class:"px-4 py-5 sm:p-6"},pe={class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},fe={class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},xe={class:"border-t border-gray-200 dark:border-gray-700"},ye={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},he={class:"mt-2 flex items-center gap-x-4"},ke={class:"h-16 w-16 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden"},be=["src"],we={key:1,class:"w-8 h-8 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},_e={class:"flex-grow space-y-2"},Me={class:"flex items-center gap-x-3"},Ce={class:"mt-1 relative"},Se=["type"],Pe={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},Fe={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},je={class:"flex justify-end items-center gap-x-3 pt-2"},Ue=["disabled"],$e={class:"flex justify-between items-center mb-4"},Ae={class:"flex items-center gap-x-3"},Ee=["disabled"],Te={key:0,class:"text-center py-10 px-4 rounded-lg bg-gray-50 dark:bg-gray-800/50"},Ie={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},Le={key:0,class:"text-center py-10 px-4 rounded-lg bg-gray-50 dark:bg-gray-800/50"},Ne={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},Re={__name:"MCPSettings",setup(u){const i=Z(),d=G(),y=J(),{userMcps:p}=A(i),{user:h}=A(y),f=()=>({name:"",url:"",icon:"",authentication_token:""}),a=r(f()),c=r(null),m=r(!1),k=r(!1),x=r(!1),j=r(null),C=r(!1),b=r(!1);K(()=>{i.fetchMcps()}),Q(()=>a.value.icon,()=>{C.value=!1});const v=P(()=>c.value!==null),U=P(()=>h.value?p.value.filter(o=>o.owner_username===h.value.username).sort((o,t)=>o.name.localeCompare(t.name)):[]),$=P(()=>p.value.filter(o=>o.owner_username===null).sort((o,t)=>o.name.localeCompare(t.name)));function N(){v.value&&w(),a.value=f(),b.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function R(o){c.value={...o},a.value.name=o.name,a.value.url=o.url,a.value.icon=o.icon||"",a.value.authentication_token=o.authentication_token||"",b.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function w(){c.value=null,a.value=f(),x.value=!1,b.value=!1}function D(){C.value=!0}async function B(){k.value=!0;try{await i.triggerMcpReload()}catch{}finally{k.value=!1}}async function V(){if(!a.value.name||!a.value.url){d.addNotification("Name and URL are required.","warning");return}m.value=!0;try{const o={name:a.value.name,url:a.value.url,icon:a.value.icon||null,authentication_token:a.value.authentication_token||null};v.value?await i.updateMcp(c.value.id,o):await i.addMcp(o),w()}catch{}finally{m.value=!1}}async function H(o){await d.showConfirmation({title:`Delete '${o.name}'?`,message:"Are you sure you want to remove this MCP server? This cannot be undone.",confirmText:"Delete"})&&(c.value&&c.value.id===o.id&&w(),await i.deleteMcp(o.id))}function z(){j.value.click()}function q(o){const t=o.target.files[0];if(!t)return;if(!["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"].includes(t.type)){d.addNotification("Invalid file type. Please select an image.","error");return}if(t.size>1*1024*1024){d.addNotification("File is too large. Maximum size is 1MB.","error");return}const S=new FileReader;S.onload=O=>{a.value.icon=O.target.result},S.onerror=()=>{d.addNotification("Failed to read the file.","error")},S.readAsDataURL(t),o.target.value=""}return(o,t)=>(l(),n("div",me,[W(ae,{name:"form-fade"},{default:X(()=>[b.value?(l(),n("div",ve,[e("div",ge,[e("h2",pe,g(v.value?"Edit Personal MCP Server":"Add Personal MCP Server"),1),e("p",fe,g(v.value?"Update the details for your existing MCP server.":"Add a new server to access more models and services."),1)]),e("div",xe,[e("form",{onSubmit:ee(V,["prevent"]),class:"p-4 sm:p-6 space-y-6"},[e("div",ye,[e("div",null,[t[8]||(t[8]=e("label",{for:"mcpName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),_(e("input",{type:"text",id:"mcpName","onUpdate:modelValue":t[0]||(t[0]=s=>a.value.name=s),class:"input-field mt-1",placeholder:"My Local Server",required:""},null,512),[[F,a.value.name]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"mcpUrl",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"URL",-1)),_(e("input",{type:"url",id:"mcpUrl","onUpdate:modelValue":t[1]||(t[1]=s=>a.value.url=s),class:"input-field mt-1",placeholder:"http://127.0.0.1:9602",required:""},null,512),[[F,a.value.url]])])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Icon (Optional)",-1)),e("div",he,[e("div",ke,[a.value.icon&&!C.value?(l(),n("img",{key:0,src:a.value.icon,onError:D,alt:"Icon Preview",class:"h-full w-full object-cover"},null,40,be)):v.value?(l(),n("svg",we,t[10]||(t[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Z"},null,-1)]))):M("",!0)]),e("div",_e,[_(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>a.value.icon=s),class:"input-field",placeholder:"Paste image URL or upload a file"},null,512),[[F,a.value.icon]]),e("div",Me,[e("button",{onClick:z,type:"button",class:"btn btn-secondary text-sm"},"Upload File"),a.value.icon?(l(),n("button",{key:0,onClick:t[3]||(t[3]=s=>a.value.icon=""),type:"button",class:"text-sm font-medium text-red-600 hover:text-red-500"},"Remove")):M("",!0)])])]),e("input",{type:"file",ref_key:"fileInput",ref:j,onChange:q,class:"hidden",accept:"image/png, image/jpeg, image/gif, image/webp, image/svg+xml"},null,544)]),e("div",null,[t[14]||(t[14]=e("label",{for:"mcpToken",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Authentication Token (Optional)",-1)),e("div",Ce,[_(e("input",{type:x.value?"text":"password",id:"mcpToken","onUpdate:modelValue":t[4]||(t[4]=s=>a.value.authentication_token=s),class:"input-field pr-10",placeholder:"Paste token here"},null,8,Se),[[te,a.value.authentication_token]]),e("button",{type:"button",onClick:t[5]||(t[5]=s=>x.value=!x.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[x.value?(l(),n("svg",Fe,t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"},null,-1)]))):(l(),n("svg",Pe,t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])))])])]),e("div",je,[e("button",{onClick:w,type:"button",class:"btn btn-secondary"},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:m.value},g(m.value?v.value?"Saving...":"Adding...":v.value?"Save Changes":"Add MCP Server"),9,Ue)])],32)])])):M("",!0)]),_:1}),e("section",null,[e("div",$e,[t[15]||(t[15]=e("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Your MCP Servers",-1)),e("div",Ae,[e("button",{onClick:t[6]||(t[6]=s=>N()),class:"btn btn-primary text-sm"}," + Add Server "),e("button",{onClick:t[7]||(t[7]=s=>B()),class:"btn btn-secondary text-sm",disabled:k.value},g(k.value?"Reloading...":"Reload Servers"),9,Ee)])]),U.value.length===0?(l(),n("div",Te,t[16]||(t[16]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"You haven't added any personal MCP servers yet.",-1),e("p",{class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},'Use the "Add Server" button to get started.',-1)]))):(l(),n("div",Ie,[(l(!0),n(E,null,T(U.value,s=>(l(),I(L,{key:s.id,mcp:s,"is-editable":"",onEdit:R,onDelete:H},null,8,["mcp"]))),128))]))]),e("section",null,[t[18]||(t[18]=e("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white mb-4"},"System MCP Servers",-1)),$.value.length===0?(l(),n("div",Le,t[17]||(t[17]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"No system-wide MCP servers are available.",-1)]))):(l(),n("div",Ne,[(l(!0),n(E,null,T($.value,s=>(l(),I(L,{key:s.id,mcp:s},null,8,["mcp"]))),128))]))])]))}},Be=Y(Re,[["__scopeId","data-v-7cb6d73a"]]);export{Be as default};
