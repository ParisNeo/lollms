import{_ as w,p as g,u as b,c as a,b as d,d as e,i as y,F as U,k as h,t as c,q as _,w as k,e as m,v as u,l as v,x as L,a as p,y as f}from"./index-D5hRrNn1.js";const N={name:"UserTable",props:{users:Array,isLoading:Boolean},emits:["delete-user","reset-password"],computed:{...g(b,{currentUserId:t=>t.user.id})}},P={class:"overflow-x-auto"},A={class:"min-w-full divide-y dark:divide-gray-600"},M={class:"bg-white dark:bg-gray-800 divide-y dark:divide-gray-700"},S={key:0},V={key:1},z={class:"px-4 py-2 text-xs font-mono"},C={class:"px-4 py-2 text-sm font-medium"},D={class:"px-4 py-2 text-sm"},I={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"},T={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-200"},F=["title"],R=["title"],q={class:"px-4 py-2 text-sm space-x-2 whitespace-nowrap"},B=["onClick","disabled"],E=["onClick","disabled"];function O(t,s,i,x,o,l){return d(),a("div",P,[e("table",A,[s[2]||(s[2]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"ID"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Username"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Admin"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"LLM Model"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Vectorizer"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Actions")])],-1)),e("tbody",M,[i.isLoading?(d(),a("tr",S,s[0]||(s[0]=[e("td",{colspan:"6",class:"px-4 py-4 text-center text-sm italic"},"Loading users...",-1)]))):i.users.length===0?(d(),a("tr",V,s[1]||(s[1]=[e("td",{colspan:"6",class:"px-4 py-4 text-center text-sm italic"},"No users found.",-1)]))):y("",!0),(d(!0),a(U,null,h(i.users,n=>(d(),a("tr",{key:n.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",z,c(n.id),1),e("td",C,c(n.username),1),e("td",D,[n.is_admin?(d(),a("span",I,"Yes")):(d(),a("span",T,"No"))]),e("td",{class:"px-4 py-2 text-xs truncate",title:n.lollms_model_name},c(n.lollms_model_name||"-"),9,F),e("td",{class:"px-4 py-2 text-xs truncate",title:n.safe_store_vectorizer},c(n.safe_store_vectorizer||"-"),9,R),e("td",q,[e("button",{onClick:r=>t.$emit("reset-password",n.id),disabled:n.id===t.currentUserId,class:"btn btn-secondary !py-1 !px-2 text-xs",title:"Reset Password"},"Reset Pass",8,B),e("button",{onClick:r=>t.$emit("delete-user",n.id),disabled:n.id===t.currentUserId,class:"btn btn-danger !py-1 !px-2 text-xs",title:"Delete User"},"Delete",8,E)])]))),128))])])])}const j=w(N,[["render",O]]),G={name:"AdminPanel",components:{UserTable:j},data(){return{users:[],isLoading:!1,newUser:{username:"",password:"",lollms_model_name:"",safe_store_vectorizer:"",is_admin:!1}}},created(){this.fetchUsers()},methods:{async fetchUsers(){this.isLoading=!0;try{const t=await f.get("/api/admin/users");this.users=t.data}catch{p().addNotification("Failed to load users.","error")}finally{this.isLoading=!1}},async addUser(){const t=p();if(!this.newUser.username||!this.newUser.password){t.addNotification("Username and password are required.","warning");return}try{await f.post("/api/admin/users",this.newUser),t.addNotification(`User '${this.newUser.username}' created successfully.`,"success"),this.resetNewUserForm(),await this.fetchUsers()}catch{}},async deleteUser(t){const s=p();if(confirm("Are you sure you want to delete this user? This cannot be undone."))try{await f.delete(`/api/admin/users/${t}`),s.addNotification("User deleted successfully.","success"),await this.fetchUsers()}catch{}},async resetPassword(t){const s=p(),i=prompt("Enter a new password for the user (min 8 characters):");if(!i||i.length<8){s.addNotification("Password reset cancelled or password too short.","warning");return}try{await f.post(`/api/admin/users/${t}/reset-password`,{new_password:i}),s.addNotification("User's password has been reset.","success")}catch{}},resetNewUserForm(){this.newUser={username:"",password:"",lollms_model_name:"",safe_store_vectorizer:"",is_admin:!1}}}},Y={class:"bg-gray-100 dark:bg-gray-700/50 p-4 rounded-lg shadow-sm mb-6"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H={class:"flex items-center"},J={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm"},K={class:"flex justify-between items-center mb-3 border-b dark:border-gray-600 pb-2"};function Q(t,s,i,x,o,l){const n=_("UserTable");return d(),a("div",null,[s[15]||(s[15]=e("h4",{class:"text-lg font-semibold mb-4"},"Administration",-1)),e("section",Y,[s[13]||(s[13]=e("h2",{class:"text-md font-semibold mb-3 border-b dark:border-gray-600 pb-2"},"Add New User",-1)),e("form",{onSubmit:s[5]||(s[5]=k((...r)=>l.addUser&&l.addUser(...r),["prevent"])),class:"space-y-4"},[e("div",$,[e("div",null,[s[7]||(s[7]=e("label",{for:"newUsername",class:"block text-sm font-medium"},"Username",-1)),m(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=r=>o.newUser.username=r),id:"newUsername",required:"",minlength:"3",class:"input-field mt-1"},null,512),[[u,o.newUser.username]])]),e("div",null,[s[8]||(s[8]=e("label",{for:"newPassword",class:"block text-sm font-medium"},"Password (min 8 chars)",-1)),m(e("input",{type:"password","onUpdate:modelValue":s[1]||(s[1]=r=>o.newUser.password=r),id:"newPassword",required:"",minlength:"8",class:"input-field mt-1"},null,512),[[u,o.newUser.password]])]),e("div",null,[s[9]||(s[9]=e("label",{for:"newLollmsModel",class:"block text-sm font-medium"},"Default LoLLMs Model (Optional)",-1)),m(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=r=>o.newUser.lollms_model_name=r),id:"newLollmsModel",class:"input-field mt-1",placeholder:"e.g., ollama/phi3:latest"},null,512),[[u,o.newUser.lollms_model_name]])]),e("div",null,[s[10]||(s[10]=e("label",{for:"newSafeStoreVectorizer",class:"block text-sm font-medium"},"Default Vectorizer (Optional)",-1)),m(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=r=>o.newUser.safe_store_vectorizer=r),id:"newSafeStoreVectorizer",class:"input-field mt-1",placeholder:"e.g., st:all-MiniLM-L6-v2"},null,512),[[u,o.newUser.safe_store_vectorizer]])])]),e("div",H,[m(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=r=>o.newUser.is_admin=r),id:"newUserIsAdmin",class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,512),[[v,o.newUser.is_admin]]),s[11]||(s[11]=e("label",{for:"newUserIsAdmin",class:"ml-2 block text-sm"},"Grant Administrator Privileges",-1))]),s[12]||(s[12]=e("div",{class:"text-right"},[e("button",{type:"submit",class:"btn btn-primary"},"Add User")],-1))],32)]),e("section",J,[e("div",K,[s[14]||(s[14]=e("h2",{class:"text-md font-semibold"},"Manage Existing Users",-1)),e("button",{onClick:s[6]||(s[6]=(...r)=>l.fetchUsers&&l.fetchUsers(...r)),class:"btn btn-secondary !py-1 !px-2 text-xs"},"Refresh List")]),L(n,{users:o.users,isLoading:o.isLoading,onDeleteUser:l.deleteUser,onResetPassword:l.resetPassword},null,8,["users","isLoading","onDeleteUser","onResetPassword"])])])}const X=w(G,[["render",Q]]);export{X as default};
