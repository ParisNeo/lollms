import{u as V,a as N,s as y,r as v,j as c,o as z,w as k,c as i,b as m,g as t,f as U,d as T,k as P,e as h,n as S,h as n,l as u,m as A}from"./index-DlqaeAlN.js";import{I as C}from"./IconSelectMenu-CrM2MwrF.js";const O={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},I={class:"border-t border-gray-200 dark:border-gray-700"},J={key:0,class:"p-4 bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 text-blue-800 dark:text-blue-200"},j=["disabled"],B={class:"flex h-6 items-center"},D=["disabled"],K={class:"flex justify-end pt-4"},R=["disabled"],F={key:0},E={key:1},H={__name:"LLMSettings",setup(G){const _=V(),p=N(),{user:s}=y(_),{availableLLMModelsGrouped:L,isLoadingLollmsModels:M}=y(p),l=v({lollms_model_name:"",llm_ctx_size:4096,llm_temperature:.7,llm_top_k:50,llm_top_p:.95,llm_repeat_penalty:1.1,llm_repeat_last_n:64,put_thoughts_in_context:!1}),d=v(!1),g=v(!1);let b={};const r=c(()=>{var o;return((o=s.value)==null?void 0:o.llm_settings_overridden)??!1}),f=c({get:()=>l.value.lollms_model_name,set:o=>{r.value||(l.value.lollms_model_name=o)}}),x=()=>{s.value&&(l.value={lollms_model_name:s.value.lollms_model_name||"",llm_ctx_size:s.value.llm_ctx_size??null,llm_temperature:s.value.llm_temperature??null,llm_top_k:s.value.llm_top_k??null,llm_top_p:s.value.llm_top_p??null,llm_repeat_penalty:s.value.llm_repeat_penalty??null,llm_repeat_last_n:s.value.llm_repeat_last_n??null,put_thoughts_in_context:s.value.put_thoughts_in_context||!1},b=JSON.parse(JSON.stringify(l.value)),g.value=!1)};z(()=>{p.availableLollmsModels.length===0&&p.fetchAvailableLollmsModels(),x()}),k(s,x,{deep:!0}),k(l,o=>{g.value=JSON.stringify(o)!==JSON.stringify(b)},{deep:!0});async function w(){d.value=!0;try{await _.updateUserPreferences(l.value)}catch{}finally{d.value=!1}}return(o,e)=>(m(),i("div",O,[e[17]||(e[17]=t("div",{class:"px-4 py-5 sm:p-6"},[t("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"LLM Configuration"),t("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"}," Adjust the default parameters for the Large Language Model. These settings will apply to new discussions. ")],-1)),t("div",I,[t("form",{onSubmit:U(w,["prevent"]),class:"p-4 sm:p-6 space-y-6"},[t("div",null,[e[8]||(e[8]=t("label",{for:"lollmsModelSelect",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Default LLM Model",-1)),P(C,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),items:h(L),"is-loading":h(M),placeholder:"Select a model",class:"mt-1"},null,8,["modelValue","items","is-loading"])]),r.value?(m(),i("div",J,e[9]||(e[9]=[t("p",{class:"font-semibold"},"Settings Overridden",-1),t("p",{class:"text-sm"},"An administrator has set and locked the generation parameters for this model. Your personal settings will not apply.",-1)]))):T("",!0),t("fieldset",{disabled:r.value,class:S(["grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",{"opacity-60 cursor-not-allowed":r.value}])},[t("div",null,[e[10]||(e[10]=t("label",{for:"contextSize",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Context Size (tokens)",-1)),n(t("input",{type:"number",id:"contextSize","onUpdate:modelValue":e[1]||(e[1]=a=>l.value.llm_ctx_size=a),class:"input-field mt-1",placeholder:"e.g., 4096"},null,512),[[u,l.value.llm_ctx_size,void 0,{number:!0}]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"temperature",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Temperature",-1)),n(t("input",{type:"number",id:"temperature","onUpdate:modelValue":e[2]||(e[2]=a=>l.value.llm_temperature=a),class:"input-field mt-1",step:"0.01",min:"0",max:"2",placeholder:"e.g., 0.7"},null,512),[[u,l.value.llm_temperature,void 0,{number:!0}]])]),t("div",null,[e[12]||(e[12]=t("label",{for:"topK",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Top K",-1)),n(t("input",{type:"number",id:"topK","onUpdate:modelValue":e[3]||(e[3]=a=>l.value.llm_top_k=a),class:"input-field mt-1",step:"1",min:"1",placeholder:"e.g., 50"},null,512),[[u,l.value.llm_top_k,void 0,{number:!0}]])]),t("div",null,[e[13]||(e[13]=t("label",{for:"topP",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Top P",-1)),n(t("input",{type:"number",id:"topP","onUpdate:modelValue":e[4]||(e[4]=a=>l.value.llm_top_p=a),class:"input-field mt-1",step:"0.01",min:"0",max:"1",placeholder:"e.g., 0.95"},null,512),[[u,l.value.llm_top_p,void 0,{number:!0}]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"repeatPenalty",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Repeat Penalty",-1)),n(t("input",{type:"number",id:"repeatPenalty","onUpdate:modelValue":e[5]||(e[5]=a=>l.value.llm_repeat_penalty=a),class:"input-field mt-1",step:"0.01",min:"0",placeholder:"e.g., 1.1"},null,512),[[u,l.value.llm_repeat_penalty,void 0,{number:!0}]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"repeatLastN",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Repeat Last N",-1)),n(t("input",{type:"number",id:"repeatLastN","onUpdate:modelValue":e[6]||(e[6]=a=>l.value.llm_repeat_last_n=a),class:"input-field mt-1",step:"1",min:"0",placeholder:"e.g., 64"},null,512),[[u,l.value.llm_repeat_last_n,void 0,{number:!0}]])])],10,j),t("div",{class:S(["relative flex items-start",{"opacity-60 cursor-not-allowed":r.value}])},[t("div",B,[n(t("input",{id:"putThoughts","onUpdate:modelValue":e[7]||(e[7]=a=>l.value.put_thoughts_in_context=a),type:"checkbox",disabled:r.value,class:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 text-blue-600 focus:ring-blue-600 dark:focus:ring-blue-600 dark:ring-offset-gray-800"},null,8,D),[[A,l.value.put_thoughts_in_context]])]),e[16]||(e[16]=t("div",{class:"ml-3 text-sm leading-6"},[t("label",{for:"putThoughts",class:"font-medium text-gray-900 dark:text-gray-300"},'Include "think" blocks in context'),t("p",{class:"text-gray-500 dark:text-gray-400"},"Allows the AI to see its previous reasoning steps.")],-1))],2),t("div",K,[t("button",{type:"submit",class:"btn btn-primary",disabled:d.value||!g.value||r.value},[d.value?(m(),i("span",F,"Saving...")):(m(),i("span",E,"Save LLM Settings"))],8,R)])],32)])]))}};export{H as default};
