import{c7 as R,a as Q,c1 as W,r as v,c as A,w as F,o as X,b as o,d as l,g as c,h as t,t as d,l as T,j as b,v as Y,c2 as N,F as g,m as x,i as S,$ as Z,q as j,b$ as ee,c0 as te,n as p,P as O,e as ne,H as se}from"./index-CFKpK6dV.js";const ae={class:"space-y-8"},ie={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},le={class:"text-xl font-semibold mb-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},de=["disabled"],re=["value"],ue={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},ce={class:"text-sm text-gray-600 dark:text-gray-400"},fe=["for"],me={key:0,class:"text-red-500"},ve=["id","onUpdate:modelValue"],ge=["value"],pe={key:1},ye={class:"relative"},_e=["type","id","onUpdate:modelValue","required","placeholder"],be=["onClick","title"],xe={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},he={class:"flex-grow flex flex-col pr-4"},ke={class:"text-sm text-gray-500 dark:text-gray-400"},we=["onClick"],Te={class:"text-xs text-gray-500 mt-1"},Se={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Be={class:"flex justify-end gap-3"},Ce=["disabled"],Ae={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},Me={class:"flex items-center gap-4"},$e=["value"],De={key:0,class:"text-center p-6"},Ve={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},Fe={key:2,class:"space-y-4"},Ne={class:"flex-grow"},je={class:"flex justify-between items-center"},Oe={class:"flex items-center gap-3"},qe={class:"font-bold text-lg text-gray-900 dark:text-white"},Ue=["onClick","title"],Ee={class:"flex gap-3"},Le=["onClick"],ze=["onClick"],Pe={class:"text-sm text-gray-500 dark:text-gray-400"},Ge={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},He={key:0},Ie={class:"font-semibold capitalize"},Je={key:0},Ke={key:1},Re={key:0},Qe={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},We=["onClick"],Ze={__name:"TTSBindingsSettings",setup(Xe){const u=R(),B=Q(),{ttsBindings:M,availableTtsBindingTypes:h,isLoadingTtsBindings:q,globalSettings:U}=W(u),m=v(!1),y=v(null),k=v(!1),f=v({}),C=v("mixed"),$=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),a=v($()),_=A(()=>y.value!==null),w=A(()=>a.value.name?h.value.find(s=>s.binding_name===a.value.name):null),E=A(()=>{if(!w.value)return[];const s=w.value.input_parameters||[],n=new Set(s.map(i=>i.name)),e=Object.keys(a.value.config||{}).filter(i=>!n.has(i)&&i!=="model_name").map(i=>({name:i,type:typeof a.value.config[i]=="boolean"?"bool":typeof a.value.config[i]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...s.filter(i=>i.name!=="model_name"),...e]});F(U,s=>{if(Array.isArray(s)){const n=s.find(e=>e.key==="tts_model_display_mode");n&&(C.value=n.value)}},{deep:!0,immediate:!0});function L(s){const n=s.target.value;C.value=n,u.updateGlobalSettings({tts_model_display_mode:n})}F(()=>a.value.name,(s,n)=>{if(s!==n&&!_.value){const e=h.value.find(r=>r.binding_name===s),i={};e&&e.input_parameters&&e.input_parameters.forEach(r=>{i[r.name]=r.default}),a.value.config=i}}),X(()=>{u.fetchTtsBindings(),u.fetchAvailableTtsBindingTypes(),u.fetchGlobalSettings()});function D(){y.value=null,a.value=$(),f.value={},m.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function z(s){y.value=s,a.value=JSON.parse(JSON.stringify(s)),a.value.config||(a.value.config={}),f.value={},m.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function V(){m.value=!1,y.value=null}function P(s){return typeof s=="string"?s.split(",").map(n=>n.trim()).filter(n=>n):Array.isArray(s)?s.filter(n=>n):[]}async function G(){if(!a.value.alias.trim()||!a.value.name){B.addNotification("Alias and Binding Type are required fields.","warning");return}k.value=!0;try{const s={alias:a.value.alias,name:a.value.name,config:a.value.config||{},is_active:a.value.is_active,default_model_name:a.value.default_model_name||null};_.value?await u.updateTtsBinding(y.value.id,s):await u.addTtsBinding(s),V()}catch(s){console.error("Submit failed:",s.message)}finally{k.value=!1}}async function H(s){await B.showConfirmation({title:`Delete TTS Binding '${s.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await u.deleteTtsBinding(s.id)}async function I(s){await u.updateTtsBinding(s.id,{is_active:!s.is_active})}function J(s){B.openModal("manageModels",{binding:s,bindingType:"tts"})}function K(s){const n=h.value.find(e=>e.binding_name===s);return n?n.title:s}return(s,n)=>(l(),o("div",ae,[m.value?(l(),o("div",ie,[t("h3",le,d(_.value?"Edit TTS Binding":"Add New TTS Binding"),1),t("form",{onSubmit:O(G,["prevent"]),class:"space-y-6"},[t("div",oe,[t("div",null,[n[3]||(n[3]=t("label",{for:"alias",class:"block text-sm font-medium"},[b("Alias "),t("span",{class:"text-red-500"},"*")],-1)),T(t("input",{type:"text",id:"alias","onUpdate:modelValue":n[0]||(n[0]=e=>a.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_xtts",autocomplete:"off"},null,512),[[Y,a.value.alias]]),n[4]||(n[4]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[n[6]||(n[6]=t("label",{for:"name",class:"block text-sm font-medium"},[b("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),T(t("select",{id:"name","onUpdate:modelValue":n[1]||(n[1]=e=>a.value.name=e),class:"input-field mt-1",required:"",disabled:_.value},[n[5]||(n[5]=t("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),o(g,null,x(S(h),e=>(l(),o("option",{key:e.binding_name,value:e.binding_name},d(e.title),9,re))),128))],8,de),[[N,a.value.name]])])]),w.value?(l(),o("div",ue,[t("p",ce,d(w.value.description),1),(l(!0),o(g,null,x(E.value,e=>(l(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[b(d(e.name.replace(/_/g," "))+" ",1),e.mandatory?(l(),o("span",me,"*")):c("",!0)],8,fe),e.options&&e.options.length>0?T((l(),o("select",{key:0,id:`param-${e.name}`,"onUpdate:modelValue":i=>a.value.config[e.name]=i,class:"input-field"},[(l(!0),o(g,null,x(P(e.options),i=>(l(),o("option",{key:i,value:i},d(i),9,ge))),128))],8,ve)),[[N,a.value.config[e.name]]]):["str","int","float"].includes(e.type)?(l(),o("div",pe,[t("div",ye,[T(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!f.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":i=>a.value.config[e.name]=i,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,_e),[[Z,a.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(l(),o("button",{key:0,type:"button",onClick:i=>f.value[e.name]=!f.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:f.value[e.name]?"Hide":"Show"},[f.value[e.name]?(l(),j(ee,{key:0,class:"w-5 h-5"})):(l(),j(te,{key:1,class:"w-5 h-5"}))],8,be)):c("",!0)])])):e.type==="bool"?(l(),o("div",xe,[t("span",he,[t("span",ke,d(e.description),1)]),t("button",{onClick:i=>a.value.config[e.name]=!a.value.config[e.name],type:"button",class:p([a.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:p([a.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,we)])):c("",!0),t("p",Te,d(e.description),1)]))),128))])):c("",!0),t("div",Se,[n[7]||(n[7]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this TTS service will not be available.")],-1)),t("button",{onClick:n[2]||(n[2]=e=>a.value.is_active=!a.value.is_active),type:"button",class:p([a.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:p([a.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",Be,[t("button",{type:"button",onClick:V,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:k.value},d(k.value?"Saving...":_.value?"Save Changes":"Add Binding"),9,Ce)])],32)])):c("",!0),t("div",null,[t("div",Ae,[n[10]||(n[10]=t("h2",{class:"text-2xl font-bold"},"TTS Bindings",-1)),t("div",Me,[t("div",null,[n[9]||(n[9]=t("label",{for:"tts-model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),t("select",{id:"tts-model-display-mode",value:C.value,onChange:L,class:"input-field mt-1"},n[8]||(n[8]=[t("option",{value:"mixed"},"Mixed (Alias or Original)",-1),t("option",{value:"aliased"},"Aliased Only",-1),t("option",{value:"original"},"Original Names Only",-1)]),40,$e)]),m.value?c("",!0):(l(),o("button",{key:0,onClick:D,class:"btn btn-primary self-end"},"+ Add New TTS Binding"))])]),S(q)?(l(),o("div",De,"Loading TTS bindings...")):S(M).length===0&&!m.value?(l(),o("div",Ve,[n[11]||(n[11]=t("p",null,"No TTS bindings configured yet.",-1)),t("button",{onClick:D,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(l(),o("div",Fe,[(l(!0),o(g,null,x(S(M),e=>(l(),o("div",{key:e.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[t("div",Ne,[t("div",je,[t("div",Oe,[t("h4",qe,d(e.alias),1),t("button",{onClick:O(i=>I(e),["stop"]),type:"button",class:p([e.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"]),title:e.is_active?"Deactivate":"Activate"},[t("span",{class:p([e.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],10,Ue)]),t("div",Ee,[t("button",{onClick:i=>z(e),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,Le),t("button",{onClick:i=>H(e),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,ze)])]),t("p",Pe,d(K(e.name)),1),t("div",Ge,[(l(!0),o(g,null,x(e.config,(i,r)=>(l(),o(g,{key:r},[i&&r!=="model_name"?(l(),o("p",He,[t("span",Ie,d(r.replace(/_/g," "))+":",1),r.includes("key")||r.includes("token")?(l(),o("span",Je,"********")):(l(),o("span",Ke,d(i),1))])):c("",!0)],64))),128)),e.default_model_name?(l(),o("p",Re,[n[12]||(n[12]=t("span",{class:"font-semibold"},"Default Model:",-1)),b(" "+d(e.default_model_name),1)])):c("",!0)])]),t("div",Qe,[t("button",{onClick:i=>J(e),class:"btn btn-secondary btn-sm flex items-center gap-2"},[ne(se,{class:"w-4 h-4"}),n[13]||(n[13]=b(" Manage Models "))],8,We)])]))),128))]))])]))}};export{Ze as default};
