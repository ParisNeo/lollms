import{u as S,a as j,c as B,r as o,o as V,b as p,d as D,e as c,f as e,w as C,g as I,_ as L,t as k,h as i,v as b,i as h,j as A}from"./index-Ds1RUQwJ.js";const F={key:0,class:"space-y-10"},z={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},E={class:"border-t border-gray-200 dark:border-gray-700 p-4 sm:p-6"},q={class:"flex-shrink-0 flex flex-col items-center space-y-2 w-full md:w-40"},$=["disabled"],G={class:"flex-grow space-y-6"},J={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},T={class:"flex justify-end"},W=["disabled"],H={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},K={class:"border-t border-gray-200 dark:border-gray-700"},O={class:"mt-1 relative"},Q=["type"],R={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},X={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},Y={class:"mt-1 relative"},Z=["type"],ee={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},te={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},ae={class:"mt-1 relative"},se=["type"],le={class:"flex justify-end"},oe=["disabled"],ie={__name:"AccountSettings",setup(re){const d=S(),u=j(),r=B(()=>d.user),s=o({first_name:"",family_name:"",email:"",birth_date:""}),f=o(!1),l=o({current_password:"",new_password:""}),v=o(""),w=o(!1),g=o(!1),m=o(!1),y=o(!1),x=o(null);V(()=>{r.value&&(s.value.first_name=r.value.first_name||"",s.value.family_name=r.value.family_name||"",s.value.email=r.value.email||"",s.value.birth_date=r.value.birth_date||"")});async function P(){f.value=!0;try{await d.updateUserProfile(s.value)}catch{}finally{f.value=!1}}async function N(){if(l.value.new_password!==v.value){u.addNotification("New passwords do not match.","error");return}if(l.value.new_password.length<8){u.addNotification("New password must be at least 8 characters long.","error");return}w.value=!0;try{await d.changePassword(l.value),l.value.current_password="",l.value.new_password="",v.value=""}catch{}finally{w.value=!1}}const M=()=>{var n;(n=x.value)==null||n.click()},U=async n=>{const t=n.target.files[0];if(!t)return;y.value=!0,u.addNotification("Uploading icon...","info");const a=new FormData;a.append("file",t);try{const _=await A.put("/api/auth/me/icon",a,{headers:{"Content-Type":"multipart/form-data"}});d.user&&(d.user.icon=_.data.icon_url),u.addNotification("Icon updated successfully!","success")}catch{u.addNotification("Icon upload failed.","error")}finally{y.value=!1,x.value&&(x.value.value="")}};return(n,t)=>r.value?(c(),p("div",F,[e("div",z,[t[14]||(t[14]=e("div",{class:"p-4 sm:p-6"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Profile"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},"Manage your public profile and personal information.")],-1)),e("div",E,[e("form",{onSubmit:C(P,["prevent"]),class:"flex flex-col md:flex-row gap-8"},[e("div",q,[I(L,{icon:r.value.icon,username:r.value.username,"size-class":"h-28 w-28"},null,8,["icon","username"]),e("input",{type:"file",ref_key:"fileInput",ref:x,onChange:U,accept:"image/png, image/jpeg, image/webp",class:"hidden"},null,544),e("button",{type:"button",onClick:M,disabled:y.value,class:"btn btn-secondary w-full"},k(y.value?"Uploading...":"Change Icon"),9,$),t[9]||(t[9]=e("p",{class:"text-xs text-center text-gray-500 dark:text-gray-400"},"Max 5MB (JPG, PNG, WEBP)",-1))]),e("div",G,[e("div",J,[e("div",null,[t[10]||(t[10]=e("label",{for:"firstName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"First Name",-1)),i(e("input",{type:"text",id:"firstName","onUpdate:modelValue":t[0]||(t[0]=a=>s.value.first_name=a),class:"input-field mt-1",placeholder:"Jane"},null,512),[[b,s.value.first_name]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"familyName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Family Name",-1)),i(e("input",{type:"text",id:"familyName","onUpdate:modelValue":t[1]||(t[1]=a=>s.value.family_name=a),class:"input-field mt-1",placeholder:"Doe"},null,512),[[b,s.value.family_name]])])]),e("div",null,[t[12]||(t[12]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email Address",-1)),i(e("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.email=a),class:"input-field mt-1",placeholder:"you@example.com"},null,512),[[b,s.value.email]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"birthDate",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Birth Date",-1)),i(e("input",{type:"date",id:"birthDate","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.birth_date=a),class:"input-field mt-1"},null,512),[[b,s.value.birth_date]])]),e("div",T,[e("button",{type:"submit",class:"btn btn-primary",disabled:f.value},k(f.value?"Saving...":"Save Profile"),9,W)])])],32)])]),e("div",H,[t[22]||(t[22]=e("div",{class:"px-4 py-5 sm:p-6"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Change Password"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},"Ensure your account is using a long, random password to stay secure.")],-1)),e("div",K,[e("form",{onSubmit:C(N,["prevent"]),class:"p-4 sm:p-6 space-y-6"},[e("div",null,[t[17]||(t[17]=e("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Current Password",-1)),e("div",O,[i(e("input",{type:g.value?"text":"password",id:"currentPassword","onUpdate:modelValue":t[4]||(t[4]=a=>l.value.current_password=a),required:"",class:"input-field pr-10",autocomplete:"current-password"},null,8,Q),[[h,l.value.current_password]]),e("button",{type:"button",onClick:t[5]||(t[5]=a=>g.value=!g.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[g.value?(c(),p("svg",X,t[16]||(t[16]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"},null,-1)]))):(c(),p("svg",R,t[15]||(t[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])))])])]),e("div",null,[t[20]||(t[20]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Password",-1)),e("div",Y,[i(e("input",{type:m.value?"text":"password",id:"newPassword","onUpdate:modelValue":t[6]||(t[6]=a=>l.value.new_password=a),required:"",minlength:"8",class:"input-field pr-10",autocomplete:"new-password"},null,8,Z),[[h,l.value.new_password]]),e("button",{type:"button",onClick:t[7]||(t[7]=a=>m.value=!m.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[m.value?(c(),p("svg",te,t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"},null,-1)]))):(c(),p("svg",ee,t[18]||(t[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])))])])]),e("div",null,[t[21]||(t[21]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Confirm New Password",-1)),e("div",ae,[i(e("input",{type:m.value?"text":"password",id:"confirmPassword","onUpdate:modelValue":t[8]||(t[8]=a=>v.value=a),required:"",class:"input-field pr-10",autocomplete:"new-password"},null,8,se),[[h,v.value]])])]),e("div",le,[e("button",{type:"submit",class:"btn btn-primary",disabled:w.value},k(w.value?"Changing...":"Change Password"),9,oe)])],32)])])])):D("",!0)}};export{ie as default};
