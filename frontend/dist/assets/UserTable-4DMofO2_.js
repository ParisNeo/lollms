import{z as T,D as N,a as B,s as E,r as f,c as V,b as l,e as r,f as t,i as j,v as z,p as R,E as w,d as h,t as i,F,x as H,y as _,m as b}from"./index-BxrZKWzz.js";const q={class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg overflow-hidden"},I={class:"px-4 py-5 sm:p-6 space-y-4"},P={class:"border-t border-gray-200 dark:border-gray-700"},Q={key:0,class:"p-6 text-center text-gray-500"},Y={key:1,class:"p-6 text-center text-gray-500"},K={key:2,class:"overflow-x-auto"},O={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Z={class:"bg-gray-50 dark:bg-gray-700/50"},G={scope:"col",class:"table-header"},J={key:0},W={scope:"col",class:"table-header"},X={key:0},ee={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},te={class:"table-cell"},se={class:"flex items-center"},ae={class:"ml-4"},oe={class:"text-sm font-medium text-gray-900 dark:text-white"},ne={class:"text-sm text-gray-500 dark:text-gray-400"},ie={class:"table-cell text-sm text-gray-500 dark:text-gray-400"},le={class:"table-cell text-sm text-gray-500 dark:text-gray-400"},re={class:"table-cell text-sm text-gray-500 dark:text-gray-400"},de={class:"table-cell text-sm text-gray-500 dark:text-gray-400"},ce={class:"table-cell"},ue={class:"flex flex-col gap-1 items-start"},me={key:0,class:"status-badge status-badge-yellow",title:"This user has requested a password reset."},ve={class:"table-cell text-sm text-gray-500 dark:text-gray-400"},ge={class:"table-cell text-right text-sm font-medium"},fe={class:"flex items-center justify-end space-x-3"},he=["onClick"],pe=["onClick"],xe=["onClick","title"],ye=["onClick"],we={__name:"UserTable",setup(_e){const m=N(),c=B(),{allUsers:k,isLoadingUsers:U}=E(m),v=f(""),d=f("username"),u=f("asc"),p=V(()=>{let a=[...k.value];if(v.value){const e=v.value.toLowerCase();a=a.filter(s=>s.username.toLowerCase().includes(e)||s.email&&s.email.toLowerCase().includes(e))}return d.value&&a.sort((e,s)=>{let o=e[d.value],n=s[d.value];return d.value==="last_activity_at"?(o=o?new Date(o).getTime():0,n=n?new Date(n).getTime():0):typeof o=="string"&&(o=o.toLowerCase(),n=n?n.toLowerCase():""),o<n?u.value==="asc"?-1:1:o>n?u.value==="asc"?1:-1:0}),a});function x(a){d.value===a?u.value=u.value==="asc"?"desc":"asc":(d.value=a,u.value="asc")}function C(a){if(!a)return"Never";const e=new Date(a),o=Math.round((new Date-e)/1e3);if(o<60)return`${o}s ago`;const n=Math.round(o/60);if(n<60)return`${n}m ago`;const g=Math.round(n/60);if(g<24)return`${g}h ago`;const y=Math.round(g/24);return y<7?`${y}d ago`:e.toLocaleDateString()}function S(a){return a.password_reset_token&&new Date(a.reset_token_expiry)>new Date}function $(a){c.openModal("adminUserEdit",{user:a,onUserUpdated:()=>m.fetchAllUsers()})}function A(){c.openModal("forceSettings",{onSettingsApplied:()=>m.fetchAllUsers()})}function L(a){c.openModal("adminUserEmail",{user:a,onSend:async({subject:e,body:s})=>{await m.sendEmailToUsers(e,s,[a.id])}})}async function M(a){const e=a.is_active?"deactivate":"activate";if(await c.showConfirmation({title:`${e.charAt(0).toUpperCase()+e.slice(1)} User?`,message:`Are you sure you want to ${e} the user "${a.username}"?`,confirmText:`Yes, ${e}`}))try{await b.post(`/api/admin/users/${a.id}/${e}`),c.addNotification(`User ${a.username} has been ${e}d.`,"success"),m.fetchAllUsers()}catch{}}async function D(a){if(await c.showConfirmation({title:"Delete User?",message:`This will permanently delete the user "${a.username}" and all associated data. This action cannot be undone.`,confirmText:"Yes, Delete User"}))try{await b.delete(`/api/admin/users/${a.id}`),c.addNotification(`User ${a.username} has been deleted.`,"success"),m.fetchAllUsers()}catch{}}return(a,e)=>(r(),l("div",q,[t("div",I,[t("div",{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},[e[3]||(e[3]=t("div",null,[t("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},"All Users"),t("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},"A sortable and searchable list of all registered users.")],-1)),t("button",{onClick:A,class:"btn btn-secondary"}," Force Settings ")]),j(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),placeholder:"Search by username or email...",class:"input-field max-w-sm"},null,512),[[z,v.value]])]),t("div",P,[R(U)?(r(),l("div",Q," Loading users... ")):p.value.length===0?(r(),l("div",Y," No users found. ")):(r(),l("div",K,[t("table",O,[t("thead",Z,[t("tr",null,[t("th",G,[t("button",{onClick:e[1]||(e[1]=s=>x("username")),class:"flex items-center gap-1"},[e[4]||(e[4]=w(" User ")),d.value==="username"?(r(),l("span",J,i(u.value==="asc"?"▲":"▼"),1)):h("",!0)])]),e[6]||(e[6]=t("th",{scope:"col",class:"table-header"}," Model/Binding ",-1)),e[7]||(e[7]=t("th",{scope:"col",class:"table-header"}," Vectorizer ",-1)),e[8]||(e[8]=t("th",{scope:"col",class:"table-header"}," Context Size ",-1)),t("th",W,[t("button",{onClick:e[2]||(e[2]=s=>x("last_activity_at")),class:"flex items-center gap-1"},[e[5]||(e[5]=w(" Last Seen ")),d.value==="last_activity_at"?(r(),l("span",X,i(u.value==="asc"?"▲":"▼"),1)):h("",!0)])]),e[9]||(e[9]=t("th",{scope:"col",class:"table-header"}," Status ",-1)),e[10]||(e[10]=t("th",{scope:"col",class:"table-header"}," Role ",-1)),e[11]||(e[11]=t("th",{scope:"col",class:"relative px-6 py-3"},[t("span",{class:"sr-only"},"Actions")],-1))])]),t("tbody",ee,[(r(!0),l(F,null,H(p.value,s=>(r(),l("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",te,[t("div",se,[t("div",ae,[t("div",oe,i(s.username),1),t("div",ne,i(s.email||"No email"),1)])])]),t("td",ie,i(s.lollms_model_name||"Not Set"),1),t("td",le,i(s.safe_store_vectorizer||"Not Set"),1),t("td",re,i(s.llm_ctx_size||"Default"),1),t("td",de,i(C(s.last_activity_at)),1),t("td",ce,[t("div",ue,[t("span",{class:_([s.is_active?"status-badge-green":"status-badge-red","status-badge"])},i(s.is_active?"Active":"Inactive"),3),S(s)?(r(),l("span",me," Reset Pending ")):h("",!0)])]),t("td",ve,i(s.is_admin?"Admin":"User"),1),t("td",ge,[t("div",fe,[t("button",{onClick:o=>$(s),title:"Edit User",class:"action-icon"},e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})],-1)]),8,he),t("button",{onClick:o=>L(s),title:"Email User",class:"action-icon"},e[13]||(e[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})],-1)]),8,pe),t("button",{onClick:o=>M(s),title:s.is_active?"Deactivate User":"Activate User",class:_(s.is_active?"action-icon-toggle-active":"action-icon-toggle-inactive")},e[14]||(e[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"})],-1)]),10,xe),t("button",{onClick:o=>D(s),title:"Delete User",class:"action-icon-delete"},e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})],-1)]),8,ye)])])]))),128))])])]))])]))}},ke=T(we,[["__scopeId","data-v-ca0067ae"]]);export{ke as default};
