import{r as c,b as o,e as n,d as v,f as t,y as w,t as m,x as X,q as ee,a as te,u as ae,s as K,o as se,k as le,c as k,g as ne,h as p,A as oe,w as ie,v as U,n as re,i as de,T as ue,B as P,l as V,F as B,m as I,z as T}from"./index-CnDdf4sZ.js";const ce={class:"relative bg-white dark:bg-gray-800/80 shadow rounded-lg p-4 flex flex-col transition hover:shadow-md"},pe=["title"],ve={class:"flex-grow"},me={class:"flex items-center gap-x-4"},ge={class:"h-12 w-12 rounded-md flex-shrink-0 bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden"},ye=["src"],fe={key:1,class:"w-7 h-7 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},xe={class:"truncate"},be=["title"],he=["title"],ke={class:"mt-3 flex items-center gap-x-3 flex-wrap"},we={key:0,class:"flex items-center gap-x-1 px-2 py-0.5 rounded-full text-xs bg-blue-50 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400"},_e={class:"capitalize"},Ce={key:1,class:"flex items-center gap-x-1 px-2 py-0.5 rounded-full text-xs bg-yellow-50 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400"},Ae={key:2,class:"flex items-center gap-x-1 px-2 py-0.5 rounded-full text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"},Me={key:1,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end items-center gap-x-3 text-sm"},F={__name:"McpCard",props:{mcp:{type:Object,required:!0},isEditable:{type:Boolean,default:!1}},emits:["edit","delete"],setup(r,{emit:d}){const g=r,_=d,x=c(!1);function C(){x.value=!0}function f(){_("edit",g.mcp)}function i(){_("delete",g.mcp)}return(A,a)=>(n(),o("div",ce,[typeof r.mcp.active=="boolean"?(n(),o("span",{key:0,class:w(["absolute top-3 right-3 h-3 w-3 rounded-full",r.mcp.active?"bg-green-500":"bg-gray-400 dark:bg-gray-600"]),title:r.mcp.active?"Active":"Inactive"},null,10,pe)):v("",!0),t("div",ve,[t("div",me,[t("div",ge,[r.mcp.icon&&!x.value?(n(),o("img",{key:0,src:r.mcp.icon,onError:C,alt:"Server Icon",class:"h-full w-full object-cover"},null,40,ye)):(n(),o("svg",fe,a[0]||(a[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Z"},null,-1)])))]),t("div",xe,[t("p",{class:"font-semibold text-gray-900 dark:text-white truncate pr-6",title:r.mcp.name},m(r.mcp.name),9,be),t("p",{class:"text-xs text-gray-500 dark:text-gray-400 font-mono truncate",title:r.mcp.url},m(r.mcp.url),9,he)])]),t("div",ke,[r.mcp.type?(n(),o("div",we,[a[1]||(a[1]=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-3 h-3"},[t("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.139a6.002 6.002 0 0 0-11.215 0c-.22.578.254 1.139.872 1.139h9.47Z"})],-1)),t("span",_e,m(r.mcp.type),1)])):v("",!0),r.mcp.authentication_type&&r.mcp.authentication_type!=="none"?(n(),o("div",Ce,a[2]||(a[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-3 h-3"},[t("path",{"fill-rule":"evenodd",d:"M8 1a3.5 3.5 0 0 0-3.5 3.5V6h7V4.5A3.5 3.5 0 0 0 8 1Zm-5 5a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H3Z","clip-rule":"evenodd"})],-1),t("span",null,"Secured",-1)]))):(n(),o("div",Ae,a[3]||(a[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-3 h-3"},[t("path",{"fill-rule":"evenodd",d:"M11.5 6V4.5a3.5 3.5 0 1 0-7 0V6H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1h-1.5Zm-4 0V4.5a.5.5 0 0 1 1 0V6h-1Z","clip-rule":"evenodd"})],-1),t("span",null,"No Auth",-1)])))])]),r.isEditable?(n(),o("div",Me,[t("button",{onClick:f,class:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-500 dark:hover:text-blue-400"},"Edit"),t("button",{onClick:i,class:"font-medium text-red-600 hover:text-red-500 dark:text-red-500 dark:hover:text-red-400"},"Delete")])):v("",!0)]))}},$e={class:"space-y-10"},Se={class:"border-b border-gray-200 dark:border-gray-700"},Ee={class:"-mb-px flex space-x-6","aria-label":"Tabs"},je={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},De={class:"px-4 py-5 sm:p-6"},Le={class:"text-xl font-bold leading-6 text-gray-900 dark:text-white capitalize"},Pe={class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},Ve={class:"border-t border-gray-200 dark:border-gray-700"},Be={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Ie=["placeholder"],Te=["placeholder"],Fe={class:"mt-2 flex items-center gap-x-4"},Ne={class:"h-16 w-16 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden"},Ue=["src"],Re={key:1,class:"w-8 h-8 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},ze={class:"flex-grow space-y-2"},He={class:"flex items-center gap-x-3"},Ze={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},qe={class:"space-y-4"},Ke={key:0,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ye={key:1,class:"relative"},Oe=["type"],We={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},Ge={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},Je={class:"flex justify-end items-center gap-x-3 pt-2"},Qe=["disabled"],Xe={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},et={class:"flex items-center gap-x-3"},tt={key:0,class:"empty-state-card"},at={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},st={class:"flex justify-between items-center my-4 flex-wrap gap-4"},lt=["disabled"],nt={key:0,class:"empty-state-card"},ot={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},it={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},rt={class:"flex items-center gap-x-3"},dt={key:0,class:"empty-state-card"},ut={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},ct={key:0,class:"empty-state-card"},pt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},vt={__name:"MCPSettings",setup(r){const d=ee(),g=te(),_=ae(),{userMcps:x,userApps:C}=K(d),{user:f}=K(_),i=c("mcps"),A=(s="mcps",e="user")=>({name:"",url:"",icon:"",active:!0,type:e,authentication_type:"none",authentication_key:""}),a=c(A()),y=c(null),M=c(!1),$=c(!1),b=c(!1),R=c(null),N=c(!1),S=c(!1);se(()=>{d.fetchMcps(),d.fetchApps()}),le(()=>a.value.icon,()=>{N.value=!1});const h=k(()=>y.value!==null),z=k(()=>x.value.filter(s=>s.type==="user").sort((s,e)=>s.name.localeCompare(e.name))),H=k(()=>x.value.filter(s=>s.type==="system").sort((s,e)=>s.name.localeCompare(e.name))),Z=k(()=>C.value.filter(s=>s.type==="user").sort((s,e)=>s.name.localeCompare(e.name))),q=k(()=>C.value.filter(s=>s.type==="system").sort((s,e)=>s.name.localeCompare(e.name)));function E(s,e="user"){h.value&&D(),i.value=s,a.value=A(s,e),S.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function j(s,e){i.value=e,y.value={...s,_type:e},a.value.name=s.name,a.value.url=s.url,a.value.icon=s.icon||"",a.value.active=typeof s.active=="boolean"?s.active:!0,a.value.type=s.type||"user",a.value.authentication_type=s.authentication_type||"none",a.value.authentication_key=s.authentication_key||"",S.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function D(){y.value=null,a.value=A(i.value),b.value=!1,S.value=!1}function Y(){N.value=!0}async function O(){$.value=!0;try{await d.triggerMcpReload()}finally{$.value=!1}}async function W(){if(!a.value.name||!a.value.url){g.addNotification("Name and URL are required.","warning");return}M.value=!0;try{const s={name:a.value.name,url:a.value.url,icon:a.value.icon||null,active:a.value.active,type:a.value.type,authentication_type:a.value.authentication_type,authentication_key:a.value.authentication_key||""},e=i.value==="apps";h.value?await(e?d.updateApp(y.value.id,s):d.updateMcp(y.value.id,s)):await(e?d.addApp(s):d.addMcp(s)),D()}finally{M.value=!1}}async function L(s,e){await g.showConfirmation({title:`Delete '${s.name}'?`,message:`Are you sure you want to remove this ${e==="mcps"?"MCP server":"Application"}? This cannot be undone.`,confirmText:"Delete"})&&(y.value&&y.value.id===s.id&&D(),await(e==="apps"?d.deleteApp(s.id):d.deleteMcp(s.id)))}function G(){R.value.click()}function J(s){const e=s.target.files[0];if(!e)return;if(!["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"].includes(e.type)){g.addNotification("Invalid file type. Please select an image.","error");return}if(e.size>1*1024*1024){g.addNotification("File is too large. Maximum size is 1MB.","error");return}const u=new FileReader;u.onload=Q=>{a.value.icon=Q.target.result},u.onerror=()=>{g.addNotification("Failed to read the file.","error")},u.readAsDataURL(e),s.target.value=""}return(s,e)=>(n(),o("div",$e,[t("div",Se,[t("nav",Ee,[t("button",{onClick:e[0]||(e[0]=l=>i.value="mcps"),class:w(["tab-button",i.value==="mcps"?"active":"inactive"])}," MCP Servers ",2),t("button",{onClick:e[1]||(e[1]=l=>i.value="apps"),class:w(["tab-button",i.value==="apps"?"active":"inactive"])}," Applications ",2)])]),ne(ue,{name:"form-fade"},{default:oe(()=>[S.value?(n(),o("div",je,[t("div",De,[t("h2",Le,m(h.value?"Edit":"Add")+" "+m(a.value.type)+" "+m(i.value==="mcps"?"MCP Server":"Application"),1),t("p",Pe,m(a.value.type==="user"?"This is only available to you.":"This is available to all users."),1)]),t("div",Ve,[t("form",{onSubmit:ie(W,["prevent"]),class:"p-4 sm:p-6 space-y-6"},[t("div",Be,[t("div",null,[e[15]||(e[15]=t("label",{for:"formName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),p(t("input",{type:"text",id:"formName","onUpdate:modelValue":e[2]||(e[2]=l=>a.value.name=l),class:"input-field mt-1",placeholder:i.value==="mcps"?"My Local Server":"My Web App",required:""},null,8,Ie),[[U,a.value.name]])]),t("div",null,[e[16]||(e[16]=t("label",{for:"formUrl",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"URL",-1)),p(t("input",{type:"url",id:"formUrl","onUpdate:modelValue":e[3]||(e[3]=l=>a.value.url=l),class:"input-field mt-1",placeholder:i.value==="mcps"?"http://127.0.0.1:9602":"https://example.com",required:""},null,8,Te),[[U,a.value.url]])])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Icon (Optional)",-1)),t("div",Fe,[t("div",Ne,[a.value.icon&&!N.value?(n(),o("img",{key:0,src:a.value.icon,onError:Y,alt:"Icon Preview",class:"h-full w-full object-cover"},null,40,Ue)):(n(),o("svg",Re,e[17]||(e[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Z"},null,-1)])))]),t("div",ze,[p(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=l=>a.value.icon=l),class:"input-field",placeholder:"Paste image URL or upload a file"},null,512),[[U,a.value.icon]]),t("div",He,[t("button",{onClick:G,type:"button",class:"btn btn-secondary text-sm"},"Upload File"),a.value.icon?(n(),o("button",{key:0,onClick:e[5]||(e[5]=l=>a.value.icon=""),type:"button",class:"text-sm font-medium text-red-600 hover:text-red-500"},"Remove")):v("",!0)])])]),t("input",{type:"file",ref_key:"fileInput",ref:R,onChange:J,class:"hidden",accept:"image/png, image/jpeg, image/gif, image/webp, image/svg+xml"},null,544)]),t("div",Ze,[e[19]||(e[19]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Inactive items cannot be used.")],-1)),t("button",{onClick:e[6]||(e[6]=l=>a.value.active=!a.value.active),type:"button",class:w([a.value.active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"])},[t("span",{class:w([a.value.active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),t("fieldset",qe,[e[24]||(e[24]=t("legend",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Authentication",-1)),p(t("select",{id:"formAuthType","onUpdate:modelValue":e[7]||(e[7]=l=>a.value.authentication_type=l),class:"input-field"},e[20]||(e[20]=[t("option",{value:"none"},"None",-1),t("option",{value:"lollms_chat_auth"},"LoLLMs Chat Auth",-1),t("option",{value:"bearer"},"Bearer Token",-1)]),512),[[re,a.value.authentication_type]]),a.value.authentication_type==="lollms_chat_auth"?(n(),o("p",Ke," A temporary token will be generated by LoLLMs for each session. ")):v("",!0),a.value.authentication_type==="bearer"?(n(),o("div",Ye,[e[23]||(e[23]=t("label",{for:"formKey",class:"sr-only"},"Authentication Key",-1)),p(t("input",{type:b.value?"text":"password",id:"formKey","onUpdate:modelValue":e[8]||(e[8]=l=>a.value.authentication_key=l),class:"input-field pr-10",placeholder:"Paste your Bearer token here"},null,8,Oe),[[de,a.value.authentication_key]]),t("button",{type:"button",onClick:e[9]||(e[9]=l=>b.value=!b.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[b.value?(n(),o("svg",Ge,e[22]||(e[22]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"},null,-1)]))):(n(),o("svg",We,e[21]||(e[21]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])))])])):v("",!0)]),t("div",Je,[t("button",{onClick:D,type:"button",class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:M.value},m(M.value?h.value?"Saving...":"Adding...":h.value?"Save Changes":`Add ${i.value==="mcps"?"MCP":"App"}`),9,Qe)])],32)])])):v("",!0)]),_:1}),p(t("section",null,[t("div",Xe,[e[25]||(e[25]=t("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Your Personal MCPs",-1)),t("div",et,[t("button",{onClick:e[10]||(e[10]=l=>E("mcps","user")),class:"btn btn-primary text-sm"},"+ Add Personal Server"),V(f).is_admin?(n(),o("button",{key:0,onClick:e[11]||(e[11]=l=>E("mcps","system")),class:"btn btn-secondary text-sm"},"+ Add System Server")):v("",!0)])]),z.value.length===0?(n(),o("div",tt,e[26]||(e[26]=[t("p",null,"You haven't added any personal MCP servers yet.",-1)]))):(n(),o("div",at,[(n(!0),o(B,null,I(z.value,l=>(n(),T(F,{key:l.id,mcp:l,"is-editable":"",onEdit:u=>j(l,"mcps"),onDelete:u=>L(l,"mcps")},null,8,["mcp","onEdit","onDelete"]))),128))]))],512),[[P,i.value==="mcps"]]),p(t("section",null,[t("div",st,[e[27]||(e[27]=t("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"System MCPs",-1)),t("button",{onClick:e[12]||(e[12]=l=>O()),class:"btn btn-secondary text-sm",disabled:$.value},m($.value?"Reloading...":"Reload All Servers"),9,lt)]),H.value.length===0?(n(),o("div",nt,e[28]||(e[28]=[t("p",null,"No system-wide MCP servers are available.",-1)]))):(n(),o("div",ot,[(n(!0),o(B,null,I(H.value,l=>(n(),T(F,{key:l.id,mcp:l,"is-editable":V(f).is_admin,onEdit:u=>j(l,"mcps"),onDelete:u=>L(l,"mcps")},null,8,["mcp","is-editable","onEdit","onDelete"]))),128))]))],512),[[P,i.value==="mcps"]]),p(t("section",null,[t("div",it,[e[29]||(e[29]=t("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Your Personal Apps",-1)),t("div",rt,[t("button",{onClick:e[13]||(e[13]=l=>E("apps","user")),class:"btn btn-primary text-sm"},"+ Add Personal App"),V(f).is_admin?(n(),o("button",{key:0,onClick:e[14]||(e[14]=l=>E("apps","system")),class:"btn btn-secondary text-sm"},"+ Add System App")):v("",!0)])]),Z.value.length===0?(n(),o("div",dt,e[30]||(e[30]=[t("p",null,"You haven't added any personal Apps yet.",-1)]))):(n(),o("div",ut,[(n(!0),o(B,null,I(Z.value,l=>(n(),T(F,{key:l.id,mcp:l,"is-editable":"",onEdit:u=>j(l,"apps"),onDelete:u=>L(l,"apps")},null,8,["mcp","onEdit","onDelete"]))),128))]))],512),[[P,i.value==="apps"]]),p(t("section",null,[e[32]||(e[32]=t("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white my-4"},"System Apps",-1)),q.value.length===0?(n(),o("div",ct,e[31]||(e[31]=[t("p",null,"No system-wide Apps are available.",-1)]))):(n(),o("div",pt,[(n(!0),o(B,null,I(q.value,l=>(n(),T(F,{key:l.id,mcp:l,"is-editable":V(f).is_admin,onEdit:u=>j(l,"apps"),onDelete:u=>L(l,"apps")},null,8,["mcp","is-editable","onEdit","onDelete"]))),128))]))],512),[[P,i.value==="apps"]])]))}},gt=X(vt,[["__scopeId","data-v-49defa9b"]]);export{gt as default};
