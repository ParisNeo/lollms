import{c7 as ue,a as ce,c1 as me,r as c,c as U,w as H,o as ve,b as o,d as l,g as m,h as t,e as O,t as r,l as B,j as $,v as q,c2 as J,F as y,m as p,i as V,$ as fe,q as K,b$ as ge,c0 as be,n as v,P as R,c9 as ye,H as _e,f as Q,ca as pe}from"./index-DnjdbnqE.js";const xe={class:"space-y-8"},he={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},ke={class:"text-xl font-semibold mb-4"},we={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ce=["disabled"],Te=["value"],Se={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},Be={class:"text-sm text-gray-600 dark:text-gray-400"},$e=["for"],Me={key:0,class:"text-red-500"},Ae=["id","onUpdate:modelValue"],Ve=["value"],De={key:1},Ne={class:"relative"},Ee=["type","id","onUpdate:modelValue","required","placeholder"],Fe=["onClick","title"],je={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Ue={class:"flex-grow flex flex-col pr-4"},Oe={class:"text-sm text-gray-500 dark:text-gray-400"},qe=["onClick"],Pe={class:"text-xs text-gray-500 mt-1"},Ie={key:1,class:"mt-6 border-t dark:border-gray-700 pt-6"},Le={class:"grid grid-cols-1 gap-4"},ze={class:"flex justify-between items-start mb-3"},Ge={class:"font-bold text-md"},He={class:"text-sm text-gray-600 dark:text-gray-400"},Je={key:0,class:"space-y-3 mb-4"},Ke={class:"block text-xs font-medium uppercase text-gray-500 dark:text-gray-400 mb-1"},Re=["onUpdate:modelValue","placeholder"],Qe={key:1,class:"flex items-center gap-2"},We=["onClick"],Xe={class:"text-sm"},Ye={class:"flex justify-end"},Ze=["onClick"],et={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},tt={class:"flex justify-end gap-3"},nt=["disabled"],at={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},st={class:"flex items-center gap-4"},lt=["value"],ot={key:0,class:"text-center p-6"},it={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},rt={key:2,class:"space-y-4"},dt={class:"flex-grow"},ut={class:"flex justify-between items-center"},ct={class:"flex items-center gap-3"},mt={class:"font-bold text-lg text-gray-900 dark:text-white"},vt=["onClick","title"],ft={class:"flex gap-3"},gt=["onClick"],bt=["onClick"],yt={class:"text-sm text-gray-500 dark:text-gray-400"},_t={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},pt={key:0},xt={class:"font-semibold capitalize"},ht={key:0},kt={key:1},wt={key:0},Ct={class:"border-t dark:border-gray-700 pt-3 flex justify-end gap-2"},Tt=["onClick"],St=["onClick"],Bt={class:"space-y-4"},$t={key:0,class:"text-center text-gray-500"},Mt={key:1,class:"flex gap-4"},At={class:"w-1/3 border-r dark:border-gray-700 pr-4 space-y-2"},Vt=["onClick"],Dt={class:"w-2/3 pl-2"},Nt={key:0},Et={class:"font-bold text-lg mb-2"},Ft={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},jt={key:0,class:"space-y-3 mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-md border dark:border-gray-700"},Ut={class:"block text-xs font-medium uppercase text-gray-500 dark:text-gray-400 mb-1"},Ot=["onUpdate:modelValue","placeholder"],qt={key:1,class:"flex items-center gap-2"},Pt=["onClick"],It={class:"text-sm"},Lt={class:"flex justify-end"},zt=["disabled"],Gt={key:1,class:"h-full flex items-center justify-center text-gray-400 text-sm"},Kt={__name:"TTSBindingsSettings",setup(Ht){const f=ue(),w=ce(),{ttsBindings:P,availableTtsBindingTypes:h,isLoadingTtsBindings:W,globalSettings:X}=me(f),C=c(!1),T=c(null),D=c(!1),k=c({}),E=c("mixed"),g=c({}),M=c(!1),F=c(null),j=c([]),u=c(null),b=c({}),N=c(!1),I=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),i=c(I()),S=U(()=>T.value!==null),x=U(()=>i.value.name?h.value.find(s=>s.binding_name===i.value.name):null),Y=U(()=>{if(!x.value)return[];const s=x.value.input_parameters||[],n=new Set(s.map(a=>a.name)),e=Object.keys(i.value.config||{}).filter(a=>!n.has(a)&&a!=="model_name").map(a=>({name:a,type:typeof i.value.config[a]=="boolean"?"bool":typeof i.value.config[a]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...s.filter(a=>a.name!=="model_name"),...e]});H(X,s=>{if(Array.isArray(s)){const n=s.find(e=>e.key==="tts_model_display_mode");n&&(E.value=n.value)}},{deep:!0,immediate:!0});function Z(s){const n=s.target.value;E.value=n,f.updateGlobalSettings({tts_model_display_mode:n})}H(()=>i.value.name,(s,n)=>{if(s!==n&&!S.value){const e=h.value.find(d=>d.binding_name===s),a={};e&&e.input_parameters&&e.input_parameters.forEach(d=>{a[d.name]=d.default}),i.value.config=a}}),ve(()=>{f.fetchTtsBindings(),f.fetchAvailableTtsBindingTypes(),f.fetchGlobalSettings()});function L(){T.value=null,i.value=I(),k.value={},g.value={},C.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function ee(s){T.value=s,i.value=JSON.parse(JSON.stringify(s)),i.value.config||(i.value.config={}),k.value={};const n=h.value.find(e=>e.binding_name===s.name);if(n&&n.commands){const e={};n.commands.forEach(a=>{e[a.name]={},a.parameters&&a.parameters.forEach(d=>{e[a.name][d.name]=d.default!==void 0?d.default:""})}),g.value=e}else g.value={};C.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function z(){C.value=!1,T.value=null}function te(s){return typeof s=="string"?s.split(",").map(n=>n.trim()).filter(n=>n):Array.isArray(s)?s.filter(n=>n):[]}async function ne(){if(!i.value.alias.trim()||!i.value.name){w.addNotification("Alias and Binding Type are required fields.","warning");return}D.value=!0;try{const s={alias:i.value.alias,name:i.value.name,config:i.value.config||{},is_active:i.value.is_active,default_model_name:i.value.default_model_name||null};S.value?await f.updateTtsBinding(T.value.id,s):await f.addTtsBinding(s),z()}catch(s){console.error("Submit failed:",s.message)}finally{D.value=!1}}async function ae(s){await w.showConfirmation({title:`Delete TTS Binding '${s.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await f.deleteTtsBinding(s.id)}async function se(s){await f.updateTtsBinding(s.id,{is_active:!s.is_active})}function le(s){w.openModal("manageModels",{binding:s,bindingType:"tts"})}function oe(s){const n=h.value.find(e=>e.binding_name===s);return n?n.title:s}async function G(s,n,e){try{w.addNotification(`Submitting command '${s.title||s.name}'...`,"info");const a=await f.executeTtsBindingCommand(n,s.name,e);if(a)return w.addNotification(`Task started: ${s.title||s.name}. Check Task Manager for progress.`,"success",5e3),a}catch(a){console.error(a),w.addNotification(`Command submission failed: ${a.message}`,"error")}}function ie(s){F.value=s;const n=h.value.find(e=>e.binding_name===s.name);j.value=n?n.commands||[]:[],u.value=null,b.value={},M.value=!0}function re(s){u.value=s,b.value={},s.parameters&&s.parameters.forEach(n=>{b.value[n.name]=n.default!==void 0?n.default:""})}async function de(){if(!(!u.value||!F.value)){N.value=!0;try{await G(u.value,F.value.id,b.value),M.value=!1}finally{N.value=!1}}}return(s,n)=>(l(),o("div",xe,[C.value?(l(),o("div",he,[t("h3",ke,r(S.value?"Edit TTS Binding":"Add New TTS Binding"),1),t("form",{onSubmit:R(ne,["prevent"]),class:"space-y-6"},[t("div",we,[t("div",null,[n[5]||(n[5]=t("label",{for:"alias",class:"block text-sm font-medium"},[$("Alias "),t("span",{class:"text-red-500"},"*")],-1)),B(t("input",{type:"text",id:"alias","onUpdate:modelValue":n[0]||(n[0]=e=>i.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_xtts",autocomplete:"off"},null,512),[[q,i.value.alias]]),n[6]||(n[6]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[n[8]||(n[8]=t("label",{for:"name",class:"block text-sm font-medium"},[$("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),B(t("select",{id:"name","onUpdate:modelValue":n[1]||(n[1]=e=>i.value.name=e),class:"input-field mt-1",required:"",disabled:S.value},[n[7]||(n[7]=t("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),o(y,null,p(V(h),e=>(l(),o("option",{key:e.binding_name,value:e.binding_name},r(e.title),9,Te))),128))],8,Ce),[[J,i.value.name]])])]),x.value?(l(),o("div",Se,[t("p",Be,r(x.value.description),1),(l(!0),o(y,null,p(Y.value,e=>(l(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[$(r(e.name.replace(/_/g," "))+" ",1),e.mandatory?(l(),o("span",Me,"*")):m("",!0)],8,$e),e.options&&e.options.length>0?B((l(),o("select",{key:0,id:`param-${e.name}`,"onUpdate:modelValue":a=>i.value.config[e.name]=a,class:"input-field"},[(l(!0),o(y,null,p(te(e.options),a=>(l(),o("option",{key:a,value:a},r(a),9,Ve))),128))],8,Ae)),[[J,i.value.config[e.name]]]):["str","int","float"].includes(e.type)?(l(),o("div",De,[t("div",Ne,[B(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!k.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":a=>i.value.config[e.name]=a,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,Ee),[[fe,i.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(l(),o("button",{key:0,type:"button",onClick:a=>k.value[e.name]=!k.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:k.value[e.name]?"Hide":"Show"},[k.value[e.name]?(l(),K(ge,{key:0,class:"w-5 h-5"})):(l(),K(be,{key:1,class:"w-5 h-5"}))],8,Fe)):m("",!0)])])):e.type==="bool"?(l(),o("div",je,[t("span",Ue,[t("span",Oe,r(e.description),1)]),t("button",{onClick:a=>i.value.config[e.name]=!i.value.config[e.name],type:"button",class:v([i.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:v([i.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,qe)])):m("",!0),t("p",Pe,r(e.description),1)]))),128))])):m("",!0),S.value&&x.value&&x.value.commands&&x.value.commands.length>0?(l(),o("div",Ie,[n[9]||(n[9]=t("h4",{class:"text-lg font-semibold mb-4"},"Binding Commands",-1)),t("div",Le,[(l(!0),o(y,null,p(x.value.commands,e=>(l(),o("div",{key:e.name,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600"},[t("div",ze,[t("div",null,[t("h5",Ge,r(e.title||e.name),1),t("p",He,r(e.description),1)])]),e.parameters&&e.parameters.length>0?(l(),o("div",Je,[(l(!0),o(y,null,p(e.parameters,a=>(l(),o("div",{key:a.name},[t("label",Ke,r(a.name),1),a.type!=="bool"?B((l(),o("input",{key:0,type:"text","onUpdate:modelValue":d=>g.value[e.name][a.name]=d,class:"input-field text-sm",placeholder:a.default},null,8,Re)),[[q,g.value[e.name][a.name]]]):(l(),o("div",Qe,[t("button",{onClick:d=>g.value[e.name][a.name]=!g.value[e.name][a.name],type:"button",class:v([g.value[e.name][a.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:v([g.value[e.name][a.name]?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,We),t("span",Xe,r(a.description),1)]))]))),128))])):m("",!0),t("div",Ye,[t("button",{type:"button",onClick:a=>G(e,T.value.id,g.value[e.name]),class:"btn btn-primary btn-sm"},"Execute",8,Ze)])]))),128))])])):m("",!0),t("div",et,[n[10]||(n[10]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this TTS service will not be available.")],-1)),t("button",{onClick:n[2]||(n[2]=e=>i.value.is_active=!i.value.is_active),type:"button",class:v([i.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:v([i.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",tt,[t("button",{type:"button",onClick:z,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:D.value},r(D.value?"Saving...":S.value?"Save Changes":"Add Binding"),9,nt)])],32)])):m("",!0),t("div",null,[t("div",at,[n[13]||(n[13]=t("h2",{class:"text-2xl font-bold"},"TTS Bindings",-1)),t("div",st,[t("div",null,[n[12]||(n[12]=t("label",{for:"tts-model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),t("select",{id:"tts-model-display-mode",value:E.value,onChange:Z,class:"input-field mt-1"},n[11]||(n[11]=[t("option",{value:"mixed"},"Mixed (Alias or Original)",-1),t("option",{value:"aliased"},"Aliased Only",-1),t("option",{value:"original"},"Original Names Only",-1)]),40,lt)]),C.value?m("",!0):(l(),o("button",{key:0,onClick:L,class:"btn btn-primary self-end"},"+ Add New TTS Binding"))])]),V(W)?(l(),o("div",ot,"Loading TTS bindings...")):V(P).length===0&&!C.value?(l(),o("div",it,[n[14]||(n[14]=t("p",null,"No TTS bindings configured yet.",-1)),t("button",{onClick:L,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(l(),o("div",rt,[(l(!0),o(y,null,p(V(P),e=>{var a,d;return l(),o("div",{key:e.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[t("div",dt,[t("div",ut,[t("div",ct,[t("h4",mt,r(e.alias),1),t("button",{onClick:R(_=>se(e),["stop"]),type:"button",class:v([e.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"]),title:e.is_active?"Deactivate":"Activate"},[t("span",{class:v([e.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],10,vt)]),t("div",ft,[t("button",{onClick:_=>ee(e),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,gt),t("button",{onClick:_=>ae(e),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,bt)])]),t("p",yt,r(oe(e.name)),1),t("div",_t,[(l(!0),o(y,null,p(e.config,(_,A)=>(l(),o(y,{key:A},[_&&A!=="model_name"?(l(),o("p",pt,[t("span",xt,r(A.replace(/_/g," "))+":",1),A.includes("key")||A.includes("token")?(l(),o("span",ht,"********")):(l(),o("span",kt,r(_),1))])):m("",!0)],64))),128)),e.default_model_name?(l(),o("p",wt,[n[15]||(n[15]=t("span",{class:"font-semibold"},"Default Model:",-1)),$(" "+r(e.default_model_name),1)])):m("",!0)])]),t("div",Ct,[(d=(a=V(h).find(_=>_.binding_name===e.name))==null?void 0:a.commands)!=null&&d.length?(l(),o("button",{key:0,onClick:_=>ie(e),class:"btn btn-secondary btn-sm flex items-center gap-2",title:"Execute Commands"},[O(ye,{class:"w-4 h-4"}),n[16]||(n[16]=$(" Commands "))],8,Tt)):m("",!0),t("button",{onClick:_=>le(e),class:"btn btn-secondary btn-sm flex items-center gap-2"},[O(_e,{class:"w-4 h-4"}),n[17]||(n[17]=$(" Manage Models "))],8,St)])])}),128))]))]),O(pe,{visible:M.value,title:"TTS Binding Commands",onClose:n[4]||(n[4]=e=>M.value=!1)},{footer:Q(()=>[t("button",{onClick:n[3]||(n[3]=e=>M.value=!1),class:"btn btn-secondary"},"Close")]),default:Q(()=>[t("div",Bt,[j.value.length?(l(),o("div",Mt,[t("div",At,[(l(!0),o(y,null,p(j.value,e=>(l(),o("button",{key:e.name,onClick:a=>re(e),class:v(["w-full text-left px-3 py-2 rounded-md text-sm transition-colors",u.value&&u.value.name===e.name?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 font-medium":"hover:bg-gray-100 dark:hover:bg-gray-700"])},r(e.title||e.name),11,Vt))),128))]),t("div",Dt,[u.value?(l(),o("div",Nt,[t("h4",Et,r(u.value.title||u.value.name),1),t("p",Ft,r(u.value.description),1),u.value.parameters&&u.value.parameters.length?(l(),o("div",jt,[(l(!0),o(y,null,p(u.value.parameters,e=>(l(),o("div",{key:e.name},[t("label",Ut,r(e.name),1),e.type!=="bool"?B((l(),o("input",{key:0,type:"text","onUpdate:modelValue":a=>b.value[e.name]=a,class:"input-field text-sm",placeholder:e.default},null,8,Ot)),[[q,b.value[e.name]]]):(l(),o("div",qt,[t("button",{onClick:a=>b.value[e.name]=!b.value[e.name],type:"button",class:v([b.value[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:v([b.value[e.name]?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,Pt),t("span",It,r(e.description),1)]))]))),128))])):m("",!0),t("div",Lt,[t("button",{onClick:de,class:"btn btn-primary",disabled:N.value},r(N.value?"Starting Task...":"Execute Command"),9,zt)])])):(l(),o("div",Gt," Select a command to view details. "))])])):(l(),o("div",$t," No commands available for this binding. "))])]),_:1},8,["visible"])]))}};export{Kt as default};
