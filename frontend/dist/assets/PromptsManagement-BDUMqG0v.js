import{S as q,c as n,b as a,g as e,d as p,t as c,n as Q,f as H,B as A,bO as bt,bP as kt,k as y,bQ as wt,A as b,Y as jt,D as xt,bU as Lt,E as K,O as Nt,L as At,x as St,q as ht,s as R,r as x,j as f,w as P,o as It,y as Ct,z as Dt,M as B,_ as $t,h as M,l as z,e as u,v as T,F as L,i as N,bM as W}from"./index-Dd3XH_0e.js";import Pt from"./IconArrowUpCircle-CHjSk_KU.js";import{_ as zt,A as Tt}from"./AppCardSkeleton-DukR6OTG.js";import Ut from"./IconArrowDown-CC96VluY.js";import Et from"./IconArrowUp-47NLkmh_.js";const Ot={class:"card"},Rt={class:"card-header"},Qt=["src","alt"],Zt={class:"flex-grow min-w-0"},Vt={class:"flex justify-between items-start"},Yt=["title"],_t={class:"card-tags"},Ft={key:0,class:"tag installed-tag"},Gt={key:1,class:"tag"},Bt={key:2,class:"tag"},Wt={key:3,class:"tag"},qt={class:"card-body"},Ht=["title"],Kt={key:0,class:"px-4 pb-2 text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1"},Jt=["title"],Xt={class:"card-footer"},te={class:"flex-1 min-w-0"},ee={key:1,class:"flex gap-2 w-full"},se={class:"flex-shrink-0 flex gap-1"},oe="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05LjE3MiA0LjU4NmMxLjA3Mi0xLjA3MiAyLjgyNy0xLjA3MiAzLjkwNiAwIGwxLjkyOCAxLjkyOGMuMDkuMDkuMTQ2LjIxMy4xNDYuMzM3djEuMjE5Yy43MTMuMDU0IDEuMzk3LjIxOCAyLjAyOC40NzhsMS45MS0xLjA0Yy4xNTYtLjA4NS4zMy0uMTA0LjQ5OC0uMDVMMjAuNzUgOC4xN2MuMjU0LjA4NC4zOTQuMzQzLjM5NC42MjV2My40M2MwIC4yODItLjE0LjU0MS0uMzk0LjYyNWwtMi42NTQgMS40NDRjLS4xNjguMDktLjM0Mi4xMDgtLjUxLjA1M2wtMS45MS0xLjA0Yy0uNjMyLS4yNi0xLjMxNS0uNDI0LTIuMDI4LS40NzhWNS41NUw5LjE3MiA0LjU4NnpNNCAxMS4yNWMwLS45OTQuNTk2LTEuODYgMS40NDctMi4yNTlMMTAuMDMgNC40M2MtLjM2OS4wMjYtLjczLjEzOC0xLjA3Mi4zMzJsLTEuOTI4IDEuOTI4Yy0xLjA3MiAxLjA3Mi0xLjA3MiAyLjgyNyAwIDMuOTA2bDQuNTk2IDQuNTk2Yy4zNzQuMzc0LjU4Ni44OC41ODYgMS40MTR2My4yMDJjLS45NC4wNS0xLjg1NS4zNzktMi41My45NDNsLTEuNzM2IDEuNzM3YTEuNSAxLjUgMCAwMS0yLjEyMiAwTDMgMTkuNWExLjUgMS41IDAgMDEgMC0yLjEyMWwxLjczNy0xLjczN2MuNTY0LS41NjQgMS4yMzYtLjkxNCAxLjk0My0uOTk2YTQuNDgzIDQuNDgzIDAgMDEtLjY4LS44NDhWMTMuNWExLjUgMS41IDAgMDEtLjQ0LTEuMDYxTDEuNDQ3IDkuMDA5QTcuNSA3LjUgMCAwMSA0IDQuNUMyLjQ4IDEuNSA1LjMzNCAxLjUgNy4wMyA1LjAzaDEuOTQzYy4wMy4zNjIuMTE4LjcxLjI2IDEuMDQzTDQuNDMgMTAuODNjLS44NTEuNDUtMS40MyAxLjMyMi0xLjQzIDIuMjQ4djIuODQ4YzAgMS4zMy42NzIgMi41MzMgMS42ODggMy4yMThhLjc1Ljc1IDAgMTEtLjgyMiAxLjE4NEEzLjAwMiAzLjAwMiAwIDAgMSA0IDE2LjM0OFYxMS4yNXoiIGNsaXAtcnVsZT0iZXZlbm9kZCIgLz4KPC9zdmc+",le={__name:"PromptCard",props:{prompt:{type:Object,required:!0},task:{type:Object,default:null},isStarred:{type:Boolean,default:!1}},emits:["star","install","update","uninstall","help","edit","view-task","cancel-install"],setup(r,{emit:m}){return(v,i)=>(a(),n("div",Ot,[e("div",Rt,[e("img",{src:r.prompt.icon||oe,alt:r.prompt.name,class:"card-icon"},null,8,Qt),e("div",Zt,[e("div",Vt,[e("h3",{class:"card-title",title:r.prompt.name},c(r.prompt.name),9,Yt),e("button",{onClick:i[0]||(i[0]=H(g=>v.$emit("star"),["stop"])),class:Q(["p-1.5 rounded-full transition-colors flex-shrink-0",r.isStarred?"bg-yellow-400/20 text-yellow-500":"text-gray-400 hover:text-yellow-500"])},[r.isStarred?(a(),A(bt,{key:0,class:"w-5 h-5"})):(a(),A(kt,{key:1,class:"w-5 h-5"}))],2)]),e("div",_t,[r.prompt.is_installed?(a(),n("span",Ft,"Installed")):p("",!0),r.prompt.author?(a(),n("span",Gt,"by "+c(r.prompt.author),1)):p("",!0),r.prompt.category?(a(),n("span",Bt,c(r.prompt.category),1)):p("",!0),r.prompt.version?(a(),n("span",Wt,"v"+c(r.prompt.version),1)):p("",!0)])])]),e("div",qt,[e("p",{class:"card-description",title:r.prompt.description},c(r.prompt.description),9,Ht)]),r.prompt.repository?(a(),n("div",Kt,[y(wt,{class:"w-3 h-3"}),e("span",{class:"truncate",title:`From: ${r.prompt.repository}`},c(r.prompt.repository),9,Jt)])):p("",!0),e("div",Xt,[e("div",te,[r.task?(a(),A(zt,{key:0,task:r.task,onView:i[1]||(i[1]=g=>v.$emit("view-task",r.task.id)),onCancel:i[2]||(i[2]=g=>v.$emit("cancel-install"))},null,8,["task"])):(a(),n("div",ee,[r.prompt.is_installed?r.prompt.update_available?(a(),n("button",{key:1,onClick:i[4]||(i[4]=g=>v.$emit("update",r.prompt)),class:"btn btn-warning w-full"},[y(Pt,{class:"w-4 h-4 mr-2"}),i[9]||(i[9]=b("Update "))])):(a(),n("button",{key:2,onClick:i[5]||(i[5]=g=>v.$emit("edit",r.prompt)),class:"btn btn-secondary w-full"},[y(xt,{class:"w-4 h-4 mr-2"}),i[10]||(i[10]=b("Edit "))])):(a(),n("button",{key:0,onClick:i[3]||(i[3]=g=>v.$emit("install",r.prompt)),class:"btn btn-primary w-full"},[y(jt,{class:"w-4 h-4 mr-2"}),i[8]||(i[8]=b("Install "))]))]))]),e("div",se,[r.prompt.has_readme?(a(),n("button",{key:0,onClick:i[6]||(i[6]=g=>v.$emit("help",r.prompt)),class:"btn btn-secondary p-2",title:"Help"},[y(Lt,{class:"w-4 h-4"})])):p("",!0),r.prompt.is_installed?(a(),n("button",{key:1,onClick:i[7]||(i[7]=g=>v.$emit("uninstall",r.prompt)),class:"btn btn-danger-outline p-2",title:"Uninstall"},[y(K,{class:"w-4 h-4"})])):p("",!0)])])]))}},ae=q(le,[["__scopeId","data-v-be50f213"]]),ne={class:"space-y-6"},ie={class:"border-b border-gray-200 dark:border-gray-700"},re={class:"-mb-px flex space-x-6"},de={key:0},ue={class:"flex justify-between items-center mb-4"},ce={class:"flex gap-2"},pe={class:"space-y-4"},me={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},ye={class:"relative lg:col-span-1"},ve={class:"grid grid-cols-1 sm:grid-cols-3 lg:col-span-3 gap-4"},ge=["value"],Me=["value"],fe={class:"flex items-center gap-2"},be=["value"],ke={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},we={key:1,class:"empty-state-card"},je={key:2},xe={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},Le={key:0,class:"flex justify-between items-center mt-6"},Ne=["disabled"],Ae={class:"text-sm text-gray-600 dark:text-gray-400"},Se=["disabled"],he={key:1},Ie={class:"flex justify-between items-center mb-4"},Ce={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},De={class:"flex items-center gap-x-4"},$e={key:0},Pe=["required"],ze={key:1},Te=["required"],Ue={key:1,class:"text-center p-4"},Ee={key:2,class:"empty-state-card"},Oe={key:3,class:"space-y-4"},Re={class:"font-semibold"},Qe={class:"text-sm text-gray-500"},Ze={class:"text-xs text-gray-400"},Ve={class:"flex items-center gap-2"},Ye=["onClick"],_e=["onClick"],Fe={__name:"PromptsManagement",setup(r){const m=Nt(),v=At(),i=St(),g=ht(),{on:J,off:X}=Ct(),{promptFilters:l}=m,{promptZooRepositories:Z,isLoadingPromptZooRepositories:tt,zooPrompts:C,isLoadingZooPrompts:et}=R(m),{systemPrompts:V,isLoading:st}=R(g),{tasks:ot}=R(v),k=x("zoo"),d=x({type:"git",name:"",url:"",path:""}),S=x(!1),w=x(null),h=x(JSON.parse(localStorage.getItem("starredPrompts")||"[]"));let Y=null;const U=x(null),D=f({get:()=>l.currentPage,set:o=>{l.currentPage=o}}),E=f(()=>C.value.total||0),_=f(()=>C.value.pages||1),lt=f(()=>{if(E.value===0)return"Showing 0-0 of 0";const o=(l.currentPage-1)*l.pageSize+1,t=Math.min(l.currentPage*l.pageSize,E.value);return`Showing ${o}-${t} of ${E.value}`});async function I(){const o={page:l.currentPage,page_size:l.pageSize,sort_by:l.sortKey,sort_order:l.sortOrder,category:l.selectedCategory!=="All"?l.selectedCategory:void 0,repository:l.selectedRepository!=="All"?l.selectedRepository:void 0,search_query:l.searchQuery||void 0,installation_status:l.installationStatusFilter!=="All"?l.installationStatusFilter:void 0};await m.fetchZooPrompts(o)}const F=f(()=>{const o=new Map;return(ot.value||[]).forEach(t=>{var s;if((s=t==null?void 0:t.name)!=null&&s.startsWith("Installing prompt: ")&&(t.status==="running"||t.status==="pending")){const j=t.name.replace("Installing prompt: ","");o.set(j,t)}}),(C.value.items||[]).map(t=>({...t,task:o.get(t.folder_name)||null}))});function at(){clearTimeout(Y),Y=setTimeout(()=>{l.currentPage!==1?l.currentPage=1:I()},300)}P(()=>[l.sortKey,l.sortOrder,l.selectedCategory,l.installationStatusFilter,l.selectedRepository],()=>{l.currentPage!==1?l.currentPage=1:I()}),P(()=>l.searchQuery,at),P(()=>l.currentPage,I),P(h,o=>{localStorage.setItem("starredPrompts",JSON.stringify(o))},{deep:!0}),It(()=>{g.fetchPrompts(),m.fetchPromptZooRepositories(),I(),J("task:completed",G)}),Dt(()=>{X("task:completed",G)});const $=f(()=>Array.isArray(Z.value)?[...Z.value].sort((o,t)=>(o.name||"").localeCompare(t.name||"")):[]),nt=f(()=>["All","Starred",...C.value.categories||[]]),it=[{value:"name",label:"Name"},{value:"author",label:"Author"},{value:"last_update_date",label:"Last Updated"},{value:"creation_date",label:"Creation Date"}];function rt(o){return o?new Date(o).toLocaleString():"Never"}async function dt(){if(!d.value.name){i.addNotification("Repository name is required.","warning");return}const o={name:d.value.name};d.value.type==="git"?o.url=d.value.url:o.path=d.value.path,w.value="add";try{await m.addPromptZooRepository(o),d.value={type:"git",name:"",url:"",path:""},S.value=!1}finally{w.value=null}}async function ut(o){w.value=o.id;try{await m.pullPromptZooRepository(o.id)}finally{w.value=null}}async function ct(o){if(await i.showConfirmation({title:`Delete Repository '${o.name}'?`})){w.value=o.id;try{await m.deletePromptZooRepository(o.id)}finally{w.value=null}}}async function pt(o){await m.installZooPrompt({repository:o.repository,folder_name:o.folder_name})}async function mt(o){const t=V.value.find(s=>s.name===o.name);t&&await i.showConfirmation({title:`Uninstall '${o.name}'?`,message:"This will remove the prompt from the system."})&&(await m.deleteSystemPrompt(t.id),await I())}async function yt(o){const t=await m.fetchPromptReadme(o.repository,o.folder_name);i.openModal("sourceViewer",{title:`README: ${o.name}`,content:t,language:"markdown"})}function vt(o){const t=h.value.indexOf(o);t>-1?h.value.splice(t,1):h.value.push(o)}function gt(){i.openModal("generatePrompt",{isSystemPrompt:!0,onTaskSubmitted:o=>{U.value=o}})}function G(o){o&&o.id===U.value&&(U.value=null,i.isModalOpen("tasksManager")&&i.closeModal("tasksManager"),o.status==="completed"&&o.result?O(o.result):i.addNotification("Prompt generation did not complete successfully.","warning"))}async function Mt(o){const t=V.value.find(s=>s.name===o.name);t&&await m.updateSystemPromptFromZoo(t.id)}function O(o){i.openModal("editPrompt",{prompt:{...o},isSystemPrompt:!0})}async function ft(){const o=await m.refreshZooCache();o&&i.openModal("tasksManager",{initialTaskId:o.id})}return(o,t)=>(a(),n("div",ne,[e("div",ie,[e("nav",re,[e("button",{onClick:t[0]||(t[0]=s=>k.value="zoo"),class:Q(["tab-button",k.value==="zoo"?"active":"inactive"])},"Zoo",2),e("button",{onClick:t[1]||(t[1]=s=>k.value="source"),class:Q(["tab-button",k.value==="source"?"active":"inactive"])},"Repositories",2)])]),k.value==="zoo"?(a(),n("section",de,[e("div",ue,[t[18]||(t[18]=e("h3",{class:"text-xl font-semibold"},"Prompts Zoo",-1)),e("div",ce,[e("button",{onClick:ft,class:"btn btn-secondary",title:"Refresh Zoo Cache from all sources"},[y(B,{class:"w-4 h-4"})]),e("button",{onClick:gt,class:"btn btn-secondary"},[y($t,{class:"w-4 h-4 mr-2"}),t[17]||(t[17]=b(" Generate with AI "))]),e("button",{onClick:t[2]||(t[2]=s=>O({})),class:"btn btn-primary"},"Create New Prompt")])]),e("div",pe,[e("div",me,[e("div",ye,[M(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>u(l).searchQuery=s),type:"text",placeholder:"Search Prompts...",class:"input-field w-full pl-10"},null,512),[[z,u(l).searchQuery]]),t[19]||(t[19]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),e("div",ve,[M(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>u(l).installationStatusFilter=s),class:"input-field"},t[20]||(t[20]=[e("option",{value:"All"},"All Statuses",-1),e("option",{value:"Installed"},"Installed",-1),e("option",{value:"Uninstalled"},"Uninstalled",-1)]),512),[[T,u(l).installationStatusFilter]]),M(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>u(l).selectedCategory=s),class:"input-field"},[(a(!0),n(L,null,N(nt.value,s=>(a(),n("option",{key:s,value:s},c(s),9,ge))),128))],512),[[T,u(l).selectedCategory]]),M(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>u(l).selectedRepository=s),class:"input-field"},[t[21]||(t[21]=e("option",{value:"All"},"All Sources",-1)),(a(!0),n(L,null,N($.value,s=>(a(),n("option",{key:s.id,value:s.name},c(s.name),9,Me))),128))],512),[[T,u(l).selectedRepository]])])]),e("div",fe,[M(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>u(l).sortKey=s),class:"input-field w-48"},[(a(),n(L,null,N(it,s=>e("option",{key:s.value,value:s.value},"Sort by "+c(s.label),9,be)),64))],512),[[T,u(l).sortKey]]),e("button",{onClick:t[8]||(t[8]=s=>u(l).sortOrder=u(l).sortOrder==="asc"?"desc":"asc"),class:"btn btn-secondary p-2"},[u(l).sortOrder==="asc"?(a(),A(Et,{key:0,class:"w-5 h-5"})):(a(),A(Ut,{key:1,class:"w-5 h-5"}))])]),u(et)||u(st)?(a(),n("div",ke,[(a(),n(L,null,N(6,s=>y(Tt,{key:s})),64))])):F.value.length===0?(a(),n("div",we,t[22]||(t[22]=[e("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(a(),n("div",je,[e("div",xe,[(a(!0),n(L,null,N(F.value,s=>(a(),A(ae,{key:s.id||`${s.repository}/${s.folder_name}`,prompt:s,task:s.task,"is-starred":h.value.includes(s.name),onStar:j=>vt(s.name),onInstall:pt,onUninstall:mt,onHelp:yt,onUpdate:j=>Mt(s),onEdit:j=>O(s)},null,8,["prompt","task","is-starred","onStar","onUpdate","onEdit"]))),128))]),_.value>1?(a(),n("div",Le,[e("button",{onClick:t[9]||(t[9]=s=>D.value--),disabled:D.value===1,class:"btn btn-secondary"},"Previous",8,Ne),e("span",Ae,c(lt.value),1),e("button",{onClick:t[10]||(t[10]=s=>D.value++),disabled:D.value>=_.value,class:"btn btn-secondary"},"Next",8,Se)])):p("",!0)]))])])):p("",!0),k.value==="source"?(a(),n("section",he,[e("div",Ie,[t[23]||(t[23]=e("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),e("button",{onClick:t[11]||(t[11]=s=>S.value=!S.value),class:"btn btn-primary"},c(S.value?"Cancel":"Add"),1)]),S.value?(a(),n("div",Ce,[e("form",{onSubmit:H(dt,["prevent"]),class:"space-y-4"},[e("div",De,[e("label",null,[M(e("input",{type:"radio","onUpdate:modelValue":t[12]||(t[12]=s=>d.value.type=s),value:"git",class:"radio-input"},null,512),[[W,d.value.type]]),t[24]||(t[24]=b(" Git"))]),e("label",null,[M(e("input",{type:"radio","onUpdate:modelValue":t[13]||(t[13]=s=>d.value.type=s),value:"local",class:"radio-input"},null,512),[[W,d.value.type]]),t[25]||(t[25]=b(" Local"))])]),e("div",null,[t[26]||(t[26]=e("label",null,"Name",-1)),M(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>d.value.name=s),type:"text",class:"input-field",required:""},null,512),[[z,d.value.name]])]),d.value.type==="git"?(a(),n("div",$e,[t[27]||(t[27]=e("label",null,"URL",-1)),M(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>d.value.url=s),type:"url",class:"input-field",required:d.value.type==="git"},null,8,Pe),[[z,d.value.url]])])):p("",!0),d.value.type==="local"?(a(),n("div",ze,[t[28]||(t[28]=e("label",null,"Path",-1)),M(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>d.value.path=s),type:"text",class:"input-field",required:d.value.type==="local"},null,8,Te),[[z,d.value.path]])])):p("",!0),t[29]||(t[29]=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"btn btn-primary"},"Add")],-1))],32)])):p("",!0),u(tt)?(a(),n("div",Ue,"Loading...")):!$.value||$.value.length===0?(a(),n("div",Ee,t[30]||(t[30]=[e("p",null,"No repositories added.",-1)]))):(a(),n("div",Oe,[(a(!0),n(L,null,N($.value,s=>(a(),n("div",{key:s.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between"},[e("div",null,[e("p",Re,c(s.name),1),e("p",Qe,c(s.url),1),e("p",Ze,"Pulled: "+c(rt(s.last_pulled_at)),1)]),e("div",Ve,[e("button",{onClick:j=>ut(s),class:"btn btn-secondary btn-sm"},[y(B,{class:"w-4 h-4 mr-1"}),b(c(s.type==="git"?"Pull":"Rescan"),1)],8,Ye),s.is_deletable?(a(),n("button",{key:0,onClick:j=>ct(s),class:"btn btn-danger btn-sm"},[y(K,{class:"w-4 h-4"})],8,_e)):p("",!0)])]))),128))]))])):p("",!0)]))}},Ke=q(Fe,[["__scopeId","data-v-224b0af2"]]);export{Ke as default};
