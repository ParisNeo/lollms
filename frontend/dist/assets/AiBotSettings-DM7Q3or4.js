import{c7 as j,ae as G,a as D,c1 as C,r as g,c as V,o as z,w as M,b as l,d as i,h as e,i as k,P as E,n as f,g as p,l as n,c2 as w,F,m as N,t as m,v as _,j as $,W as K}from"./index--9PGqaVf.js";const O={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},H={key:0,class:"p-6 text-center"},J={class:"space-y-8"},R={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},W={class:"space-y-6 pt-6 border-t dark:border-gray-600"},q=["value"],Q=["value"],X={key:0},Y={class:"space-y-6 pt-6 border-t dark:border-gray-600"},Z={class:"flex items-center justify-between"},tt=["disabled"],et={key:0,class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ot={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},at={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},st={key:0,class:"space-y-4"},lt={key:0},it={key:1},nt={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},rt={class:"flex justify-end"},dt=["disabled"],ut={key:2,class:"p-6 text-center"},pt={class:"text-gray-500"},bt={__name:"AiBotSettings",setup(mt){const r=j(),c=G(),b=D(),{globalSettings:y,aiBotSettings:d,isLoadingAiBotSettings:U}=C(r),{availableLollmsModels:h,publicPersonalities:S}=C(c),o=g({ai_bot_enabled:!1,ai_bot_system_prompt:"",lollms_model_name:"",active_personality_id:"",ai_bot_auto_post:!1,ai_bot_post_interval:24,ai_bot_content_mode:"static_text",ai_bot_static_content:"",ai_bot_file_path:"",ai_bot_generation_prompt:"Generate an interesting and engaging social media post based on the provided context. Keep it under 500 characters."}),v=g(!1),u=g(!1),x=g(!1);let P="{}";const A=V(()=>y.value.filter(s=>s.category==="AI Bot")),L=V(()=>S.value.map(s=>({id:s.id,name:`${s.name} (by ${s.author})`})));z(()=>{y.value.length===0&&r.fetchGlobalSettings(),d.value||r.fetchAiBotSettings(),h.value.length===0&&c.fetchAdminAvailableLollmsModels(),S.value.length===0&&c.fetchPersonalities()}),M([y,d],B,{deep:!0}),M(o,s=>{x.value=JSON.stringify(s)!==P},{deep:!0});function B(){const s={...o.value};A.value.length>0&&A.value.forEach(t=>{s[t.key]=t.value}),d.value&&(s.lollms_model_name=d.value.lollms_model_name,s.active_personality_id=d.value.active_personality_id),o.value=s,P=JSON.stringify(o.value),x.value=!1}async function T(){v.value=!0;try{const s={ai_bot_enabled:o.value.ai_bot_enabled,ai_bot_system_prompt:o.value.ai_bot_system_prompt,ai_bot_auto_post:o.value.ai_bot_auto_post,ai_bot_post_interval:parseFloat(o.value.ai_bot_post_interval),ai_bot_content_mode:o.value.ai_bot_content_mode,ai_bot_static_content:o.value.ai_bot_static_content,ai_bot_file_path:o.value.ai_bot_file_path,ai_bot_generation_prompt:o.value.ai_bot_generation_prompt},t={lollms_model_name:o.value.lollms_model_name,active_personality_id:o.value.active_personality_id};await Promise.all([r.updateGlobalSettings(s),r.updateAiBotSettings(t)]),b.addNotification("Settings saved successfully","success"),B()}catch{b.addNotification("Failed to save settings","error")}finally{v.value=!1}}async function I(){if(confirm("This will force the bot to generate and publish a post immediately using the current settings. Continue?")){u.value=!0;try{await K.post("/api/admin/trigger-post"),b.addNotification("Post generation task started!","success")}catch(s){console.error(s),b.addNotification("Failed to trigger post.","error")}finally{u.value=!1}}}return(s,t)=>(i(),l("div",O,[t[29]||(t[29]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," AI Bot Settings "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure the automated AI assistant that responds to @lollms mentions and auto-posts content. ")],-1)),k(U)?(i(),l("div",H,"Loading settings...")):Object.keys(o.value).length?(i(),l("form",{key:1,onSubmit:E(T,["prevent"]),class:"p-6"},[e("div",J,[e("div",R,[t[10]||(t[10]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable AI Bot Responses"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Allow the bot to reply to @lollms mentions.")],-1)),e("button",{onClick:t[0]||(t[0]=a=>o.value.ai_bot_enabled=!o.value.ai_bot_enabled),type:"button",class:f([o.value.ai_bot_enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:f([o.value.ai_bot_enabled?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),e("div",W,[e("div",null,[t[12]||(t[12]=e("label",{for:"bot-model",class:"block text-sm font-medium"},"Bot Model",-1)),n(e("select",{id:"bot-model","onUpdate:modelValue":t[1]||(t[1]=a=>o.value.lollms_model_name=a),class:"input-field mt-1"},[t[11]||(t[11]=e("option",{value:""},"-- Select a Model --",-1)),(i(!0),l(F,null,N(k(h),a=>(i(),l("option",{key:a.id,value:a.id},m(a.name),9,q))),128))],512),[[w,o.value.lollms_model_name]]),t[13]||(t[13]=e("p",{class:"mt-1 text-xs text-gray-500"},"The model the bot will use for all system-level generations.",-1))]),e("div",null,[t[15]||(t[15]=e("label",{for:"bot-personality",class:"block text-sm font-medium"},"Bot Personality",-1)),n(e("select",{id:"bot-personality","onUpdate:modelValue":t[2]||(t[2]=a=>o.value.active_personality_id=a),class:"input-field mt-1"},[t[14]||(t[14]=e("option",{value:""},"-- Use Default System Prompt --",-1)),(i(!0),l(F,null,N(L.value,a=>(i(),l("option",{key:a.id,value:a.id},m(a.name),9,Q))),128))],512),[[w,o.value.active_personality_id]]),t[16]||(t[16]=e("p",{class:"mt-1 text-xs text-gray-500"},"Select a personality to define the bot's behavior.",-1))]),o.value.active_personality_id?p("",!0):(i(),l("div",X,[t[17]||(t[17]=e("label",{for:"bot-prompt",class:"block text-sm font-medium"},"Default System Prompt",-1)),n(e("textarea",{id:"bot-prompt","onUpdate:modelValue":t[3]||(t[3]=a=>o.value.ai_bot_system_prompt=a),rows:"3",class:"input-field mt-1"},null,512),[[_,o.value.ai_bot_system_prompt]])]))]),e("div",Y,[e("div",Z,[t[20]||(t[20]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Auto-Posting Feed",-1)),o.value.ai_bot_auto_post?(i(),l("button",{key:0,type:"button",onClick:I,disabled:u.value,class:"btn btn-secondary btn-sm flex items-center gap-2"},[u.value?(i(),l("svg",et,t[18]||(t[18]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(i(),l("svg",ot,t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))),$(" "+m(u.value?"Generating...":"Trigger Post Now"),1)],8,tt)):p("",!0)]),e("div",at,[t[21]||(t[21]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable Auto-Posting"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"The bot will post to the main feed periodically based on provided material.")],-1)),e("button",{onClick:t[4]||(t[4]=a=>o.value.ai_bot_auto_post=!o.value.ai_bot_auto_post),type:"button",class:f([o.value.ai_bot_auto_post?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:f([o.value.ai_bot_auto_post?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),o.value.ai_bot_auto_post?(i(),l("div",st,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium"},"Posting Interval (Hours)",-1)),n(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=a=>o.value.ai_bot_post_interval=a),min:"1",step:"0.5",class:"input-field mt-1"},null,512),[[_,o.value.ai_bot_post_interval]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium"},"Content Source",-1)),n(e("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>o.value.ai_bot_content_mode=a),class:"input-field mt-1"},t[23]||(t[23]=[e("option",{value:"static_text"},"Manual Text (Knowledge Base)",-1),e("option",{value:"file"},"File Path (Server Side)",-1)]),512),[[w,o.value.ai_bot_content_mode]])]),o.value.ai_bot_content_mode==="static_text"?(i(),l("div",lt,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium"},"Knowledge Base Material",-1)),n(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=a=>o.value.ai_bot_static_content=a),rows:"6",class:"input-field mt-1",placeholder:"Paste interesting facts, news, or context here..."},null,512),[[_,o.value.ai_bot_static_content]])])):p("",!0),o.value.ai_bot_content_mode==="file"?(i(),l("div",it,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium"},"Absolute File Path",-1)),n(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=a=>o.value.ai_bot_file_path=a),class:"input-field mt-1",placeholder:"/path/to/interesting_content.txt"},null,512),[[_,o.value.ai_bot_file_path]])])):p("",!0),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium"},"Generation Prompt",-1)),n(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=a=>o.value.ai_bot_generation_prompt=a),rows:"3",class:"input-field mt-1"},null,512),[[_,o.value.ai_bot_generation_prompt]]),t[28]||(t[28]=e("p",{class:"mt-1 text-xs text-gray-500"},"Instructions for the AI on how to use the material to create a post.",-1))])])):p("",!0)])]),e("div",nt,[e("div",rt,[e("button",{type:"submit",class:"btn btn-primary",disabled:v.value||!x.value},m(v.value?"Saving...":"Save Settings"),9,dt)])])],32)):(i(),l("div",ut,[e("p",pt,m(k(r).isLoadingSettings?"Loading settings...":"Could not load AI Bot settings."),1)]))]))}};export{bt as default};
