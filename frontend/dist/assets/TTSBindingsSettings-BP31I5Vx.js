import{c7 as X,a as Y,c1 as Z,r as b,c as $,w as F,o as ee,b as o,d as l,g as m,h as t,t as d,l as T,j as C,v as E,c2 as j,F as v,m as x,i as B,$ as te,q as O,b$ as ne,c0 as se,n as g,P as U,e as ae,H as le}from"./index--9PGqaVf.js";const ie={class:"space-y-8"},oe={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},re={class:"text-xl font-semibold mb-4"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue=["disabled"],ce=["value"],me={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},fe={class:"text-sm text-gray-600 dark:text-gray-400"},ve=["for"],ge={key:0,class:"text-red-500"},ye=["id","onUpdate:modelValue"],_e=["value"],pe={key:1},be={class:"relative"},xe=["type","id","onUpdate:modelValue","required","placeholder"],he=["onClick","title"],ke={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},we={class:"flex-grow flex flex-col pr-4"},Te={class:"text-sm text-gray-500 dark:text-gray-400"},Ce=["onClick"],Se={class:"text-xs text-gray-500 mt-1"},Be={key:1,class:"mt-6 border-t dark:border-gray-700 pt-6"},Ae={class:"grid grid-cols-1 gap-4"},$e={class:"flex justify-between items-start mb-3"},Me={class:"font-bold text-md"},De={class:"text-sm text-gray-600 dark:text-gray-400"},Ne={key:0,class:"space-y-3 mb-4"},Ve={class:"block text-xs font-medium uppercase text-gray-500 dark:text-gray-400 mb-1"},Fe=["onUpdate:modelValue","placeholder"],Ee={key:1,class:"flex items-center gap-2"},je=["onClick"],Oe={class:"text-sm"},Ue={class:"flex justify-end"},qe=["onClick"],Le={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Pe={class:"flex justify-end gap-3"},ze=["disabled"],Ge={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},Je={class:"flex items-center gap-4"},He=["value"],Ie={key:0,class:"text-center p-6"},Re={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},Ke={key:2,class:"space-y-4"},Qe={class:"flex-grow"},We={class:"flex justify-between items-center"},Xe={class:"flex items-center gap-3"},Ye={class:"font-bold text-lg text-gray-900 dark:text-white"},Ze=["onClick","title"],et={class:"flex gap-3"},tt=["onClick"],nt=["onClick"],st={class:"text-sm text-gray-500 dark:text-gray-400"},at={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},lt={key:0},it={class:"font-semibold capitalize"},ot={key:0},rt={key:1},dt={key:0},ut={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},ct=["onClick"],vt={__name:"TTSBindingsSettings",setup(mt){const u=X(),y=Y(),{ttsBindings:M,availableTtsBindingTypes:w,isLoadingTtsBindings:q,globalSettings:L}=Z(u),h=b(!1),_=b(null),S=b(!1),p=b({}),A=b("mixed"),c=b({}),D=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),i=b(D()),k=$(()=>_.value!==null),f=$(()=>i.value.name?w.value.find(a=>a.binding_name===i.value.name):null),P=$(()=>{if(!f.value)return[];const a=f.value.input_parameters||[],n=new Set(a.map(s=>s.name)),e=Object.keys(i.value.config||{}).filter(s=>!n.has(s)&&s!=="model_name").map(s=>({name:s,type:typeof i.value.config[s]=="boolean"?"bool":typeof i.value.config[s]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...a.filter(s=>s.name!=="model_name"),...e]});F(L,a=>{if(Array.isArray(a)){const n=a.find(e=>e.key==="tts_model_display_mode");n&&(A.value=n.value)}},{deep:!0,immediate:!0});function z(a){const n=a.target.value;A.value=n,u.updateGlobalSettings({tts_model_display_mode:n})}F(()=>i.value.name,(a,n)=>{if(a!==n&&!k.value){const e=w.value.find(r=>r.binding_name===a),s={};e&&e.input_parameters&&e.input_parameters.forEach(r=>{s[r.name]=r.default}),i.value.config=s}}),ee(()=>{u.fetchTtsBindings(),u.fetchAvailableTtsBindingTypes(),u.fetchGlobalSettings()});function N(){_.value=null,i.value=D(),p.value={},c.value={},h.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function G(a){_.value=a,i.value=JSON.parse(JSON.stringify(a)),i.value.config||(i.value.config={}),p.value={};const n=w.value.find(e=>e.binding_name===a.name);if(n&&n.commands){const e={};n.commands.forEach(s=>{e[s.name]={},s.parameters&&s.parameters.forEach(r=>{e[s.name][r.name]=r.default!==void 0?r.default:""})}),c.value=e}else c.value={};h.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function V(){h.value=!1,_.value=null}function J(a){return typeof a=="string"?a.split(",").map(n=>n.trim()).filter(n=>n):Array.isArray(a)?a.filter(n=>n):[]}async function H(){if(!i.value.alias.trim()||!i.value.name){y.addNotification("Alias and Binding Type are required fields.","warning");return}S.value=!0;try{const a={alias:i.value.alias,name:i.value.name,config:i.value.config||{},is_active:i.value.is_active,default_model_name:i.value.default_model_name||null};k.value?await u.updateTtsBinding(_.value.id,a):await u.addTtsBinding(a),V()}catch(a){console.error("Submit failed:",a.message)}finally{S.value=!1}}async function I(a){await y.showConfirmation({title:`Delete TTS Binding '${a.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await u.deleteTtsBinding(a.id)}async function R(a){await u.updateTtsBinding(a.id,{is_active:!a.is_active})}function K(a){y.openModal("manageModels",{binding:a,bindingType:"tts"})}function Q(a){const n=w.value.find(e=>e.binding_name===a);return n?n.title:a}async function W(a){if(_.value)try{y.addNotification(`Executing command '${a.title||a.name}'...`,"info");const n=c.value[a.name]||{},e=await u.executeTtsBindingCommand(_.value.id,a.name,n);e.status&&(y.addNotification("Command executed successfully.","success"),e.result&&y.showGenericModal({title:"Command Execution Result",content:JSON.stringify(e.result,null,2)}))}catch(n){console.error(n),y.addNotification(`Command execution failed: ${n.message}`,"error")}}return(a,n)=>(l(),o("div",ie,[h.value?(l(),o("div",oe,[t("h3",re,d(k.value?"Edit TTS Binding":"Add New TTS Binding"),1),t("form",{onSubmit:U(H,["prevent"]),class:"space-y-6"},[t("div",de,[t("div",null,[n[3]||(n[3]=t("label",{for:"alias",class:"block text-sm font-medium"},[C("Alias "),t("span",{class:"text-red-500"},"*")],-1)),T(t("input",{type:"text",id:"alias","onUpdate:modelValue":n[0]||(n[0]=e=>i.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_xtts",autocomplete:"off"},null,512),[[E,i.value.alias]]),n[4]||(n[4]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[n[6]||(n[6]=t("label",{for:"name",class:"block text-sm font-medium"},[C("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),T(t("select",{id:"name","onUpdate:modelValue":n[1]||(n[1]=e=>i.value.name=e),class:"input-field mt-1",required:"",disabled:k.value},[n[5]||(n[5]=t("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),o(v,null,x(B(w),e=>(l(),o("option",{key:e.binding_name,value:e.binding_name},d(e.title),9,ce))),128))],8,ue),[[j,i.value.name]])])]),f.value?(l(),o("div",me,[t("p",fe,d(f.value.description),1),(l(!0),o(v,null,x(P.value,e=>(l(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[C(d(e.name.replace(/_/g," "))+" ",1),e.mandatory?(l(),o("span",ge,"*")):m("",!0)],8,ve),e.options&&e.options.length>0?T((l(),o("select",{key:0,id:`param-${e.name}`,"onUpdate:modelValue":s=>i.value.config[e.name]=s,class:"input-field"},[(l(!0),o(v,null,x(J(e.options),s=>(l(),o("option",{key:s,value:s},d(s),9,_e))),128))],8,ye)),[[j,i.value.config[e.name]]]):["str","int","float"].includes(e.type)?(l(),o("div",pe,[t("div",be,[T(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!p.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":s=>i.value.config[e.name]=s,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,xe),[[te,i.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(l(),o("button",{key:0,type:"button",onClick:s=>p.value[e.name]=!p.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:p.value[e.name]?"Hide":"Show"},[p.value[e.name]?(l(),O(ne,{key:0,class:"w-5 h-5"})):(l(),O(se,{key:1,class:"w-5 h-5"}))],8,he)):m("",!0)])])):e.type==="bool"?(l(),o("div",ke,[t("span",we,[t("span",Te,d(e.description),1)]),t("button",{onClick:s=>i.value.config[e.name]=!i.value.config[e.name],type:"button",class:g([i.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:g([i.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,Ce)])):m("",!0),t("p",Se,d(e.description),1)]))),128))])):m("",!0),k.value&&f.value&&f.value.commands&&f.value.commands.length>0?(l(),o("div",Be,[n[7]||(n[7]=t("h4",{class:"text-lg font-semibold mb-4"},"Binding Commands",-1)),t("div",Ae,[(l(!0),o(v,null,x(f.value.commands,e=>(l(),o("div",{key:e.name,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600"},[t("div",$e,[t("div",null,[t("h5",Me,d(e.title||e.name),1),t("p",De,d(e.description),1)])]),e.parameters&&e.parameters.length>0?(l(),o("div",Ne,[(l(!0),o(v,null,x(e.parameters,s=>(l(),o("div",{key:s.name},[t("label",Ve,d(s.name),1),s.type!=="bool"?T((l(),o("input",{key:0,type:"text","onUpdate:modelValue":r=>c.value[e.name][s.name]=r,class:"input-field text-sm",placeholder:s.default},null,8,Fe)),[[E,c.value[e.name][s.name]]]):(l(),o("div",Ee,[t("button",{onClick:r=>c.value[e.name][s.name]=!c.value[e.name][s.name],type:"button",class:g([c.value[e.name][s.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-5 w-9 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:g([c.value[e.name][s.name]?"translate-x-4":"translate-x-0","pointer-events-none inline-block h-4 w-4 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,je),t("span",Oe,d(s.description),1)]))]))),128))])):m("",!0),t("div",Ue,[t("button",{type:"button",onClick:s=>W(e),class:"btn btn-primary btn-sm"},"Execute",8,qe)])]))),128))])])):m("",!0),t("div",Le,[n[8]||(n[8]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this TTS service will not be available.")],-1)),t("button",{onClick:n[2]||(n[2]=e=>i.value.is_active=!i.value.is_active),type:"button",class:g([i.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:g([i.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",Pe,[t("button",{type:"button",onClick:V,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:S.value},d(S.value?"Saving...":k.value?"Save Changes":"Add Binding"),9,ze)])],32)])):m("",!0),t("div",null,[t("div",Ge,[n[11]||(n[11]=t("h2",{class:"text-2xl font-bold"},"TTS Bindings",-1)),t("div",Je,[t("div",null,[n[10]||(n[10]=t("label",{for:"tts-model-display-mode",class:"block text-xs font-medium text-gray-500 dark:text-gray-400"},"Model Display Mode",-1)),t("select",{id:"tts-model-display-mode",value:A.value,onChange:z,class:"input-field mt-1"},n[9]||(n[9]=[t("option",{value:"mixed"},"Mixed (Alias or Original)",-1),t("option",{value:"aliased"},"Aliased Only",-1),t("option",{value:"original"},"Original Names Only",-1)]),40,He)]),h.value?m("",!0):(l(),o("button",{key:0,onClick:N,class:"btn btn-primary self-end"},"+ Add New TTS Binding"))])]),B(q)?(l(),o("div",Ie,"Loading TTS bindings...")):B(M).length===0&&!h.value?(l(),o("div",Re,[n[12]||(n[12]=t("p",null,"No TTS bindings configured yet.",-1)),t("button",{onClick:N,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(l(),o("div",Ke,[(l(!0),o(v,null,x(B(M),e=>(l(),o("div",{key:e.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[t("div",Qe,[t("div",We,[t("div",Xe,[t("h4",Ye,d(e.alias),1),t("button",{onClick:U(s=>R(e),["stop"]),type:"button",class:g([e.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"]),title:e.is_active?"Deactivate":"Activate"},[t("span",{class:g([e.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],10,Ze)]),t("div",et,[t("button",{onClick:s=>G(e),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,tt),t("button",{onClick:s=>I(e),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,nt)])]),t("p",st,d(Q(e.name)),1),t("div",at,[(l(!0),o(v,null,x(e.config,(s,r)=>(l(),o(v,{key:r},[s&&r!=="model_name"?(l(),o("p",lt,[t("span",it,d(r.replace(/_/g," "))+":",1),r.includes("key")||r.includes("token")?(l(),o("span",ot,"********")):(l(),o("span",rt,d(s),1))])):m("",!0)],64))),128)),e.default_model_name?(l(),o("p",dt,[n[13]||(n[13]=t("span",{class:"font-semibold"},"Default Model:",-1)),C(" "+d(e.default_model_name),1)])):m("",!0)])]),t("div",ut,[t("button",{onClick:s=>K(e),class:"btn btn-secondary btn-sm flex items-center gap-2"},[ae(le,{class:"w-4 h-4"}),n[14]||(n[14]=C(" Manage Models "))],8,ct)])]))),128))]))])]))}};export{vt as default};
