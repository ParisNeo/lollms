import{bd as M,f as h,c as _,a as r,o as a,e as t,bo as C,t as c,F as S,b as P,bk as E,d as R,bf as j,_ as B,i as V,j as A,bv as D,bg as I,m as F,bi as T,bq as $,h as q,g as x,bj as J,bl as z,v as K}from"./index-B6Bc3z59.js";const W={class:"json-node"},H={class:"flex items-start"},Q={class:"flex-shrink-0 flex items-center",style:{"min-width":"150px"}},X={class:"font-bold text-lg"},Y={key:1,class:"w-6 h-6 mr-1 flex-shrink-0"},Z={class:"text-gray-800 dark:text-gray-200 select-all break-all"},ee={class:"ml-2 flex-grow"},te=["src"],ae={key:3,class:"text-gray-500 italic"},re={key:4,class:"text-gray-500 italic"},oe={key:5,class:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words select-all"},se={__name:"JsonNode",props:{itemKey:{type:[String,Number],required:!0},itemValue:{required:!0},level:{type:Number,default:0}},setup(y){const i=R(()=>B(()=>Promise.resolve().then(()=>ne),void 0)),v=y,l=h(v.level<2),f=p=>typeof p=="string"&&p.startsWith("data:image/")&&p.includes(";base64,"),n=_(()=>v.itemValue===null?"null":Array.isArray(v.itemValue)?"array":f(v.itemValue)?"image":typeof v.itemValue=="object"?"object":typeof v.itemValue),m=_(()=>n.value==="object"&&Object.keys(v.itemValue).length>0||n.value==="array"&&v.itemValue.length>0),b=_(()=>n.value==="array"?`[... ${v.itemValue.length} items]`:n.value==="object"?"{...}":"");function g(){m.value&&(l.value=!l.value)}return(p,O)=>(a(),r("div",W,[t("div",H,[t("div",Q,[m.value?(a(),r("button",{key:0,onClick:C(g,["prevent"]),class:"w-6 h-6 mr-1 flex items-center justify-center text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"},[t("span",X,c(l.value?"âˆ’":"+"),1)])):(a(),r("span",Y)),t("strong",Z,c(y.itemKey)+":",1)]),t("div",ee,[m.value&&!l.value?(a(),r("span",{key:0,onClick:g,class:"text-gray-500 cursor-pointer hover:underline"},c(b.value),1)):(a(),r(S,{key:1},[m.value?(a(),P(E(i),{key:0,json:y.itemValue,level:y.level+1},null,8,["json","level"])):n.value==="image"?(a(),r("img",{key:1,src:y.itemValue,alt:"Base64 Image",class:"max-w-xs max-h-48 rounded-md border border-gray-200 dark:border-gray-700 mt-1"},null,8,te)):n.value==="boolean"?(a(),r("span",{key:2,class:j([y.itemValue?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300","px-2 py-0.5 text-xs font-semibold rounded-full"])},c(y.itemValue),3)):n.value==="null"?(a(),r("span",ae,"null")):n.value==="object"||n.value==="array"?(a(),r("span",re,c(n.value==="object"?"{} (empty object)":"[] (empty array)"),1)):(a(),r("span",oe,c(y.itemValue),1))],64))])])]))}},le=M(se,[["__scopeId","data-v-36aad7d8"]]),U={__name:"JsonRenderer",props:{json:{type:[Object,Array],required:!0},level:{type:Number,default:0}},setup(y){const i=y,v=_(()=>i.json===null||typeof i.json!="object"?[]:Array.isArray(i.json)?i.json.map((f,n)=>({key:n,value:f})):Object.entries(i.json).map(([f,n])=>({key:f,value:n}))),l=_(()=>i.level>0?{paddingLeft:"20px"}:{});return(f,n)=>(a(),r("div",{class:j(["json-renderer-container w-full",{"border-l border-gray-200 dark:border-gray-700":y.level>0}]),style:D(l.value)},[(a(!0),r(S,null,V(v.value,m=>(a(),r("div",{key:m.key,class:"json-entry py-1"},[A(le,{"item-key":m.key,"item-value":m.value,level:y.level},null,8,["item-key","item-value","level"])]))),128))],6))}},ne=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"})),ie={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},de={class:"space-y-10"},ue={class:"text-lg font-medium text-gray-800 dark:text-gray-200 border-b border-gray-200 dark:border-gray-600 pb-2 mb-6"},ce={class:"space-y-8"},ye={key:0},ve=["for"],fe=["id","onUpdate:modelValue"],me={key:1},be=["for"],pe=["id","onUpdate:modelValue"],ke={key:2},ge=["for"],_e=["type","step","id","onUpdate:modelValue"],he={key:3},xe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},Se={class:"mt-2"},je=["onClick"],we={key:4},Ve={class:"flex justify-between items-center mb-1"},Oe=["for"],Ne=["onClick"],$e={key:0},Je=["id","onUpdate:modelValue"],Ce={key:1,class:"mt-2 p-4 rounded-md bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700"},Ee={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},Ae={class:"flex justify-end"},Ue=["disabled"],Ge={key:1,class:"p-6 text-center"},Le={key:2,class:"p-6 text-center"},Pe={__name:"GlobalSettings",setup(y){const i=I(),v=F(),l=h({}),f=h(!1),n=h(!1);let m="{}";const b=h({}),g=_(()=>{const o=i.globalSettings.filter(s=>s.category!=="Email Settings"&&s.category!=="Server"&&s.key!=="password_recovery_mode"),k=["Registration","Authentication","Services","Defaults","Global LLM Overrides"],u=o.reduce((s,N)=>{const w=N.category||"General";return s[w]||(s[w]=[]),s[w].push(N),s},{}),e={};return k.forEach(s=>{u[s]&&(e[s]=u[s])}),Object.keys(u).forEach(s=>{k.includes(s)||(e[s]=u[s])}),e});T(()=>{i.globalSettings.length===0?i.fetchGlobalSettings():p()}),$(()=>i.globalSettings,p,{deep:!0}),$(l,d=>{n.value=JSON.stringify(d)!==m},{deep:!0});function p(){const d={};i.globalSettings.length>0&&(i.globalSettings.forEach(o=>{if(o.type==="json"){try{d[o.key]=JSON.stringify(o.value,null,2)}catch{d[o.key]=o.value}b.value[o.key]=!1}else d[o.key]=o.value}),l.value=d,m=JSON.parse(JSON.stringify(d)),n.value=!1)}function O(d){try{return JSON.parse(l.value[d])}catch(o){return{error:"Invalid JSON format in text editor",details:o.message}}}function G(d){b.value[d]=!b.value[d]}async function L(){f.value=!0;const d=Object.values(g.value).flat(),o={};let k=!1;for(const u of d){const e=u.key;if(l.value.hasOwnProperty(e))if(u.type==="json")try{o[e]=JSON.parse(l.value[e])}catch{v.addNotification(`Invalid JSON format for '${u.description}'. Please fix it before saving.`,"error"),k=!0}else o[e]=l.value[e]}if(k){f.value=!1;return}try{await i.updateGlobalSettings(o),Object.keys(b.value).forEach(u=>b.value[u]=!1)}catch{}finally{f.value=!1}}return(d,o)=>(a(),r("div",ie,[o[4]||(o[4]=t("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," Global System Settings "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Manage application-wide settings. Changes may require users to log out and back in. ")],-1)),Object.keys(g.value).length?(a(),r("form",{key:0,onSubmit:C(L,["prevent"]),class:"p-6"},[t("div",de,[(a(!0),r(S,null,V(g.value,(k,u)=>(a(),r("div",{key:u},[t("h4",ue,c(u),1),t("div",ce,[(a(!0),r(S,null,V(k,e=>(a(),r("div",{key:e.key},[e.key==="registration_mode"?(a(),r("div",ye,[t("label",{for:e.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},c(e.description),9,ve),x(t("select",{id:e.key,"onUpdate:modelValue":s=>l.value[e.key]=s,class:"input-field mt-1"},o[0]||(o[0]=[t("option",{value:"direct"},"Direct (instantly active)",-1),t("option",{value:"admin_approval"},"Admin Approval",-1)]),8,fe),[[J,l.value[e.key]]])])):e.key==="force_model_mode"?(a(),r("div",me,[t("label",{for:e.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},c(e.description),9,be),x(t("select",{id:e.key,"onUpdate:modelValue":s=>l.value[e.key]=s,class:"input-field mt-1"},o[1]||(o[1]=[t("option",{value:"disabled"},"Disabled",-1),t("option",{value:"force_once"},"Force Once (set user preference)",-1),t("option",{value:"force_always"},"Force Always (override session)",-1)]),8,pe),[[J,l.value[e.key]]])])):["string","integer","float"].includes(e.type)?(a(),r("div",ke,[t("label",{for:e.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},c(e.description),9,ge),x(t("input",{type:e.type==="string"?"text":"number",step:e.type==="float"?"0.1":"1",id:e.key,"onUpdate:modelValue":s=>l.value[e.key]=s,class:"input-field mt-1"},null,8,_e),[[z,l.value[e.key]]])])):e.type==="boolean"?(a(),r("div",he,[t("label",xe,c(e.description),1),t("div",Se,[t("button",{onClick:s=>l.value[e.key]=!l.value[e.key],type:"button",class:j([l.value[e.key]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"])},[t("span",{class:j([l.value[e.key]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],10,je)])])):e.type==="json"?(a(),r("div",we,[t("div",Ve,[t("label",{for:e.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},c(e.description),9,Oe),t("button",{onClick:s=>G(e.key),type:"button",class:"btn btn-secondary btn-xs"},c(b.value[e.key]?"View Rendered":"Edit Raw"),9,Ne)]),b.value[e.key]?(a(),r("div",$e,[x(t("textarea",{id:e.key,"onUpdate:modelValue":s=>l.value[e.key]=s,rows:"8",class:"input-field w-full font-mono text-xs !leading-relaxed",placeholder:"Enter valid JSON here..."},null,8,Je),[[K,l.value[e.key]]])])):(a(),r("div",Ce,[A(U,{json:O(e.key)},null,8,["json"])]))])):q("",!0)]))),128))])]))),128))]),t("div",Ee,[t("div",Ae,[t("button",{type:"submit",class:"btn btn-primary",disabled:f.value||!n.value},c(f.value?"Saving...":"Save Global Settings"),9,Ue)])])],32)):E(i).isLoadingSettings?(a(),r("div",Ge,o[2]||(o[2]=[t("p",{class:"text-gray-500"},"Loading settings...",-1)]))):(a(),r("div",Le,o[3]||(o[3]=[t("p",{class:"text-gray-500"},"Could not load global settings.",-1)])))]))}};export{Pe as default};
