import{a0 as be,S as we,P as ke,q as he,p as _e,s as N,r as i,x as g,w as I,o as xe,y as Pe,z as Se,c as a,b as o,g as s,d as m,n as H,k as U,A as M,_ as Ae,h as p,j as $,v as z,F as P,i as S,t as c,e as L,B as Re,bJ as Q,f as Ce,Q as Ie,E as Ue}from"./index-D-mtVVL_.js";import{A as Me,a as $e}from"./AppCardSkeleton-BGFCR1dd.js";import"./IconArrowUpCircle-BoIecm4J.js";import"./IconGlobeAlt-BNSQ72y5.js";import"./IconPlayCircle-BYvctNKM.js";import"./IconWrenchScrewdriver-vIhvHL5o.js";const Te={class:"space-y-6"},Ve={class:"border-b border-gray-200 dark:border-gray-700"},Ze={class:"-mb-px flex space-x-6"},Ne={key:0},ze={class:"flex justify-between items-center mb-4"},Le={class:"space-y-4"},qe={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},je={class:"relative lg:col-span-1"},Be={class:"grid grid-cols-1 sm:grid-cols-3 lg:col-span-3 gap-4"},De=["value"],Ee=["value"],Fe={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},Oe={key:1,class:"empty-state-card"},Ge={key:2},Je={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},He={key:0,class:"flex justify-between items-center mt-6"},Qe=["disabled"],We={class:"text-sm text-gray-600 dark:text-gray-400"},Ke=["disabled"],Xe={key:1},Ye={class:"flex justify-between items-center mb-4"},et={key:0,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm mb-6"},tt={class:"flex items-center gap-x-4"},st={key:0},lt=["required"],ot={key:1},at=["required"],nt={key:1,class:"text-center p-4"},it={key:2,class:"empty-state-card"},rt={key:3,class:"space-y-4"},ut={class:"font-semibold"},dt={class:"text-sm text-gray-500"},pt={class:"text-xs text-gray-400"},ct={class:"flex items-center gap-2"},mt=["onClick"],vt=["onClick"],yt={__name:"PromptsManagement",setup(ft){const r=we(),W=ke(),d=he(),q=_e(),{on:K,off:X}=Pe(),{promptZooRepositories:j,isLoadingPromptZooRepositories:Y,zooPrompts:A,isLoadingZooPrompts:ee}=N(r),{systemPrompts:B,isLoading:te}=N(q),{tasks:se}=N(W),v=i("zoo"),n=i({type:"git",name:"",url:"",path:""}),b=i(!1),y=i(null),R=i(""),w=i("All"),k=i("All"),h=i("All"),D=i("name"),E=i("asc"),_=i(JSON.parse(localStorage.getItem("starredPrompts")||"[]")),u=i(1),T=i(24);let F=null;const V=i(null),le=i(null),Z=g(()=>A.value.total||0),O=g(()=>A.value.pages||1),oe=g(()=>{if(Z.value===0)return"Showing 0-0 of 0";const l=(u.value-1)*T.value+1,e=Math.min(u.value*T.value,Z.value);return`Showing ${l}-${e} of ${Z.value}`});async function x(){const l={page:u.value,page_size:T.value,sort_by:D.value,sort_order:E.value,category:w.value!=="All"?w.value:void 0,repository:h.value!=="All"?h.value:void 0,search_query:R.value||void 0,installation_status:k.value!=="All"?k.value:void 0};await r.fetchZooPrompts(l)}const G=g(()=>{const l=new Map;return(se.value||[]).forEach(e=>{var t;if((t=e==null?void 0:e.name)!=null&&t.startsWith("Installing prompt: ")&&(e.status==="running"||e.status==="pending")){const f=e.name.replace("Installing prompt: ","");l.set(f,e)}}),(A.value.items||[]).map(e=>({...e,task:l.get(e.folder_name)||null}))});function ae(){clearTimeout(F),F=setTimeout(()=>{u.value=1,x()},300)}I([D,E,w,k,h],()=>{u.value=1,x()}),I(R,ae),I(u,x),I(_,l=>{localStorage.setItem("starredPrompts",JSON.stringify(l))},{deep:!0}),xe(()=>{q.fetchPrompts(),r.fetchPromptZooRepositories(),x(),K("task:completed",J)}),Se(()=>{X("task:completed",J)});const C=g(()=>Array.isArray(j.value)?[...j.value].sort((l,e)=>(l.name||"").localeCompare(e.name||"")):[]),ne=g(()=>["All","Starred",...A.value.categories||[]]);function ie(l){return l?new Date(l).toLocaleString():"Never"}async function re(){if(!n.value.name){d.addNotification("Repository name is required.","warning");return}const l={name:n.value.name};n.value.type==="git"?l.url=n.value.url:l.path=n.value.path,y.value="add";try{await r.addPromptZooRepository(l),n.value={type:"git",name:"",url:"",path:""},b.value=!1}finally{y.value=null}}async function ue(l){y.value=l.id;try{await r.pullPromptZooRepository(l.id)}finally{y.value=null}}async function de(l){if(await d.showConfirmation({title:`Delete Repository '${l.name}'?`})){y.value=l.id;try{await r.deletePromptZooRepository(l.id)}finally{y.value=null}}}async function pe(l){await r.installZooPrompt({repository:l.repository,folder_name:l.folder_name})}async function ce(l){const e=B.value.find(t=>t.name===l.name);e&&await d.showConfirmation({title:`Uninstall '${l.name}'?`,message:"This will remove the prompt from the system."})&&(await r.deleteSystemPrompt(e.id),await x())}async function me(l){const e=await r.fetchPromptReadme(l.repository,l.folder_name);d.openModal("sourceViewer",{title:`README: ${l.name}`,content:e,language:"markdown"})}function ve(l){const e=_.value.indexOf(l);e>-1?_.value.splice(e,1):_.value.push(l)}function ye(){d.openModal("generatePrompt",{isSystemPrompt:!0,onTaskSubmitted:l=>{V.value=l}})}function J(l){l&&l.id===V.value&&(V.value=null,d.isModalOpen("tasksManager")&&d.closeModal("tasksManager"),l.status==="completed"&&l.result?ge(l.result):d.addNotification("Prompt generation did not complete successfully.","warning"))}async function fe(l){const e=B.value.find(t=>t.name===l.name);e&&await r.updateSystemPromptFromZoo(e.id)}function ge(l){le.value={...l},d.openModal("editSystemPrompt")}return(l,e)=>(o(),a("div",Te,[s("div",Ve,[s("nav",Ze,[s("button",{onClick:e[0]||(e[0]=t=>v.value="zoo"),class:H(["tab-button",v.value==="zoo"?"active":"inactive"])},"Zoo",2),s("button",{onClick:e[1]||(e[1]=t=>v.value="source"),class:H(["tab-button",v.value==="source"?"active":"inactive"])},"Repositories",2)])]),v.value==="zoo"?(o(),a("section",Ne,[s("div",ze,[e[15]||(e[15]=s("h3",{class:"text-xl font-semibold"},"Prompts Zoo",-1)),s("button",{onClick:ye,class:"btn btn-secondary"},[U(Ae,{class:"w-4 h-4 mr-2"}),e[14]||(e[14]=M(" Generate with AI"))])]),s("div",Le,[s("div",qe,[s("div",je,[p(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>R.value=t),type:"text",placeholder:"Search Prompts...",class:"input-field w-full pl-10"},null,512),[[$,R.value]]),e[16]||(e[16]=s("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[s("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),s("div",Be,[p(s("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>k.value=t),class:"input-field"},e[17]||(e[17]=[s("option",{value:"All"},"All Statuses",-1),s("option",{value:"Installed"},"Installed",-1),s("option",{value:"Uninstalled"},"Uninstalled",-1)]),512),[[z,k.value]]),p(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>w.value=t),class:"input-field"},[(o(!0),a(P,null,S(ne.value,t=>(o(),a("option",{key:t,value:t},c(t),9,De))),128))],512),[[z,w.value]]),p(s("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>h.value=t),class:"input-field"},[e[18]||(e[18]=s("option",{value:"All"},"All Sources",-1)),(o(!0),a(P,null,S(C.value,t=>(o(),a("option",{key:t.id,value:t.name},c(t.name),9,Ee))),128))],512),[[z,h.value]])])]),L(ee)||L(te)?(o(),a("div",Fe,[(o(),a(P,null,S(6,t=>U(Me,{key:t})),64))])):G.value.length===0?(o(),a("div",Oe,e[19]||(e[19]=[s("h4",{class:"font-semibold"},"No Prompts Found",-1)]))):(o(),a("div",Ge,[s("div",Je,[(o(!0),a(P,null,S(G.value,t=>(o(),Re($e,{key:t.id||`${t.repository}/${t.folder_name}`,app:t,task:t.task,"is-starred":_.value.includes(t.name),"item-type-name":"Prompt",onStar:f=>ve(t.name),onInstall:pe,onUninstall:f=>ce(t),onHelp:me,onUpdate:f=>fe(t)},null,8,["app","task","is-starred","onStar","onUninstall","onUpdate"]))),128))]),O.value>1?(o(),a("div",He,[s("button",{onClick:e[6]||(e[6]=t=>u.value--),disabled:u.value===1,class:"btn btn-secondary"},"Previous",8,Qe),s("span",We,c(oe.value),1),s("button",{onClick:e[7]||(e[7]=t=>u.value++),disabled:u.value>=O.value,class:"btn btn-secondary"},"Next",8,Ke)])):m("",!0)]))])])):m("",!0),v.value==="source"?(o(),a("section",Xe,[s("div",Ye,[e[20]||(e[20]=s("h3",{class:"text-xl font-semibold"},"Prompt Zoo Repositories",-1)),s("button",{onClick:e[8]||(e[8]=t=>b.value=!b.value),class:"btn btn-primary"},c(b.value?"Cancel":"Add"),1)]),b.value?(o(),a("div",et,[s("form",{onSubmit:Ce(re,["prevent"]),class:"space-y-4"},[s("div",tt,[s("label",null,[p(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>n.value.type=t),value:"git",class:"radio-input"},null,512),[[Q,n.value.type]]),e[21]||(e[21]=M(" Git"))]),s("label",null,[p(s("input",{type:"radio","onUpdate:modelValue":e[10]||(e[10]=t=>n.value.type=t),value:"local",class:"radio-input"},null,512),[[Q,n.value.type]]),e[22]||(e[22]=M(" Local"))])]),s("div",null,[e[23]||(e[23]=s("label",null,"Name",-1)),p(s("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>n.value.name=t),type:"text",class:"input-field",required:""},null,512),[[$,n.value.name]])]),n.value.type==="git"?(o(),a("div",st,[e[24]||(e[24]=s("label",null,"URL",-1)),p(s("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>n.value.url=t),type:"url",class:"input-field",required:n.value.type==="git"},null,8,lt),[[$,n.value.url]])])):m("",!0),n.value.type==="local"?(o(),a("div",ot,[e[25]||(e[25]=s("label",null,"Path",-1)),p(s("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>n.value.path=t),type:"text",class:"input-field",required:n.value.type==="local"},null,8,at),[[$,n.value.path]])])):m("",!0),e[26]||(e[26]=s("div",{class:"flex justify-end"},[s("button",{type:"submit",class:"btn btn-primary"},"Add")],-1))],32)])):m("",!0),L(Y)?(o(),a("div",nt,"Loading...")):!C.value||C.value.length===0?(o(),a("div",it,e[27]||(e[27]=[s("p",null,"No repositories added.",-1)]))):(o(),a("div",rt,[(o(!0),a(P,null,S(C.value,t=>(o(),a("div",{key:t.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm flex items-center justify-between"},[s("div",null,[s("p",ut,c(t.name),1),s("p",dt,c(t.url),1),s("p",pt,"Pulled: "+c(ie(t.last_pulled_at)),1)]),s("div",ct,[s("button",{onClick:f=>ue(t),class:"btn btn-secondary btn-sm"},[U(Ie,{class:"w-4 h-4 mr-1"}),M(c(t.type==="git"?"Pull":"Rescan"),1)],8,mt),t.is_deletable?(o(),a("button",{key:0,onClick:f=>de(t),class:"btn btn-danger btn-sm"},[U(Ue,{class:"w-4 h-4"})],8,vt)):m("",!0)])]))),128))]))])):m("",!0)]))}},xt=be(yt,[["__scopeId","data-v-6c553cba"]]);export{xt as default};
