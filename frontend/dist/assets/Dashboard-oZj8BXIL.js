import{l as N,s as C,c as v,a as r,b as o,d as t,k,e as i,f as c,n as S,bs as V,t as a,B as A,g as m,j as M,F as f,i as w,r as $,m as B,o as G,bt as R}from"./index-C8lUn4a8.js";import U from"./IconGpu-eajRK_JK.js";import D from"./IconHardDrive-D8cpQjpG.js";const j={class:"space-y-6"},I={class:"flex items-center justify-between"},F=["disabled"],H={key:0,class:"text-center p-8"},L={key:1,class:"space-y-6"},T={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},E={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},O={class:"flex items-center"},q={class:"mt-2 text-2xl font-bold text-gray-900 dark:text-white"},J={class:"text-sm text-gray-500 dark:text-gray-400"},K={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},Q={class:"flex items-center"},W={class:"mt-2 text-2xl font-bold text-gray-900 dark:text-white"},X={class:"text-sm text-gray-500 dark:text-gray-400"},Y={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},Z={class:"flex items-center"},tt={key:0,class:"mt-2 text-2xl font-bold text-gray-900 dark:text-white"},et={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},st={key:2,class:"mt-2 text-lg text-gray-500 dark:text-gray-400"},at={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},lt={class:"flex items-center mb-2"},rt={class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},ot={class:"font-medium text-gray-900 dark:text-white"},dt={class:"font-medium text-gray-900 dark:text-white"},nt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-3"},it={class:"flex items-center mb-2"},gt={class:"font-semibold text-gray-800 dark:text-gray-200"},ut={key:0,class:"ml-3 text-xs font-semibold px-2 py-0.5 rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300"},ct={key:1,class:"ml-2 text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"},_t={class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},mt={class:"font-medium text-gray-900 dark:text-white"},yt={class:"font-medium text-gray-900 dark:text-white"},bt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-3"},xt={class:"flex items-center mb-2"},pt={class:"font-semibold text-gray-800 dark:text-gray-200"},vt={class:"text-sm text-gray-600 dark:text-gray-300 space-y-1"},ht={class:"font-medium text-gray-900 dark:text-white"},kt={class:"font-medium text-gray-900 dark:text-white"},ft={class:"font-medium text-gray-900 dark:text-white"},wt={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-3"},Mt={key:1,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md text-center text-gray-500 dark:text-gray-400"},$t={key:2,class:"text-center p-8"},St={__name:"SystemStatus",setup(P){const _=N(),{systemStatus:l,isLoadingSystemStatus:y}=C(_),b=v(()=>{var n;return((n=l.value)==null?void 0:n.gpus)||[]}),h=v(()=>b.value.reduce((n,e)=>n+e.vram_used_gb,0)),u=v(()=>b.value.reduce((n,e)=>n+e.vram_total_gb,0)),p=v(()=>u.value>0?h.value/u.value*100:0),g=v(()=>{if(!l.value||!l.value.disks)return null;let n=l.value.disks.find(e=>e.is_data_disk);return!n&&l.value.disks.length>0&&(n=l.value.disks[0]),n}),d=n=>n==null?"N/A":`${n.toFixed(1)} GB`,x=n=>n==null?"N/A":`${n.toFixed(2)}%`;return(n,e)=>(o(),r("div",j,[t("div",I,[e[1]||(e[1]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"System Status",-1)),t("button",{onClick:e[0]||(e[0]=(...s)=>i(_).fetchSystemStatus&&i(_).fetchSystemStatus(...s)),class:"btn btn-secondary btn-sm",disabled:i(y)},[c(V,{class:S(["w-4 h-4",{"animate-spin":i(y)}])},null,8,["class"])],8,F)]),i(y)&&!i(l)?(o(),r("div",H,e[2]||(e[2]=[t("p",null,"Loading system status...",-1)]))):i(l)?(o(),r("div",L,[t("div",T,[t("div",E,[t("div",O,[c(U,{class:"w-6 h-6 mr-3 text-gray-400"}),e[3]||(e[3]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"GPU VRAM",-1))]),t("p",q,a(u.value>0?`${d(h.value)} / ${d(u.value)}`:"N/A"),1),t("p",J,a(u.value>0?`(${x(p.value)})`:"No compatible GPU found"),1)]),t("div",K,[t("div",Q,[c(A,{class:"w-6 h-6 mr-3 text-gray-400"}),e[4]||(e[4]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"CPU RAM",-1))]),t("p",W,a(d(i(l).cpu_ram_used_gb))+" / "+a(d(i(l).cpu_ram_total_gb)),1),t("p",X,"("+a(x(i(l).cpu_ram_usage_percent))+")",1)]),t("div",Y,[t("div",Z,[c(D,{class:"w-6 h-6 mr-3 text-gray-400"}),e[5]||(e[5]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"Data Disk",-1))]),g.value?(o(),r("p",tt,a(d(g.value.used_gb))+" / "+a(d(g.value.total_gb)),1)):k("",!0),g.value?(o(),r("p",et,"("+a(x(g.value.usage_percent))+")",1)):(o(),r("p",st,"No disk info"))])]),t("div",at,[t("div",lt,[c(A,{class:"w-5 h-5 mr-2 text-gray-400"}),e[6]||(e[6]=t("h4",{class:"font-semibold text-gray-800 dark:text-gray-200"},"CPU RAM Usage Details",-1))]),t("div",rt,[t("p",null,[e[7]||(e[7]=m("Available: ")),t("span",ot,a(d(i(l).cpu_ram_available_gb)),1)]),t("p",null,[e[8]||(e[8]=m("Usage: ")),t("span",dt,a(d(i(l).cpu_ram_used_gb))+" / "+a(d(i(l).cpu_ram_total_gb))+" ("+a(x(i(l).cpu_ram_usage_percent))+")",1)])]),t("div",nt,[t("div",{class:"bg-gradient-to-r from-blue-400 to-purple-500 h-2.5 rounded-full",style:M({width:i(l).cpu_ram_usage_percent+"%"})},null,4)])]),(o(!0),r(f,null,w(i(l).disks,s=>(o(),r("div",{key:s.mount_point,class:S(["p-4 rounded-lg shadow-md border-l-4",{"bg-white dark:bg-gray-800 border-transparent":!s.is_app_disk&&!s.is_data_disk,"bg-blue-50 dark:bg-blue-900/20 border-blue-500":s.is_data_disk&&!s.is_app_disk,"bg-green-50 dark:bg-green-900/20 border-green-500":s.is_app_disk&&!s.is_data_disk,"bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 border-purple-500":s.is_app_disk&&s.is_data_disk}])},[t("div",it,[c(D,{class:"w-5 h-5 mr-2 text-gray-400"}),t("h4",gt,"Disk: "+a(s.mount_point),1),s.is_data_disk?(o(),r("span",ut,"Data")):k("",!0),s.is_app_disk?(o(),r("span",ct,"App")):k("",!0)]),t("div",_t,[t("p",null,[e[9]||(e[9]=m("Available: ")),t("span",mt,a(d(s.available_gb)),1)]),t("p",null,[e[10]||(e[10]=m("Usage: ")),t("span",yt,a(d(s.used_gb))+" / "+a(d(s.total_gb))+" ("+a(x(s.usage_percent))+")",1)])]),t("div",bt,[t("div",{class:"bg-gradient-to-r from-cyan-400 to-teal-500 h-2.5 rounded-full",style:M({width:s.usage_percent+"%"})},null,4)])],2))),128)),b.value.length>0?(o(!0),r(f,{key:0},w(b.value,(s,z)=>(o(),r("div",{key:s.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md"},[t("div",xt,[c(U,{class:"w-5 h-5 mr-2 text-gray-400"}),t("h4",pt,"GPU "+a(z+1)+" Usage Details",1)]),t("div",vt,[t("p",null,[e[11]||(e[11]=m("Model: ")),t("span",ht,a(s.name),1)]),t("p",null,[e[12]||(e[12]=m("Available VRAM: ")),t("span",kt,a(d(s.vram_total_gb-s.vram_used_gb)),1)]),t("p",null,[e[13]||(e[13]=m("Usage: ")),t("span",ft,a(d(s.vram_used_gb))+" / "+a(d(s.vram_total_gb))+" ("+a(x(s.vram_usage_percent))+")",1)])]),t("div",wt,[t("div",{class:"bg-gradient-to-r from-indigo-500 to-pink-500 h-2.5 rounded-full",style:M({width:s.vram_usage_percent+"%"})},null,4)])]))),128)):(o(),r("div",Mt,e[14]||(e[14]=[t("p",null,"No NVIDIA GPU detected or pynvml library not installed on the server.",-1)])))])):i(y)?k("",!0):(o(),r("div",$t,e[15]||(e[15]=[t("p",{class:"text-red-500"},"Failed to load system status. Please check server logs.",-1)])))]))}},At={class:"space-y-12"},Ut={class:"space-y-6"},Dt={class:"flex items-center justify-between"},Nt=["disabled"],Pt={key:0,class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5"},zt={key:1,class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-5"},Ct={class:"flex items-center"},Vt={class:"flex-shrink-0"},Bt={class:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Gt=["d"],Rt={class:"ml-5 w-0 flex-1"},jt={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},It={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ft={key:2,class:"text-center p-10 bg-white dark:bg-gray-800 rounded-lg shadow"},Et={__name:"Dashboard",setup(P){const _=$(null),l=$(!0),y=B(),b=N(),h=$([{key:"total_users",label:"Total Users",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{key:"active_users_24h",label:"Active in 24h",icon:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},{key:"new_users_7d",label:"New in 7d",icon:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"},{key:"pending_approval",label:"Pending Approval",icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},{key:"pending_password_resets",label:"Password Resets",icon:"M15 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}]);async function u(){l.value=!0;try{const[p]=await Promise.all([R.get("/api/admin/stats"),b.fetchSystemStatus()]);_.value=p.data}catch{y.addNotification("Could not load dashboard statistics.","error")}finally{l.value=!1}}return G(u),(p,g)=>(o(),r("div",At,[t("div",Ut,[t("div",Dt,[g[2]||(g[2]=t("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," Application Overview ",-1)),t("button",{onClick:u,class:"btn btn-secondary btn-sm",disabled:l.value},[(o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",class:S(["h-4 w-4",{"animate-spin":l.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},g[0]||(g[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h5M20 20v-5h-5M4 4l16 16"},null,-1)]),2)),g[1]||(g[1]=t("span",{class:"ml-2"},"Refresh",-1))],8,Nt)]),l.value?(o(),r("div",Pt,[(o(),r(f,null,w(5,d=>t("div",{key:d,class:"bg-white dark:bg-gray-800/50 rounded-lg shadow p-5 animate-pulse"},g[3]||(g[3]=[t("div",{class:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"},null,-1),t("div",{class:"h-10 bg-gray-200 dark:bg-gray-700 rounded w-1/2"},null,-1)]))),64))])):_.value?(o(),r("div",zt,[(o(!0),r(f,null,w(h.value,d=>(o(),r("div",{key:d.key,class:"bg-white dark:bg-gray-800 rounded-lg shadow p-5 flex flex-col justify-between"},[t("div",null,[t("div",Ct,[t("div",Vt,[(o(),r("svg",Bt,[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:d.icon},null,8,Gt)]))]),t("div",Rt,[t("dl",null,[t("dt",jt,a(d.label),1),t("dd",null,[t("div",It,a(_.value[d.key]),1)])])])])])]))),128))])):(o(),r("div",Ft,g[4]||(g[4]=[t("p",{class:"text-gray-500"},"Could not load dashboard data.",-1)])))]),c(St)]))}};export{Et as default};
