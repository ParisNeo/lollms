import{O as q,x as H,s as K,r as u,j as $,o as Q,w as L,c as i,b as r,g as e,f as w,h as I,l as N,d as Z,e as g,W as ee,t as h,k as d,A as T,X as j,F as D,i as M,n as te,N as le,Y as se,D as W,E as A}from"./index-Dd3XH_0e.js";const oe={class:"space-y-12"},ne={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},ae={class:"mt-2 flex items-center gap-x-4"},ie=["src"],re={class:"flex justify-end pt-4 border-t dark:border-gray-700"},de=["disabled"],ce={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},ue={class:"p-6 border-b dark:border-gray-700 flex justify-between items-center"},ge={class:"flex gap-2"},ve={class:"p-6 grid grid-cols-1 lg:grid-cols-2 gap-8"},me={class:"flex justify-between items-center mb-2"},fe={class:"border rounded-lg overflow-hidden dark:border-gray-700 max-h-96 overflow-y-auto"},be={key:0},ye={key:1,class:"divide-y dark:divide-gray-700"},pe=["onClick"],we={class:"font-medium text-sm"},he={class:"flex items-center gap-1"},_e=["onClick"],ke=["onClick"],Ce=["onClick"],xe={class:"flex justify-between items-center mb-2"},Fe={class:"font-semibold"},Se=["disabled"],$e={class:"border rounded-lg overflow-hidden dark:border-gray-700 max-h-96 overflow-y-auto"},Le={key:0},Ie={key:1,class:"p-4 text-center text-sm text-gray-500"},Ne={key:2,class:"divide-y dark:divide-gray-700"},Te=["title"],je={class:"flex items-center gap-1 flex-shrink-0"},De=["onClick"],Me=["onClick"],Pe={__name:"WelcomeSettings",setup(We){const o=q(),v=H(),{globalSettings:_,funFacts:P,funFactCategories:k,isLoadingFunFacts:V,isLoadingFunFactCategories:E}=K(o),a=u({}),c=u(!1),y=u(!1),m=u(null),p=u(null);let C="{}";const n=u(null),x=$(()=>_.value.filter(l=>l.category==="Welcome Page")),R=$(()=>n.value?P.value.filter(l=>l.category.id===n.value):[]);Q(()=>{o.fetchGlobalSettings(),o.fetchFunFacts(),o.fetchFunFactCategories()}),L(()=>_.value,U,{deep:!0}),L(a,l=>{y.value=JSON.stringify(l)!==C},{deep:!0});function U(){const l={};x.value.length>0&&(x.value.forEach(t=>{l[t.key]=t.value}),a.value=l,C=JSON.stringify(a.value),y.value=!1)}function B(l){const t=l.target.files[0];if(t&&t.type.startsWith("image/")){m.value=t;const f=new FileReader;f.onload=s=>{p.value=s.target.result},f.readAsDataURL(t),y.value=!0}}async function O(){c.value=!0;try{await o.removeWelcomeLogo(),m.value=null,p.value=null}finally{c.value=!1}}async function z(){c.value=!0;try{const l={welcome_text:a.value.welcome_text,welcome_slogan:a.value.welcome_slogan};await o.updateGlobalSettings(l),m.value&&(await o.uploadWelcomeLogo(m.value),m.value=null,p.value=null)}finally{c.value=!1}}function F(l=null){v.openModal("funFactCategory",{category:l,onSave:o.fetchFunFactCategories})}function S(l=null){if(!n.value&&!l){v.addNotification("Please select a category first.","warning");return}v.openModal("funFact",{fact:l,preselectedCategoryId:n.value,onSave:o.fetchFunFacts})}async function G(l){await v.showConfirmation({title:"Delete Category and its Facts?",message:`This will permanently delete "${l.name}" and all facts inside it. This action cannot be undone.`,confirmText:"Delete All"})&&(await o.deleteFunFactCategory(l.id),n.value===l.id&&(n.value=null))}async function J(l){await v.showConfirmation({title:"Delete Fun Fact?",message:"Are you sure you want to delete this fact?",confirmText:"Delete"})&&await o.deleteFunFact(l.id)}async function X(l){await o.exportCategory(l.id,l.name)}async function Y(l){const t=l.target.files[0];t&&await o.importCategoryFromFile(t),l.target.value=""}return(l,t)=>{var f;return r(),i("div",oe,[e("div",ne,[t[10]||(t[10]=e("div",{class:"p-6 border-b dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold"},"Welcome Page Settings")],-1)),e("form",{onSubmit:w(z,["prevent"]),class:"p-6 space-y-6"},[e("div",null,[t[7]||(t[7]=e("label",{for:"welcome_text",class:"label"},"Main Welcome Text",-1)),I(e("input",{id:"welcome_text","onUpdate:modelValue":t[0]||(t[0]=s=>a.value.welcome_text=s),type:"text",class:"input-field mt-1"},null,512),[[N,a.value.welcome_text]])]),e("div",null,[t[8]||(t[8]=e("label",{for:"welcome_slogan",class:"label"},"Slogan",-1)),I(e("input",{id:"welcome_slogan","onUpdate:modelValue":t[1]||(t[1]=s=>a.value.welcome_slogan=s),type:"text",class:"input-field mt-1"},null,512),[[N,a.value.welcome_slogan]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"label"},"Custom Logo",-1)),e("div",ae,[e("img",{src:p.value||a.value.welcome_logo_url||g(ee),alt:"Logo Preview",class:"h-16 w-16 object-contain rounded-md bg-gray-100 dark:bg-gray-700"},null,8,ie),e("input",{type:"file",onChange:B,accept:"image/*",class:"hidden",ref:"logoInput"},null,544),e("button",{type:"button",onClick:t[2]||(t[2]=s=>l.$refs.logoInput.click()),class:"btn btn-secondary"},"Change"),a.value.welcome_logo_url?(r(),i("button",{key:0,type:"button",onClick:O,class:"btn btn-danger-outline"},"Remove")):Z("",!0)])]),e("div",re,[e("button",{type:"submit",class:"btn btn-primary",disabled:c.value||!y.value},h(c.value?"Saving...":"Save Settings"),9,de)])],32)]),e("div",ce,[e("div",ue,[t[11]||(t[11]=e("h3",{class:"text-xl font-semibold"},"Fun Facts Management",-1)),e("div",ge,[e("button",{onClick:t[3]||(t[3]=s=>l.$refs.importInput.click()),class:"btn btn-secondary btn-sm"},"Import Category"),e("input",{type:"file",ref:"importInput",onChange:Y,accept:".json",class:"hidden"},null,544),e("button",{onClick:t[4]||(t[4]=s=>g(o).exportFunFacts()),class:"btn btn-secondary btn-sm"},"Export All")])]),e("div",ve,[e("div",null,[e("div",me,[t[13]||(t[13]=e("h4",{class:"font-semibold"},"Categories",-1)),e("button",{onClick:t[5]||(t[5]=s=>F()),class:"btn btn-secondary btn-sm"},[d(j,{class:"w-4 h-4 mr-1"}),t[12]||(t[12]=T("New"))])]),e("div",fe,[g(E)?(r(),i("div",be,"Loading...")):(r(),i("ul",ye,[(r(!0),i(D,null,M(g(k),s=>(r(),i("li",{key:s.id,onClick:b=>n.value=s.id,class:te(["p-2 flex items-center justify-between cursor-pointer",n.value===s.id?"bg-blue-100 dark:bg-blue-900/50":"hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[e("div",null,[e("span",we,h(s.name),1),e("div",{class:"w-4 h-4 rounded-full inline-block ml-2",style:le({backgroundColor:s.color})},null,4)]),e("div",he,[e("button",{onClick:w(b=>X(s),["stop"]),class:"btn-icon"},[d(se,{class:"w-4 h-4"})],8,_e),e("button",{onClick:w(b=>F(s),["stop"]),class:"btn-icon"},[d(W,{class:"w-4 h-4"})],8,ke),e("button",{onClick:w(b=>G(s),["stop"]),class:"btn-icon-danger"},[d(A,{class:"w-4 h-4"})],8,Ce)])],10,pe))),128))]))])]),e("div",null,[e("div",xe,[e("h4",Fe,h(n.value?`Facts in "${(f=g(k).find(s=>s.id===n.value))==null?void 0:f.name}"`:"Select a Category"),1),e("button",{onClick:t[6]||(t[6]=s=>S()),disabled:!n.value,class:"btn btn-secondary btn-sm"},[d(j,{class:"w-4 h-4 mr-1"}),t[14]||(t[14]=T("New"))],8,Se)]),e("div",$e,[g(V)?(r(),i("div",Le,"Loading...")):n.value?(r(),i("ul",Ne,[(r(!0),i(D,null,M(R.value,s=>(r(),i("li",{key:s.id,class:"p-2 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("p",{class:"text-sm flex-grow pr-2 truncate",title:s.content},h(s.content),9,Te),e("div",je,[e("button",{onClick:b=>S(s),class:"btn-icon"},[d(W,{class:"w-4 h-4"})],8,De),e("button",{onClick:b=>J(s),class:"btn-icon-danger"},[d(A,{class:"w-4 h-4"})],8,Me)])]))),128))])):(r(),i("div",Ie,"Select a category to view its facts."))])])])])])}}};export{Pe as default};
