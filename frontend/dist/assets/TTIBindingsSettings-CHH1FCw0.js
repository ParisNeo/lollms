import{P as O,q as J,s as P,r as y,z as S,w as H,o as K,c as o,b as l,d as u,g as t,t as d,h as T,A as p,j as R,v as M,F as g,i as b,e as B,H as G,B as V,J as Q,K as W,n as x,f as X,k as Y,S as Z}from"./index-E0GzCsZZ.js";const ee={class:"space-y-8"},te={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},ne={class:"text-xl font-semibold mb-4"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie=["disabled"],ae=["value"],le={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},oe={class:"text-sm text-gray-600 dark:text-gray-400"},de=["for"],re={key:0,class:"text-red-500"},ue=["id","onUpdate:modelValue"],ce=["value"],fe={key:1},me={class:"relative"},ge=["type","id","onUpdate:modelValue","required","placeholder"],ve=["onClick","title"],_e={key:2,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},ye={class:"flex-grow flex flex-col pr-4"},pe={class:"text-sm text-gray-500 dark:text-gray-400"},be=["onClick"],xe={class:"text-xs text-gray-500 mt-1"},he={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},ke={class:"flex justify-end gap-3"},we=["disabled"],Te={class:"flex justify-between items-center mb-4"},Be={key:0,class:"text-center p-6"},Ce={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},Se={key:2,class:"space-y-4"},Ae={class:"flex items-start gap-4"},$e=["title"],Fe={class:"flex-grow"},Ie={class:"flex justify-between items-center"},Me={class:"font-bold text-lg text-gray-900 dark:text-white"},Ve={class:"flex gap-3"},De=["onClick"],Ne=["onClick"],je={class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},Ue={key:0},Ee={class:"font-semibold capitalize"},ze={key:0},Le={key:1},Oe={key:0},Je={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},Pe=["onClick"],Re={__name:"TTIBindingsSettings",setup(He){const f=O(),C=J(),{ttiBindings:A,availableTtiBindingTypes:h,isLoadingTtiBindings:D}=P(f),m=y(!1),v=y(null),k=y(!1),c=y({}),$=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),s=y($()),_=S(()=>v.value!==null),w=S(()=>s.value.name?h.value.find(i=>i.binding_name===s.value.name):null),N=S(()=>{if(!w.value)return[];const i=w.value.input_parameters||[],n=new Set(i.map(a=>a.name)),e=Object.keys(s.value.config||{}).filter(a=>!n.has(a)&&a!=="model_name").map(a=>({name:a,type:typeof s.value.config[a]=="boolean"?"bool":typeof s.value.config[a]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...i.filter(a=>a.name!=="model_name"),...e]});H(()=>s.value.name,(i,n)=>{if(i!==n&&!_.value){const e=h.value.find(r=>r.binding_name===i),a={};e&&e.input_parameters&&e.input_parameters.forEach(r=>{a[r.name]=r.default}),s.value.config=a}}),K(()=>{f.fetchTtiBindings(),f.fetchAvailableTtiBindingTypes()});function F(){v.value=null,s.value=$(),c.value={},m.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function j(i){v.value=i,s.value=JSON.parse(JSON.stringify(i)),s.value.config||(s.value.config={}),c.value={},m.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function I(){m.value=!1,v.value=null}function q(i){return typeof i=="string"?i.split(",").map(n=>n.trim()).filter(n=>n):Array.isArray(i)?i.filter(n=>n):[]}async function U(){if(!s.value.alias.trim()||!s.value.name){C.addNotification("Alias and Binding Type are required fields.","warning");return}k.value=!0;try{const i={alias:s.value.alias,name:s.value.name,config:s.value.config||{},is_active:s.value.is_active,default_model_name:s.value.default_model_name||null};_.value?await f.updateTtiBinding(v.value.id,i):await f.addTtiBinding(i),I()}catch(i){console.error("Submit failed:",i.message)}finally{k.value=!1}}async function E(i){await C.showConfirmation({title:`Delete TTI Binding '${i.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await f.deleteTtiBinding(i.id)}function z(i){C.openModal("manageModels",{binding:i,bindingType:"tti"})}function L(i){const n=h.value.find(e=>e.binding_name===i);return n?n.title:i}return(i,n)=>(l(),o("div",ee,[m.value?(l(),o("div",te,[t("h3",ne,d(_.value?"Edit TTI Binding":"Add New TTI Binding"),1),t("form",{onSubmit:X(U,["prevent"]),class:"space-y-6"},[t("div",se,[t("div",null,[n[3]||(n[3]=t("label",{for:"alias",class:"block text-sm font-medium"},[p("Alias "),t("span",{class:"text-red-500"},"*")],-1)),T(t("input",{type:"text",id:"alias","onUpdate:modelValue":n[0]||(n[0]=e=>s.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_sd",autocomplete:"off"},null,512),[[R,s.value.alias]]),n[4]||(n[4]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[n[6]||(n[6]=t("label",{for:"name",class:"block text-sm font-medium"},[p("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),T(t("select",{id:"name","onUpdate:modelValue":n[1]||(n[1]=e=>s.value.name=e),class:"input-field mt-1",required:"",disabled:_.value},[n[5]||(n[5]=t("option",{disabled:"",value:""},"Select a type",-1)),(l(!0),o(g,null,b(B(h),e=>(l(),o("option",{key:e.binding_name,value:e.binding_name},d(e.title),9,ae))),128))],8,ie),[[M,s.value.name]])])]),w.value?(l(),o("div",le,[t("p",oe,d(w.value.description),1),(l(!0),o(g,null,b(N.value,e=>(l(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[p(d(e.name.replace(/_/g," "))+" ",1),e.mandatory?(l(),o("span",re,"*")):u("",!0)],8,de),e.options&&e.options.length>0?T((l(),o("select",{key:0,id:`param-${e.name}`,"onUpdate:modelValue":a=>s.value.config[e.name]=a,class:"input-field"},[(l(!0),o(g,null,b(q(e.options),a=>(l(),o("option",{key:a,value:a},d(a),9,ce))),128))],8,ue)),[[M,s.value.config[e.name]]]):["str","int","float"].includes(e.type)?(l(),o("div",fe,[t("div",me,[T(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!c.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":a=>s.value.config[e.name]=a,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,ge),[[G,s.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(l(),o("button",{key:0,type:"button",onClick:a=>c.value[e.name]=!c.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:c.value[e.name]?"Hide":"Show"},[c.value[e.name]?(l(),V(Q,{key:0,class:"w-5 h-5"})):(l(),V(W,{key:1,class:"w-5 h-5"}))],8,ve)):u("",!0)])])):e.type==="bool"?(l(),o("div",_e,[t("span",ye,[t("span",pe,d(e.description),1)]),t("button",{onClick:a=>s.value.config[e.name]=!s.value.config[e.name],type:"button",class:x([s.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:x([s.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,be)])):u("",!0),t("p",xe,d(e.description),1)]))),128))])):u("",!0),t("div",he,[n[7]||(n[7]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this TTI service will not be available.")],-1)),t("button",{onClick:n[2]||(n[2]=e=>s.value.is_active=!s.value.is_active),type:"button",class:x([s.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:x([s.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",ke,[t("button",{type:"button",onClick:I,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:k.value},d(k.value?"Saving...":_.value?"Save Changes":"Add Binding"),9,we)])],32)])):u("",!0),t("div",null,[t("div",Te,[n[8]||(n[8]=t("h2",{class:"text-2xl font-bold"},"TTI Bindings",-1)),m.value?u("",!0):(l(),o("button",{key:0,onClick:F,class:"btn btn-primary"},"+ Add New TTI Binding"))]),B(D)?(l(),o("div",Be,"Loading TTI bindings...")):B(A).length===0&&!m.value?(l(),o("div",Ce,[n[9]||(n[9]=t("p",null,"No TTI bindings configured yet.",-1)),t("button",{onClick:F,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(l(),o("div",Se,[(l(!0),o(g,null,b(B(A),e=>(l(),o("div",{key:e.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[t("div",Ae,[t("span",{class:x(["mt-1 h-3 w-3 rounded-full flex-shrink-0",e.is_active?"bg-green-500":"bg-gray-400"]),title:e.is_active?"Active":"Inactive"},null,10,$e),t("div",Fe,[t("div",Ie,[t("h4",Me,d(e.alias),1),t("div",Ve,[t("button",{onClick:a=>j(e),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,De),t("button",{onClick:a=>E(e),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,Ne)])]),t("p",je,d(L(e.name)),1),t("div",qe,[(l(!0),o(g,null,b(e.config,(a,r)=>(l(),o(g,{key:r},[a&&r!=="model_name"?(l(),o("p",Ue,[t("span",Ee,d(r.replace(/_/g," "))+":",1),r.includes("key")||r.includes("token")?(l(),o("span",ze,"********")):(l(),o("span",Le,d(a),1))])):u("",!0)],64))),128)),e.default_model_name?(l(),o("p",Oe,[n[10]||(n[10]=t("span",{class:"font-semibold"},"Default Model:",-1)),p(" "+d(e.default_model_name),1)])):u("",!0)])])]),t("div",Je,[t("button",{onClick:a=>z(e),class:"btn btn-secondary btn-sm flex items-center gap-2"},[Y(Z,{class:"w-4 h-4"}),n[11]||(n[11]=p(" Manage Models "))],8,Pe)])]))),128))]))])]))}};export{Re as default};
