import{l as z,m as L,s as O,r as _,c as C,w as J,o as P,a as o,b as a,k as u,d as t,t as d,p as S,g as y,v as H,A as K,F as p,i as w,e as T,B as R,q as M,_ as G,C as Q,n as b,z as W,f as X,D as Y}from"./index-Rf4-wOhF.js";const Z={class:"space-y-8"},ee={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6"},te={class:"text-xl font-semibold mb-4"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},se=["disabled"],ae=["value"],ie={key:0,class:"space-y-6 border-t dark:border-gray-700 pt-6"},le={class:"text-sm text-gray-600 dark:text-gray-400"},oe=["for"],de={key:0,class:"text-red-500"},re={key:0},ue={class:"relative"},ce=["type","id","onUpdate:modelValue","required","placeholder"],me=["onClick","title"],fe={key:1,class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},ge={class:"flex-grow flex flex-col pr-4"},ve={class:"text-sm text-gray-500 dark:text-gray-400"},_e=["onClick"],ye={class:"text-xs text-gray-500 mt-1"},pe={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},be={class:"flex justify-end gap-3"},xe=["disabled"],he={class:"flex justify-between items-center mb-4"},ke={key:0,class:"text-center p-6"},we={key:1,class:"text-center p-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg"},Te={key:2,class:"space-y-4"},Be={class:"flex items-start gap-4"},Ce=["title"],Se={class:"flex-grow"},Ae={class:"flex justify-between items-center"},De={class:"font-bold text-lg text-gray-900 dark:text-white"},Fe={class:"flex gap-3"},Ie=["onClick"],Me=["onClick"],$e={class:"text-sm text-gray-500 dark:text-gray-400"},Ne={class:"mt-2 text-xs space-y-1 text-gray-600 dark:text-gray-300"},Ve={key:0},je={class:"font-semibold capitalize"},qe={key:0},Ee={key:1},Ue={key:0},ze={class:"border-t dark:border-gray-700 pt-3 flex justify-end"},Le=["onClick"],Pe={__name:"TTIBindingsSettings",setup(Oe){const m=z(),B=L(),{ttiBindings:A,availableTtiBindingTypes:x,isLoadingTtiBindings:$}=O(m),f=_(!1),g=_(null),h=_(!1),c=_({}),D=()=>({id:null,alias:"",name:"",config:{},default_model_name:"",is_active:!0}),n=_(D()),v=C(()=>g.value!==null),k=C(()=>n.value.name?x.value.find(i=>i.binding_name===n.value.name):null),N=C(()=>{if(!k.value)return[];const i=k.value.input_parameters||[],s=new Set(i.map(l=>l.name)),e=Object.keys(n.value.config||{}).filter(l=>!s.has(l)&&l!=="model_name").map(l=>({name:l,type:typeof n.value.config[l]=="boolean"?"bool":typeof n.value.config[l]=="number"?"float":"str",description:"(Parameter not in binding description)",mandatory:!1}));return[...i.filter(l=>l.name!=="model_name"),...e]});J(()=>n.value.name,(i,s)=>{if(i!==s&&!v.value){const e=x.value.find(r=>r.binding_name===i),l={};e&&e.input_parameters&&e.input_parameters.forEach(r=>{l[r.name]=r.default}),n.value.config=l}}),P(()=>{m.fetchTtiBindings(),m.fetchAvailableTtiBindingTypes()});function F(){g.value=null,n.value=D(),c.value={},f.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function V(i){g.value=i,n.value=JSON.parse(JSON.stringify(i)),n.value.config||(n.value.config={}),c.value={},f.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function I(){f.value=!1,g.value=null}async function j(){if(!n.value.alias.trim()||!n.value.name){B.addNotification("Alias and Binding Type are required fields.","warning");return}h.value=!0;try{const i={alias:n.value.alias,name:n.value.name,config:n.value.config||{},is_active:n.value.is_active,default_model_name:n.value.default_model_name||null};v.value?await m.updateTtiBinding(g.value.id,i):await m.addTtiBinding(i),I()}catch(i){console.error("Submit failed:",i.message)}finally{h.value=!1}}async function q(i){await B.showConfirmation({title:`Delete TTI Binding '${i.alias}'?`,message:"Are you sure? This action cannot be undone.",confirmText:"Delete"})&&await m.deleteTtiBinding(i.id)}function E(i){B.openModal("manageModels",{binding:i,bindingType:"tti"})}function U(i){const s=x.value.find(e=>e.binding_name===i);return s?s.title:i}return(i,s)=>(a(),o("div",Z,[f.value?(a(),o("div",ee,[t("h3",te,d(v.value?"Edit TTI Binding":"Add New TTI Binding"),1),t("form",{onSubmit:W(j,["prevent"]),class:"space-y-6"},[t("div",ne,[t("div",null,[s[3]||(s[3]=t("label",{for:"alias",class:"block text-sm font-medium"},[y("Alias "),t("span",{class:"text-red-500"},"*")],-1)),S(t("input",{type:"text",id:"alias","onUpdate:modelValue":s[0]||(s[0]=e=>n.value.alias=e),class:"input-field mt-1",required:"",placeholder:"e.g., local_sd"},null,512),[[H,n.value.alias]]),s[4]||(s[4]=t("p",{class:"text-xs text-gray-500 mt-1"},"A unique, short name for this configuration.",-1))]),t("div",null,[s[6]||(s[6]=t("label",{for:"name",class:"block text-sm font-medium"},[y("Binding Type "),t("span",{class:"text-red-500"},"*")],-1)),S(t("select",{id:"name","onUpdate:modelValue":s[1]||(s[1]=e=>n.value.name=e),class:"input-field mt-1",required:"",disabled:v.value},[s[5]||(s[5]=t("option",{disabled:"",value:""},"Select a type",-1)),(a(!0),o(p,null,w(T(x),e=>(a(),o("option",{key:e.binding_name,value:e.binding_name},d(e.title),9,ae))),128))],8,se),[[K,n.value.name]])])]),k.value?(a(),o("div",ie,[t("p",le,d(k.value.description),1),(a(!0),o(p,null,w(N.value,e=>(a(),o("div",{key:e.name,class:"space-y-1"},[t("label",{for:`param-${e.name}`,class:"block text-sm font-medium capitalize"},[y(d(e.name.replace(/_/g," "))+" ",1),e.mandatory?(a(),o("span",de,"*")):u("",!0)],8,oe),["str","int","float"].includes(e.type)?(a(),o("div",re,[t("div",ue,[S(t("input",{type:(e.name.includes("key")||e.name.includes("token"))&&!c.value[e.name]?"password":"text",id:`param-${e.name}`,"onUpdate:modelValue":l=>n.value.config[e.name]=l,class:"input-field",required:e.mandatory,placeholder:e.description,autocomplete:"off"},null,8,ce),[[R,n.value.config[e.name]]]),e.name.includes("key")||e.name.includes("token")?(a(),o("button",{key:0,type:"button",onClick:l=>c.value[e.name]=!c.value[e.name],class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",title:c.value[e.name]?"Hide":"Show"},[c.value[e.name]?(a(),M(G,{key:0,class:"w-5 h-5"})):(a(),M(Q,{key:1,class:"w-5 h-5"}))],8,me)):u("",!0)])])):e.type==="bool"?(a(),o("div",fe,[t("span",ge,[t("span",ve,d(e.description),1)]),t("button",{onClick:l=>n.value.config[e.name]=!n.value.config[e.name],type:"button",class:b([n.value.config[e.name]?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:b([n.value.config[e.name]?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],10,_e)])):u("",!0),t("p",ye,d(e.description),1)]))),128))])):u("",!0),t("div",pe,[s[7]||(s[7]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"If disabled, this TTI service will not be available.")],-1)),t("button",{onClick:s[2]||(s[2]=e=>n.value.is_active=!n.value.is_active),type:"button",class:b([n.value.is_active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:b([n.value.is_active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition-colors duration-200 ease-in-out"])},null,2)],2)]),t("div",be,[t("button",{type:"button",onClick:I,class:"btn btn-secondary"},"Cancel"),t("button",{type:"submit",class:"btn btn-primary",disabled:h.value},d(h.value?"Saving...":v.value?"Save Changes":"Add Binding"),9,xe)])],32)])):u("",!0),t("div",null,[t("div",he,[s[8]||(s[8]=t("h2",{class:"text-2xl font-bold"},"TTI Bindings",-1)),f.value?u("",!0):(a(),o("button",{key:0,onClick:F,class:"btn btn-primary"},"+ Add New TTI Binding"))]),T($)?(a(),o("div",ke,"Loading TTI bindings...")):T(A).length===0&&!f.value?(a(),o("div",we,[s[9]||(s[9]=t("p",null,"No TTI bindings configured yet.",-1)),t("button",{onClick:F,class:"mt-2 text-blue-600 hover:underline"},"Add your first one")])):(a(),o("div",Te,[(a(!0),o(p,null,w(T(A),e=>(a(),o("div",{key:e.id,class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex flex-col gap-4"},[t("div",Be,[t("span",{class:b(["mt-1 h-3 w-3 rounded-full flex-shrink-0",e.is_active?"bg-green-500":"bg-gray-400"]),title:e.is_active?"Active":"Inactive"},null,10,Ce),t("div",Se,[t("div",Ae,[t("h4",De,d(e.alias),1),t("div",Fe,[t("button",{onClick:l=>V(e),class:"text-sm font-medium text-blue-600 hover:underline"},"Edit",8,Ie),t("button",{onClick:l=>q(e),class:"text-sm font-medium text-red-600 hover:underline"},"Delete",8,Me)])]),t("p",$e,d(U(e.name)),1),t("div",Ne,[(a(!0),o(p,null,w(e.config,(l,r)=>(a(),o(p,{key:r},[l&&r!=="model_name"?(a(),o("p",Ve,[t("span",je,d(r.replace(/_/g," "))+":",1),r.includes("key")||r.includes("token")?(a(),o("span",qe,"********")):(a(),o("span",Ee,d(l),1))])):u("",!0)],64))),128)),e.default_model_name?(a(),o("p",Ue,[s[10]||(s[10]=t("span",{class:"font-semibold"},"Default Model:",-1)),y(" "+d(e.default_model_name),1)])):u("",!0)])])]),t("div",ze,[t("button",{onClick:l=>E(e),class:"btn btn-secondary btn-sm flex items-center gap-2"},[X(Y,{class:"w-4 h-4"}),s[11]||(s[11]=y(" Manage Models "))],8,Le)])]))),128))]))])]))}};export{Pe as default};
