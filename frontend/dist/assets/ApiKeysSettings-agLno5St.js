import{l as v,a as _,D as k,s as p,r as g,c as A,o as K,b as l,e as o,f as e,w as S,h as D,v as T,t as r,n as f,F as C,q as L}from"./index-BqCh0aMd.js";const M={class:"space-y-10"},I={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},N={key:0,class:"p-6 text-center"},O={key:1},P={class:"p-4 sm:p-6"},B={class:"flex-grow w-full"},E=["disabled"],q={class:"border-t border-gray-200 dark:border-gray-700"},F={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},R={key:1,role:"list",class:"divide-y divide-gray-200 dark:divide-gray-700"},U={class:"flex-grow"},V={class:"text-sm font-semibold text-gray-900 dark:text-white"},$={class:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2"},j={class:"flex-shrink-0 flex flex-col sm:flex-row sm:items-center gap-4 w-full sm:w-auto"},G={class:"text-xs text-gray-500 dark:text-gray-400 sm:text-right"},Y=["onClick"],Q={__name:"ApiKeysSettings",setup(z){const i=v(),c=_(),y=k(),{apiKeys:u}=p(i),{globalSettings:x}=p(y),n=g(""),d=g(!1),w=A(()=>{const t=x.value.find(s=>s.key==="openai_api_service_enabled");return t?t.value:!1});K(()=>{y.globalSettings.length===0&&y.fetchGlobalSettings(),i.apiKeys.length===0&&i.fetchApiKeys()});function m(t){return t?new Date(t).toLocaleString():"Never"}async function b(){if(!n.value.trim()){c.addNotification("Please provide an alias for the new key.","warning");return}d.value=!0;try{const t=await i.addApiKey(n.value.trim());console.log("Opening the new api key modal"),c.openModal("newApiKey",{keyData:t}),console.log("Opening the new api key modal. DONE"),n.value=""}catch{}finally{d.value=!1}}async function h(t){await c.showConfirmation({title:`Delete key '${t.alias}'?`,message:"This will permanently revoke the key. This action cannot be undone.",confirmText:"Delete Key"})&&await i.deleteApiKey(t.id)}return(t,s)=>(o(),l("div",M,[e("div",I,[s[3]||(s[3]=e("div",{class:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"API Keys"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"}," Manage your API keys for accessing the LoLLMs backend with OpenAI-compatible tools. ")],-1)),w.value?(o(),l("div",O,[e("div",P,[e("form",{onSubmit:S(b,["prevent"]),class:"flex flex-col sm:flex-row items-start sm:items-end gap-4"},[e("div",B,[s[2]||(s[2]=e("label",{for:"keyAlias",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Key Alias",-1)),D(e("input",{type:"text",id:"keyAlias","onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),class:"input-field mt-1",placeholder:"e.g., My Research Tool",required:""},null,512),[[T,n.value]])]),e("button",{type:"submit",class:"btn btn-primary w-full sm:w-auto",disabled:d.value},r(d.value?"Creating...":"Create New Key"),9,E)],32)]),e("div",q,[f(u).length===0?(o(),l("div",F," You have not created any API keys yet. ")):(o(),l("ul",R,[(o(!0),l(C,null,L(f(u),a=>(o(),l("li",{key:a.id,class:"px-4 py-4 sm:px-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},[e("div",U,[e("p",V,r(a.alias),1),e("p",$,[e("span",null,r(a.key_prefix)+"...",1)])]),e("div",j,[e("div",G,[e("p",null,"Last used: "+r(m(a.last_used_at)),1),e("p",null,"Created: "+r(m(a.created_at)),1)]),e("button",{onClick:H=>h(a),class:"btn btn-danger-outline btn-sm sm:w-auto w-full"}," Delete ",8,Y)])]))),128))]))])])):(o(),l("div",N,s[1]||(s[1]=[e("div",{class:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-lg"},[e("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"}," The OpenAI-compatible API service is currently disabled by the administrator. ")],-1)])))])]))}};export{Q as default};
