import{c7 as L,ae as D,c1 as A,r as y,c as P,o as G,w as B,b as s,d as n,h as e,i as x,P as T,n as m,g as b,l as i,c2 as c,F as M,m as U,t as p,v as u}from"./index-CZUz33lt.js";const j={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},E={key:0,class:"p-6 text-center"},N={class:"space-y-8"},$={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},K={class:"space-y-6 pt-6 border-t dark:border-gray-600"},O=["value"],J=["value"],R={key:0},z={class:"space-y-6 pt-6 border-t dark:border-gray-600"},H={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},q={key:0,class:"space-y-4"},Q={key:0},W={key:1},X={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},Y={class:"flex justify-end"},Z=["disabled"],tt={key:2,class:"p-6 text-center"},et={class:"text-gray-500"},lt={__name:"AiBotSettings",setup(at){const r=L(),v=D(),{globalSettings:g,aiBotSettings:d,isLoadingAiBotSettings:V}=A(r),{availableLollmsModels:k,publicPersonalities:S}=A(v),a=y({ai_bot_enabled:!1,ai_bot_system_prompt:"",lollms_model_name:"",active_personality_id:"",ai_bot_auto_post:!1,ai_bot_post_interval:24,ai_bot_content_mode:"static_text",ai_bot_static_content:"",ai_bot_file_path:"",ai_bot_generation_prompt:"Generate an interesting and engaging social media post based on the provided context. Keep it under 500 characters."}),_=y(!1),f=y(!1);let w="{}";const h=P(()=>g.value.filter(l=>l.category==="AI Bot")),F=P(()=>S.value.map(l=>({id:l.id,name:`${l.name} (by ${l.author})`})));G(()=>{g.value.length===0&&r.fetchGlobalSettings(),d.value||r.fetchAiBotSettings(),k.value.length===0&&v.fetchAdminAvailableLollmsModels(),S.value.length===0&&v.fetchPersonalities()}),B([g,d],C,{deep:!0}),B(a,l=>{f.value=JSON.stringify(l)!==w},{deep:!0});function C(){const l={...a.value};h.value.length>0&&h.value.forEach(t=>{l[t.key]=t.value}),d.value&&(l.lollms_model_name=d.value.lollms_model_name,l.active_personality_id=d.value.active_personality_id),a.value=l,w=JSON.stringify(a.value),f.value=!1}async function I(){_.value=!0;try{const l={ai_bot_enabled:a.value.ai_bot_enabled,ai_bot_system_prompt:a.value.ai_bot_system_prompt,ai_bot_auto_post:a.value.ai_bot_auto_post,ai_bot_post_interval:parseFloat(a.value.ai_bot_post_interval),ai_bot_content_mode:a.value.ai_bot_content_mode,ai_bot_static_content:a.value.ai_bot_static_content,ai_bot_file_path:a.value.ai_bot_file_path,ai_bot_generation_prompt:a.value.ai_bot_generation_prompt},t={lollms_model_name:a.value.lollms_model_name,active_personality_id:a.value.active_personality_id};await Promise.all([r.updateGlobalSettings(l),r.updateAiBotSettings(t)])}finally{_.value=!1}}return(l,t)=>(n(),s("div",j,[t[27]||(t[27]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," AI Bot Settings "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure the automated AI assistant that responds to @lollms mentions and auto-posts content. ")],-1)),x(V)?(n(),s("div",E,"Loading settings...")):Object.keys(a.value).length?(n(),s("form",{key:1,onSubmit:T(I,["prevent"]),class:"p-6"},[e("div",N,[e("div",$,[t[10]||(t[10]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable AI Bot Responses"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Allow the bot to reply to @lollms mentions.")],-1)),e("button",{onClick:t[0]||(t[0]=o=>a.value.ai_bot_enabled=!a.value.ai_bot_enabled),type:"button",class:m([a.value.ai_bot_enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:m([a.value.ai_bot_enabled?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),e("div",K,[e("div",null,[t[12]||(t[12]=e("label",{for:"bot-model",class:"block text-sm font-medium"},"Bot Model",-1)),i(e("select",{id:"bot-model","onUpdate:modelValue":t[1]||(t[1]=o=>a.value.lollms_model_name=o),class:"input-field mt-1"},[t[11]||(t[11]=e("option",{value:""},"-- Select a Model --",-1)),(n(!0),s(M,null,U(x(k),o=>(n(),s("option",{key:o.id,value:o.id},p(o.name),9,O))),128))],512),[[c,a.value.lollms_model_name]]),t[13]||(t[13]=e("p",{class:"mt-1 text-xs text-gray-500"},"The model the bot will use for all system-level generations.",-1))]),e("div",null,[t[15]||(t[15]=e("label",{for:"bot-personality",class:"block text-sm font-medium"},"Bot Personality",-1)),i(e("select",{id:"bot-personality","onUpdate:modelValue":t[2]||(t[2]=o=>a.value.active_personality_id=o),class:"input-field mt-1"},[t[14]||(t[14]=e("option",{value:""},"-- Use Default System Prompt --",-1)),(n(!0),s(M,null,U(F.value,o=>(n(),s("option",{key:o.id,value:o.id},p(o.name),9,J))),128))],512),[[c,a.value.active_personality_id]]),t[16]||(t[16]=e("p",{class:"mt-1 text-xs text-gray-500"},"Select a personality to define the bot's behavior.",-1))]),a.value.active_personality_id?b("",!0):(n(),s("div",R,[t[17]||(t[17]=e("label",{for:"bot-prompt",class:"block text-sm font-medium"},"Default System Prompt",-1)),i(e("textarea",{id:"bot-prompt","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.ai_bot_system_prompt=o),rows:"3",class:"input-field mt-1"},null,512),[[u,a.value.ai_bot_system_prompt]])]))]),e("div",z,[t[26]||(t[26]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Auto-Posting Feed",-1)),e("div",H,[t[18]||(t[18]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable Auto-Posting"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"The bot will post to the main feed periodically based on provided material.")],-1)),e("button",{onClick:t[4]||(t[4]=o=>a.value.ai_bot_auto_post=!a.value.ai_bot_auto_post),type:"button",class:m([a.value.ai_bot_auto_post?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:m([a.value.ai_bot_auto_post?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),a.value.ai_bot_auto_post?(n(),s("div",q,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium"},"Posting Interval (Hours)",-1)),i(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=o=>a.value.ai_bot_post_interval=o),min:"1",step:"0.5",class:"input-field mt-1"},null,512),[[u,a.value.ai_bot_post_interval]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium"},"Content Source",-1)),i(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.value.ai_bot_content_mode=o),class:"input-field mt-1"},t[20]||(t[20]=[e("option",{value:"static_text"},"Manual Text (Knowledge Base)",-1),e("option",{value:"file"},"File Path (Server Side)",-1)]),512),[[c,a.value.ai_bot_content_mode]])]),a.value.ai_bot_content_mode==="static_text"?(n(),s("div",Q,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium"},"Knowledge Base Material",-1)),i(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=o=>a.value.ai_bot_static_content=o),rows:"6",class:"input-field mt-1",placeholder:"Paste interesting facts, news, or context here..."},null,512),[[u,a.value.ai_bot_static_content]])])):b("",!0),a.value.ai_bot_content_mode==="file"?(n(),s("div",W,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium"},"Absolute File Path",-1)),i(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=o=>a.value.ai_bot_file_path=o),class:"input-field mt-1",placeholder:"/path/to/interesting_content.txt"},null,512),[[u,a.value.ai_bot_file_path]])])):b("",!0),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium"},"Generation Prompt",-1)),i(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.value.ai_bot_generation_prompt=o),rows:"3",class:"input-field mt-1"},null,512),[[u,a.value.ai_bot_generation_prompt]]),t[25]||(t[25]=e("p",{class:"mt-1 text-xs text-gray-500"},"Instructions for the AI on how to use the material to create a post.",-1))])])):b("",!0)])]),e("div",X,[e("div",Y,[e("button",{type:"submit",class:"btn btn-primary",disabled:_.value||!f.value},p(_.value?"Saving...":"Save Settings"),9,Z)])])],32)):(n(),s("div",tt,[e("p",et,p(x(r).isLoadingSettings?"Loading settings...":"Could not load AI Bot settings."),1)]))]))}};export{lt as default};
