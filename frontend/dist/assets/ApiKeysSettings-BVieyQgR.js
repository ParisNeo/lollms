import{a as M,x as L,u as q,s as A,r as x,j as f,o as V,w as K,c as i,b as n,g as e,d as _,e as c,n as v,t as l,f as S,h as D,l as z,F as E,i as R,m as B,A as O,k as U,E as Y}from"./index-Dd3XH_0e.js";const $={class:"space-y-10"},j={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},F={class:"p-4 sm:p-6"},G={class:"space-y-4 mb-6"},H={class:"p-4 border rounded-lg dark:border-gray-700"},J={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Q={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md"},W={class:"text-gray-500 dark:text-gray-400"},X={class:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-md"},Z={class:"text-gray-500 dark:text-gray-400"},ee={key:0,class:"text-center"},te={key:1},se={class:"flex-grow w-full"},ae=["disabled"],le={key:0},re={class:"border-t border-gray-200 dark:border-gray-700"},oe={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},ie={key:1},ne={key:0,class:"px-4 sm:px-6 py-2 bg-blue-50 dark:bg-blue-900/20 flex items-center justify-between transition-all"},de={class:"flex items-center gap-4"},ce={class:"text-sm font-semibold text-blue-800 dark:text-blue-200"},ue={role:"list",class:"divide-y divide-gray-200 dark:divide-gray-700"},ye=["value"],ge={class:"flex-grow ml-2"},pe={class:"text-sm font-semibold text-gray-900 dark:text-white"},me={class:"text-sm text-gray-500 dark:text-gray-400 font-mono"},ve={class:"text-xs text-gray-500 dark:text-gray-400 text-right"},be=["onClick"],_e={__name:"ApiKeysSettings",setup(xe){const d=M(),u=L(),C=q(),{apiKeys:y}=A(d),{user:r}=A(C),g=x(""),p=x(!1),a=x(new Set),m=f(()=>r.value?r.value.openai_api_service_enabled||r.value.ollama_service_enabled:!1),h=f(()=>y.value.length>0),b=f({get:()=>h.value&&a.value.size===y.value.length,set:s=>{s?a.value=new Set(y.value.map(t=>t.id)):a.value.clear()}});V(()=>{m.value&&d.apiKeys.length===0&&d.fetchApiKeys()}),K(m,s=>{s&&d.apiKeys.length===0&&d.fetchApiKeys()}),K(y,()=>{a.value.clear()});function k(s){return s?new Date(s).toLocaleString():"Never"}async function T(){if(!g.value.trim()){u.addNotification("Please provide an alias for the new key.","warning");return}p.value=!0;try{const s=await d.addApiKey(g.value.trim());u.openModal("newApiKey",{keyData:s}),g.value=""}catch{}finally{p.value=!1}}async function I(s){await u.showConfirmation({title:`Delete key '${s.alias}'?`,message:"This will permanently revoke the key. This action cannot be undone.",confirmText:"Delete Key"})&&await d.deleteSingleApiKey(s.id)}async function N(){const s=Array.from(a.value);if(s.length===0){u.addNotification("No keys selected for deletion.","warning");return}await u.showConfirmation({title:`Delete ${s.length} API Key(s)?`,message:"This will permanently revoke the selected keys. This action cannot be undone.",confirmText:"Delete Selected"})&&await d.deleteMultipleApiKeys(s)}function P(){b.value=!b.value}return(s,t)=>(n(),i("div",$,[e("div",j,[t[10]||(t[10]=e("div",{class:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"API Keys"),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"}," Manage your API keys for accessing the LoLLMs backend with OpenAI-compatible tools. ")],-1)),e("div",F,[e("div",G,[e("div",H,[t[5]||(t[5]=e("h3",{class:"font-semibold text-lg mb-2"},"API Service Status",-1)),c(r)?(n(),i("div",J,[e("div",Q,[t[3]||(t[3]=e("p",{class:"font-medium text-gray-800 dark:text-gray-200"},"OpenAI-Compatible API",-1)),e("p",{class:v(c(r).openai_api_service_enabled?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")}," Status: "+l(c(r).openai_api_service_enabled?"Enabled":"Disabled"),3),e("p",W," Key Required: "+l(c(r).openai_api_require_key?"Yes":"No"),1)]),e("div",X,[t[4]||(t[4]=e("p",{class:"font-medium text-gray-800 dark:text-gray-200"},"Ollama-Compatible API",-1)),e("p",{class:v(c(r).ollama_service_enabled?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")}," Status: "+l(c(r).ollama_service_enabled?"Enabled":"Disabled"),3),e("p",Z," Key Required: "+l(c(r).ollama_require_key?"Yes":"No"),1)])])):_("",!0),t[6]||(t[6]=e("p",{class:"text-xs text-gray-500 mt-2"},"API keys below can be used for any enabled service that requires a key.",-1))])]),m.value?(n(),i("div",te,[e("form",{onSubmit:S(T,["prevent"]),class:"flex flex-col sm:flex-row items-start sm:items-end gap-4"},[e("div",se,[t[8]||(t[8]=e("label",{for:"keyAlias",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Key Alias",-1)),D(e("input",{type:"text",id:"keyAlias","onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),class:"input-field mt-1",placeholder:"e.g., My Research Tool",required:""},null,512),[[z,g.value]])]),e("button",{type:"submit",class:"btn btn-primary w-full sm:w-auto",disabled:p.value},l(p.value?"Creating...":"Create New Key"),9,ae)],32)])):(n(),i("div",ee,t[7]||(t[7]=[e("div",{class:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-lg"},[e("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"}," All API services are currently disabled by the administrator. ")],-1)])))]),m.value?(n(),i("div",le,[e("div",re,[h.value?(n(),i("div",ie,[a.value.size>0?(n(),i("div",ne,[e("div",de,[e("span",ce,l(a.value.size)+" selected",1),e("button",{onClick:P,class:"text-sm font-medium text-blue-600 hover:underline"},l(b.value?"Deselect All":"Select All"),1)]),e("button",{onClick:N,class:"btn btn-danger btn-sm"}," Delete Selected ")])):_("",!0),e("ul",ue,[(n(!0),i(E,null,R(c(y),o=>(n(),i("li",{key:o.id,class:v(["px-4 py-4 sm:px-6 flex items-center gap-4 group transition-colors duration-150",{"bg-blue-50 dark:bg-blue-900/40":a.value.has(o.id)}])},[D(e("input",{type:"checkbox",value:o.id,"onUpdate:modelValue":t[1]||(t[1]=w=>a.value=w),onClick:t[2]||(t[2]=S(()=>{},["stop"])),class:"h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"},null,8,ye),[[B,a.value]]),e("div",ge,[e("p",pe,l(o.alias),1),e("p",me,[O(l(o.key_prefix),1),t[9]||(t[9]=e("span",null,"...",-1))])]),e("div",ve,[e("p",null,"Last used: "+l(k(o.last_used_at)),1),e("p",null,"Created: "+l(k(o.created_at)),1)]),e("button",{onClick:w=>I(o),class:v(["p-2 rounded-full text-gray-400 hover:bg-red-100 hover:text-red-600 dark:hover:bg-red-900/50 dark:hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",{"opacity-100":a.value.size>0}]),title:"Delete this key"},[U(Y,{class:"h-5 w-5"})],10,be)],2))),128))])])):(n(),i("div",oe," You have not created any API keys yet. "))])])):_("",!0)])]))}};export{_e as default};
