import{u as p,c as m,b as r,d as a,h as e,F as h,m as b,n as y,e as f,U as k,t as g,g as w,a as C,o as S,C as V,c7 as v,a1 as $,q as L}from"./index-DsAC8y70.js";import{_ as U}from"./DmWindow-25jsmxXK.js";const D={class:"h-full bg-white dark:bg-gray-800 flex flex-col"},M={class:"flex-grow overflow-y-auto custom-scrollbar"},N={key:0,class:"p-4 text-center text-sm text-gray-500"},j={key:1,class:"p-8 text-center"},B={key:2,class:"divide-y divide-gray-100 dark:divide-gray-700/50"},T=["onClick"],I={class:"ml-3 flex-1 min-w-0"},z={class:"flex justify-between items-baseline"},F={class:"font-semibold text-sm text-gray-900 dark:text-gray-100 truncate pr-2"},P={class:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0"},q={class:"flex justify-between items-center mt-1"},A={key:0,class:"flex-shrink-0 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-blue-600 rounded-full"},E={__name:"ConversationList",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(x,{emit:o}){const c=o,i=p(),d=m(()=>i.conversations),_=m(()=>i.isLoadingConversations);function u(l){c("update:modelValue",l)}function s(l){if(!l)return"";const n=new Date(l),t=new Date;return n.toDateString()===t.toDateString()?n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):n.toLocaleDateString()}return(l,n)=>(a(),r("div",D,[n[1]||(n[1]=e("div",{class:"p-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0"},[e("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},"Messages")],-1)),e("div",M,[_.value&&d.value.length===0?(a(),r("div",N," Loading conversations... ")):d.value.length===0?(a(),r("div",j,n[0]||(n[0]=[e("p",{class:"text-sm text-gray-500"},"No conversations yet.",-1)]))):(a(),r("ul",B,[(a(!0),r(h,null,b(d.value,t=>(a(),r("li",{key:t.partner_user_id},[e("button",{onClick:K=>u(t.partner_user_id),class:y(["w-full text-left flex items-center p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors relative",{"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500":x.modelValue===t.partner_user_id}])},[f(k,{icon:t.partner_icon,username:t.partner_username,"size-class":"h-12 w-12 flex-shrink-0"},null,8,["icon","username"]),e("div",I,[e("div",z,[e("p",F,g(t.partner_username),1),e("span",P,g(s(t.last_message_at)),1)]),e("div",q,[e("p",{class:y(["text-xs text-gray-500 dark:text-gray-400 truncate pr-2",{"font-medium text-gray-800 dark:text-gray-200":t.unread_count>0}])},g(t.last_message),3),t.unread_count>0?(a(),r("span",A,g(t.unread_count),1)):w("",!0)])])],10,T)]))),128))]))])]))}},R={class:"flex h-full bg-white dark:bg-gray-900 overflow-hidden"},Y={class:"w-80 flex-shrink-0 border-r border-gray-200 dark:border-gray-700 h-full overflow-hidden"},G={class:"flex-1 min-w-0 h-full flex flex-col relative"},H={key:1,class:"h-full flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800/50"},J={class:"p-6 rounded-full bg-gray-100 dark:bg-gray-700 mb-4"},W={__name:"MessagesView",setup(x){const o=p(),c=C(),i=m(()=>o.activeConversationUserId),d=m(()=>i.value?o.activeConversations[i.value]:null);function _(u){const s=o.conversations.find(l=>l.partner_user_id===u);s&&o.openConversation({id:s.partner_user_id,username:s.partner_username,icon:s.partner_icon})}return S(()=>{c.setPageTitle({title:"Messages",icon:V(v)}),o.fetchConversations()}),$(()=>{c.setPageTitle({title:""})}),(u,s)=>(a(),r("div",R,[e("div",Y,[f(E,{"model-value":i.value,"onUpdate:modelValue":_},null,8,["model-value"])]),e("div",G,[d.value?(a(),L(U,{key:0,conversation:d.value,class:"h-full"},null,8,["conversation"])):(a(),r("div",H,[e("div",J,[f(v,{class:"w-12 h-12 text-gray-400 dark:text-gray-500"})]),s[0]||(s[0]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-200"},"Your Messages",-1)),s[1]||(s[1]=e("p",{class:"mt-1 text-sm"},"Select a conversation from the list to start chatting.",-1))]))])]))}};export{W as default};
