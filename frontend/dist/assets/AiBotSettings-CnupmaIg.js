import{c7 as D,ae as z,a as E,c1 as P,r as f,c as N,o as O,w as M,b as l,d as i,h as e,i as V,P as $,n as y,g as m,l as r,c2 as w,F as h,m as S,t as b,v as _,j as G,W as K}from"./index-Bgi7Xgs0.js";const H={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},J={key:0,class:"p-6 text-center"},R={class:"space-y-8"},W={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},q={class:"space-y-6 pt-6 border-t dark:border-gray-600"},Q=["label"],X=["value"],Y=["value"],Z={key:0},tt={class:"space-y-6 pt-6 border-t dark:border-gray-600"},et={class:"flex items-center justify-between"},ot=["disabled"],at={key:0,class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},st={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},lt={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},it={key:0,class:"space-y-4"},nt={key:0},rt={key:1},dt={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},ut={class:"flex justify-end"},pt=["disabled"],mt={key:2,class:"p-6 text-center"},bt={class:"text-gray-500"},ct={__name:"AiBotSettings",setup(_t){const u=D(),A=z(),g=E(),{globalSettings:gt,aiBotSettings:v,isLoadingAiBotSettings:U,adminAvailableLollmsModels:x}=P(u),{publicPersonalities:B}=P(A),a=f({ai_bot_enabled:!1,ai_bot_system_prompt:"",lollms_model_name:"",active_personality_id:"",ai_bot_auto_post:!1,ai_bot_post_interval:24,ai_bot_content_mode:"static_text",ai_bot_static_content:"",ai_bot_file_path:"",ai_bot_generation_prompt:"Generate an interesting and engaging social media post based on the provided context. Keep it under 500 characters."}),c=f(!1),p=f(!1),k=f(!1);let C="{}";const F=N(()=>B.value.map(s=>({id:s.id,name:`${s.name} (by ${s.author})`}))),j=N(()=>{const s={};return x.value?(x.value.forEach(t=>{let o="Aliases",d=t.name;if(t.binding)o=t.binding;else if(t.name&&t.name.includes("/")){const n=t.name.split("/");o=n[0],d=n.slice(1).join("/")}o=o.charAt(0).toUpperCase()+o.slice(1),s[o]||(s[o]=[]),s[o].push({...t,displayName:d})}),Object.keys(s).sort().reduce((t,o)=>(t[o]=s[o].sort((d,n)=>d.displayName.localeCompare(n.displayName)),t),{})):{}});O(()=>{v.value||u.fetchAiBotSettings(),x.value.length===0&&u.fetchAdminAvailableLollmsModels(),B.value.length===0&&A.fetchPersonalities()}),M(v,L,{deep:!0}),M(a,s=>{k.value=JSON.stringify(s)!==C},{deep:!0});function L(){if(!v.value)return;const s=v.value,t={lollms_model_name:s.lollms_model_name||"",active_personality_id:s.active_personality_id||"",ai_bot_enabled:s.ai_bot_enabled??!1,ai_bot_system_prompt:s.ai_bot_system_prompt||"",ai_bot_auto_post:s.ai_bot_auto_post??!1,ai_bot_post_interval:s.ai_bot_post_interval||24,ai_bot_content_mode:s.ai_bot_content_mode||"static_text",ai_bot_static_content:s.ai_bot_static_content||"",ai_bot_file_path:s.ai_bot_file_path||"",ai_bot_generation_prompt:s.ai_bot_generation_prompt||""};a.value=t,C=JSON.stringify(a.value),k.value=!1}async function T(){c.value=!0;try{const s={...a.value};await u.updateAiBotSettings(s),g.addNotification("Settings saved successfully","success")}catch(s){console.error(s),g.addNotification("Failed to save settings","error")}finally{c.value=!1}}async function I(){if(confirm("This will force the bot to generate and publish a post immediately using the current settings. Continue?")){p.value=!0;try{await K.post("/api/admin/trigger-post"),g.addNotification("Post generation task started!","success")}catch(s){console.error(s),g.addNotification("Failed to trigger post.","error")}finally{p.value=!1}}}return(s,t)=>(i(),l("div",H,[t[29]||(t[29]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," AI Bot Settings "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure the automated AI assistant that responds to @lollms mentions and auto-posts content. ")],-1)),V(U)?(i(),l("div",J,"Loading settings...")):Object.keys(a.value).length?(i(),l("form",{key:1,onSubmit:$(T,["prevent"]),class:"p-6"},[e("div",R,[e("div",W,[t[10]||(t[10]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable AI Bot Responses"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Allow the bot to reply to @lollms mentions.")],-1)),e("button",{onClick:t[0]||(t[0]=o=>a.value.ai_bot_enabled=!a.value.ai_bot_enabled),type:"button",class:y([a.value.ai_bot_enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:y([a.value.ai_bot_enabled?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),e("div",q,[e("div",null,[t[12]||(t[12]=e("label",{for:"bot-model",class:"block text-sm font-medium"},"Bot Model",-1)),r(e("select",{id:"bot-model","onUpdate:modelValue":t[1]||(t[1]=o=>a.value.lollms_model_name=o),class:"input-field mt-1"},[t[11]||(t[11]=e("option",{value:""},"-- Select a Model --",-1)),(i(!0),l(h,null,S(j.value,(o,d)=>(i(),l("optgroup",{key:d,label:d},[(i(!0),l(h,null,S(o,n=>(i(),l("option",{key:n.id,value:n.id},b(n.displayName),9,X))),128))],8,Q))),128))],512),[[w,a.value.lollms_model_name]]),t[13]||(t[13]=e("p",{class:"mt-1 text-xs text-gray-500"},"The model the bot will use for all system-level generations.",-1))]),e("div",null,[t[15]||(t[15]=e("label",{for:"bot-personality",class:"block text-sm font-medium"},"Bot Personality",-1)),r(e("select",{id:"bot-personality","onUpdate:modelValue":t[2]||(t[2]=o=>a.value.active_personality_id=o),class:"input-field mt-1"},[t[14]||(t[14]=e("option",{value:""},"-- Use Default System Prompt --",-1)),(i(!0),l(h,null,S(F.value,o=>(i(),l("option",{key:o.id,value:o.id},b(o.name),9,Y))),128))],512),[[w,a.value.active_personality_id]]),t[16]||(t[16]=e("p",{class:"mt-1 text-xs text-gray-500"},"Select a personality to define the bot's behavior.",-1))]),a.value.active_personality_id?m("",!0):(i(),l("div",Z,[t[17]||(t[17]=e("label",{for:"bot-prompt",class:"block text-sm font-medium"},"Default System Prompt",-1)),r(e("textarea",{id:"bot-prompt","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.ai_bot_system_prompt=o),rows:"3",class:"input-field mt-1"},null,512),[[_,a.value.ai_bot_system_prompt]])]))]),e("div",tt,[e("div",et,[t[20]||(t[20]=e("h4",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Auto-Posting Feed",-1)),a.value.ai_bot_auto_post?(i(),l("button",{key:0,type:"button",onClick:I,disabled:p.value,class:"btn btn-secondary btn-sm flex items-center gap-2"},[p.value?(i(),l("svg",at,t[18]||(t[18]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(i(),l("svg",st,t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))),G(" "+b(p.value?"Generating...":"Trigger Post Now"),1)],8,ot)):m("",!0)]),e("div",lt,[t[21]||(t[21]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable Auto-Posting"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"The bot will post to the main feed periodically based on provided material.")],-1)),e("button",{onClick:t[4]||(t[4]=o=>a.value.ai_bot_auto_post=!a.value.ai_bot_auto_post),type:"button",class:y([a.value.ai_bot_auto_post?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[e("span",{class:y([a.value.ai_bot_auto_post?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),a.value.ai_bot_auto_post?(i(),l("div",it,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium"},"Posting Interval (Hours)",-1)),r(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=o=>a.value.ai_bot_post_interval=o),min:"1",step:"0.5",class:"input-field mt-1"},null,512),[[_,a.value.ai_bot_post_interval]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium"},"Content Source",-1)),r(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.value.ai_bot_content_mode=o),class:"input-field mt-1"},t[23]||(t[23]=[e("option",{value:"static_text"},"Manual Text (Knowledge Base)",-1),e("option",{value:"file"},"File Path (Server Side)",-1)]),512),[[w,a.value.ai_bot_content_mode]])]),a.value.ai_bot_content_mode==="static_text"?(i(),l("div",nt,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium"},"Knowledge Base Material",-1)),r(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=o=>a.value.ai_bot_static_content=o),rows:"6",class:"input-field mt-1",placeholder:"Paste interesting facts, news, or context here..."},null,512),[[_,a.value.ai_bot_static_content]])])):m("",!0),a.value.ai_bot_content_mode==="file"?(i(),l("div",rt,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium"},"Absolute File Path",-1)),r(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=o=>a.value.ai_bot_file_path=o),class:"input-field mt-1",placeholder:"/path/to/interesting_content.txt"},null,512),[[_,a.value.ai_bot_file_path]])])):m("",!0),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium"},"Generation Prompt",-1)),r(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.value.ai_bot_generation_prompt=o),rows:"3",class:"input-field mt-1"},null,512),[[_,a.value.ai_bot_generation_prompt]]),t[28]||(t[28]=e("p",{class:"mt-1 text-xs text-gray-500"},"Instructions for the AI on how to use the material to create a post.",-1))])])):m("",!0)])]),e("div",dt,[e("div",ut,[e("button",{type:"submit",class:"btn btn-primary",disabled:c.value||!k.value},b(c.value?"Saving...":"Save Settings"),9,pt)])])],32)):(i(),l("div",mt,[e("p",bt,b(V(u).isLoadingSettings?"Loading settings...":"Could not load AI Bot settings."),1)]))]))}};export{ct as default};
