import{c7 as F,ae as I,c1 as S,r as v,c as k,o as U,w as h,b as o,d as i,h as t,i as g,P as V,n as w,g as N,l as y,c2 as B,F as A,m as P,t as u,v as T}from"./index-CLkdNmIG.js";const j={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},E={key:0,class:"p-6 text-center"},G={class:"space-y-8"},O={class:"relative flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},$={class:"space-y-6 pt-6 border-t dark:border-gray-600"},J=["value"],R=["value"],z={key:0},q={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},H={class:"flex justify-end"},K=["disabled"],Q={key:2,class:"p-6 text-center"},W={class:"text-gray-500"},Z={__name:"AiBotSettings",setup(X){const n=F(),m=I(),{globalSettings:b,aiBotSettings:r,isLoadingAiBotSettings:L}=S(n),{availableLollmsModels:_,publicPersonalities:f}=S(m),a=v({ai_bot_enabled:!1,ai_bot_system_prompt:"",lollms_model_name:"",active_personality_id:""}),d=v(!1),p=v(!1);let c="{}";const x=k(()=>b.value.filter(s=>s.category==="AI Bot")),M=k(()=>f.value.map(s=>({id:s.id,name:`${s.name} (by ${s.author})`})));U(()=>{b.value.length===0&&n.fetchGlobalSettings(),r.value||n.fetchAiBotSettings(),_.value.length===0&&m.fetchAdminAvailableLollmsModels(),f.value.length===0&&m.fetchPersonalities()}),h([b,r],C,{deep:!0}),h(a,s=>{p.value=JSON.stringify(s)!==c},{deep:!0});function C(){const s={...a.value};x.value.length>0&&x.value.forEach(e=>{s[e.key]=e.value}),r.value&&(s.lollms_model_name=r.value.lollms_model_name,s.active_personality_id=r.value.active_personality_id),a.value=s,c=JSON.stringify(a.value),p.value=!1}async function D(){d.value=!0;try{const s={ai_bot_enabled:a.value.ai_bot_enabled,ai_bot_system_prompt:a.value.ai_bot_system_prompt},e={lollms_model_name:a.value.lollms_model_name,active_personality_id:a.value.active_personality_id};await Promise.all([n.updateGlobalSettings(s),n.updateAiBotSettings(e)])}finally{d.value=!1}}return(s,e)=>(i(),o("div",j,[e[13]||(e[13]=t("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," AI Bot Settings "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure the automated AI assistant that responds to @lollms mentions and performs system tasks like RSS processing. ")],-1)),g(L)?(i(),o("div",E,"Loading settings...")):Object.keys(a.value).length?(i(),o("form",{key:1,onSubmit:V(D,["prevent"]),class:"p-6"},[t("div",G,[t("div",O,[e[4]||(e[4]=t("span",{class:"flex-grow flex flex-col"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable AI Bot"),t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Allow the bot to reply to @lollms mentions.")],-1)),t("button",{onClick:e[0]||(e[0]=l=>a.value.ai_bot_enabled=!a.value.ai_bot_enabled),type:"button",class:w([a.value.ai_bot_enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:w([a.value.ai_bot_enabled?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),t("div",$,[t("div",null,[e[6]||(e[6]=t("label",{for:"bot-model",class:"block text-sm font-medium"},"Bot Model",-1)),y(t("select",{id:"bot-model","onUpdate:modelValue":e[1]||(e[1]=l=>a.value.lollms_model_name=l),class:"input-field mt-1"},[e[5]||(e[5]=t("option",{value:""},"-- Select a Model --",-1)),(i(!0),o(A,null,P(g(_),l=>(i(),o("option",{key:l.id,value:l.id},u(l.name),9,J))),128))],512),[[B,a.value.lollms_model_name]]),e[7]||(e[7]=t("p",{class:"mt-1 text-xs text-gray-500"},"The model the bot will use for all system-level generations.",-1))]),t("div",null,[e[9]||(e[9]=t("label",{for:"bot-personality",class:"block text-sm font-medium"},"Bot Personality",-1)),y(t("select",{id:"bot-personality","onUpdate:modelValue":e[2]||(e[2]=l=>a.value.active_personality_id=l),class:"input-field mt-1"},[e[8]||(e[8]=t("option",{value:""},"-- Use Default System Prompt --",-1)),(i(!0),o(A,null,P(M.value,l=>(i(),o("option",{key:l.id,value:l.id},u(l.name),9,R))),128))],512),[[B,a.value.active_personality_id]]),e[10]||(e[10]=t("p",{class:"mt-1 text-xs text-gray-500"},"Select a personality to define the bot's behavior.",-1))]),a.value.active_personality_id?N("",!0):(i(),o("div",z,[e[11]||(e[11]=t("label",{for:"bot-prompt",class:"block text-sm font-medium"},"Default System Prompt",-1)),y(t("textarea",{id:"bot-prompt","onUpdate:modelValue":e[3]||(e[3]=l=>a.value.ai_bot_system_prompt=l),rows:"6",class:"input-field mt-1"},null,512),[[T,a.value.ai_bot_system_prompt]]),e[12]||(e[12]=t("p",{class:"mt-1 text-xs text-gray-500"},"The system prompt used if no personality is selected.",-1))]))])]),t("div",q,[t("div",H,[t("button",{type:"submit",class:"btn btn-primary",disabled:d.value||!p.value},u(d.value?"Saving...":"Save Settings"),9,K)])])],32)):(i(),o("div",Q,[t("p",W,u(g(n).isLoadingSettings?"Loading settings...":"Could not load AI Bot settings."),1)]))]))}};export{Z as default};
