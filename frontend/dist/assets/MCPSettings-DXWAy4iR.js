import{r as d,b as n,e as s,d as v,f as e,y as L,t as g,x as Y,k as G,a as J,u as Q,s as I,o as W,l as X,c as $,g as ee,A as te,w as ae,h,v as A,n as le,i as se,T as ne,q as N,F as U,m as D,z as R}from"./index-DZGxGMYB.js";const oe={class:"relative bg-white dark:bg-gray-800/80 shadow rounded-lg p-4 flex flex-col transition hover:shadow-md"},re=["title"],ie={class:"flex-grow"},de={class:"flex items-center gap-x-4"},ue={class:"h-12 w-12 rounded-md flex-shrink-0 bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden"},ce=["src"],ve={key:1,class:"w-7 h-7 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},ge={class:"truncate"},me=["title"],ye=["title"],pe={class:"mt-3 flex items-center gap-x-3 flex-wrap"},fe={key:0,class:"flex items-center gap-x-1 px-2 py-0.5 rounded-full text-xs bg-blue-50 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400"},xe={class:"capitalize"},he={key:1,class:"flex items-center gap-x-1 px-2 py-0.5 rounded-full text-xs bg-yellow-50 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400"},be={key:2,class:"flex items-center gap-x-1 px-2 py-0.5 rounded-full text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"},ke={key:1,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end items-center gap-x-3 text-sm"},T={__name:"McpCard",props:{mcp:{type:Object,required:!0},isEditable:{type:Boolean,default:!1}},emits:["edit","delete"],setup(r,{emit:u}){const c=r,b=u,y=d(!1);function k(){y.value=!0}function p(){b("edit",c.mcp)}function a(){b("delete",c.mcp)}return(m,i)=>(s(),n("div",oe,[typeof r.mcp.active=="boolean"?(s(),n("span",{key:0,class:L(["absolute top-3 right-3 h-3 w-3 rounded-full",r.mcp.active?"bg-green-500":"bg-gray-400 dark:bg-gray-600"]),title:r.mcp.active?"Active":"Inactive"},null,10,re)):v("",!0),e("div",ie,[e("div",de,[e("div",ue,[r.mcp.icon&&!y.value?(s(),n("img",{key:0,src:r.mcp.icon,onError:k,alt:"Server Icon",class:"h-full w-full object-cover"},null,40,ce)):(s(),n("svg",ve,i[0]||(i[0]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Z"},null,-1)])))]),e("div",ge,[e("p",{class:"font-semibold text-gray-900 dark:text-white truncate pr-6",title:r.mcp.name},g(r.mcp.name),9,me),e("p",{class:"text-xs text-gray-500 dark:text-gray-400 font-mono truncate",title:r.mcp.url},g(r.mcp.url),9,ye)])]),e("div",pe,[r.mcp.type?(s(),n("div",fe,[i[1]||(i[1]=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-3 h-3"},[e("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.139a6.002 6.002 0 0 0-11.215 0c-.22.578.254 1.139.872 1.139h9.47Z"})],-1)),e("span",xe,g(r.mcp.type),1)])):v("",!0),r.mcp.authentication_type&&r.mcp.authentication_type!=="none"?(s(),n("div",he,i[2]||(i[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-3 h-3"},[e("path",{"fill-rule":"evenodd",d:"M8 1a3.5 3.5 0 0 0-3.5 3.5V6h7V4.5A3.5 3.5 0 0 0 8 1Zm-5 5a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H3Z","clip-rule":"evenodd"})],-1),e("span",null,"Secured",-1)]))):(s(),n("div",be,i[3]||(i[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"w-3 h-3"},[e("path",{"fill-rule":"evenodd",d:"M11.5 6V4.5a3.5 3.5 0 1 0-7 0V6H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1h-1.5Zm-4 0V4.5a.5.5 0 0 1 1 0V6h-1Z","clip-rule":"evenodd"})],-1),e("span",null,"No Auth",-1)])))])]),r.isEditable?(s(),n("div",ke,[e("button",{onClick:p,class:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-500 dark:hover:text-blue-400"},"Edit"),e("button",{onClick:a,class:"font-medium text-red-600 hover:text-red-500 dark:text-red-500 dark:hover:text-red-400"},"Delete")])):v("",!0)]))}},we={class:"space-y-10"},_e={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},Me={class:"px-4 py-5 sm:p-6"},Ce={class:"text-xl font-bold leading-6 text-gray-900 dark:text-white capitalize"},Se={class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},$e={class:"border-t border-gray-200 dark:border-gray-700"},Ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Le={class:"mt-2 flex items-center gap-x-4"},je={class:"h-16 w-16 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden"},Pe=["src"],Ve={key:1,class:"w-8 h-8 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},Fe={class:"flex-grow space-y-2"},Be={class:"flex items-center gap-x-3"},Ee={class:"flex items-center justify-between bg-gray-50 dark:bg-gray-700/50 p-3 rounded-md"},Ie={class:"space-y-4"},Ne={key:0,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ue={key:1,class:"relative"},De=["type"],Re={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},Te={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},ze={class:"flex justify-end items-center gap-x-3 pt-2"},He=["disabled"],Ze={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},qe={class:"flex items-center gap-x-3"},Ke={key:0,class:"text-center py-10 px-4 rounded-lg bg-gray-50 dark:bg-gray-800/50"},Oe={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},Ye={class:"flex justify-between items-center mb-4 flex-wrap gap-4"},Ge=["disabled"],Je={key:0,class:"text-center py-10 px-4 rounded-lg bg-gray-50 dark:bg-gray-800/50"},Qe={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},We={__name:"MCPSettings",setup(r){const u=G(),c=J(),b=Q(),{userMcps:y}=I(u),{user:k}=I(b),p=(l="user")=>({name:"",url:"",icon:"",active:!0,type:l,authentication_type:"none",authentication_key:""}),a=d(p()),m=d(null),i=d(!1),w=d(!1),f=d(!1),j=d(null),C=d(!1),_=d(!1);W(()=>{u.fetchMcps()}),X(()=>a.value.icon,()=>{C.value=!1});const x=$(()=>m.value!==null),P=$(()=>y.value.filter(l=>l.type==="user").sort((l,t)=>l.name.localeCompare(t.name))),V=$(()=>y.value.filter(l=>l.type==="system").sort((l,t)=>l.name.localeCompare(t.name)));function F(l="user"){x.value&&M(),a.value=p(l),_.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function B(l){m.value={...l},a.value.name=l.name,a.value.url=l.url,a.value.icon=l.icon||"",a.value.active=typeof l.active=="boolean"?l.active:!0,a.value.type=l.type||"user",a.value.authentication_type=l.authentication_type||"none",a.value.authentication_key=l.authentication_key||"",_.value=!0,window.scrollTo({top:0,behavior:"smooth"})}function M(){m.value=null,a.value=p(),f.value=!1,_.value=!1}function z(){C.value=!0}async function H(){w.value=!0;try{await u.triggerMcpReload()}catch{}finally{w.value=!1}}async function Z(){if(!a.value.name||!a.value.url){c.addNotification("Name and URL are required.","warning");return}i.value=!0;try{const l={name:a.value.name,url:a.value.url,icon:a.value.icon||null,active:a.value.active,type:a.value.type,authentication_type:a.value.authentication_type,authentication_key:a.value.authentication_key||""};x.value?await u.updateMcp(m.value.id,l):await u.addMcp(l),M()}catch{}finally{i.value=!1}}async function E(l){await c.showConfirmation({title:`Delete '${l.name}'?`,message:"Are you sure you want to remove this MCP server? This cannot be undone.",confirmText:"Delete"})&&(m.value&&m.value.id===l.id&&M(),await u.deleteMcp(l.id))}function q(){j.value.click()}function K(l){const t=l.target.files[0];if(!t)return;if(!["image/jpeg","image/png","image/gif","image/webp","image/svg+xml"].includes(t.type)){c.addNotification("Invalid file type. Please select an image.","error");return}if(t.size>1*1024*1024){c.addNotification("File is too large. Maximum size is 1MB.","error");return}const S=new FileReader;S.onload=O=>{a.value.icon=O.target.result},S.onerror=()=>{c.addNotification("Failed to read the file.","error")},S.readAsDataURL(t),l.target.value=""}return(l,t)=>(s(),n("div",we,[ee(ne,{name:"form-fade"},{default:te(()=>[_.value?(s(),n("div",_e,[e("div",Me,[e("h2",Ce,g(x.value?"Edit":"Add")+" "+g(a.value.type)+" MCP Server ",1),e("p",Se,g(a.value.type==="user"?"Personal servers are only available to you.":"System servers are available to all users."),1)]),e("div",$e,[e("form",{onSubmit:ae(Z,["prevent"]),class:"p-4 sm:p-6 space-y-6"},[e("div",Ae,[e("div",null,[t[11]||(t[11]=e("label",{for:"mcpName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),h(e("input",{type:"text",id:"mcpName","onUpdate:modelValue":t[0]||(t[0]=o=>a.value.name=o),class:"input-field mt-1",placeholder:"My Local Server",required:""},null,512),[[A,a.value.name]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"mcpUrl",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"URL",-1)),h(e("input",{type:"url",id:"mcpUrl","onUpdate:modelValue":t[1]||(t[1]=o=>a.value.url=o),class:"input-field mt-1",placeholder:"http://127.0.0.1:9602",required:""},null,512),[[A,a.value.url]])])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Icon (Optional)",-1)),e("div",Le,[e("div",je,[a.value.icon&&!C.value?(s(),n("img",{key:0,src:a.value.icon,onError:z,alt:"Icon Preview",class:"h-full w-full object-cover"},null,40,Pe)):(s(),n("svg",Ve,t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Z"},null,-1)])))]),e("div",Fe,[h(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=o=>a.value.icon=o),class:"input-field",placeholder:"Paste image URL or upload a file"},null,512),[[A,a.value.icon]]),e("div",Be,[e("button",{onClick:q,type:"button",class:"btn btn-secondary text-sm"},"Upload File"),a.value.icon?(s(),n("button",{key:0,onClick:t[3]||(t[3]=o=>a.value.icon=""),type:"button",class:"text-sm font-medium text-red-600 hover:text-red-500"},"Remove")):v("",!0)])])]),e("input",{type:"file",ref_key:"fileInput",ref:j,onChange:K,class:"hidden",accept:"image/png, image/jpeg, image/gif, image/webp, image/svg+xml"},null,544)]),e("div",Ee,[t[15]||(t[15]=e("span",{class:"flex-grow flex flex-col"},[e("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Active"),e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Inactive servers cannot be used for generation.")],-1)),e("button",{onClick:t[4]||(t[4]=o=>a.value.active=!a.value.active),type:"button",class:L([a.value.active?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"])},[e("span",{class:L([a.value.active?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),e("fieldset",Ie,[t[20]||(t[20]=e("legend",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Authentication",-1)),h(e("select",{id:"mcpAuthType","onUpdate:modelValue":t[5]||(t[5]=o=>a.value.authentication_type=o),class:"input-field"},t[16]||(t[16]=[e("option",{value:"none"},"None",-1),e("option",{value:"lollms_chat_auth"},"LoLLMs Chat Auth",-1),e("option",{value:"bearer"},"Bearer Token",-1)]),512),[[le,a.value.authentication_type]]),a.value.authentication_type==="lollms_chat_auth"?(s(),n("p",Ne," A temporary token will be generated by LoLLMs for each session. ")):v("",!0),a.value.authentication_type==="bearer"?(s(),n("div",Ue,[t[19]||(t[19]=e("label",{for:"mcpKey",class:"sr-only"},"Authentication Key",-1)),h(e("input",{type:f.value?"text":"password",id:"mcpKey","onUpdate:modelValue":t[6]||(t[6]=o=>a.value.authentication_key=o),class:"input-field pr-10",placeholder:"Paste your Bearer token here"},null,8,De),[[se,a.value.authentication_key]]),e("button",{type:"button",onClick:t[7]||(t[7]=o=>f.value=!f.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"},[f.value?(s(),n("svg",Te,t[18]||(t[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228"},null,-1)]))):(s(),n("svg",Re,t[17]||(t[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])))])])):v("",!0)]),e("div",ze,[e("button",{onClick:M,type:"button",class:"btn btn-secondary"},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:i.value},g(i.value?x.value?"Saving...":"Adding...":x.value?"Save Changes":"Add MCP Server"),9,He)])],32)])])):v("",!0)]),_:1}),e("section",null,[e("div",Ze,[t[21]||(t[21]=e("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"Your Personal MCPs",-1)),e("div",qe,[e("button",{onClick:t[8]||(t[8]=o=>F("user")),class:"btn btn-primary text-sm"}," + Add Personal Server "),N(k).is_admin?(s(),n("button",{key:0,onClick:t[9]||(t[9]=o=>F("system")),class:"btn btn-secondary text-sm"}," + Add System Server ")):v("",!0)])]),P.value.length===0?(s(),n("div",Ke,t[22]||(t[22]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"You haven't added any personal MCP servers yet.",-1),e("p",{class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},'Click "Add Personal Server" to get started.',-1)]))):(s(),n("div",Oe,[(s(!0),n(U,null,D(P.value,o=>(s(),R(T,{key:o.id,mcp:o,"is-editable":"",onEdit:B,onDelete:E},null,8,["mcp"]))),128))]))]),e("section",null,[e("div",Ye,[t[23]||(t[23]=e("h3",{class:"text-xl font-bold leading-6 text-gray-900 dark:text-white"},"System MCPs",-1)),e("button",{onClick:t[10]||(t[10]=o=>H()),class:"btn btn-secondary text-sm",disabled:w.value},g(w.value?"Reloading...":"Reload All Servers"),9,Ge)]),V.value.length===0?(s(),n("div",Je,t[24]||(t[24]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"No system-wide MCP servers are available.",-1)]))):(s(),n("div",Qe,[(s(!0),n(U,null,D(V.value,o=>(s(),R(T,{key:o.id,mcp:o,"is-editable":N(k).is_admin,onEdit:B,onDelete:E},null,8,["mcp","is-editable"]))),128))]))])]))}},et=Y(We,[["__scopeId","data-v-181337fa"]]);export{et as default};
