import{c7 as C,a as I,r as u,c as x,o as M,w as k,b as r,d as o,h as t,i as g,P as y,g as P,n as S,e as w,cd as h,t as B}from"./index-DnjdbnqE.js";const L={class:"bg-white dark:bg-gray-800 shadow-md rounded-lg"},N={key:0,class:"p-6 text-center"},A={key:0,class:"text-center text-gray-500"},T={key:1,class:"space-y-6"},$={class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},j={key:0,class:"space-y-4"},E={class:"mt-1 flex rounded-md shadow-sm"},O=["value"],U={class:"mt-1 flex rounded-md shadow-sm"},V=["value"],G=["disabled"],J={class:"mt-8 pt-5 border-t border-gray-200 dark:border-gray-700"},z={class:"flex justify-end"},D=["disabled"],q={__name:"SCIMSettings",setup(F){const n=C(),c=I(),a=u({}),l=u(!1),i=u(!1);let p="{}";const b=x(()=>`${window.location.origin}/api/scim/v2`),d=x(()=>n.globalSettings.filter(s=>s.category==="SCIM Provisioning").sort((s,e)=>s.key.localeCompare(e.key)));function m(){if(d.value.length>0){const s={};d.value.forEach(e=>{s[e.key]=e.value}),a.value=s,p=JSON.stringify(a.value),i.value=!1}}function v(s){return typeof s=="boolean"?s:typeof s=="string"?s.toLowerCase()==="true":!!s}M(()=>{n.globalSettings.length===0?n.fetchGlobalSettings():m()}),k(()=>n.globalSettings,m,{deep:!0}),k(a,s=>{i.value=JSON.stringify(s)!==p},{deep:!0});async function _(){l.value=!0;try{await n.updateGlobalSettings({...a.value})}finally{l.value=!1}}return(s,e)=>(o(),r("div",L,[e[9]||(e[9]=t("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-xl font-semibold leading-6 text-gray-900 dark:text-white"}," SCIM Provisioning "),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Configure automated user and group provisioning from an external Identity Provider (IdP). ")],-1)),g(n).isLoadingSettings?(o(),r("div",N,"Loading settings...")):(o(),r("form",{key:1,onSubmit:y(_,["prevent"]),class:"p-6 space-y-6"},[d.value.length===0?(o(),r("div",A," Could not load SCIM settings. ")):(o(),r("div",T,[t("div",$,[e[3]||(e[3]=t("span",{class:"flex-grow flex flex-col pr-4"},[t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable SCIM"),t("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Allow an external IdP to manage users and groups in lollms.")],-1)),t("button",{onClick:e[0]||(e[0]=f=>a.value.scim_enabled=!a.value.scim_enabled),type:"button",class:S([v(a.value.scim_enabled)?"bg-blue-600":"bg-gray-200 dark:bg-gray-600","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out"])},[t("span",{class:S([v(a.value.scim_enabled)?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"])},null,2)],2)]),a.value.scim_enabled?(o(),r("div",j,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium"},"SCIM Tenant URL",-1)),t("div",E,[t("input",{type:"text",value:b.value,readonly:"",class:"input-field rounded-r-none flex-grow"},null,8,O),t("button",{onClick:e[1]||(e[1]=y(f=>g(c).copyToClipboard(b.value),["prevent"])),type:"button",class:"relative -ml-px inline-flex items-center space-x-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600"},[w(h,{class:"h-5 w-5"}),e[4]||(e[4]=t("span",null,"Copy",-1))])])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium"},"SCIM Secret Token",-1)),t("div",U,[t("input",{type:"password",value:a.value.scim_token||"A token will be generated on save",readonly:"",class:"input-field rounded-r-none flex-grow"},null,8,V),t("button",{onClick:e[2]||(e[2]=y(f=>g(c).copyToClipboard(a.value.scim_token),["prevent"])),type:"button",class:"relative -ml-px inline-flex items-center space-x-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600",disabled:!a.value.scim_token},[w(h,{class:"h-5 w-5"}),e[6]||(e[6]=t("span",null,"Copy",-1))],8,G)]),e[8]||(e[8]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," If this field is empty, a secure token will be generated when you click save. Provide this token to your IdP. ",-1))])])):P("",!0)])),t("div",J,[t("div",z,[t("button",{type:"submit",class:"btn btn-primary",disabled:l.value||!i.value},B(l.value?"Saving...":"Save Changes"),9,D)])])],32))]))}};export{q as default};
